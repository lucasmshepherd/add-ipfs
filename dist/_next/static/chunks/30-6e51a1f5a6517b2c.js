(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{19824:function(a,b){"use strict";let c=-8,d=-4,e=0,f=1,g=1,h=2,i=5,j=1024,k=2048,l=8192,m=0,n=4,o=8,p=12,q=12,r=16,s="undefined"!=typeof BigUint64Array,t=Symbol(),u=1024;function v(a,b){let c=new Uint32Array(a),e=new Uint16Array(a);var f=c[b+d>>>2]>>>1,g=b>>>1;if(f<=u)return String.fromCharCode.apply(String,e.subarray(g,g+f));let h=[];do{let i=e[g+u-1],j=i>=55296&&i<56320?u-1:u;h.push(String.fromCharCode.apply(String,e.subarray(g,g+=j))),f-=j}while(f>u);return h.join("")+String.fromCharCode.apply(String,e.subarray(g,g+f))}function w(a){let b={};function c(a,b){return a?v(a.buffer,b):"<yet unknown>"}let d=a.env=a.env||{};return d.abort=d.abort||function(a,e,f,g){let h=b.memory||d.memory;throw Error("abort: "+c(h,a)+" at "+c(h,e)+":"+f+":"+g)},d.trace=d.trace||function(a,e){let f=b.memory||d.memory;console.log("trace: "+c(f,a)+(e?" ":"")+Array.prototype.slice.call(arguments,2,2+e).join(", "))},a.Math=a.Math||Math,a.Date=a.Date||Date,b}function x(a,b){let t=b.exports,u=t.memory,w=t.table,x=t["__alloc"],y=t["__retain"],z=t["__rtti_base"]|| -1;function A(a){let b=new Uint32Array(u.buffer),c=b[z>>>2];if((a>>>=0)>=c)throw Error("invalid id: "+a);return b[(z+4>>>2)+2*a]}function B(a){let b=new Uint32Array(u.buffer),c=b[z>>>2];if((a>>>=0)>=c)throw Error("invalid id: "+a);return b[(z+4>>>2)+2*a+1]}function D(a){return 31-Math.clz32(a>>>i&31)}function E(a){let b=a.length,c=x(b<<1,f),d=new Uint16Array(u.buffer);for(var e=0,g=c>>>1;e<b;++e)d[g+e]=a.charCodeAt(e);return c}function F(a){let b=u.buffer,d=new Uint32Array(b)[a+c>>>2];if(d!==f)throw Error("not a string: "+a);return v(b,a)}function G(a,b,c){let d=u.buffer;if(c)switch(a){case 2:return new Float32Array(d);case 3:return new Float64Array(d)}else switch(a){case 0:return new(b?Int8Array:Uint8Array)(d);case 1:return new(b?Int16Array:Uint16Array)(d);case 2:return new(b?Int32Array:Uint32Array)(d);case 3:return new(b?BigInt64Array:BigUint64Array)(d)}throw Error("unsupported align: "+a)}function H(a,b){let c=A(a);if(!(c&(g|h)))throw Error("not an array: "+a+" @ "+c);let d=D(c),f=b.length,i=x(f<<d,e),s=x(c&h?r:p,a),t=new Uint32Array(u.buffer);t[s+m>>>2]=y(i),t[s+n>>>2]=i,t[s+o>>>2]=f<<d,c&h&&(t[s+q>>>2]=f);let v=G(d,c&j,c&k);if(c&l)for(let w=0;w<f;++w)v[(i>>>d)+w]=y(b[w]);else v.set(b,i>>>d);return s}function I(a){let b=new Uint32Array(u.buffer),e=b[a+c>>>2],f=A(e);if(!(f&g))throw Error("not an array: "+e);let i=D(f);var l=b[a+n>>>2];let m=f&h?b[a+q>>>2]:b[l+d>>>2]>>>i;return G(i,f&j,f&k).subarray(l>>>=i,l+m)}function J(a){let b=I(a),c=b.length,d=Array(c);for(let e=0;e<c;e++)d[e]=b[e];return d}function K(a){let b=u.buffer,c=new Uint32Array(b)[a+d>>>2];return b.slice(a,a+c)}function L(a,b,c){return new a(M(a,b,c))}function M(a,b,c){let e=u.buffer,f=new Uint32Array(e),g=f[c+n>>>2];return new a(e,g,f[g+d>>>2]>>>b)}function N(a,b){let d=new Uint32Array(u.buffer);var e=d[a+c>>>2];if(e<=d[z>>>2])do if(e==b)return!0;while(e=B(e));return!1}return a.__allocString=E,a.__getString=F,a.__allocArray=H,a.__getArrayView=I,a.__getArray=J,a.__getArrayBuffer=K,a.__getInt8Array=L.bind(null,Int8Array,0),a.__getInt8ArrayView=M.bind(null,Int8Array,0),a.__getUint8Array=L.bind(null,Uint8Array,0),a.__getUint8ArrayView=M.bind(null,Uint8Array,0),a.__getUint8ClampedArray=L.bind(null,Uint8ClampedArray,0),a.__getUint8ClampedArrayView=M.bind(null,Uint8ClampedArray,0),a.__getInt16Array=L.bind(null,Int16Array,1),a.__getInt16ArrayView=M.bind(null,Int16Array,1),a.__getUint16Array=L.bind(null,Uint16Array,1),a.__getUint16ArrayView=M.bind(null,Uint16Array,1),a.__getInt32Array=L.bind(null,Int32Array,2),a.__getInt32ArrayView=M.bind(null,Int32Array,2),a.__getUint32Array=L.bind(null,Uint32Array,2),a.__getUint32ArrayView=M.bind(null,Uint32Array,2),s&&(a.__getInt64Array=L.bind(null,BigInt64Array,3),a.__getInt64ArrayView=M.bind(null,BigInt64Array,3),a.__getUint64Array=L.bind(null,BigUint64Array,3),a.__getUint64ArrayView=M.bind(null,BigUint64Array,3)),a.__getFloat32Array=L.bind(null,Float32Array,2),a.__getFloat32ArrayView=M.bind(null,Float32Array,2),a.__getFloat64Array=L.bind(null,Float64Array,3),a.__getFloat64ArrayView=M.bind(null,Float64Array,3),a.__instanceof=N,a.memory=a.memory||u,a.table=a.table||w,C(t,a)}function y(a){return"undefined"!=typeof Response&&a instanceof Response}async function z(a,b){return y(a=await a)?B(a,b):x(w(b||(b={})),await WebAssembly.instantiate(a instanceof WebAssembly.Module?a:await WebAssembly.compile(a),b))}function A(a,b){return x(w(b||(b={})),new WebAssembly.Instance(a instanceof WebAssembly.Module?a:new WebAssembly.Module(a),b))}async function B(a,b){return WebAssembly.instantiateStreaming?x(w(b||(b={})),(await WebAssembly.instantiateStreaming(a,b)).instance):z(y(a=await a)?a.arrayBuffer():a,b)}function C(a,b){var c=b?Object.create(b):{},d=a["__argumentsLength"]?function(b){a["__argumentsLength"].value=b}:a["__setArgumentsLength"]||a["__setargc"]||function(){};for(let e in a){if(!Object.prototype.hasOwnProperty.call(a,e))continue;let f=a[e],g=e.split("."),h=c;for(;g.length>1;){let i=g.shift();Object.prototype.hasOwnProperty.call(h,i)||(h[i]={}),h=h[i]}let j=g[0],k=j.indexOf("#");if(k>=0){let l=j.substring(0,k),m=h[l];if(void 0===m||!m.prototype){let n=function(...a){return n.wrap(n.prototype.constructor(0,...a))};n.prototype={valueOf:function(){return this[t]}},n.wrap=function(a){return Object.create(n.prototype,{[t]:{value:a,writable:!1}})},m&&Object.getOwnPropertyNames(m).forEach(a=>Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(m,a))),h[l]=n}if(j=j.substring(k+1),h=h[l].prototype,/^(get|set):/.test(j)){if(!Object.prototype.hasOwnProperty.call(h,j=j.substring(4))){let o=a[e.replace("set:","get:")],p=a[e.replace("get:","set:")];Object.defineProperty(h,j,{get:function(){return o(this[t])},set:function(a){p(this[t],a)},enumerable:!0})}}else"constructor"===j?(h[j]=(...a)=>(d(a.length),f(...a))).original=f:(h[j]=function(...a){return d(a.length),f(this[t],...a)}).original=f}else/^(get|set):/.test(j)?Object.prototype.hasOwnProperty.call(h,j=j.substring(4))||Object.defineProperty(h,j,{get:a[e.replace("set:","get:")],set:a[e.replace("get:","set:")],enumerable:!0}):"function"==typeof f&&f!==d?(h[j]=(...a)=>(d(a.length),f(...a))).original=f:h[j]=f}return c}b.instantiate=z,b.instantiateSync=A,b.instantiateStreaming=B,b.demangle=C},37124:function(a,b,c){"use strict";a.exports=c(64478)},41496:function(a){"use strict";a.exports=d;var b,c=/\/|\./;function d(a,b){c.test(a)||(a="google/protobuf/"+a+".proto",b={nested:{google:{nested:{protobuf:{nested:b}}}}}),d[a]=b}d("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),d("duration",{Duration:b={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),d("timestamp",{Timestamp:b}),d("empty",{Empty:{fields:{}}}),d("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),d("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),d("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),d.get=function(a){return d[a]||null}},99305:function(a,b,c){"use strict";var d=b,e=c(63697),f=c(41509);function g(a,b,c,d){if(b.resolvedType){if(b.resolvedType instanceof e){a("switch(d%s){",d);for(var f=b.resolvedType.values,g=Object.keys(f),h=0;h<g.length;++h)f[g[h]]!==b.typeDefault||(a("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',d,d,d),b.repeated||a("break")),a("case%j:",g[h])("case %i:",f[g[h]])("m%s=%j",d,f[g[h]])("break");a("}")}else a('if(typeof d%s!=="object")',d)("throw TypeError(%j)",b.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",d,c,d)}else{var i=!1;switch(b.type){case"double":case"float":a("m%s=Number(d%s)",d,d);break;case"uint32":case"fixed32":a("m%s=d%s>>>0",d,d);break;case"int32":case"sint32":case"sfixed32":a("m%s=d%s|0",d,d);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",d,d,i)('else if(typeof d%s==="string")',d)("m%s=parseInt(d%s,10)",d,d)('else if(typeof d%s==="number")',d)("m%s=d%s",d,d)('else if(typeof d%s==="object")',d)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",d,d,d,i?"true":"");break;case"bytes":a('if(typeof d%s==="string")',d)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",d,d,d)("else if(d%s.length >= 0)",d)("m%s=d%s",d,d);break;case"string":a("m%s=String(d%s)",d,d);break;case"bool":a("m%s=Boolean(d%s)",d,d)}}return a}function h(a,b,c,d){if(b.resolvedType)b.resolvedType instanceof e?a("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",d,c,d,d,c,d,d):a("d%s=types[%i].toObject(m%s,o)",d,c,d);else{var f=!1;switch(b.type){case"double":case"float":a("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",d,d,d,d);break;case"uint64":f=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a('if(typeof m%s==="number")',d)("d%s=o.longs===String?String(m%s):m%s",d,d,d)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",d,d,d,d,f?"true":"",d);break;case"bytes":a("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",d,d,d,d,d);break;default:a("d%s=m%s",d,d)}}return a}d.fromObject=function(a){var b=a.fieldsArray,c=f.codegen(["d"],a.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!b.length)return c("return new this.ctor");c("var m=new this.ctor");for(var d=0;d<b.length;++d){var h=b[d].resolve(),i=f.safeProp(h.name);h.map?(c("if(d%s){",i)('if(typeof d%s!=="object")',i)("throw TypeError(%j)",h.fullName+": object expected")("m%s={}",i)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",i),g(c,h,d,i+"[ks[i]]")("}")("}")):h.repeated?(c("if(d%s){",i)("if(!Array.isArray(d%s))",i)("throw TypeError(%j)",h.fullName+": array expected")("m%s=[]",i)("for(var i=0;i<d%s.length;++i){",i),g(c,h,d,i+"[i]")("}")("}")):(h.resolvedType instanceof e||c("if(d%s!=null){",i),g(c,h,d,i),h.resolvedType instanceof e||c("}"))}return c("return m")},d.toObject=function(a){var b=a.fieldsArray.slice().sort(f.compareFieldsById);if(!b.length)return f.codegen()("return {}");for(var c=f.codegen(["m","o"],a.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],g=[],i=[],j=0;j<b.length;++j)b[j].partOf||(b[j].resolve().repeated?d:b[j].map?g:i).push(b[j]);if(d.length){for(c("if(o.arrays||o.defaults){"),j=0;j<d.length;++j)c("d%s=[]",f.safeProp(d[j].name));c("}")}if(g.length){for(c("if(o.objects||o.defaults){"),j=0;j<g.length;++j)c("d%s={}",f.safeProp(g[j].name));c("}")}if(i.length){for(c("if(o.defaults){"),j=0;j<i.length;++j){var k=i[j],l=f.safeProp(k.name);if(k.resolvedType instanceof e)c("d%s=o.enums===String?%j:%j",l,k.resolvedType.valuesById[k.typeDefault],k.typeDefault);else if(k.long)c("if(util.Long){")("var n=new util.Long(%i,%i,%j)",k.typeDefault.low,k.typeDefault.high,k.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,k.typeDefault.toString(),k.typeDefault.toNumber());else if(k.bytes){var m="["+Array.prototype.slice.call(k.typeDefault).join(",")+"]";c("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,k.typeDefault))("else{")("d%s=%s",l,m)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else c("d%s=%j",l,k.typeDefault)}c("}")}var n=!1;for(j=0;j<b.length;++j){var k=b[j],o=a._fieldsArray.indexOf(k),l=f.safeProp(k.name);k.map?(n||(n=!0,c("var ks2")),c("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),h(c,k,o,l+"[ks2[j]]")("}")):k.repeated?(c("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),h(c,k,o,l+"[j]")("}")):(c("if(m%s!=null&&m.hasOwnProperty(%j)){",l,k.name),h(c,k,o,l),k.partOf&&c("if(o.oneofs)")("d%s=%j",f.safeProp(k.partOf.name),k.name)),c("}")}return c("return d")}},77472:function(a,b,c){"use strict";a.exports=h;var d=c(63697),e=c(51847),f=c(41509);function g(a){return"missing required '"+a.name+"'"}function h(a){var b=f.codegen(["r","l"],a.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(a.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");a.group&&b("if((t&7)===4)")("break"),b("switch(t>>>3){");for(var c=0;c<a.fieldsArray.length;++c){var h=a._fieldsArray[c].resolve(),i=h.resolvedType instanceof d?"int32":h.type,j="m"+f.safeProp(h.name);b("case %i: {",h.id),h.map?(b("if(%s===util.emptyObject)",j)("%s={}",j)("var c2 = r.uint32()+r.pos"),void 0!==e.defaults[h.keyType]?b("k=%j",e.defaults[h.keyType]):b("k=null"),void 0!==e.defaults[i]?b("value=%j",e.defaults[i]):b("value=null"),b("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",h.keyType)("case 2:"),void 0===e.basic[i]?b("value=types[%i].decode(r,r.uint32())",c):b("value=r.%s()",i),b("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),b(void 0!==e.long[h.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",j)):h.repeated?(b("if(!(%s&&%s.length))",j,j)("%s=[]",j),void 0!==e.packed[i]&&b("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",j,i)("}else"),void 0===e.basic[i]?b(h.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",j,c):b("%s.push(r.%s())",j,i)):void 0===e.basic[i]?b(h.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",j,c):b("%s=r.%s()",j,i),b("break")("}")}for(b("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<a._fieldsArray.length;++c){var k=a._fieldsArray[c];k.required&&b("if(!m.hasOwnProperty(%j))",k.name)("throw util.ProtocolError(%j,{instance:m})",g(k))}return b("return m")}},39097:function(a,b,c){"use strict";a.exports=h;var d=c(63697),e=c(51847),f=c(41509);function g(a,b,c,d){return b.resolvedType.group?a("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,d,(b.id<<3|3)>>>0,(b.id<<3|4)>>>0):a("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,d,(b.id<<3|2)>>>0)}function h(a){for(var b,c,h=f.codegen(["m","w"],a.name+"$encode")("if(!w)")("w=Writer.create()"),i=a.fieldsArray.slice().sort(f.compareFieldsById),b=0;b<i.length;++b){var j=i[b].resolve(),k=a._fieldsArray.indexOf(j),l=j.resolvedType instanceof d?"int32":j.type,m=e.basic[l];c="m"+f.safeProp(j.name),j.map?(h("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",c,j.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",c)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(j.id<<3|2)>>>0,8|e.mapKey[j.keyType],j.keyType),void 0===m?h("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",k,c):h(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|m,l,c),h("}")("}")):j.repeated?(h("if(%s!=null&&%s.length){",c,c),j.packed&& void 0!==e.packed[l]?h("w.uint32(%i).fork()",(j.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",c)("w.%s(%s[i])",l,c)("w.ldelim()"):(h("for(var i=0;i<%s.length;++i)",c),void 0===m?g(h,j,k,c+"[i]"):h("w.uint32(%i).%s(%s[i])",(j.id<<3|m)>>>0,l,c)),h("}")):(j.optional&&h("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",c,j.name),void 0===m?g(h,j,k,c):h("w.uint32(%i).%s(%s)",(j.id<<3|m)>>>0,l,c))}return h("return w")}},63697:function(a,b,c){"use strict";a.exports=g;var d=c(12070);((g.prototype=Object.create(d.prototype)).constructor=g).className="Enum";var e=c(81865),f=c(41509);function g(a,b,c,e,f,g){if(d.call(this,a,c),b&&"object"!=typeof b)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=e,this.comments=f||{},this.valuesOptions=g,this.reserved=void 0,b)for(var h=Object.keys(b),i=0;i<h.length;++i)"number"==typeof b[h[i]]&&(this.valuesById[this.values[h[i]]=b[h[i]]]=h[i])}g.fromJSON=function(a,b){var c=new g(a,b.values,b.options,b.comment,b.comments);return c.reserved=b.reserved,c},g.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return f.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",b?this.comment:void 0,"comments",b?this.comments:void 0])},g.prototype.add=function(a,b,c,d){if(!f.isString(a))throw TypeError("name must be a string");if(!f.isInteger(b))throw TypeError("id must be an integer");if(void 0!==this.values[a])throw Error("duplicate name '"+a+"' in "+this);if(this.isReservedId(b))throw Error("id "+b+" is reserved in "+this);if(this.isReservedName(a))throw Error("name '"+a+"' is reserved in "+this);if(void 0!==this.valuesById[b]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+b+" in "+this);this.values[a]=b}else this.valuesById[this.values[a]=b]=a;return d&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[a]=d||null),this.comments[a]=c||null,this},g.prototype.remove=function(a){if(!f.isString(a))throw TypeError("name must be a string");var b=this.values[a];if(null==b)throw Error("name '"+a+"' does not exist in "+this);return delete this.valuesById[b],delete this.values[a],delete this.comments[a],this.valuesOptions&&delete this.valuesOptions[a],this},g.prototype.isReservedId=function(a){return e.isReservedId(this.reserved,a)},g.prototype.isReservedName=function(a){return e.isReservedName(this.reserved,a)}},95584:function(a,b,c){"use strict";a.exports=j;var d,e=c(12070);((j.prototype=Object.create(e.prototype)).constructor=j).className="Field";var f=c(63697),g=c(51847),h=c(41509),i=/^required|optional|repeated$/;function j(a,b,c,d,f,j,k){if(h.isObject(d)?(k=f,j=d,d=f=void 0):h.isObject(f)&&(k=j,j=f,f=void 0),e.call(this,a,j),!h.isInteger(b)||b<0)throw TypeError("id must be a non-negative integer");if(!h.isString(c))throw TypeError("type must be a string");if(void 0!==d&&!i.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==f&&!h.isString(f))throw TypeError("extend must be a string");"proto3_optional"===d&&(d="optional"),this.rule=d&&"optional"!==d?d:void 0,this.type=c,this.id=b,this.extend=f||void 0,this.required="required"===d,this.optional=!this.required,this.repeated="repeated"===d,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!h.Long&& void 0!==g.long[c],this.bytes="bytes"===c,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=k}j.fromJSON=function(a,b){return new j(a,b.id,b.type,b.rule,b.extend,b.options,b.comment)},Object.defineProperty(j.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),j.prototype.setOption=function(a,b,c){return"packed"===a&&(this._packed=null),e.prototype.setOption.call(this,a,b,c)},j.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return h.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},j.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=g.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof d?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof f&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof f)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=h.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var a;h.base64.test(this.typeDefault)?h.base64.decode(this.typeDefault,a=h.newBuffer(h.base64.length(this.typeDefault)),0):h.utf8.write(this.typeDefault,a=h.newBuffer(h.utf8.length(this.typeDefault)),0),this.typeDefault=a}return this.map?this.defaultValue=h.emptyObject:this.repeated?this.defaultValue=h.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof d&&(this.parent.ctor.prototype[this.name]=this.defaultValue),e.prototype.resolve.call(this)},j.d=function(a,b,c,d){return"function"==typeof b?b=h.decorateType(b).name:b&&"object"==typeof b&&(b=h.decorateEnum(b).name),function(e,f){h.decorateType(e.constructor).add(new j(f,a,b,c,{default:d}))}},j._configure=function(a){d=a}},6139:function(a,b,c){"use strict";var d=a.exports=c(99942);function e(a,b,c){return"function"==typeof b?(c=b,b=new d.Root):b||(b=new d.Root),b.load(a,c)}function f(a,b){return b||(b=new d.Root),b.loadSync(a)}d.build="light",d.load=e,d.loadSync=f,d.encoder=c(39097),d.decoder=c(77472),d.verifier=c(11203),d.converter=c(99305),d.ReflectionObject=c(12070),d.Namespace=c(81865),d.Root=c(64305),d.Enum=c(63697),d.Type=c(11703),d.Field=c(95584),d.OneOf=c(46371),d.MapField=c(43429),d.Service=c(50155),d.Method=c(16601),d.Message=c(23185),d.wrappers=c(58190),d.types=c(51847),d.util=c(41509),d.ReflectionObject._configure(d.Root),d.Namespace._configure(d.Type,d.Service,d.Enum),d.Root._configure(d.Type),d.Field._configure(d.Type)},99942:function(a,b,c){"use strict";var d=b;function e(){d.util._configure(),d.Writer._configure(d.BufferWriter),d.Reader._configure(d.BufferReader)}d.build="minimal",d.Writer=c(88864),d.BufferWriter=c(29405),d.Reader=c(45234),d.BufferReader=c(98595),d.util=c(96895),d.rpc=c(20413),d.roots=c(96405),d.configure=e,e()},64478:function(a,b,c){"use strict";var d=a.exports=c(6139);d.build="full",d.tokenize=c(51322),d.parse=c(86525),d.common=c(41496),d.Root._configure(d.Type,d.parse,d.common)},43429:function(a,b,c){"use strict";a.exports=g;var d=c(95584);((g.prototype=Object.create(d.prototype)).constructor=g).className="MapField";var e=c(51847),f=c(41509);function g(a,b,c,e,g,h){if(d.call(this,a,b,e,void 0,void 0,g,h),!f.isString(c))throw TypeError("keyType must be a string");this.keyType=c,this.resolvedKeyType=null,this.map=!0}g.fromJSON=function(a,b){return new g(a,b.id,b.keyType,b.type,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return f.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},g.prototype.resolve=function(){if(this.resolved)return this;if(void 0===e.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return d.prototype.resolve.call(this)},g.d=function(a,b,c){return"function"==typeof c?c=f.decorateType(c).name:c&&"object"==typeof c&&(c=f.decorateEnum(c).name),function(d,e){f.decorateType(d.constructor).add(new g(e,a,b,c))}}},23185:function(a,b,c){"use strict";a.exports=e;var d=c(96895);function e(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)this[b[c]]=a[b[c]]}e.create=function(a){return this.$type.create(a)},e.encode=function(a,b){return this.$type.encode(a,b)},e.encodeDelimited=function(a,b){return this.$type.encodeDelimited(a,b)},e.decode=function(a){return this.$type.decode(a)},e.decodeDelimited=function(a){return this.$type.decodeDelimited(a)},e.verify=function(a){return this.$type.verify(a)},e.fromObject=function(a){return this.$type.fromObject(a)},e.toObject=function(a,b){return this.$type.toObject(a,b)},e.prototype.toJSON=function(){return this.$type.toObject(this,d.toJSONOptions)}},16601:function(a,b,c){"use strict";a.exports=f;var d=c(12070);((f.prototype=Object.create(d.prototype)).constructor=f).className="Method";var e=c(41509);function f(a,b,c,f,g,h,i,j,k){if(e.isObject(g)?(i=g,g=h=void 0):e.isObject(h)&&(i=h,h=void 0),!(void 0===b||e.isString(b)))throw TypeError("type must be a string");if(!e.isString(c))throw TypeError("requestType must be a string");if(!e.isString(f))throw TypeError("responseType must be a string");d.call(this,a,i),this.type=b||"rpc",this.requestType=c,this.requestStream=!!g||void 0,this.responseType=f,this.responseStream=!!h||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=j,this.parsedOptions=k}f.fromJSON=function(a,b){return new f(a,b.type,b.requestType,b.responseType,b.requestStream,b.responseStream,b.options,b.comment,b.parsedOptions)},f.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return e.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",b?this.comment:void 0,"parsedOptions",this.parsedOptions,])},f.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),d.prototype.resolve.call(this))}},81865:function(a,b,c){"use strict";a.exports=l;var d,e,f,g=c(12070);((l.prototype=Object.create(g.prototype)).constructor=l).className="Namespace";var h=c(95584),i=c(41509),j=c(46371);function k(a,b){if(a&&a.length){for(var c={},d=0;d<a.length;++d)c[a[d].name]=a[d].toJSON(b);return c}}function l(a,b){g.call(this,a,b),this.nested=void 0,this._nestedArray=null}function m(a){return a._nestedArray=null,a}l.fromJSON=function(a,b){return new l(a,b.options).addJSON(b.nested)},l.arrayToJSON=k,l.isReservedId=function(a,b){if(a){for(var c=0;c<a.length;++c)if("string"!=typeof a[c]&&a[c][0]<=b&&a[c][1]>b)return!0}return!1},l.isReservedName=function(a,b){if(a){for(var c=0;c<a.length;++c)if(a[c]===b)return!0}return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=i.toArray(this.nested))}}),l.prototype.toJSON=function(a){return i.toObject(["options",this.options,"nested",k(this.nestedArray,a)])},l.prototype.addJSON=function(a){var b=this;if(a)for(var c,g=Object.keys(a),i=0;i<g.length;++i)c=a[g[i]],b.add((void 0!==c.fields?d.fromJSON:void 0!==c.values?f.fromJSON:void 0!==c.methods?e.fromJSON:void 0!==c.id?h.fromJSON:l.fromJSON)(g[i],c));return this},l.prototype.get=function(a){return this.nested&&this.nested[a]||null},l.prototype.getEnum=function(a){if(this.nested&&this.nested[a]instanceof f)return this.nested[a].values;throw Error("no such enum: "+a)},l.prototype.add=function(a){if(!(a instanceof h&& void 0!==a.extend||a instanceof d||a instanceof j||a instanceof f||a instanceof e||a instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var b=this.get(a.name);if(b){if(b instanceof l&&a instanceof l&&!(b instanceof d||b instanceof e)){for(var c=b.nestedArray,g=0;g<c.length;++g)a.add(c[g]);this.remove(b),this.nested||(this.nested={}),a.setOptions(b.options,!0)}else throw Error("duplicate name '"+a.name+"' in "+this)}}else this.nested={};return this.nested[a.name]=a,a.onAdd(this),m(this)},l.prototype.remove=function(a){if(!(a instanceof g))throw TypeError("object must be a ReflectionObject");if(a.parent!==this)throw Error(a+" is not a member of "+this);return delete this.nested[a.name],Object.keys(this.nested).length||(this.nested=void 0),a.onRemove(this),m(this)},l.prototype.define=function(a,b){if(i.isString(a))a=a.split(".");else if(!Array.isArray(a))throw TypeError("illegal path");if(a&&a.length&&""===a[0])throw Error("path must be relative");for(var c=this;a.length>0;){var d=a.shift();if(c.nested&&c.nested[d]){if(!((c=c.nested[d])instanceof l))throw Error("path conflicts with non-namespace objects")}else c.add(c=new l(d))}return b&&c.addJSON(b),c},l.prototype.resolveAll=function(){for(var a=this.nestedArray,b=0;b<a.length;)a[b]instanceof l?a[b++].resolveAll():a[b++].resolve();return this.resolve()},l.prototype.lookup=function(a,b,c){if("boolean"==typeof b?(c=b,b=void 0):b&&!Array.isArray(b)&&(b=[b]),i.isString(a)&&a.length){if("."===a)return this.root;a=a.split(".")}else if(!a.length)return this;if(""===a[0])return this.root.lookup(a.slice(1),b);var d=this.get(a[0]);if(d){if(1===a.length){if(!b||b.indexOf(d.constructor)> -1)return d}else if(d instanceof l&&(d=d.lookup(a.slice(1),b,!0)))return d}else for(var e=0;e<this.nestedArray.length;++e)if(this._nestedArray[e]instanceof l&&(d=this._nestedArray[e].lookup(a,b,!0)))return d;return null===this.parent||c?null:this.parent.lookup(a,b)},l.prototype.lookupType=function(a){var b=this.lookup(a,[d]);if(!b)throw Error("no such type: "+a);return b},l.prototype.lookupEnum=function(a){var b=this.lookup(a,[f]);if(!b)throw Error("no such Enum '"+a+"' in "+this);return b},l.prototype.lookupTypeOrEnum=function(a){var b=this.lookup(a,[d,f]);if(!b)throw Error("no such Type or Enum '"+a+"' in "+this);return b},l.prototype.lookupService=function(a){var b=this.lookup(a,[e]);if(!b)throw Error("no such Service '"+a+"' in "+this);return b},l._configure=function(a,b,c){d=a,e=b,f=c}},12070:function(a,b,c){"use strict";a.exports=f,f.className="ReflectionObject";var d,e=c(41509);function f(a,b){if(!e.isString(a))throw TypeError("name must be a string");if(b&&!e.isObject(b))throw TypeError("options must be an object");this.options=b,this.parsedOptions=null,this.name=a,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(f.prototype,{root:{get:function(){for(var a=this;null!==a.parent;)a=a.parent;return a}},fullName:{get:function(){for(var a=[this.name],b=this.parent;b;)a.unshift(b.name),b=b.parent;return a.join(".")}}}),f.prototype.toJSON=function(){throw Error()},f.prototype.onAdd=function(a){this.parent&&this.parent!==a&&this.parent.remove(this),this.parent=a,this.resolved=!1;var b=a.root;b instanceof d&&b._handleAdd(this)},f.prototype.onRemove=function(a){var b=a.root;b instanceof d&&b._handleRemove(this),this.parent=null,this.resolved=!1},f.prototype.resolve=function(){return this.resolved||this.root instanceof d&&(this.resolved=!0),this},f.prototype.getOption=function(a){if(this.options)return this.options[a]},f.prototype.setOption=function(a,b,c){return c&&this.options&& void 0!==this.options[a]||((this.options||(this.options={}))[a]=b),this},f.prototype.setParsedOption=function(a,b,c){this.parsedOptions||(this.parsedOptions=[]);var d=this.parsedOptions;if(c){var f=d.find(function(b){return Object.prototype.hasOwnProperty.call(b,a)});if(f){var g=f[a];e.setProperty(g,c,b)}else(f={})[a]=e.setProperty({},c,b),d.push(f)}else{var h={};h[a]=b,d.push(h)}return this},f.prototype.setOptions=function(a,b){if(a)for(var c=Object.keys(a),d=0;d<c.length;++d)this.setOption(c[d],a[c[d]],b);return this},f.prototype.toString=function(){var a=this.constructor.className,b=this.fullName;return b.length?a+" "+b:a},f._configure=function(a){d=a}},46371:function(a,b,c){"use strict";a.exports=g;var d=c(12070);((g.prototype=Object.create(d.prototype)).constructor=g).className="OneOf";var e=c(95584),f=c(41509);function g(a,b,c,e){if(Array.isArray(b)||(c=b,b=void 0),d.call(this,a,c),!(void 0===b||Array.isArray(b)))throw TypeError("fieldNames must be an Array");this.oneof=b||[],this.fieldsArray=[],this.comment=e}function h(a){if(a.parent)for(var b=0;b<a.fieldsArray.length;++b)a.fieldsArray[b].parent||a.parent.add(a.fieldsArray[b])}g.fromJSON=function(a,b){return new g(a,b.oneof,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return f.toObject(["options",this.options,"oneof",this.oneof,"comment",b?this.comment:void 0])},g.prototype.add=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");return a.parent&&a.parent!==this.parent&&a.parent.remove(a),this.oneof.push(a.name),this.fieldsArray.push(a),a.partOf=this,h(this),this},g.prototype.remove=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");var b=this.fieldsArray.indexOf(a);if(b<0)throw Error(a+" is not a member of "+this);return this.fieldsArray.splice(b,1),(b=this.oneof.indexOf(a.name))> -1&&this.oneof.splice(b,1),a.partOf=null,this},g.prototype.onAdd=function(a){d.prototype.onAdd.call(this,a);for(var b=this,c=0;c<this.oneof.length;++c){var e=a.get(this.oneof[c]);e&&!e.partOf&&(e.partOf=b,b.fieldsArray.push(e))}h(this)},g.prototype.onRemove=function(a){for(var b,c=0;c<this.fieldsArray.length;++c)(b=this.fieldsArray[c]).parent&&b.parent.remove(b);d.prototype.onRemove.call(this,a)},g.d=function(){for(var a=Array(arguments.length),b=0;b<arguments.length;)a[b]=arguments[b++];return function(b,c){f.decorateType(b.constructor).add(new g(c,a)),Object.defineProperty(b,c,{get:f.oneOfGetter(a),set:f.oneOfSetter(a)})}}},86525:function(a,b,c){"use strict";a.exports=y,y.filename=null,y.defaults={keepCase:!1};var d=c(51322),e=c(64305),f=c(11703),g=c(95584),h=c(43429),i=c(46371),j=c(63697),k=c(50155),l=c(16601),m=c(51847),n=c(41509),o=/^[1-9][0-9]*$/,p=/^-?[1-9][0-9]*$/,q=/^0[x][0-9a-fA-F]+$/,r=/^-?0[x][0-9a-fA-F]+$/,s=/^0[0-7]+$/,t=/^-?0[0-7]+$/,u=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,v=/^[a-zA-Z_][a-zA-Z_0-9]*$/,w=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,x=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function y(a,b,c){b instanceof e||(c=b,b=new e),c||(c=y.defaults);var z,A,B,C,D,E=c.preferTrailingComment||!1,F=d(a,c.alternateCommentMode||!1),G=F.next,H=F.push,I=F.peek,J=F.skip,K=F.cmnt,L=!0,M=!1,N=b,O=c.keepCase?function(a){return a}:n.camelCase;function P(a,b,c){var d=y.filename;return c||(y.filename=null),Error("illegal "+(b||"token")+" '"+a+"' ("+(d?d+", ":"")+"line "+F.line+")")}function Q(){var a,b=[];do{if('"'!==(a=G())&&"'"!==a)throw P(a);b.push(G()),J(a),a=I()}while('"'===a||"'"===a);return b.join("")}function R(a){var b=G();switch(b){case"'":case'"':return H(b),Q();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return T(b,!0)}catch(c){if(a&&w.test(b))return b;throw P(b,"value")}}function S(a,b){var c,d;do b&&('"'===(c=I())||"'"===c)?a.push(Q()):a.push([d=U(G()),J("to",!0)?U(G()):d]);while(J(",",!0));J(";")}function T(a,b){var c=1;switch("-"===a.charAt(0)&&(c=-1,a=a.substring(1)),a){case"inf":case"INF":case"Inf":return c*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(o.test(a))return c*parseInt(a,10);if(q.test(a))return c*parseInt(a,16);if(s.test(a))return c*parseInt(a,8);if(u.test(a))return c*parseFloat(a);throw P(a,"number",b)}function U(a,b){switch(a){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!b&&"-"===a.charAt(0))throw P(a,"id");if(p.test(a))return parseInt(a,10);if(r.test(a))return parseInt(a,16);if(t.test(a))return parseInt(a,8);throw P(a,"id")}function V(){if(void 0!==A)throw P("package");if(A=G(),!w.test(A))throw P(A,"name");N=N.define(A),J(";")}function W(){var a,b=I();switch(b){case"weak":a=C||(C=[]),G();break;case"public":G();default:a=B||(B=[])}b=Q(),J(";"),a.push(b)}function X(){if(J("="),!(M="proto3"===(D=Q()))&&"proto2"!==D)throw P(D,"syntax");J(";")}function Y(a,b){switch(b){case"option":return af(a,b),J(";"),!0;case"message":return $(a,b),!0;case"enum":return ad(a,b),!0;case"service":return ak(a,b),!0;case"extend":return am(a,b),!0}return!1}function Z(a,b,c){var d,e=F.line;if(a&&("string"!=typeof a.comment&&(a.comment=K()),a.filename=y.filename),J("{",!0)){for(;"}"!==(d=G());)b(d);J(";",!0)}else c&&c(),J(";"),a&&("string"!=typeof a.comment||E)&&(a.comment=K(e)||a.comment)}function $(a,b){if(!v.test(b=G()))throw P(b,"type name");var c=new f(b);Z(c,function(a){if(!Y(c,a))switch(a){case"map":ab(c,a);break;case"required":case"repeated":_(c,a);break;case"optional":M?_(c,"proto3_optional"):_(c,"optional");break;case"oneof":ac(c,a);break;case"extensions":S(c.extensions||(c.extensions=[]));break;case"reserved":S(c.reserved||(c.reserved=[]),!0);break;default:if(!M||!w.test(a))throw P(a);H(a),_(c,"optional")}}),a.add(c)}function _(a,b,c){var d=G();if("group"===d){aa(a,b);return}if(!w.test(d))throw P(d,"type");var e=G();if(!v.test(e))throw P(e,"name");e=O(e),J("=");var f=new g(e,U(G()),d,b,c);if(Z(f,function(a){if("option"===a)af(f,a),J(";");else throw P(a)},function(){aj(f)}),"proto3_optional"===b){var h=new i("_"+e);f.setOption("proto3_optional",!0),h.add(f),a.add(h)}else a.add(f);!M&&f.repeated&&(void 0!==m.packed[d]|| void 0===m.basic[d])&&f.setOption("packed",!1,!0)}function aa(a,b){var c=G();if(!v.test(c))throw P(c,"name");var d=n.lcFirst(c);c===d&&(c=n.ucFirst(c)),J("=");var e=U(G()),h=new f(c);h.group=!0;var i=new g(d,e,c,b);i.filename=y.filename,Z(h,function(a){switch(a){case"option":af(h,a),J(";");break;case"required":case"repeated":_(h,a);break;case"optional":M?_(h,"proto3_optional"):_(h,"optional");break;case"message":$(h,a);break;case"enum":ad(h,a);break;default:throw P(a)}}),a.add(h).add(i)}function ab(a){J("<");var b=G();if(void 0===m.mapKey[b])throw P(b,"type");J(",");var c=G();if(!w.test(c))throw P(c,"type");J(">");var d=G();if(!v.test(d))throw P(d,"name");J("=");var e=new h(O(d),U(G()),b,c);Z(e,function(a){if("option"===a)af(e,a),J(";");else throw P(a)},function(){aj(e)}),a.add(e)}function ac(a,b){if(!v.test(b=G()))throw P(b,"name");var c=new i(O(b));Z(c,function(a){"option"===a?(af(c,a),J(";")):(H(a),_(c,"optional"))}),a.add(c)}function ad(a,b){if(!v.test(b=G()))throw P(b,"name");var c=new j(b);Z(c,function(a){switch(a){case"option":af(c,a),J(";");break;case"reserved":S(c.reserved||(c.reserved=[]),!0);break;default:ae(c,a)}}),a.add(c)}function ae(a,b){if(!v.test(b))throw P(b,"name");J("=");var c=U(G(),!0),d={options:void 0};d.setOption=function(a,b){void 0===this.options&&(this.options={}),this.options[a]=b},Z(d,function(a){if("option"===a)af(d,a),J(";");else throw P(a)},function(){aj(d)}),a.add(b,c,d.comment,d.options)}function af(a,b){var c,d=J("(",!0);if(!w.test(b=G()))throw P(b,"name");var e=b,f=e;d&&(J(")"),f=e="("+e+")",b=I(),x.test(b)&&(c=b.slice(1),e+=b,G())),J("=");var g=ag(a,e);ai(a,f,g,c)}function ag(a,b){if(J("{",!0)){for(var c={};!J("}",!0);){if(!v.test(z=G()))throw P(z,"name");var d,e,f=z;if(J(":",!0),"{"===I())d=ag(a,b+"."+z);else if("["===I()){if(d=[],J("[",!0)){do e=R(!0),d.push(e);while(J(",",!0));J("]"),void 0!==e&&ah(a,b+"."+z,e)}}else d=R(!0),ah(a,b+"."+z,d);var g=c[f];g&&(d=[].concat(g).concat(d)),c[f]=d,J(",",!0),J(";",!0)}return c}var h=R(!0);return ah(a,b,h),h}function ah(a,b,c){a.setOption&&a.setOption(b,c)}function ai(a,b,c,d){a.setParsedOption&&a.setParsedOption(b,c,d)}function aj(a){if(J("[",!0)){do af(a,"option");while(J(",",!0));J("]")}return a}function ak(a,b){if(!v.test(b=G()))throw P(b,"service name");var c=new k(b);Z(c,function(a){if(!Y(c,a)){if("rpc"===a)al(c,a);else throw P(a)}}),a.add(c)}function al(a,b){var c=K(),d=b;if(!v.test(b=G()))throw P(b,"name");var e,f,g,h,i=b;if(J("("),J("stream",!0)&&(f=!0),!w.test(b=G())||(e=b,J(")"),J("returns"),J("("),J("stream",!0)&&(h=!0),!w.test(b=G())))throw P(b);g=b,J(")");var j=new l(i,d,e,g,f,h);j.comment=c,Z(j,function(a){if("option"===a)af(j,a),J(";");else throw P(a)}),a.add(j)}function am(a,b){if(!w.test(b=G()))throw P(b,"reference");var c=b;Z(null,function(b){switch(b){case"required":case"repeated":_(a,b,c);break;case"optional":M?_(a,"proto3_optional",c):_(a,"optional",c);break;default:if(!M||!w.test(b))throw P(b);H(b),_(a,"optional",c)}})}for(;null!==(z=G());)switch(z){case"package":if(!L)throw P(z);V();break;case"import":if(!L)throw P(z);W();break;case"syntax":if(!L)throw P(z);X();break;case"option":af(N,z),J(";");break;default:if(Y(N,z)){L=!1;continue}throw P(z)}return y.filename=null,{package:A,imports:B,weakImports:C,syntax:D,root:b}}},45234:function(a,b,c){"use strict";a.exports=i;var d,e=c(96895),f=e.LongBits,g=e.utf8;function h(a,b){return RangeError("index out of range: "+a.pos+" + "+(b||1)+" > "+a.len)}function i(a){this.buf=a,this.pos=0,this.len=a.length}var j,k="undefined"!=typeof Uint8Array?function(a){if(a instanceof Uint8Array||Array.isArray(a))return new i(a);throw Error("illegal buffer")}:function(a){if(Array.isArray(a))return new i(a);throw Error("illegal buffer")},l=function(){return e.Buffer?function(a){return(i.create=function(a){return e.Buffer.isBuffer(a)?new d(a):k(a)})(a)}:k};function m(){var a=new f(0,0),b=0;if(this.len-this.pos>4){for(;b<4;++b)if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(127&this.buf[this.pos])<<28)>>>0,a.hi=(a.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return a;b=0}else{for(;b<3;++b){if(this.pos>=this.len)throw h(this);if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(127&this.buf[this.pos++])<<7*b)>>>0,a}if(this.len-this.pos>4){for(;b<5;++b)if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}else for(;b<5;++b){if(this.pos>=this.len)throw h(this);if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}function n(a,b){return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0}function o(){if(this.pos+8>this.len)throw h(this,8);return new f(n(this.buf,this.pos+=4),n(this.buf,this.pos+=4))}i.create=l(),i.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,i.prototype.uint32=(j=4294967295,function(){if(j=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(j=(j|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(j=(j|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(j=(j|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(j=(j|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return j;if((this.pos+=5)>this.len)throw this.pos=this.len,h(this,10);return j}),i.prototype.int32=function(){return 0|this.uint32()},i.prototype.sint32=function(){var a=this.uint32();return a>>>1^ -(1&a)|0},i.prototype.bool=function(){return 0!==this.uint32()},i.prototype.fixed32=function(){if(this.pos+4>this.len)throw h(this,4);return n(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw h(this,4);return 0|n(this.buf,this.pos+=4)},i.prototype.float=function(){if(this.pos+4>this.len)throw h(this,4);var a=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a},i.prototype.double=function(){if(this.pos+8>this.len)throw h(this,4);var a=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a},i.prototype.bytes=function(){var a=this.uint32(),b=this.pos,c=this.pos+a;if(c>this.len)throw h(this,a);return(this.pos+=a,Array.isArray(this.buf))?this.buf.slice(b,c):b===c?new this.buf.constructor(0):this._slice.call(this.buf,b,c)},i.prototype.string=function(){var a=this.bytes();return g.read(a,0,a.length)},i.prototype.skip=function(a){if("number"==typeof a){if(this.pos+a>this.len)throw h(this,a);this.pos+=a}else do if(this.pos>=this.len)throw h(this);while(128&this.buf[this.pos++]);return this},i.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(a=7&this.uint32());)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},i._configure=function(a){d=a,i.create=l(),d._configure();var b=e.Long?"toLong":"toNumber";e.merge(i.prototype,{int64:function(){return m.call(this)[b](!1)},uint64:function(){return m.call(this)[b](!0)},sint64:function(){return m.call(this).zzDecode()[b](!1)},fixed64:function(){return o.call(this)[b](!0)},sfixed64:function(){return o.call(this)[b](!1)}})}},98595:function(a,b,c){"use strict";a.exports=f;var d=c(45234);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(96895);function f(a){d.call(this,a)}f._configure=function(){e.Buffer&&(f.prototype._slice=e.Buffer.prototype.slice)},f.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},f._configure()},64305:function(a,b,c){"use strict";a.exports=l;var d,e,f,g=c(81865);((l.prototype=Object.create(g.prototype)).constructor=l).className="Root";var h=c(95584),i=c(63697),j=c(46371),k=c(41509);function l(a){g.call(this,"",a),this.deferred=[],this.files=[]}function m(){}l.fromJSON=function(a,b){return b||(b=new l),a.options&&b.setOptions(a.options),b.addJSON(a.nested)},l.prototype.resolvePath=k.path.resolve,l.prototype.fetch=k.fetch,l.prototype.load=function a(b,c,d){"function"==typeof c&&(d=c,c=void 0);var g=this;if(!d)return k.asPromise(a,g,b,c);var h=d===m;function i(a,b){if(d){var c=d;if(d=null,h)throw a;c(a,b)}}function j(a){var b=a.lastIndexOf("google/protobuf/");if(b> -1){var c=a.substring(b);if(c in f)return c}return null}function l(a,b){try{if(k.isString(b)&&"{"===b.charAt(0)&&(b=JSON.parse(b)),k.isString(b)){e.filename=a;var d,f=e(b,g,c),l=0;if(f.imports)for(;l<f.imports.length;++l)(d=j(f.imports[l])||g.resolvePath(a,f.imports[l]))&&n(d);if(f.weakImports)for(l=0;l<f.weakImports.length;++l)(d=j(f.weakImports[l])||g.resolvePath(a,f.weakImports[l]))&&n(d,!0)}else g.setOptions(b.options).addJSON(b.nested)}catch(m){i(m)}h||o||i(null,g)}function n(a,b){if(!(g.files.indexOf(a)> -1)){if(g.files.push(a),a in f){h?l(a,f[a]):(++o,setTimeout(function(){--o,l(a,f[a])}));return}if(h){var c;try{c=k.fs.readFileSync(a).toString("utf8")}catch(e){b||i(e);return}l(a,c)}else++o,g.fetch(a,function(c,e){if(--o,d){if(c){b?o||i(null,g):i(c);return}l(a,e)}})}}var o=0;k.isString(b)&&(b=[b]);for(var p,q=0;q<b.length;++q)(p=g.resolvePath("",b[q]))&&n(p);if(h)return g;o||i(null,g)},l.prototype.loadSync=function(a,b){if(!k.isNode)throw Error("not supported");return this.load(a,b,m)},l.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(a){return"'extend "+a.extend+"' in "+a.parent.fullName}).join(", "));return g.prototype.resolveAll.call(this)};var n=/^[A-Z]/;function o(a,b){var c=b.parent.lookup(b.extend);if(c){var d=new h(b.fullName,b.id,b.type,b.rule,void 0,b.options);return d.declaringField=b,b.extensionField=d,c.add(d),!0}return!1}l.prototype._handleAdd=function(a){if(a instanceof h)void 0===a.extend||a.extensionField||o(this,a)||this.deferred.push(a);else if(a instanceof i)n.test(a.name)&&(a.parent[a.name]=a.values);else if(!(a instanceof j)){if(a instanceof d)for(var b=0;b<this.deferred.length;)o(this,this.deferred[b])?this.deferred.splice(b,1):++b;for(var c=0;c<a.nestedArray.length;++c)this._handleAdd(a._nestedArray[c]);n.test(a.name)&&(a.parent[a.name]=a)}},l.prototype._handleRemove=function(a){if(a instanceof h){if(void 0!==a.extend){if(a.extensionField)a.extensionField.parent.remove(a.extensionField),a.extensionField=null;else{var b=this.deferred.indexOf(a);b> -1&&this.deferred.splice(b,1)}}}else if(a instanceof i)n.test(a.name)&&delete a.parent[a.name];else if(a instanceof g){for(var c=0;c<a.nestedArray.length;++c)this._handleRemove(a._nestedArray[c]);n.test(a.name)&&delete a.parent[a.name]}},l._configure=function(a,b,c){d=a,e=b,f=c}},96405:function(a){"use strict";a.exports={}},20413:function(a,b,c){"use strict";b.Service=c(72387)},72387:function(a,b,c){"use strict";a.exports=e;var d=c(96895);function e(a,b,c){if("function"!=typeof a)throw TypeError("rpcImpl must be a function");d.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=Boolean(b),this.responseDelimited=Boolean(c)}(e.prototype=Object.create(d.EventEmitter.prototype)).constructor=e,e.prototype.rpcCall=function a(b,c,e,f,g){if(!f)throw TypeError("request must be specified");var h=this;if(!g)return d.asPromise(a,h,b,c,e,f);if(!h.rpcImpl){setTimeout(function(){g(Error("already ended"))},0);return}try{return h.rpcImpl(b,c[h.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(a,c){if(a)return h.emit("error",a,b),g(a);if(null===c){h.end(!0);return}if(!(c instanceof e))try{c=e[h.responseDelimited?"decodeDelimited":"decode"](c)}catch(d){return h.emit("error",d,b),g(d)}return h.emit("data",c,b),g(null,c)})}catch(i){h.emit("error",i,b),setTimeout(function(){g(i)},0);return}},e.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},50155:function(a,b,c){"use strict";a.exports=h;var d=c(81865);((h.prototype=Object.create(d.prototype)).constructor=h).className="Service";var e=c(16601),f=c(41509),g=c(20413);function h(a,b){d.call(this,a,b),this.methods={},this._methodsArray=null}function i(a){return a._methodsArray=null,a}h.fromJSON=function(a,b){var c=new h(a,b.options);if(b.methods)for(var d=Object.keys(b.methods),f=0;f<d.length;++f)c.add(e.fromJSON(d[f],b.methods[d[f]]));return b.nested&&c.addJSON(b.nested),c.comment=b.comment,c},h.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&Boolean(a.keepComments);return f.toObject(["options",b&&b.options||void 0,"methods",d.arrayToJSON(this.methodsArray,a)||{},"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},Object.defineProperty(h.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=f.toArray(this.methods))}}),h.prototype.get=function(a){return this.methods[a]||d.prototype.get.call(this,a)},h.prototype.resolveAll=function(){for(var a=this.methodsArray,b=0;b<a.length;++b)a[b].resolve();return d.prototype.resolve.call(this)},h.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);return a instanceof e?(this.methods[a.name]=a,a.parent=this,i(this)):d.prototype.add.call(this,a)},h.prototype.remove=function(a){if(a instanceof e){if(this.methods[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.methods[a.name],a.parent=null,i(this)}return d.prototype.remove.call(this,a)},h.prototype.create=function(a,b,c){for(var d,e=new g.Service(a,b,c),h=0;h<this.methodsArray.length;++h){var i=f.lcFirst((d=this._methodsArray[h]).resolve().name).replace(/[^$\w_]/g,"");e[i]=f.codegen(["r","c"],f.isReserved(i)?i+"_":i)("return this.rpcCall(m,q,s,r,c)")({m:d,q:d.resolvedRequestType.ctor,s:d.resolvedResponseType.ctor})}return e}},51322:function(a){"use strict";a.exports=l;var b=/[\s{}=;:[\],'"()<>]/g,c=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,d=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,e=/^ *[*/]+ */,f=/^\s*\*?\/*/,g=/\n/g,h=/\s/,i=/\\(.?)/g,j={"0":"\0",r:"\r",n:"\n",t:"	"};function k(a){return a.replace(i,function(a,b){switch(b){case"\\":case"":return b;default:return j[b]||""}})}function l(a,i){a=a.toString();var j=0,l=a.length,m=1,n=0,o={},p=[],q=null;function r(a){return Error("illegal "+a+" (line "+m+")")}function s(){var b="'"===q?d:c;b.lastIndex=j-1;var e=b.exec(a);if(!e)throw r("string");return j=b.lastIndex,y(q),q=null,k(e[1])}function t(b){return a.charAt(b)}function u(b,c,d){var h,j,k={type:a.charAt(b++),lineEmpty:!1,leading:d},l=b-(h=i?2:3);do if(--l<0||"\n"===(j=a.charAt(l))){k.lineEmpty=!0;break}while(" "===j||"	"===j);for(var p=a.substring(b,c).split(g),q=0;q<p.length;++q)p[q]=p[q].replace(i?f:e,"").trim();k.text=p.join("\n").trim(),o[m]=k,n=m}function v(b){var c=w(b),d=a.substring(b,c);return/^\s*\/{1,2}/.test(d)}function w(a){for(var b=a;b<l&&"\n"!==t(b);)b++;return b}function x(){if(p.length>0)return p.shift();if(q)return s();var c,d,e,f,g,k=0===j;do{if(j===l)return null;for(c=!1;h.test(e=t(j));)if("\n"===e&&(k=!0,++m),++j===l)return null;if("/"===t(j)){if(++j===l)throw r("comment");if("/"===t(j)){if(i){if(f=j,g=!1,v(j)){g=!0;do if((j=w(j))===l||(j++,!k))break;while(v(j))}else j=Math.min(l,w(j)+1);g&&(u(f,j,k),k=!0),m++,c=!0}else{for(g="/"===t(f=j+1);"\n"!==t(++j);)if(j===l)return null;++j,g&&(u(f,j-1,k),k=!0),++m,c=!0}}else{if("*"!==(e=t(j)))return"/";f=j+1,g=i||"*"===t(f);do{if("\n"===e&& ++m,++j===l)throw r("comment");d=e,e=t(j)}while("*"!==d||"/"!==e);++j,g&&(u(f,j-2,k),k=!0),c=!0}}}while(c);var n=j;if(b.lastIndex=0,!b.test(t(n++)))for(;n<l&&!b.test(t(n));)++n;var o=a.substring(j,j=n);return('"'===o||"'"===o)&&(q=o),o}function y(a){p.push(a)}function z(){if(!p.length){var a=x();if(null===a)return null;y(a)}return p[0]}function A(a,b){var c=z();if(c===a)return x(),!0;if(!b)throw r("token '"+c+"', '"+a+"' expected");return!1}function B(a){var b,c=null;return void 0===a?(b=o[m-1],delete o[m-1],b&&(i||"*"===b.type||b.lineEmpty)&&(c=b.leading?b.text:null)):(n<a&&z(),b=o[a],delete o[a],b&&!b.lineEmpty&&(i||"/"===b.type)&&(c=b.leading?null:b.text)),c}return Object.defineProperty({next:x,peek:z,push:y,skip:A,cmnt:B},"line",{get:function(){return m}})}l.unescape=k},11703:function(a,b,c){"use strict";a.exports=s;var d=c(81865);((s.prototype=Object.create(d.prototype)).constructor=s).className="Type";var e=c(63697),f=c(46371),g=c(95584),h=c(43429),i=c(50155),j=c(23185),k=c(45234),l=c(88864),m=c(41509),n=c(39097),o=c(77472),p=c(11203),q=c(99305),r=c(58190);function s(a,b){d.call(this,a,b),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function t(a){return a._fieldsById=a._fieldsArray=a._oneofsArray=null,delete a.encode,delete a.decode,delete a.verify,a}Object.defineProperties(s.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var a=Object.keys(this.fields),b=0;b<a.length;++b){var c=this.fields[a[b]],d=c.id;if(this._fieldsById[d])throw Error("duplicate id "+d+" in "+this);this._fieldsById[d]=c}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=m.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=m.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=s.generateConstructor(this)())},set:function(a){var b=a.prototype;b instanceof j||((a.prototype=new j).constructor=a,m.merge(a.prototype,b)),a.$type=a.prototype.$type=this,m.merge(a,j,!0),this._ctor=a;for(var c=0;c<this.fieldsArray.length;++c)this._fieldsArray[c].resolve();var d={};for(c=0;c<this.oneofsArray.length;++c)d[this._oneofsArray[c].resolve().name]={get:m.oneOfGetter(this._oneofsArray[c].oneof),set:m.oneOfSetter(this._oneofsArray[c].oneof)};c&&Object.defineProperties(a.prototype,d)}}}),s.generateConstructor=function(a){for(var b,c=m.codegen(["p"],a.name),d=0;d<a.fieldsArray.length;++d)(b=a._fieldsArray[d]).map?c("this%s={}",m.safeProp(b.name)):b.repeated&&c("this%s=[]",m.safeProp(b.name));return c("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},s.fromJSON=function(a,b){var c=new s(a,b.options);c.extensions=b.extensions,c.reserved=b.reserved;for(var j=Object.keys(b.fields),k=0;k<j.length;++k)c.add((void 0!==b.fields[j[k]].keyType?h.fromJSON:g.fromJSON)(j[k],b.fields[j[k]]));if(b.oneofs)for(j=Object.keys(b.oneofs),k=0;k<j.length;++k)c.add(f.fromJSON(j[k],b.oneofs[j[k]]));if(b.nested)for(j=Object.keys(b.nested),k=0;k<j.length;++k){var l=b.nested[j[k]];c.add((void 0!==l.id?g.fromJSON:void 0!==l.fields?s.fromJSON:void 0!==l.values?e.fromJSON:void 0!==l.methods?i.fromJSON:d.fromJSON)(j[k],l))}return b.extensions&&b.extensions.length&&(c.extensions=b.extensions),b.reserved&&b.reserved.length&&(c.reserved=b.reserved),b.group&&(c.group=!0),b.comment&&(c.comment=b.comment),c},s.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&Boolean(a.keepComments);return m.toObject(["options",b&&b.options||void 0,"oneofs",d.arrayToJSON(this.oneofsArray,a),"fields",d.arrayToJSON(this.fieldsArray.filter(function(a){return!a.declaringField}),a)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},s.prototype.resolveAll=function(){for(var a=this.fieldsArray,b=0;b<a.length;)a[b++].resolve();var c=this.oneofsArray;for(b=0;b<c.length;)c[b++].resolve();return d.prototype.resolveAll.call(this)},s.prototype.get=function(a){return this.fields[a]||this.oneofs&&this.oneofs[a]||this.nested&&this.nested[a]||null},s.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);if(a instanceof g&& void 0===a.extend){if(this._fieldsById?this._fieldsById[a.id]:this.fieldsById[a.id])throw Error("duplicate id "+a.id+" in "+this);if(this.isReservedId(a.id))throw Error("id "+a.id+" is reserved in "+this);if(this.isReservedName(a.name))throw Error("name '"+a.name+"' is reserved in "+this);return a.parent&&a.parent.remove(a),this.fields[a.name]=a,a.message=this,a.onAdd(this),t(this)}return a instanceof f?(this.oneofs||(this.oneofs={}),this.oneofs[a.name]=a,a.onAdd(this),t(this)):d.prototype.add.call(this,a)},s.prototype.remove=function(a){if(a instanceof g&& void 0===a.extend){if(!this.fields||this.fields[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.fields[a.name],a.parent=null,a.onRemove(this),t(this)}if(a instanceof f){if(!this.oneofs||this.oneofs[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.oneofs[a.name],a.parent=null,a.onRemove(this),t(this)}return d.prototype.remove.call(this,a)},s.prototype.isReservedId=function(a){return d.isReservedId(this.reserved,a)},s.prototype.isReservedName=function(a){return d.isReservedName(this.reserved,a)},s.prototype.create=function(a){return new this.ctor(a)},s.prototype.setup=function(){for(var a=this.fullName,b=[],c=0;c<this.fieldsArray.length;++c)b.push(this._fieldsArray[c].resolve().resolvedType);this.encode=n(this)({Writer:l,types:b,util:m}),this.decode=o(this)({Reader:k,types:b,util:m}),this.verify=p(this)({types:b,util:m}),this.fromObject=q.fromObject(this)({types:b,util:m}),this.toObject=q.toObject(this)({types:b,util:m});var d=r[a];if(d){var e=Object.create(this);e.fromObject=this.fromObject,this.fromObject=d.fromObject.bind(e),e.toObject=this.toObject,this.toObject=d.toObject.bind(e)}return this},s.prototype.encode=function(a,b){return this.setup().encode(a,b)},s.prototype.encodeDelimited=function(a,b){return this.encode(a,b&&b.len?b.fork():b).ldelim()},s.prototype.decode=function(a,b){return this.setup().decode(a,b)},s.prototype.decodeDelimited=function(a){return a instanceof k||(a=k.create(a)),this.decode(a,a.uint32())},s.prototype.verify=function(a){return this.setup().verify(a)},s.prototype.fromObject=function(a){return this.setup().fromObject(a)},s.prototype.toObject=function(a,b){return this.setup().toObject(a,b)},s.d=function(a){return function(b){m.decorateType(b,a)}}},51847:function(a,b,c){"use strict";var d=b,e=c(41509),f=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function g(a,b){var c=0,d={};for(b|=0;c<a.length;)d[f[c+b]]=a[c++];return d}d.basic=g([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),d.defaults=g([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",e.emptyArray,null]),d.long=g([0,0,0,1,1],7),d.mapKey=g([0,0,0,5,5,0,0,0,1,1,0,2],2),d.packed=g([1,5,0,0,0,5,5,0,0,0,1,1,0])},41509:function(a,b,c){"use strict";var d,e,f=a.exports=c(96895),g=c(96405);f.codegen=c(75124),f.fetch=c(49054),f.path=c(18626),f.fs=f.inquire("fs"),f.toArray=function(a){if(a){for(var b=Object.keys(a),c=Array(b.length),d=0;d<b.length;)c[d]=a[b[d++]];return c}return[]},f.toObject=function(a){for(var b={},c=0;c<a.length;){var d=a[c++],e=a[c++];void 0!==e&&(b[d]=e)}return b};var h=/\\/g,i=/"/g;f.isReserved=function(a){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(a)},f.safeProp=function(a){return!/^[$\w_]+$/.test(a)||f.isReserved(a)?'["'+a.replace(h,"\\\\").replace(i,'\\"')+'"]':"."+a},f.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var j=/_([a-z])/g;f.camelCase=function(a){return a.substring(0,1)+a.substring(1).replace(j,function(a,b){return b.toUpperCase()})},f.compareFieldsById=function(a,b){return a.id-b.id},f.decorateType=function(a,b){if(a.$type)return b&&a.$type.name!==b&&(f.decorateRoot.remove(a.$type),a.$type.name=b,f.decorateRoot.add(a.$type)),a.$type;d||(d=c(11703));var e=new d(b||a.name);return f.decorateRoot.add(e),e.ctor=a,Object.defineProperty(a,"$type",{value:e,enumerable:!1}),Object.defineProperty(a.prototype,"$type",{value:e,enumerable:!1}),e};var k=0;f.decorateEnum=function(a){if(a.$type)return a.$type;e||(e=c(63697));var b=new e("Enum"+k++,a);return f.decorateRoot.add(b),Object.defineProperty(a,"$type",{value:b,enumerable:!1}),b},f.setProperty=function(a,b,c){function d(a,b,c){var e=b.shift();if("__proto__"===e)return a;if(b.length>0)a[e]=d(a[e]||{},b,c);else{var f=a[e];f&&(c=[].concat(f).concat(c)),a[e]=c}return a}if("object"!=typeof a)throw TypeError("dst must be an object");if(!b)throw TypeError("path must be specified");return d(a,b=b.split("."),c)},Object.defineProperty(f,"decorateRoot",{get:function(){return g.decorated||(g.decorated=new(c(64305)))}})},60323:function(a,b,c){"use strict";a.exports=e;var d=c(96895);function e(a,b){this.lo=a>>>0,this.hi=b>>>0}var f=e.zero=new e(0,0);f.toNumber=function(){return 0},f.zzEncode=f.zzDecode=function(){return this},f.length=function(){return 1};var g=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(a){if(0===a)return f;var b=a<0;b&&(a=-a);var c=a>>>0,d=(a-c)/4294967296>>>0;return b&&(d=~d>>>0,c=~c>>>0,++c>4294967295&&(c=0,++d>4294967295&&(d=0))),new e(c,d)},e.from=function(a){if("number"==typeof a)return e.fromNumber(a);if(d.isString(a)){if(!d.Long)return e.fromNumber(parseInt(a,10));a=d.Long.fromString(a)}return a.low||a.high?new e(a.low>>>0,a.high>>>0):f},e.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var b=~this.lo+1>>>0,c=~this.hi>>>0;return b||(c=c+1>>>0),-(b+4294967296*c)}return this.lo+4294967296*this.hi},e.prototype.toLong=function(a){return d.Long?new d.Long(0|this.lo,0|this.hi,Boolean(a)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(a)}};var h=String.prototype.charCodeAt;e.fromHash=function(a){return a===g?f:new e((h.call(a,0)|h.call(a,1)<<8|h.call(a,2)<<16|h.call(a,3)<<24)>>>0,(h.call(a,4)|h.call(a,5)<<8|h.call(a,6)<<16|h.call(a,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},e.prototype.zzDecode=function(){var a=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},e.prototype.length=function(){var a=this.lo,b=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return 0===c?0===b?a<16384?a<128?1:2:a<2097152?3:4:b<16384?b<128?5:6:b<2097152?7:8:c<128?9:10}},96895:function(a,b,c){"use strict";var d=b;function e(a,b,c){for(var d=Object.keys(b),e=0;e<d.length;++e)void 0!==a[d[e]]&&c||(a[d[e]]=b[d[e]]);return a}function f(a){function b(a,c){if(!(this instanceof b))return new b(a,c);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,b):Object.defineProperty(this,"stack",{value:Error().stack||""}),c&&e(this,c)}return b.prototype=Object.create(Error.prototype,{constructor:{value:b,writable:!0,enumerable:!1,configurable:!0},name:{get(){return a},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),b}d.asPromise=c(34537),d.base64=c(97419),d.EventEmitter=c(19211),d.float=c(10945),d.inquire=c(67199),d.utf8=c(94997),d.pool=c(76662),d.LongBits=c(60323),d.isNode=Boolean(void 0!==c.g&&c.g&&c.g.process&&c.g.process.versions&&c.g.process.versions.node),d.global=d.isNode&&c.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},d.isString=function(a){return"string"==typeof a||a instanceof String},d.isObject=function(a){return a&&"object"==typeof a},d.isset=d.isSet=function(a,b){var c=a[b];return!!(null!=c&&a.hasOwnProperty(b))&&("object"!=typeof c||(Array.isArray(c)?c.length:Object.keys(c).length)>0)},d.Buffer=function(){try{var a=d.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(b){return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(a){return"number"==typeof a?d.Buffer?d._Buffer_allocUnsafe(a):new d.Array(a):d.Buffer?d._Buffer_from(a):"undefined"==typeof Uint8Array?a:new Uint8Array(a)},d.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(a){return a?d.LongBits.from(a).toHash():d.LongBits.zeroHash},d.longFromHash=function(a,b){var c=d.LongBits.fromHash(a);return d.Long?d.Long.fromBits(c.lo,c.hi,b):c.toNumber(Boolean(b))},d.merge=e,d.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},d.newError=f,d.ProtocolError=f("ProtocolError"),d.oneOfGetter=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c> -1;--c)if(1===b[a[c]]&& void 0!==this[a[c]]&&null!==this[a[c]])return a[c]}},d.oneOfSetter=function(a){return function(b){for(var c=0;c<a.length;++c)a[c]!==b&&delete this[a[c]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var a=d.Buffer;if(!a){d._Buffer_from=d._Buffer_allocUnsafe=null;return}d._Buffer_from=a.from!==Uint8Array.from&&a.from||function(b,c){return new a(b,c)},d._Buffer_allocUnsafe=a.allocUnsafe||function(b){return new a(b)}}},11203:function(a,b,c){"use strict";a.exports=i;var d=c(63697),e=c(41509);function f(a,b){return a.name+": "+b+(a.repeated&&"array"!==b?"[]":a.map&&"object"!==b?"{k:"+a.keyType+"}":"")+" expected"}function g(a,b,c,e){if(b.resolvedType){if(b.resolvedType instanceof d){a("switch(%s){",e)("default:")("return%j",f(b,"enum value"));for(var g=Object.keys(b.resolvedType.values),h=0;h<g.length;++h)a("case %i:",b.resolvedType.values[g[h]]);a("break")("}")}else a("{")("var e=types[%i].verify(%s);",c,e)("if(e)")("return%j+e",b.name+".")("}")}else switch(b.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.isInteger(%s))",e)("return%j",f(b,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",e,e,e,e)("return%j",f(b,"integer|Long"));break;case"float":case"double":a('if(typeof %s!=="number")',e)("return%j",f(b,"number"));break;case"bool":a('if(typeof %s!=="boolean")',e)("return%j",f(b,"boolean"));break;case"string":a("if(!util.isString(%s))",e)("return%j",f(b,"string"));break;case"bytes":a('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',e,e,e)("return%j",f(b,"buffer"))}return a}function h(a,b,c){switch(b.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.key32Re.test(%s))",c)("return%j",f(b,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.key64Re.test(%s))",c)("return%j",f(b,"integer|Long key"));break;case"bool":a("if(!util.key2Re.test(%s))",c)("return%j",f(b,"boolean key"))}return a}function i(a){var b=e.codegen(["m"],a.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),c=a.oneofsArray,d={};c.length&&b("var p={}");for(var i=0;i<a.fieldsArray.length;++i){var j=a._fieldsArray[i].resolve(),k="m"+e.safeProp(j.name);if(j.optional&&b("if(%s!=null&&m.hasOwnProperty(%j)){",k,j.name),j.map)b("if(!util.isObject(%s))",k)("return%j",f(j,"object"))("var k=Object.keys(%s)",k)("for(var i=0;i<k.length;++i){"),h(b,j,"k[i]"),g(b,j,i,k+"[k[i]]")("}");else if(j.repeated)b("if(!Array.isArray(%s))",k)("return%j",f(j,"array"))("for(var i=0;i<%s.length;++i){",k),g(b,j,i,k+"[i]")("}");else{if(j.partOf){var l=e.safeProp(j.partOf.name);1===d[j.partOf.name]&&b("if(p%s===1)",l)("return%j",j.partOf.name+": multiple values"),d[j.partOf.name]=1,b("p%s=1",l)}g(b,j,i,k)}j.optional&&b("}")}return b("return null")}},58190:function(a,b,c){"use strict";var d=b,e=c(23185);d[".google.protobuf.Any"]={fromObject:function(a){if(a&&a["@type"]){var b=a["@type"].substring(a["@type"].lastIndexOf("/")+1),c=this.lookup(b);if(c){var d="."===a["@type"].charAt(0)?a["@type"].slice(1):a["@type"];return -1===d.indexOf("/")&&(d="/"+d),this.create({type_url:d,value:c.encode(c.fromObject(a)).finish()})}}return this.fromObject(a)},toObject:function(a,b){var c="type.googleapis.com/",d="",f="";if(b&&b.json&&a.type_url&&a.value){f=a.type_url.substring(a.type_url.lastIndexOf("/")+1),d=a.type_url.substring(0,a.type_url.lastIndexOf("/")+1);var g=this.lookup(f);g&&(a=g.decode(a.value))}if(!(a instanceof this.ctor)&&a instanceof e){var h=a.$type.toObject(a,b),i="."===a.$type.fullName[0]?a.$type.fullName.slice(1):a.$type.fullName;return""===d&&(d=c),f=d+i,h["@type"]=f,h}return this.toObject(a,b)}}},88864:function(a,b,c){"use strict";a.exports=l;var d,e=c(96895),f=e.LongBits,g=e.base64,h=e.utf8;function i(a,b,c){this.fn=a,this.len=b,this.next=void 0,this.val=c}function j(){}function k(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function l(){this.len=0,this.head=new i(j,0,0),this.tail=this.head,this.states=null}var m=function(){return e.Buffer?function(){return(l.create=function(){return new d})()}:function(){return new l}};function n(a,b,c){b[c]=255&a}function o(a,b,c){for(;a>127;)b[c++]=127&a|128,a>>>=7;b[c]=a}function p(a,b){this.len=a,this.next=void 0,this.val=b}function q(a,b,c){for(;a.hi;)b[c++]=127&a.lo|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)b[c++]=127&a.lo|128,a.lo=a.lo>>>7;b[c++]=a.lo}function r(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}l.create=m(),l.alloc=function(a){return new e.Array(a)},e.Array!==Array&&(l.alloc=e.pool(l.alloc,e.Array.prototype.subarray)),l.prototype._push=function(a,b,c){return this.tail=this.tail.next=new i(a,b,c),this.len+=b,this},p.prototype=Object.create(i.prototype),p.prototype.fn=o,l.prototype.uint32=function(a){return this.len+=(this.tail=this.tail.next=new p((a>>>=0)<128?1:a<16384?2:a<2097152?3:a<268435456?4:5,a)).len,this},l.prototype.int32=function(a){return a<0?this._push(q,10,f.fromNumber(a)):this.uint32(a)},l.prototype.sint32=function(a){return this.uint32((a<<1^a>>31)>>>0)},l.prototype.uint64=function(a){var b=f.from(a);return this._push(q,b.length(),b)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(a){var b=f.from(a).zzEncode();return this._push(q,b.length(),b)},l.prototype.bool=function(a){return this._push(n,1,a?1:0)},l.prototype.fixed32=function(a){return this._push(r,4,a>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(a){var b=f.from(a);return this._push(r,4,b.lo)._push(r,4,b.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(a){return this._push(e.float.writeFloatLE,4,a)},l.prototype.double=function(a){return this._push(e.float.writeDoubleLE,8,a)};var s=e.Array.prototype.set?function(a,b,c){b.set(a,c)}:function(a,b,c){for(var d=0;d<a.length;++d)b[c+d]=a[d]};l.prototype.bytes=function(a){var b=a.length>>>0;if(!b)return this._push(n,1,0);if(e.isString(a)){var c=l.alloc(b=g.length(a));g.decode(a,c,0),a=c}return this.uint32(b)._push(s,b,a)},l.prototype.string=function(a){var b=h.length(a);return b?this.uint32(b)._push(h.write,b,a):this._push(n,1,0)},l.prototype.fork=function(){return this.states=new k(this),this.head=this.tail=new i(j,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(j,0,0),this.len=0),this},l.prototype.ldelim=function(){var a=this.head,b=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=a.next,this.tail=b,this.len+=c),this},l.prototype.finish=function(){for(var a=this.head.next,b=this.constructor.alloc(this.len),c=0;a;)a.fn(a.val,b,c),c+=a.len,a=a.next;return b},l._configure=function(a){d=a,l.create=m(),d._configure()}},29405:function(a,b,c){"use strict";a.exports=f;var d=c(88864);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(96895);function f(){d.call(this)}function g(a,b,c){a.length<40?e.utf8.write(a,b,c):b.utf8Write?b.utf8Write(a,c):b.write(a,c)}f._configure=function(){f.alloc=e._Buffer_allocUnsafe,f.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&"set"===e.Buffer.prototype.set.name?function(a,b,c){b.set(a,c)}:function(a,b,c){if(a.copy)a.copy(b,c,0,a.length);else for(var d=0;d<a.length;)b[c++]=a[d++]}},f.prototype.bytes=function(a){e.isString(a)&&(a=e._Buffer_from(a,"base64"));var b=a.length>>>0;return this.uint32(b),b&&this._push(f.writeBytesBuffer,b,a),this},f.prototype.string=function(a){var b=e.Buffer.byteLength(a);return this.uint32(b),b&&this._push(g,b,a),this},f._configure()},34537:function(a){"use strict";function b(a,b){for(var c=Array(arguments.length-1),d=0,e=2,f=!0;e<arguments.length;)c[d++]=arguments[e++];return new Promise(function(e,g){c[d]=function(a){if(f){if(f=!1,a)g(a);else{for(var b=Array(arguments.length-1),c=0;c<b.length;)b[c++]=arguments[c];e.apply(null,b)}}};try{a.apply(b||null,c)}catch(h){f&&(f=!1,g(h))}})}a.exports=b},97419:function(a,b){"use strict";var c=b;c.length=function(a){var b=a.length;if(!b)return 0;for(var c=0;--b%4>1&&"="===a.charAt(b);)++c;return Math.ceil(3*a.length)/4-c};for(var d=Array(64),e=Array(123),f=0;f<64;)e[d[f]=f<26?f+65:f<52?f+71:f<62?f-4:f-59|43]=f++;c.encode=function(a,b,c){for(var e,f=null,g=[],h=0,i=0;b<c;){var j=a[b++];switch(i){case 0:g[h++]=d[j>>2],e=(3&j)<<4,i=1;break;case 1:g[h++]=d[e|j>>4],e=(15&j)<<2,i=2;break;case 2:g[h++]=d[e|j>>6],g[h++]=d[63&j],i=0}h>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,g)),h=0)}return(i&&(g[h++]=d[e],g[h++]=61,1===i&&(g[h++]=61)),f)?(h&&f.push(String.fromCharCode.apply(String,g.slice(0,h))),f.join("")):String.fromCharCode.apply(String,g.slice(0,h))};var g="invalid encoding";c.decode=function(a,b,c){for(var d,f=c,h=0,i=0;i<a.length;){var j=a.charCodeAt(i++);if(61===j&&h>1)break;if(void 0===(j=e[j]))throw Error(g);switch(h){case 0:d=j,h=1;break;case 1:b[c++]=d<<2|(48&j)>>4,d=j,h=2;break;case 2:b[c++]=(15&d)<<4|(60&j)>>2,d=j,h=3;break;case 3:b[c++]=(3&d)<<6|j,h=0}}if(1===h)throw Error(g);return c-f},c.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}},75124:function(a){"use strict";function b(a,c){"string"==typeof a&&(c=a,a=void 0);var d=[];function e(a){if("string"!=typeof a){var c=f();if(b.verbose&&console.log("codegen: "+c),c="return "+c,a){for(var g=Object.keys(a),h=Array(g.length+1),i=Array(g.length),j=0;j<g.length;)h[j]=g[j],i[j]=a[g[j++]];return h[j]=c,Function.apply(null,h).apply(null,i)}return Function(c)()}for(var k=Array(arguments.length-1),l=0;l<k.length;)k[l]=arguments[++l];if(l=0,a=a.replace(/%([%dfijs])/g,function(a,b){var c=k[l++];switch(b){case"d":case"f":return String(Number(c));case"i":return String(Math.floor(c));case"j":return JSON.stringify(c);case"s":return String(c)}return"%"}),l!==k.length)throw Error("parameter count mismatch");return d.push(a),e}function f(b){return"function "+(b||c||"")+"("+(a&&a.join(",")||"")+"){\n  "+d.join("\n  ")+"\n}"}return e.toString=f,e}a.exports=b,b.verbose=!1},19211:function(a){"use strict";function b(){this._listeners={}}a.exports=b,b.prototype.on=function(a,b,c){return(this._listeners[a]||(this._listeners[a]=[])).push({fn:b,ctx:c||this}),this},b.prototype.off=function(a,b){if(void 0===a)this._listeners={};else if(void 0===b)this._listeners[a]=[];else for(var c=this._listeners[a],d=0;d<c.length;)c[d].fn===b?c.splice(d,1):++d;return this},b.prototype.emit=function(a){var b=this._listeners[a];if(b){for(var c=[],d=1;d<arguments.length;)c.push(arguments[d++]);for(d=0;d<b.length;)b[d].fn.apply(b[d++].ctx,c)}return this}},49054:function(a,b,c){"use strict";a.exports=f;var d=c(34537),e=c(67199)("fs");function f(a,b,c){return("function"==typeof b?(c=b,b={}):b||(b={}),c)?!b.xhr&&e&&e.readFile?e.readFile(a,function(d,e){return d&&"undefined"!=typeof XMLHttpRequest?f.xhr(a,b,c):d?c(d):c(null,b.binary?e:e.toString("utf8"))}):f.xhr(a,b,c):d(f,this,a,b)}f.xhr=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){if(0!==d.status&&200!==d.status)return c(Error("status "+d.status));if(b.binary){var a=d.response;if(!a){a=[];for(var e=0;e<d.responseText.length;++e)a.push(255&d.responseText.charCodeAt(e))}return c(null,"undefined"!=typeof Uint8Array?new Uint8Array(a):a)}return c(null,d.responseText)}},b.binary&&("overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.responseType="arraybuffer"),d.open("GET",a),d.send()}},10945:function(a){"use strict";function b(a){if("undefined"!=typeof Float32Array)!function(){var b=new Float32Array([-0]),c=new Uint8Array(b.buffer),d=128===c[3];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3]}function f(a,d,e){b[0]=a,d[e]=c[3],d[e+1]=c[2],d[e+2]=c[1],d[e+3]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],b[0]}function h(a,d){return c[3]=a[d],c[2]=a[d+1],c[1]=a[d+2],c[0]=a[d+3],b[0]}a.writeFloatLE=d?e:f,a.writeFloatBE=d?f:e,a.readFloatLE=d?g:h,a.readFloatBE=d?h:g}();else{function b(a,b,c,d){var e=b<0?1:0;if(e&&(b=-b),0===b)a(1/b>0?0:2147483648,c,d);else if(isNaN(b))a(2143289344,c,d);else if(b>34028234663852886e22)a((e<<31|2139095040)>>>0,c,d);else if(b<11754943508222875e-54)a((e<<31|Math.round(b/1401298464324817e-60))>>>0,c,d);else{var f=Math.floor(Math.log(b)/Math.LN2),g=8388607&Math.round(b*Math.pow(2,-f)*8388608);a((e<<31|f+127<<23|g)>>>0,c,d)}}function g(a,b,c){var d=a(b,c),e=(d>>31)*2+1,f=d>>>23&255,g=8388607&d;return 255===f?g?NaN:e*(1/0):0===f?1401298464324817e-60*e*g:e*Math.pow(2,f-150)*(g+8388608)}a.writeFloatLE=b.bind(null,c),a.writeFloatBE=b.bind(null,d),a.readFloatLE=g.bind(null,e),a.readFloatBE=g.bind(null,f)}if("undefined"!=typeof Float64Array)!function(){var b=new Float64Array([-0]),c=new Uint8Array(b.buffer),d=128===c[7];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3],d[e+4]=c[4],d[e+5]=c[5],d[e+6]=c[6],d[e+7]=c[7]}function f(a,d,e){b[0]=a,d[e]=c[7],d[e+1]=c[6],d[e+2]=c[5],d[e+3]=c[4],d[e+4]=c[3],d[e+5]=c[2],d[e+6]=c[1],d[e+7]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],c[4]=a[d+4],c[5]=a[d+5],c[6]=a[d+6],c[7]=a[d+7],b[0]}function h(a,d){return c[7]=a[d],c[6]=a[d+1],c[5]=a[d+2],c[4]=a[d+3],c[3]=a[d+4],c[2]=a[d+5],c[1]=a[d+6],c[0]=a[d+7],b[0]}a.writeDoubleLE=d?e:f,a.writeDoubleBE=d?f:e,a.readDoubleLE=d?g:h,a.readDoubleBE=d?h:g}();else{function h(a,b,c,d,e,f){var g,h=d<0?1:0;if(h&&(d=-d),0===d)a(0,e,f+b),a(1/d>0?0:2147483648,e,f+c);else if(isNaN(d))a(0,e,f+b),a(2146959360,e,f+c);else if(d>17976931348623157e292)a(0,e,f+b),a((h<<31|2146435072)>>>0,e,f+c);else if(d<22250738585072014e-324)a((g=d/5e-324)>>>0,e,f+b),a((h<<31|g/4294967296)>>>0,e,f+c);else{var i=Math.floor(Math.log(d)/Math.LN2);1024===i&&(i=1023),a(4503599627370496*(g=d*Math.pow(2,-i))>>>0,e,f+b),a((h<<31|i+1023<<20|1048576*g&1048575)>>>0,e,f+c)}}function i(a,b,c,d,e){var f=a(d,e+b),g=a(d,e+c),h=(g>>31)*2+1,i=g>>>20&2047,j=4294967296*(1048575&g)+f;return 2047===i?j?NaN:h*(1/0):0===i?5e-324*h*j:h*Math.pow(2,i-1075)*(j+4503599627370496)}a.writeDoubleLE=h.bind(null,c,0,4),a.writeDoubleBE=h.bind(null,d,4,0),a.readDoubleLE=i.bind(null,e,0,4),a.readDoubleBE=i.bind(null,f,4,0)}return a}function c(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}function d(a,b,c){b[c]=a>>>24,b[c+1]=a>>>16&255,b[c+2]=a>>>8&255,b[c+3]=255&a}function e(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0}function f(a,b){return(a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3])>>>0}a.exports=b(b)},67199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},18626:function(a,b){"use strict";var c=b,d=c.isAbsolute=function(a){return/^(?:\/|\w+:)/.test(a)},e=c.normalize=function(a){var b=(a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),c=d(a),e="";c&&(e=b.shift()+"/");for(var f=0;f<b.length;)".."===b[f]?f>0&&".."!==b[f-1]?b.splice(--f,2):c?b.splice(f,1):++f:"."===b[f]?b.splice(f,1):++f;return e+b.join("/")};c.resolve=function(a,b,c){return(c||(b=e(b)),d(b))?b:(c||(a=e(a)),(a=a.replace(/(?:\/|^)[^/]+$/,"")).length?e(a+"/"+b):b)}},76662:function(a){"use strict";function b(a,b,c){var d=c||8192,e=d>>>1,f=null,g=d;return function(c){if(c<1||c>e)return a(c);g+c>d&&(f=a(d),g=0);var h=b.call(f,g,g+=c);return 7&g&&(g=(7|g)+1),h}}a.exports=b},94997:function(a,b){"use strict";var c=b;c.length=function(a){for(var b=0,c=0,d=0;d<a.length;++d)(c=a.charCodeAt(d))<128?b+=1:c<2048?b+=2:(64512&c)==55296&&(64512&a.charCodeAt(d+1))==56320?(++d,b+=4):b+=3;return b},c.read=function(a,b,c){if(c-b<1)return"";for(var d,e=null,f=[],g=0;b<c;)(d=a[b++])<128?f[g++]=d:d>191&&d<224?f[g++]=(31&d)<<6|63&a[b++]:d>239&&d<365?(d=((7&d)<<18|(63&a[b++])<<12|(63&a[b++])<<6|63&a[b++])-65536,f[g++]=55296+(d>>10),f[g++]=56320+(1023&d)):f[g++]=(15&d)<<12|(63&a[b++])<<6|63&a[b++],g>8191&&((e||(e=[])).push(String.fromCharCode.apply(String,f)),g=0);return e?(g&&e.push(String.fromCharCode.apply(String,f.slice(0,g))),e.join("")):String.fromCharCode.apply(String,f.slice(0,g))},c.write=function(a,b,c){for(var d,e,f=c,g=0;g<a.length;++g)(d=a.charCodeAt(g))<128?b[c++]=d:d<2048?(b[c++]=d>>6|192,b[c++]=63&d|128):(64512&d)==55296&&(64512&(e=a.charCodeAt(g+1)))==56320?(d=65536+((1023&d)<<10)+(1023&e),++g,b[c++]=d>>18|240,b[c++]=d>>12&63|128,b[c++]=d>>6&63|128,b[c++]=63&d|128):(b[c++]=d>>12|224,b[c++]=d>>6&63|128,b[c++]=63&d|128);return c-f}},98099:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(97117);function e(a,b){return void 0===b&&(b=0),(a[b+0]<<8|a[b+1])<<16>>16}function f(a,b){return void 0===b&&(b=0),(a[b+0]<<8|a[b+1])>>>0}function g(a,b){return void 0===b&&(b=0),(a[b+1]<<8|a[b])<<16>>16}function h(a,b){return void 0===b&&(b=0),(a[b+1]<<8|a[b])>>>0}function i(a,b,c){return void 0===b&&(b=new Uint8Array(2)),void 0===c&&(c=0),b[c+0]=a>>>8,b[c+1]=a>>>0,b}function j(a,b,c){return void 0===b&&(b=new Uint8Array(2)),void 0===c&&(c=0),b[c+0]=a>>>0,b[c+1]=a>>>8,b}function k(a,b){return void 0===b&&(b=0),a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3]}function l(a,b){return void 0===b&&(b=0),(a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3])>>>0}function m(a,b){return void 0===b&&(b=0),a[b+3]<<24|a[b+2]<<16|a[b+1]<<8|a[b]}function n(a,b){return void 0===b&&(b=0),(a[b+3]<<24|a[b+2]<<16|a[b+1]<<8|a[b])>>>0}function o(a,b,c){return void 0===b&&(b=new Uint8Array(4)),void 0===c&&(c=0),b[c+0]=a>>>24,b[c+1]=a>>>16,b[c+2]=a>>>8,b[c+3]=a>>>0,b}function p(a,b,c){return void 0===b&&(b=new Uint8Array(4)),void 0===c&&(c=0),b[c+0]=a>>>0,b[c+1]=a>>>8,b[c+2]=a>>>16,b[c+3]=a>>>24,b}function q(a,b){void 0===b&&(b=0);var c=k(a,b),d=k(a,b+4);return 4294967296*c+d-(d>>31)*4294967296}function r(a,b){void 0===b&&(b=0);var c=l(a,b),d=l(a,b+4);return 4294967296*c+d}function s(a,b){void 0===b&&(b=0);var c=m(a,b);return 4294967296*m(a,b+4)+c-(c>>31)*4294967296}function t(a,b){void 0===b&&(b=0);var c=n(a,b),d=n(a,b+4);return 4294967296*d+c}function u(a,b,c){return void 0===b&&(b=new Uint8Array(8)),void 0===c&&(c=0),o(a/4294967296>>>0,b,c),o(a>>>0,b,c+4),b}function v(a,b,c){return void 0===b&&(b=new Uint8Array(8)),void 0===c&&(c=0),p(a>>>0,b,c),p(a/4294967296>>>0,b,c+4),b}function w(a,b,c){if(void 0===c&&(c=0),a%8!=0)throw Error("readUintBE supports only bitLengths divisible by 8");if(a/8>b.length-c)throw Error("readUintBE: array is too short for the given bitLength");for(var d=0,e=1,f=a/8+c-1;f>=c;f--)d+=b[f]*e,e*=256;return d}function x(a,b,c){if(void 0===c&&(c=0),a%8!=0)throw Error("readUintLE supports only bitLengths divisible by 8");if(a/8>b.length-c)throw Error("readUintLE: array is too short for the given bitLength");for(var d=0,e=1,f=c;f<c+a/8;f++)d+=b[f]*e,e*=256;return d}function y(a,b,c,e){if(void 0===c&&(c=new Uint8Array(a/8)),void 0===e&&(e=0),a%8!=0)throw Error("writeUintBE supports only bitLengths divisible by 8");if(!d.isSafeInteger(b))throw Error("writeUintBE value must be an integer");for(var f=1,g=a/8+e-1;g>=e;g--)c[g]=b/f&255,f*=256;return c}function z(a,b,c,e){if(void 0===c&&(c=new Uint8Array(a/8)),void 0===e&&(e=0),a%8!=0)throw Error("writeUintLE supports only bitLengths divisible by 8");if(!d.isSafeInteger(b))throw Error("writeUintLE value must be an integer");for(var f=1,g=e;g<e+a/8;g++)c[g]=b/f&255,f*=256;return c}function A(a,b){return void 0===b&&(b=0),new DataView(a.buffer,a.byteOffset,a.byteLength).getFloat32(b)}function B(a,b){return void 0===b&&(b=0),new DataView(a.buffer,a.byteOffset,a.byteLength).getFloat32(b,!0)}function C(a,b){return void 0===b&&(b=0),new DataView(a.buffer,a.byteOffset,a.byteLength).getFloat64(b)}function D(a,b){return void 0===b&&(b=0),new DataView(a.buffer,a.byteOffset,a.byteLength).getFloat64(b,!0)}function E(a,b,c){return void 0===b&&(b=new Uint8Array(4)),void 0===c&&(c=0),new DataView(b.buffer,b.byteOffset,b.byteLength).setFloat32(c,a),b}function F(a,b,c){return void 0===b&&(b=new Uint8Array(4)),void 0===c&&(c=0),new DataView(b.buffer,b.byteOffset,b.byteLength).setFloat32(c,a,!0),b}function G(a,b,c){return void 0===b&&(b=new Uint8Array(8)),void 0===c&&(c=0),new DataView(b.buffer,b.byteOffset,b.byteLength).setFloat64(c,a),b}function H(a,b,c){return void 0===b&&(b=new Uint8Array(8)),void 0===c&&(c=0),new DataView(b.buffer,b.byteOffset,b.byteLength).setFloat64(c,a,!0),b}b.readInt16BE=e,b.readUint16BE=f,b.readInt16LE=g,b.readUint16LE=h,b.writeUint16BE=i,b.writeInt16BE=i,b.writeUint16LE=j,b.writeInt16LE=j,b.readInt32BE=k,b.readUint32BE=l,b.readInt32LE=m,b.readUint32LE=n,b.writeUint32BE=o,b.writeInt32BE=o,b.writeUint32LE=p,b.writeInt32LE=p,b.readInt64BE=q,b.readUint64BE=r,b.readInt64LE=s,b.readUint64LE=t,b.writeUint64BE=u,b.writeInt64BE=u,b.writeUint64LE=v,b.writeInt64LE=v,b.readUintBE=w,b.readUintLE=x,b.writeUintBE=y,b.writeUintLE=z,b.readFloat32BE=A,b.readFloat32LE=B,b.readFloat64BE=C,b.readFloat64LE=D,b.writeFloat32BE=E,b.writeFloat32LE=F,b.writeFloat64BE=G,b.writeFloat64LE=H},15501:function(a,b,c){"use strict";d={value:!0};var d,e=c(25439),f=c(63027),g=c(17309),h=c(98099),i=c(4153);b.Cv=32,b.WH=12,b.pg=16;var j=new Uint8Array(16),k=function(){function a(a){if(this.nonceLength=b.WH,this.tagLength=b.pg,a.length!==b.Cv)throw Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(a)}return a.prototype.seal=function(a,b,c,d){if(a.length>16)throw Error("ChaCha20Poly1305: incorrect nonce length");var f,h=new Uint8Array(16);h.set(a,h.length-a.length);var i=new Uint8Array(32);e.stream(this._key,h,i,4);var j=b.length+this.tagLength;if(d){if(d.length!==j)throw Error("ChaCha20Poly1305: incorrect destination length");f=d}else f=new Uint8Array(j);return e.streamXOR(this._key,h,b,f,4),this._authenticate(f.subarray(f.length-this.tagLength,f.length),i,f.subarray(0,f.length-this.tagLength),c),g.wipe(h),f},a.prototype.open=function(a,b,c,d){if(a.length>16)throw Error("ChaCha20Poly1305: incorrect nonce length");if(b.length<this.tagLength)return null;var f,h=new Uint8Array(16);h.set(a,h.length-a.length);var j=new Uint8Array(32);e.stream(this._key,h,j,4);var k=new Uint8Array(this.tagLength);if(this._authenticate(k,j,b.subarray(0,b.length-this.tagLength),c),!i.equal(k,b.subarray(b.length-this.tagLength,b.length)))return null;var l=b.length-this.tagLength;if(d){if(d.length!==l)throw Error("ChaCha20Poly1305: incorrect destination length");f=d}else f=new Uint8Array(l);return e.streamXOR(this._key,h,b.subarray(0,b.length-this.tagLength),f,4),g.wipe(h),f},a.prototype.clean=function(){return g.wipe(this._key),this},a.prototype._authenticate=function(a,b,c,d){var e=new f.Poly1305(b);d&&(e.update(d),d.length%16>0&&e.update(j.subarray(d.length%16))),e.update(c),c.length%16>0&&e.update(j.subarray(c.length%16));var i=new Uint8Array(8);d&&h.writeUint64LE(d.length,i),e.update(i),h.writeUint64LE(c.length,i),e.update(i);for(var k=e.digest(),l=0;l<k.length;l++)a[l]=k[l];e.clean(),g.wipe(k),g.wipe(i)},a}();b.OK=k},25439:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(98099),e=c(17309),f=20;function g(a,b,c){for(var e=1634760805,g=857760878,h=2036477234,i=1797285236,j=c[3]<<24|c[2]<<16|c[1]<<8|c[0],k=c[7]<<24|c[6]<<16|c[5]<<8|c[4],l=c[11]<<24|c[10]<<16|c[9]<<8|c[8],m=c[15]<<24|c[14]<<16|c[13]<<8|c[12],n=c[19]<<24|c[18]<<16|c[17]<<8|c[16],o=c[23]<<24|c[22]<<16|c[21]<<8|c[20],p=c[27]<<24|c[26]<<16|c[25]<<8|c[24],q=c[31]<<24|c[30]<<16|c[29]<<8|c[28],r=b[3]<<24|b[2]<<16|b[1]<<8|b[0],s=b[7]<<24|b[6]<<16|b[5]<<8|b[4],t=b[11]<<24|b[10]<<16|b[9]<<8|b[8],u=b[15]<<24|b[14]<<16|b[13]<<8|b[12],v=e,w=g,x=h,y=i,z=j,A=k,B=l,C=m,D=n,E=o,F=p,G=q,H=r,I=s,J=t,K=u,L=0;L<f;L+=2)H^=v=v+z|0,z^=D=D+(H=H>>>16|H<<16)|0,z=z>>>20|z<<12,I^=w=w+A|0,A^=E=E+(I=I>>>16|I<<16)|0,A=A>>>20|A<<12,J^=x=x+B|0,B^=F=F+(J=J>>>16|J<<16)|0,B=B>>>20|B<<12,K^=y=y+C|0,C^=G=G+(K=K>>>16|K<<16)|0,C=C>>>20|C<<12,J^=x=x+B|0,B^=F=F+(J=J>>>24|J<<8)|0,B=B>>>25|B<<7,K^=y=y+C|0,C^=G=G+(K=K>>>24|K<<8)|0,C=C>>>25|C<<7,I^=w=w+A|0,A^=E=E+(I=I>>>24|I<<8)|0,A=A>>>25|A<<7,H^=v=v+z|0,z^=D=D+(H=H>>>24|H<<8)|0,z=z>>>25|z<<7,K^=v=v+A|0,A^=F=F+(K=K>>>16|K<<16)|0,A=A>>>20|A<<12,H^=w=w+B|0,B^=G=G+(H=H>>>16|H<<16)|0,B=B>>>20|B<<12,I^=x=x+C|0,C^=D=D+(I=I>>>16|I<<16)|0,C=C>>>20|C<<12,J^=y=y+z|0,z^=E=E+(J=J>>>16|J<<16)|0,z=z>>>20|z<<12,I^=x=x+C|0,C^=D=D+(I=I>>>24|I<<8)|0,C=C>>>25|C<<7,J^=y=y+z|0,z^=E=E+(J=J>>>24|J<<8)|0,z=z>>>25|z<<7,H^=w=w+B|0,B^=G=G+(H=H>>>24|H<<8)|0,B=B>>>25|B<<7,K^=v=v+A|0,A^=F=F+(K=K>>>24|K<<8)|0,A=A>>>25|A<<7;d.writeUint32LE(v+e|0,a,0),d.writeUint32LE(w+g|0,a,4),d.writeUint32LE(x+h|0,a,8),d.writeUint32LE(y+i|0,a,12),d.writeUint32LE(z+j|0,a,16),d.writeUint32LE(A+k|0,a,20),d.writeUint32LE(B+l|0,a,24),d.writeUint32LE(C+m|0,a,28),d.writeUint32LE(D+n|0,a,32),d.writeUint32LE(E+o|0,a,36),d.writeUint32LE(F+p|0,a,40),d.writeUint32LE(G+q|0,a,44),d.writeUint32LE(H+r|0,a,48),d.writeUint32LE(I+s|0,a,52),d.writeUint32LE(J+t|0,a,56),d.writeUint32LE(K+u|0,a,60)}function h(a,b,c,d,f){if(void 0===f&&(f=0),32!==a.length)throw Error("ChaCha: key size must be 32 bytes");if(d.length<c.length)throw Error("ChaCha: destination is shorter than source");if(0===f){if(8!==b.length&&12!==b.length)throw Error("ChaCha nonce must be 8 or 12 bytes");i=(h=new Uint8Array(16)).length-b.length,h.set(b,i)}else{if(16!==b.length)throw Error("ChaCha nonce with counter must be 16 bytes");h=b,i=f}for(var h,i,k=new Uint8Array(64),l=0;l<c.length;l+=64){g(k,h,a);for(var m=l;m<l+64&&m<c.length;m++)d[m]=c[m]^k[m-l];j(h,0,i)}return e.wipe(k),0===f&&e.wipe(h),d}function i(a,b,c,d){return void 0===d&&(d=0),e.wipe(c),h(a,b,c,c,d)}function j(a,b,c){for(var d=1;c--;)d=d+(255&a[b])|0,a[b]=255&d,d>>>=8,b++;if(d>0)throw Error("ChaCha: counter overflow")}b.streamXOR=h,b.stream=i},4153:function(a,b){"use strict";function c(a,b,c){return~(a-1)&b|a-1&c}function d(a,b){return(0|a)-(0|b)-1>>>31&1}function e(a,b){if(a.length!==b.length)return 0;for(var c=0,d=0;d<a.length;d++)c|=a[d]^b[d];return 1&c-1>>>8}function f(a,b){return 0!==a.length&&0!==b.length&&0!==e(a,b)}Object.defineProperty(b,"__esModule",{value:!0}),b.select=c,b.lessOrEqual=d,b.compare=e,b.equal=f},79984:function(a,b){"use strict";function c(a){return void 0!==a.saveState&& void 0!==a.restoreState&& void 0!==a.cleanSavedState}Object.defineProperty(b,"__esModule",{value:!0}),b.isSerializableHash=c},512:function(a,b,c){"use strict";d={value:!0};var d,e=c(25629),f=c(17309),g=function(){function a(a,b,c,d){void 0===c&&(c=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=a,this._info=d;var f=e.hmac(this._hash,c,b);this._hmac=new e.HMAC(a,f),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return a.prototype._fillBuffer=function(){this._counter[0]++;var a=this._counter[0];if(0===a)throw Error("hkdf: cannot expand more");this._hmac.reset(),a>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},a.prototype.expand=function(a){for(var b=new Uint8Array(a),c=0;c<b.length;c++)this._bufpos===this._buffer.length&&this._fillBuffer(),b[c]=this._buffer[this._bufpos++];return b},a.prototype.clean=function(){this._hmac.clean(),f.wipe(this._buffer),f.wipe(this._counter),this._bufpos=0},a}();b.t=g},25629:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(79984),e=c(4153),f=c(17309),g=function(){function a(a,b){this._finished=!1,this._inner=new a,this._outer=new a,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var c=new Uint8Array(this.blockSize);b.length>this.blockSize?this._inner.update(b).finish(c).clean():c.set(b);for(var e=0;e<c.length;e++)c[e]^=54;this._inner.update(c);for(var e=0;e<c.length;e++)c[e]^=106;this._outer.update(c),d.isSerializableHash(this._inner)&&d.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),f.wipe(c)}return a.prototype.reset=function(){if(!d.isSerializableHash(this._inner)||!d.isSerializableHash(this._outer))throw Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},a.prototype.clean=function(){d.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),d.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},a.prototype.update=function(a){return this._inner.update(a),this},a.prototype.finish=function(a){return this._finished?(this._outer.finish(a),this):(this._inner.finish(a),this._outer.update(a.subarray(0,this.digestLength)).finish(a),this._finished=!0,this)},a.prototype.digest=function(){var a=new Uint8Array(this.digestLength);return this.finish(a),a},a.prototype.saveState=function(){if(!d.isSerializableHash(this._inner))throw Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},a.prototype.restoreState=function(a){if(!d.isSerializableHash(this._inner)||!d.isSerializableHash(this._outer))throw Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(a),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},a.prototype.cleanSavedState=function(a){if(!d.isSerializableHash(this._inner))throw Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(a)},a}();function h(a,b,c){var d=new g(a,b);d.update(c);var e=d.digest();return d.clean(),e}b.HMAC=g,b.hmac=h,b.equal=e.equal},97117:function(a,b){"use strict";function c(a,b){var c=a>>>16&65535,d=65535&a,e=b>>>16&65535,f=65535&b;return d*f+(c*f+d*e<<16>>>0)|0}function d(a,b){return a+b|0}function e(a,b){return a-b|0}function f(a,b){return a<<b|a>>>32-b}function g(a,b){return a<<32-b|a>>>b}function h(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a}Object.defineProperty(b,"__esModule",{value:!0}),b.mul=Math.imul||c,b.add=d,b.sub=e,b.rotl=f,b.rotr=g,b.isInteger=Number.isInteger||h,b.MAX_SAFE_INTEGER=9007199254740991,b.isSafeInteger=function(a){return b.isInteger(a)&&a>= -b.MAX_SAFE_INTEGER&&a<=b.MAX_SAFE_INTEGER}},63027:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(4153),e=c(17309);b.DIGEST_LENGTH=16;var f=function(){function a(a){this.digestLength=b.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var c=a[0]|a[1]<<8;this._r[0]=8191&c;var d=a[2]|a[3]<<8;this._r[1]=(c>>>13|d<<3)&8191;var e=a[4]|a[5]<<8;this._r[2]=(d>>>10|e<<6)&7939;var f=a[6]|a[7]<<8;this._r[3]=(e>>>7|f<<9)&8191;var g=a[8]|a[9]<<8;this._r[4]=(f>>>4|g<<12)&255,this._r[5]=g>>>1&8190;var h=a[10]|a[11]<<8;this._r[6]=(g>>>14|h<<2)&8191;var i=a[12]|a[13]<<8;this._r[7]=(h>>>11|i<<5)&8065;var j=a[14]|a[15]<<8;this._r[8]=(i>>>8|j<<8)&8191,this._r[9]=j>>>5&127,this._pad[0]=a[16]|a[17]<<8,this._pad[1]=a[18]|a[19]<<8,this._pad[2]=a[20]|a[21]<<8,this._pad[3]=a[22]|a[23]<<8,this._pad[4]=a[24]|a[25]<<8,this._pad[5]=a[26]|a[27]<<8,this._pad[6]=a[28]|a[29]<<8,this._pad[7]=a[30]|a[31]<<8}return a.prototype._blocks=function(a,b,c){for(var d=this._fin?0:2048,e=this._h[0],f=this._h[1],g=this._h[2],h=this._h[3],i=this._h[4],j=this._h[5],k=this._h[6],l=this._h[7],m=this._h[8],n=this._h[9],o=this._r[0],p=this._r[1],q=this._r[2],r=this._r[3],s=this._r[4],t=this._r[5],u=this._r[6],v=this._r[7],w=this._r[8],x=this._r[9];c>=16;){var y=a[b+0]|a[b+1]<<8;e+=8191&y;var z=a[b+2]|a[b+3]<<8;f+=(y>>>13|z<<3)&8191;var A=a[b+4]|a[b+5]<<8;g+=(z>>>10|A<<6)&8191;var B=a[b+6]|a[b+7]<<8;h+=(A>>>7|B<<9)&8191;var C=a[b+8]|a[b+9]<<8;i+=(B>>>4|C<<12)&8191,j+=C>>>1&8191;var D=a[b+10]|a[b+11]<<8;k+=(C>>>14|D<<2)&8191;var E=a[b+12]|a[b+13]<<8;l+=(D>>>11|E<<5)&8191;var F=a[b+14]|a[b+15]<<8;m+=(E>>>8|F<<8)&8191,n+=F>>>5|d;var G=0,H=G;H+=e*o,H+=f*(5*x),H+=g*(5*w),H+=h*(5*v),H+=i*(5*u),G=H>>>13,H&=8191,H+=j*(5*t),H+=k*(5*s),H+=l*(5*r),H+=m*(5*q),H+=n*(5*p),G+=H>>>13,H&=8191;var I=G;I+=e*p,I+=f*o,I+=g*(5*x),I+=h*(5*w),I+=i*(5*v),G=I>>>13,I&=8191,I+=j*(5*u),I+=k*(5*t),I+=l*(5*s),I+=m*(5*r),I+=n*(5*q),G+=I>>>13,I&=8191;var J=G;J+=e*q,J+=f*p,J+=g*o,J+=h*(5*x),J+=i*(5*w),G=J>>>13,J&=8191,J+=j*(5*v),J+=k*(5*u),J+=l*(5*t),J+=m*(5*s),J+=n*(5*r),G+=J>>>13,J&=8191;var K=G;K+=e*r,K+=f*q,K+=g*p,K+=h*o,K+=i*(5*x),G=K>>>13,K&=8191,K+=j*(5*w),K+=k*(5*v),K+=l*(5*u),K+=m*(5*t),K+=n*(5*s),G+=K>>>13,K&=8191;var L=G;L+=e*s,L+=f*r,L+=g*q,L+=h*p,L+=i*o,G=L>>>13,L&=8191,L+=j*(5*x),L+=k*(5*w),L+=l*(5*v),L+=m*(5*u),L+=n*(5*t),G+=L>>>13,L&=8191;var M=G;M+=e*t,M+=f*s,M+=g*r,M+=h*q,M+=i*p,G=M>>>13,M&=8191,M+=j*o,M+=k*(5*x),M+=l*(5*w),M+=m*(5*v),M+=n*(5*u),G+=M>>>13,M&=8191;var N=G;N+=e*u,N+=f*t,N+=g*s,N+=h*r,N+=i*q,G=N>>>13,N&=8191,N+=j*p,N+=k*o,N+=l*(5*x),N+=m*(5*w),N+=n*(5*v),G+=N>>>13,N&=8191;var O=G;O+=e*v,O+=f*u,O+=g*t,O+=h*s,O+=i*r,G=O>>>13,O&=8191,O+=j*q,O+=k*p,O+=l*o,O+=m*(5*x),O+=n*(5*w),G+=O>>>13,O&=8191;var P=G;P+=e*w,P+=f*v,P+=g*u,P+=h*t,P+=i*s,G=P>>>13,P&=8191,P+=j*r,P+=k*q,P+=l*p,P+=m*o,P+=n*(5*x),G+=P>>>13,P&=8191;var Q=G;Q+=e*x,Q+=f*w,Q+=g*v,Q+=h*u,Q+=i*t,G=Q>>>13,Q&=8191,Q+=j*s,Q+=k*r,Q+=l*q,Q+=m*p,Q+=n*o,G+=Q>>>13,Q&=8191,H=8191&(G=(G=(G<<2)+G|0)+H|0),G>>>=13,I+=G,e=H,f=I,g=J,h=K,i=L,j=M,k=N,l=O,m=P,n=Q,b+=16,c-=16}this._h[0]=e,this._h[1]=f,this._h[2]=g,this._h[3]=h,this._h[4]=i,this._h[5]=j,this._h[6]=k,this._h[7]=l,this._h[8]=m,this._h[9]=n},a.prototype.finish=function(a,b){void 0===b&&(b=0);var c,d,e,f,g=new Uint16Array(10);if(this._leftover){for(f=this._leftover,this._buffer[f++]=1;f<16;f++)this._buffer[f]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(c=this._h[1]>>>13,this._h[1]&=8191,f=2;f<10;f++)this._h[f]+=c,c=this._h[f]>>>13,this._h[f]&=8191;for(this._h[0]+=5*c,c=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=c,c=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=c,g[0]=this._h[0]+5,c=g[0]>>>13,g[0]&=8191,f=1;f<10;f++)g[f]=this._h[f]+c,c=g[f]>>>13,g[f]&=8191;for(g[9]-=8192,d=(1^c)-1,f=0;f<10;f++)g[f]&=d;for(f=0,d=~d;f<10;f++)this._h[f]=this._h[f]&d|g[f];for(f=1,this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,e=this._h[0]+this._pad[0],this._h[0]=65535&e;f<8;f++)e=(this._h[f]+this._pad[f]|0)+(e>>>16)|0,this._h[f]=65535&e;return a[b+0]=this._h[0]>>>0,a[b+1]=this._h[0]>>>8,a[b+2]=this._h[1]>>>0,a[b+3]=this._h[1]>>>8,a[b+4]=this._h[2]>>>0,a[b+5]=this._h[2]>>>8,a[b+6]=this._h[3]>>>0,a[b+7]=this._h[3]>>>8,a[b+8]=this._h[4]>>>0,a[b+9]=this._h[4]>>>8,a[b+10]=this._h[5]>>>0,a[b+11]=this._h[5]>>>8,a[b+12]=this._h[6]>>>0,a[b+13]=this._h[6]>>>8,a[b+14]=this._h[7]>>>0,a[b+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(a){var b,c=0,d=a.length;if(this._leftover){(b=16-this._leftover)>d&&(b=d);for(var e=0;e<b;e++)this._buffer[this._leftover+e]=a[c+e];if(d-=b,c+=b,this._leftover+=b,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(d>=16&&(b=d-d%16,this._blocks(a,c,b),c+=b,d-=b),d){for(var e=0;e<d;e++)this._buffer[this._leftover+e]=a[c+e];this._leftover+=d}return this},a.prototype.digest=function(){if(this._finished)throw Error("Poly1305 was finished");var a=new Uint8Array(16);return this.finish(a),a},a.prototype.clean=function(){return e.wipe(this._buffer),e.wipe(this._r),e.wipe(this._h),e.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();function g(a,b){var c=new f(a);c.update(b);var d=c.digest();return c.clean(),d}function h(a,c){return a.length===b.DIGEST_LENGTH&&c.length===b.DIGEST_LENGTH&&d.equal(a,c)}b.Poly1305=f,b.oneTimeAuth=g,b.equal=h},31416:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.randomStringForEntropy=b.randomString=b.randomUint32=b.randomBytes=b.defaultRandomSource=void 0;let d=c(46008),e=c(98099),f=c(17309);function g(a,c=b.defaultRandomSource){return c.randomBytes(a)}function h(a=b.defaultRandomSource){let c=g(4,a),d=(0,e.readUint32LE)(c);return(0,f.wipe)(c),d}b.defaultRandomSource=new d.SystemRandomSource,b.randomBytes=g,b.randomUint32=h;let i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function j(a,c=i,d=b.defaultRandomSource){if(c.length<2)throw Error("randomString charset is too short");if(c.length>256)throw Error("randomString charset is too long");let e="",h=c.length,j=256-256%h;for(;a>0;){let k=g(Math.ceil(256*a/j),d);for(let l=0;l<k.length&&a>0;l++){let m=k[l];m<j&&(e+=c.charAt(m%h),a--)}(0,f.wipe)(k)}return e}function k(a,c=i,d=b.defaultRandomSource){let e=Math.ceil(a/(Math.log(c.length)/Math.LN2));return j(e,c,d)}b.randomString=j,b.randomStringForEntropy=k},75455:function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BrowserRandomSource=void 0;let c=65536;class d{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let a="undefined"!=typeof self?self.crypto||self.msCrypto:null;a&& void 0!==a.getRandomValues&&(this._crypto=a,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(a){if(!this.isAvailable||!this._crypto)throw Error("Browser random byte generator is not available.");let b=new Uint8Array(a);for(let d=0;d<b.length;d+=c)this._crypto.getRandomValues(b.subarray(d,d+Math.min(b.length-d,c)));return b}}b.BrowserRandomSource=d},58871:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.NodeRandomSource=void 0;let d=c(17309);class e{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{let a=c(35883);a&&a.randomBytes&&(this._crypto=a,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(a){if(!this.isAvailable||!this._crypto)throw Error("Node.js random byte generator is not available.");let b=this._crypto.randomBytes(a);if(b.length!==a)throw Error("NodeRandomSource: got fewer bytes than requested");let c=new Uint8Array(a);for(let e=0;e<c.length;e++)c[e]=b[e];return(0,d.wipe)(b),c}}b.NodeRandomSource=e},46008:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.SystemRandomSource=void 0;let d=c(75455),e=c(58871);class f{constructor(){if(this.isAvailable=!1,this.name="",this._source=new d.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new e.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(a){if(!this.isAvailable)throw Error("System random byte generator is not available.");return this._source.randomBytes(a)}}b.SystemRandomSource=f},73294:function(a,b,c){"use strict";d={value:!0};var d,e=c(98099),f=c(17309);b.k=32,b.cn=64;var g=function(){function a(){this.digestLength=b.k,this.blockSize=b.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){f.wipe(this._buffer),f.wipe(this._temp),this.reset()},a.prototype.update=function(a,b){if(void 0===b&&(b=a.length),this._finished)throw Error("SHA256: can't update because hash was finished.");var c=0;if(this._bytesHashed+=b,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&b>0;)this._buffer[this._bufferLength++]=a[c++],b--;this._bufferLength===this.blockSize&&(i(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(b>=this.blockSize&&(c=i(this._temp,this._state,a,c,b),b%=this.blockSize);b>0;)this._buffer[this._bufferLength++]=a[c++],b--;return this},a.prototype.finish=function(a){if(!this._finished){var b=this._bytesHashed,c=this._bufferLength,d=b/536870912|0,f=b<<3,g=b%64<56?64:128;this._buffer[c]=128;for(var h=c+1;h<g-8;h++)this._buffer[h]=0;e.writeUint32BE(d,this._buffer,g-8),e.writeUint32BE(f,this._buffer,g-4),i(this._temp,this._state,this._buffer,0,g),this._finished=!0}for(var h=0;h<this.digestLength/4;h++)e.writeUint32BE(this._state[h],a,4*h);return this},a.prototype.digest=function(){var a=new Uint8Array(this.digestLength);return this.finish(a),a},a.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(a){return this._state.set(a.state),this._bufferLength=a.bufferLength,a.buffer&&this._buffer.set(a.buffer),this._bytesHashed=a.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(a){f.wipe(a.state),a.buffer&&f.wipe(a.buffer),a.bufferLength=0,a.bytesHashed=0},a}();b.mE=g;var h=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function i(a,b,c,d,f){for(;f>=64;){for(var g=b[0],i=b[1],j=b[2],k=b[3],l=b[4],m=b[5],n=b[6],o=b[7],p=0;p<16;p++){var q=d+4*p;a[p]=e.readUint32BE(c,q)}for(var p=16;p<64;p++){var r=a[p-2],s=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,t=((r=a[p-15])>>>7|r<<25)^(r>>>18|r<<14)^r>>>3;a[p]=(s+a[p-7]|0)+(t+a[p-16]|0)}for(var p=0;p<64;p++){var s=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&m^ ~l&n)|0)+(o+(h[p]+a[p]|0)|0)|0,t=((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+(g&i^g&j^i&j)|0;o=n,n=m,m=l,l=k+s|0,k=j,j=i,i=g,g=s+t|0}b[0]+=g,b[1]+=i,b[2]+=j,b[3]+=k,b[4]+=l,b[5]+=m,b[6]+=n,b[7]+=o,d+=64,f-=64}return d}function j(a){var b=new g;b.update(a);var c=b.digest();return b.clean(),c}b.vp=j},17309:function(a,b){"use strict";function c(a){for(var b=0;b<a.length;b++)a[b]=0;return a}Object.defineProperty(b,"__esModule",{value:!0}),b.wipe=c},57664:function(a,b,c){"use strict";var d;d={value:!0},b.gi=b.Au=b._w=d=d=d=b.KS=b.kz=void 0;let e=c(31416),f=c(17309);function g(a){let b=new Float64Array(16);if(a)for(let c=0;c<a.length;c++)b[c]=a[c];return b}b.kz=32,b.KS=32,d=32;let h=new Uint8Array(32);h[0]=9;let i=g([56129,1]);function j(a){let b=1;for(let c=0;c<16;c++){let d=a[c]+b+65535;b=Math.floor(d/65536),a[c]=d-65536*b}a[0]+=b-1+37*(b-1)}function k(a,b,c){let d=~(c-1);for(let e=0;e<16;e++){let f=d&(a[e]^b[e]);a[e]^=f,b[e]^=f}}function l(a,b){let c=g(),d=g();for(let e=0;e<16;e++)d[e]=b[e];j(d),j(d),j(d);for(let f=0;f<2;f++){c[0]=d[0]-65517;for(let h=1;h<15;h++)c[h]=d[h]-65535-(c[h-1]>>16&1),c[h-1]&=65535;c[15]=d[15]-32767-(c[14]>>16&1);let i=c[15]>>16&1;c[14]&=65535,k(d,c,1-i)}for(let l=0;l<16;l++)a[2*l]=255&d[l],a[2*l+1]=d[l]>>8}function m(a,b){for(let c=0;c<16;c++)a[c]=b[2*c]+(b[2*c+1]<<8);a[15]&=32767}function n(a,b,c){for(let d=0;d<16;d++)a[d]=b[d]+c[d]}function o(a,b,c){for(let d=0;d<16;d++)a[d]=b[d]-c[d]}function p(a,b,c){let d,e,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=c[0],L=c[1],M=c[2],N=c[3],O=c[4],P=c[5],Q=c[6],R=c[7],S=c[8],T=c[9],U=c[10],V=c[11],W=c[12],X=c[13],Y=c[14],Z=c[15];f+=(d=b[0])*K,g+=d*L,h+=d*M,i+=d*N,j+=d*O,k+=d*P,l+=d*Q,m+=d*R,n+=d*S,o+=d*T,p+=d*U,q+=d*V,r+=d*W,s+=d*X,t+=d*Y,u+=d*Z,d=b[1],g+=d*K,h+=d*L,i+=d*M,j+=d*N,k+=d*O,l+=d*P,m+=d*Q,n+=d*R,o+=d*S,p+=d*T,q+=d*U,r+=d*V,s+=d*W,t+=d*X,u+=d*Y,v+=d*Z,d=b[2],h+=d*K,i+=d*L,j+=d*M,k+=d*N,l+=d*O,m+=d*P,n+=d*Q,o+=d*R,p+=d*S,q+=d*T,r+=d*U,s+=d*V,t+=d*W,u+=d*X,v+=d*Y,w+=d*Z,d=b[3],i+=d*K,j+=d*L,k+=d*M,l+=d*N,m+=d*O,n+=d*P,o+=d*Q,p+=d*R,q+=d*S,r+=d*T,s+=d*U,t+=d*V,u+=d*W,v+=d*X,w+=d*Y,x+=d*Z,d=b[4],j+=d*K,k+=d*L,l+=d*M,m+=d*N,n+=d*O,o+=d*P,p+=d*Q,q+=d*R,r+=d*S,s+=d*T,t+=d*U,u+=d*V,v+=d*W,w+=d*X,x+=d*Y,y+=d*Z,d=b[5],k+=d*K,l+=d*L,m+=d*M,n+=d*N,o+=d*O,p+=d*P,q+=d*Q,r+=d*R,s+=d*S,t+=d*T,u+=d*U,v+=d*V,w+=d*W,x+=d*X,y+=d*Y,z+=d*Z,d=b[6],l+=d*K,m+=d*L,n+=d*M,o+=d*N,p+=d*O,q+=d*P,r+=d*Q,s+=d*R,t+=d*S,u+=d*T,v+=d*U,w+=d*V,x+=d*W,y+=d*X,z+=d*Y,A+=d*Z,d=b[7],m+=d*K,n+=d*L,o+=d*M,p+=d*N,q+=d*O,r+=d*P,s+=d*Q,t+=d*R,u+=d*S,v+=d*T,w+=d*U,x+=d*V,y+=d*W,z+=d*X,A+=d*Y,B+=d*Z,d=b[8],n+=d*K,o+=d*L,p+=d*M,q+=d*N,r+=d*O,s+=d*P,t+=d*Q,u+=d*R,v+=d*S,w+=d*T,x+=d*U,y+=d*V,z+=d*W,A+=d*X,B+=d*Y,C+=d*Z,d=b[9],o+=d*K,p+=d*L,q+=d*M,r+=d*N,s+=d*O,t+=d*P,u+=d*Q,v+=d*R,w+=d*S,x+=d*T,y+=d*U,z+=d*V,A+=d*W,B+=d*X,C+=d*Y,D+=d*Z,d=b[10],p+=d*K,q+=d*L,r+=d*M,s+=d*N,t+=d*O,u+=d*P,v+=d*Q,w+=d*R,x+=d*S,y+=d*T,z+=d*U,A+=d*V,B+=d*W,C+=d*X,D+=d*Y,E+=d*Z,d=b[11],q+=d*K,r+=d*L,s+=d*M,t+=d*N,u+=d*O,v+=d*P,w+=d*Q,x+=d*R,y+=d*S,z+=d*T,A+=d*U,B+=d*V,C+=d*W,D+=d*X,E+=d*Y,F+=d*Z,d=b[12],r+=d*K,s+=d*L,t+=d*M,u+=d*N,v+=d*O,w+=d*P,x+=d*Q,y+=d*R,z+=d*S,A+=d*T,B+=d*U,C+=d*V,D+=d*W,E+=d*X,F+=d*Y,G+=d*Z,d=b[13],s+=d*K,t+=d*L,u+=d*M,v+=d*N,w+=d*O,x+=d*P,y+=d*Q,z+=d*R,A+=d*S,B+=d*T,C+=d*U,D+=d*V,E+=d*W,F+=d*X,G+=d*Y,H+=d*Z,d=b[14],t+=d*K,u+=d*L,v+=d*M,w+=d*N,x+=d*O,y+=d*P,z+=d*Q,A+=d*R,B+=d*S,C+=d*T,D+=d*U,E+=d*V,F+=d*W,G+=d*X,H+=d*Y,I+=d*Z,d=b[15],u+=d*K,v+=d*L,w+=d*M,x+=d*N,y+=d*O,z+=d*P,A+=d*Q,B+=d*R,C+=d*S,D+=d*T,E+=d*U,F+=d*V,G+=d*W,H+=d*X,I+=d*Y,J+=d*Z,f+=38*v,g+=38*w,h+=38*x,i+=38*y,j+=38*z,k+=38*A,l+=38*B,m+=38*C,n+=38*D,o+=38*E,p+=38*F,q+=38*G,r+=38*H,s+=38*I,t+=38*J,e=1,d=f+e+65535,e=Math.floor(d/65536),f=d-65536*e,d=g+e+65535,e=Math.floor(d/65536),g=d-65536*e,d=h+e+65535,e=Math.floor(d/65536),h=d-65536*e,d=i+e+65535,e=Math.floor(d/65536),i=d-65536*e,d=j+e+65535,e=Math.floor(d/65536),j=d-65536*e,d=k+e+65535,e=Math.floor(d/65536),k=d-65536*e,d=l+e+65535,e=Math.floor(d/65536),l=d-65536*e,d=m+e+65535,e=Math.floor(d/65536),m=d-65536*e,d=n+e+65535,e=Math.floor(d/65536),n=d-65536*e,d=o+e+65535,e=Math.floor(d/65536),o=d-65536*e,d=p+e+65535,e=Math.floor(d/65536),p=d-65536*e,d=q+e+65535,e=Math.floor(d/65536),q=d-65536*e,d=r+e+65535,e=Math.floor(d/65536),r=d-65536*e,d=s+e+65535,e=Math.floor(d/65536),s=d-65536*e,d=t+e+65535,e=Math.floor(d/65536),t=d-65536*e,d=u+e+65535,e=Math.floor(d/65536),u=d-65536*e,f+=e-1+37*(e-1),e=1,d=f+e+65535,e=Math.floor(d/65536),f=d-65536*e,d=g+e+65535,e=Math.floor(d/65536),g=d-65536*e,d=h+e+65535,e=Math.floor(d/65536),h=d-65536*e,d=i+e+65535,e=Math.floor(d/65536),i=d-65536*e,d=j+e+65535,e=Math.floor(d/65536),j=d-65536*e,d=k+e+65535,e=Math.floor(d/65536),k=d-65536*e,d=l+e+65535,e=Math.floor(d/65536),l=d-65536*e,d=m+e+65535,e=Math.floor(d/65536),m=d-65536*e,d=n+e+65535,e=Math.floor(d/65536),n=d-65536*e,d=o+e+65535,e=Math.floor(d/65536),o=d-65536*e,d=p+e+65535,e=Math.floor(d/65536),p=d-65536*e,d=q+e+65535,e=Math.floor(d/65536),q=d-65536*e,d=r+e+65535,e=Math.floor(d/65536),r=d-65536*e,d=s+e+65535,e=Math.floor(d/65536),s=d-65536*e,d=t+e+65535,e=Math.floor(d/65536),t=d-65536*e,d=u+e+65535,e=Math.floor(d/65536),u=d-65536*e,f+=e-1+37*(e-1),a[0]=f,a[1]=g,a[2]=h,a[3]=i,a[4]=j,a[5]=k,a[6]=l,a[7]=m,a[8]=n,a[9]=o,a[10]=p,a[11]=q,a[12]=r,a[13]=s,a[14]=t,a[15]=u}function q(a,b){p(a,b,b)}function r(a,b){let c=g();for(let d=0;d<16;d++)c[d]=b[d];for(let e=253;e>=0;e--)q(c,c),2!==e&&4!==e&&p(c,c,b);for(let f=0;f<16;f++)a[f]=c[f]}function s(a,b){let c=new Uint8Array(32),d=new Float64Array(80),e=g(),f=g(),h=g(),j=g(),s=g(),t=g();for(let u=0;u<31;u++)c[u]=a[u];c[31]=127&a[31]|64,c[0]&=248,m(d,b);for(let v=0;v<16;v++)f[v]=d[v];e[0]=j[0]=1;for(let w=254;w>=0;--w){let x=c[w>>>3]>>>(7&w)&1;k(e,f,x),k(h,j,x),n(s,e,h),o(e,e,h),n(h,f,j),o(f,f,j),q(j,s),q(t,e),p(e,h,e),p(h,f,s),n(s,e,h),o(e,e,h),q(f,e),o(h,j,t),p(e,h,i),n(e,e,j),p(h,h,e),p(e,j,t),p(j,f,d),q(f,s),k(e,f,x),k(h,j,x)}for(let y=0;y<16;y++)d[y+16]=e[y],d[y+32]=h[y],d[y+48]=f[y],d[y+64]=j[y];let z=d.subarray(32),A=d.subarray(16);r(z,z),p(A,A,z);let B=new Uint8Array(32);return l(B,A),B}function t(a){return s(a,h)}function u(a){if(a.length!==b.KS)throw Error(`x25519: seed must be ${b.KS} bytes`);let c=new Uint8Array(a),d=t(c);return{publicKey:d,secretKey:c}}function v(a){let b=(0,e.randomBytes)(32,a),c=u(b);return(0,f.wipe)(b),c}function w(a,c,d=!1){if(a.length!==b.kz)throw Error("X25519: incorrect secret key length");if(c.length!==b.kz)throw Error("X25519: incorrect public key length");let e=s(a,c);if(d){let f=0;for(let g=0;g<e.length;g++)f|=e[g];if(0===f)throw Error("X25519: invalid shared key")}return e}d=s,d=t,b._w=u,b.Au=v,b.gi=w},63573:function(a,b){"use strict";let c=Math.exp;b=a.exports=function(a){if("number"!=typeof a)throw Error("must provide a timespan to the moving average constructor");if(a<=0)throw Error("must provide a timespan > 0 to the moving average constructor");let b,d=0,e=0,f=0,g,h={};function i(b,d){return 1-c(-(b-d)/a)}return h.push=function(a,c){if(g){let h=i(a,g),j=c-b,k=h*j;b=h*c+(1-h)*b,d=(1-h)*(d+j*k),e=Math.sqrt(d),f=b+h*j}else b=c;g=a},h.movingAverage=function(){return b},h.variance=function(){return d},h.deviation=function(){return e},h.forecast=function(){return f},h}},18508:function(a,b,c){"use strict";let d=Object.freeze({});function e(a){if("object"!=typeof a||null===a)throw TypeError("First argument must be an abstract-leveldown compliant store");this.db=a,this._operations=[],this._written=!1}e.prototype._checkWritten=function(){if(this._written)throw Error("write() already called on this batch")},e.prototype.put=function(a,b,c){this._checkWritten();let e=this.db._checkKey(a)||this.db._checkValue(b);if(e)throw e;return a=this.db._serializeKey(a),b=this.db._serializeValue(b),this._put(a,b,null!=c?c:d),this},e.prototype._put=function(a,b,c){this._operations.push({...c,type:"put",key:a,value:b})},e.prototype.del=function(a,b){this._checkWritten();let c=this.db._checkKey(a);if(c)throw c;return a=this.db._serializeKey(a),this._del(a,null!=b?b:d),this},e.prototype._del=function(a,b){this._operations.push({...b,type:"del",key:a})},e.prototype.clear=function(){return this._checkWritten(),this._clear(),this},e.prototype._clear=function(){this._operations=[]},e.prototype.write=function(a,b){if(this._checkWritten(),"function"==typeof a&&(b=a),"function"!=typeof b)throw Error("write() requires a callback argument");("object"!=typeof a||null===a)&&(a={}),this._written=!0,this._write(a,b)},e.prototype._write=function(a,b){this.db._batch(this._operations,a,b)},e.prototype._nextTick=c(17212),a.exports=e},43538:function(a,b,c){"use strict";function d(a){if("object"!=typeof a||null===a)throw TypeError("First argument must be an abstract-leveldown compliant store");this.db=a,this._ended=!1,this._nexting=!1}d.prototype.next=function(a){let b=this;if(void 0===a)b=new Promise(function(b,c){a=function(a,d,e){a?c(a):void 0===d&& void 0===e?b():b([d,e])}});else if("function"!=typeof a)throw Error("next() requires a callback argument");return this._ended?(this._nextTick(a,Error("cannot call next() after end()")),b):this._nexting?(this._nextTick(a,Error("cannot call next() before previous next() has completed")),b):(this._nexting=!0,this._next((b,...c)=>{this._nexting=!1,a(b,...c)}),b)},d.prototype._next=function(a){this._nextTick(a)},d.prototype.seek=function(a){if(this._ended)throw Error("cannot call seek() after end()");if(this._nexting)throw Error("cannot call seek() before next() has completed");a=this.db._serializeKey(a),this._seek(a)},d.prototype._seek=function(a){},d.prototype.end=function(a){let b;if(void 0===a)b=new Promise(function(b,c){a=function(a){a?c(a):b()}});else if("function"!=typeof a)throw Error("end() requires a callback argument");return this._ended?(this._nextTick(a,Error("end() already called on iterator")),b):(this._ended=!0,this._end(a),b)},d.prototype._end=function(a){this._nextTick(a)},d.prototype[Symbol.asyncIterator]=async function*(){try{let a;for(;void 0!==(a=await this.next());)yield a}finally{this._ended||await this.end()}},d.prototype._nextTick=c(17212),a.exports=d},32554:function(a,b,c){"use strict";let d=c(51675),e=c(48738),f=c(16957),g=c(43538),h=c(18508),i=c(90070).R,j=c(90070).F,k=Object.prototype.hasOwnProperty,l=["lt","lte","gt","gte"];function m(a){this.status="new",this.supports=d(a,{status:!0})}function n(a,b){let c={};for(let d in b){if(!k.call(b,d))continue;if("start"===d||"end"===d)throw Error('Legacy range options ("start" and "end") have been removed');let e=b[d];o(d)&&(e=a._serializeKey(e)),c[d]=e}return c}function o(a){return -1!==l.indexOf(a)}function p(a,b){return!a.isOperational()&&(a._nextTick(b,Error("Database is not open")),!0)}m.prototype.open=function(a,b){let c=this.status;if("function"==typeof a&&(b=a),"function"!=typeof b)throw Error("open() requires a callback argument");("object"!=typeof a||null===a)&&(a={}),a.createIfMissing=!1!==a.createIfMissing,a.errorIfExists=!!a.errorIfExists,this.status="opening",this._open(a,a=>{if(a)return this.status=c,b(a);this.status="open",b()})},m.prototype._open=function(a,b){this._nextTick(b)},m.prototype.close=function(a){let b=this.status;if("function"!=typeof a)throw Error("close() requires a callback argument");this.status="closing",this._close(c=>{if(c)return this.status=b,a(c);this.status="closed",a()})},m.prototype._close=function(a){this._nextTick(a)},m.prototype.get=function(a,b,c){if("function"==typeof b&&(c=b),"function"!=typeof c)throw Error("get() requires a callback argument");let d=this._checkKey(a);if(d)return this._nextTick(c,d);a=this._serializeKey(a),("object"!=typeof b||null===b)&&(b={}),b.asBuffer=!1!==b.asBuffer,this._get(a,b,c)},m.prototype._get=function(a,b,c){this._nextTick(function(){c(Error("NotFound"))})},m.prototype.getMany=function(a,b,c){if(c=i(b,c),c=f.fromCallback(c),b=j(b),p(this,c))return c.promise;if(!Array.isArray(a))return this._nextTick(c,Error("getMany() requires an array argument")),c.promise;if(0===a.length)return this._nextTick(c,null,[]),c.promise;"boolean"!=typeof b.asBuffer&&(b={...b,asBuffer:!0});let d=Array(a.length);for(let e=0;e<a.length;e++){let g=a[e],h=this._checkKey(g);if(h)return this._nextTick(c,h),c.promise;d[e]=this._serializeKey(g)}return this._getMany(d,b,c),c.promise},m.prototype._getMany=function(a,b,c){this._nextTick(c,null,Array(a.length).fill(void 0))},m.prototype.put=function(a,b,c,d){if("function"==typeof c&&(d=c),"function"!=typeof d)throw Error("put() requires a callback argument");let e=this._checkKey(a)||this._checkValue(b);if(e)return this._nextTick(d,e);a=this._serializeKey(a),b=this._serializeValue(b),("object"!=typeof c||null===c)&&(c={}),this._put(a,b,c,d)},m.prototype._put=function(a,b,c,d){this._nextTick(d)},m.prototype.del=function(a,b,c){if("function"==typeof b&&(c=b),"function"!=typeof c)throw Error("del() requires a callback argument");let d=this._checkKey(a);if(d)return this._nextTick(c,d);a=this._serializeKey(a),("object"!=typeof b||null===b)&&(b={}),this._del(a,b,c)},m.prototype._del=function(a,b,c){this._nextTick(c)},m.prototype.batch=function(a,b,c){if(!arguments.length)return this._chainedBatch();if("function"==typeof b&&(c=b),"function"==typeof a&&(c=a),"function"!=typeof c)throw Error("batch(array) requires a callback argument");if(!Array.isArray(a))return this._nextTick(c,Error("batch(array) requires an array argument"));if(0===a.length)return this._nextTick(c);("object"!=typeof b||null===b)&&(b={});let d=Array(a.length);for(let e=0;e<a.length;e++){if("object"!=typeof a[e]||null===a[e])return this._nextTick(c,Error("batch(array) element must be an object and not `null`"));let f=Object.assign({},a[e]);if("put"!==f.type&&"del"!==f.type)return this._nextTick(c,Error("`type` must be 'put' or 'del'"));let g=this._checkKey(f.key);if(g)return this._nextTick(c,g);if(f.key=this._serializeKey(f.key),"put"===f.type){let h=this._checkValue(f.value);if(h)return this._nextTick(c,h);f.value=this._serializeValue(f.value)}d[e]=f}this._batch(d,b,c)},m.prototype._batch=function(a,b,c){this._nextTick(c)},m.prototype.clear=function(a,b){if("function"==typeof a)b=a;else if("function"!=typeof b)throw Error("clear() requires a callback argument");(a=n(this,a)).reverse=!!a.reverse,a.limit="limit"in a?a.limit:-1,this._clear(a,b)},m.prototype._clear=function(a,b){a.keys=!0,a.values=!1,a.keyAsBuffer=!0,a.valueAsBuffer=!0;let c=this._iterator(a),d={},e=a=>{if(a)return c.end(function(){b(a)});c.next((a,f)=>a?e(a):void 0===f?c.end(b):void this._del(f,d,e))};e()},m.prototype._setupIteratorOptions=function(a){return(a=n(this,a)).reverse=!!a.reverse,a.keys=!1!==a.keys,a.values=!1!==a.values,a.limit="limit"in a?a.limit:-1,a.keyAsBuffer=!1!==a.keyAsBuffer,a.valueAsBuffer=!1!==a.valueAsBuffer,a},m.prototype.iterator=function(a){return("object"!=typeof a||null===a)&&(a={}),a=this._setupIteratorOptions(a),this._iterator(a)},m.prototype._iterator=function(a){return new g(this)},m.prototype._chainedBatch=function(){return new h(this)},m.prototype._serializeKey=function(a){return a},m.prototype._serializeValue=function(a){return a},m.prototype._checkKey=function(a){return null==a?Error("key cannot be `null` or `undefined`"):e(a)&&0===a.length?Error("key cannot be an empty Buffer"):""===a?Error("key cannot be an empty String"):Array.isArray(a)&&0===a.length?Error("key cannot be an empty Array"):void 0},m.prototype._checkValue=function(a){if(null==a)return Error("value cannot be `null` or `undefined`")},m.prototype.isOperational=function(){return"open"===this.status||this._isOperational()},m.prototype._isOperational=function(){return!1},m.prototype._nextTick=c(17212),a.exports=m},24012:function(a,b,c){"use strict";b.AbstractLevelDOWN=c(32554),b.AbstractIterator=c(43538),b.AbstractChainedBatch=c(18508)},90070:function(a,b){"use strict";b.R=function(a,b){return"function"==typeof a?a:b},b.F=function(a){return"object"==typeof a&&null!==a?a:{}}},17212:function(a,b,c){"use strict";let d=c(54375);a.exports=function(a,...b){0===b.length?d(a):d(()=>a(...b))}},32044:function(a){function b(a){let b=new globalThis.AbortController;function c(){for(let d of(b.abort(),a))d&&d.removeEventListener&&d.removeEventListener("abort",c)}for(let d of a)if(d&&d.addEventListener){if(d.aborted){c();break}d.addEventListener("abort",c)}return b.signal}a.exports=b,a.exports.anySignal=b},79742:function(a,b){"use strict";b.byteLength=j,b.toByteArray=l,b.fromByteArray=o;for(var c=[],d=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,h=f.length;g<h;++g)c[g]=f[g],d[f.charCodeAt(g)]=g;function i(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}function j(a){var b=i(a),c=b[0],d=b[1];return(c+d)*3/4-d}function k(a,b,c){return(b+c)*3/4-c}function l(a){var b,c,f=i(a),g=f[0],h=f[1],j=new e(k(a,g,h)),l=0,m=h>0?g-4:g;for(c=0;c<m;c+=4)b=d[a.charCodeAt(c)]<<18|d[a.charCodeAt(c+1)]<<12|d[a.charCodeAt(c+2)]<<6|d[a.charCodeAt(c+3)],j[l++]=b>>16&255,j[l++]=b>>8&255,j[l++]=255&b;return 2===h&&(b=d[a.charCodeAt(c)]<<2|d[a.charCodeAt(c+1)]>>4,j[l++]=255&b),1===h&&(b=d[a.charCodeAt(c)]<<10|d[a.charCodeAt(c+1)]<<4|d[a.charCodeAt(c+2)]>>2,j[l++]=b>>8&255,j[l++]=255&b),j}function m(a){return c[a>>18&63]+c[a>>12&63]+c[a>>6&63]+c[63&a]}function n(a,b,c){for(var d,e=[],f=b;f<c;f+=3)e.push(m(d=(a[f]<<16&16711680)+(a[f+1]<<8&65280)+(255&a[f+2])));return e.join("")}function o(a){for(var b,d=a.length,e=d%3,f=[],g=16383,h=0,i=d-e;h<i;h+=g)f.push(n(a,h,h+g>i?i:h+g));return 1===e?f.push(c[(b=a[d-1])>>2]+c[b<<4&63]+"=="):2===e&&f.push(c[(b=(a[d-2]<<8)+a[d-1])>>10]+c[b>>4&63]+c[b<<2&63]+"="),f.join("")}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},9668:function(a,b,c){"use strict";let{Buffer:d}=c(48764),e=Symbol.for("BufferList");function f(a){if(!(this instanceof f))return new f(a);f._init.call(this,a)}f._init=function(a){Object.defineProperty(this,e,{value:!0}),this._bufs=[],this.length=0,a&&this.append(a)},f.prototype._new=function(a){return new f(a)},f.prototype._offset=function(a){if(0===a)return[0,0];let b=0;for(let c=0;c<this._bufs.length;c++){let d=b+this._bufs[c].length;if(a<d||c===this._bufs.length-1)return[c,a-b];b=d}},f.prototype._reverseOffset=function(a){let b=a[0],c=a[1];for(let d=0;d<b;d++)c+=this._bufs[d].length;return c},f.prototype.get=function(a){if(a>this.length||a<0)return;let b=this._offset(a);return this._bufs[b[0]][b[1]]},f.prototype.slice=function(a,b){return"number"==typeof a&&a<0&&(a+=this.length),"number"==typeof b&&b<0&&(b+=this.length),this.copy(null,0,a,b)},f.prototype.copy=function(a,b,c,e){if(("number"!=typeof c||c<0)&&(c=0),("number"!=typeof e||e>this.length)&&(e=this.length),c>=this.length||e<=0)return a||d.alloc(0);let f=!!a,g=this._offset(c),h=e-c,i=h,j=f&&b||0,k=g[1];if(0===c&&e===this.length){if(!f)return 1===this._bufs.length?this._bufs[0]:d.concat(this._bufs,this.length);for(let l=0;l<this._bufs.length;l++)this._bufs[l].copy(a,j),j+=this._bufs[l].length;return a}if(i<=this._bufs[g[0]].length-k)return f?this._bufs[g[0]].copy(a,b,k,k+i):this._bufs[g[0]].slice(k,k+i);f||(a=d.allocUnsafe(h));for(let m=g[0];m<this._bufs.length;m++){let n=this._bufs[m].length-k;if(i>n)this._bufs[m].copy(a,j,k),j+=n;else{this._bufs[m].copy(a,j,k,k+i),j+=n;break}i-=n,k&&(k=0)}return a.length>j?a.slice(0,j):a},f.prototype.shallowSlice=function(a,b){if(a=a||0,b="number"!=typeof b?this.length:b,a<0&&(a+=this.length),b<0&&(b+=this.length),a===b)return this._new();let c=this._offset(a),d=this._offset(b),e=this._bufs.slice(c[0],d[0]+1);return 0===d[1]?e.pop():e[e.length-1]=e[e.length-1].slice(0,d[1]),0!==c[1]&&(e[0]=e[0].slice(c[1])),this._new(e)},f.prototype.toString=function(a,b,c){return this.slice(b,c).toString(a)},f.prototype.consume=function(a){if(Number.isNaN(a=Math.trunc(a))||a<=0)return this;for(;this._bufs.length;)if(a>=this._bufs[0].length)a-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(a),this.length-=a;break}return this},f.prototype.duplicate=function(){let a=this._new();for(let b=0;b<this._bufs.length;b++)a.append(this._bufs[b]);return a},f.prototype.append=function(a){if(null==a)return this;if(a.buffer)this._appendBuffer(d.from(a.buffer,a.byteOffset,a.byteLength));else if(Array.isArray(a))for(let b=0;b<a.length;b++)this.append(a[b]);else if(this._isBufferList(a))for(let c=0;c<a._bufs.length;c++)this.append(a._bufs[c]);else"number"==typeof a&&(a=a.toString()),this._appendBuffer(d.from(a));return this},f.prototype._appendBuffer=function(a){this._bufs.push(a),this.length+=a.length},f.prototype.indexOf=function(a,b,c){if(void 0===c&&"string"==typeof b&&(c=b,b=void 0),"function"==typeof a||Array.isArray(a))throw TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof a?a=d.from([a]):"string"==typeof a?a=d.from(a,c):this._isBufferList(a)?a=a.slice():Array.isArray(a.buffer)?a=d.from(a.buffer,a.byteOffset,a.byteLength):d.isBuffer(a)||(a=d.from(a)),isNaN(b=Number(b||0))&&(b=0),b<0&&(b=this.length+b),b<0&&(b=0),0===a.length)return b>this.length?this.length:b;let e=this._offset(b),f=e[0],g=e[1];for(;f<this._bufs.length;f++){let h=this._bufs[f];for(;g<h.length;){let i=h.length-g;if(i>=a.length){let j=h.indexOf(a,g);if(-1!==j)return this._reverseOffset([f,j]);g=h.length-a.length+1}else{let k=this._reverseOffset([f,g]);if(this._match(k,a))return k;g++}}g=0}return -1},f.prototype._match=function(a,b){if(this.length-a<b.length)return!1;for(let c=0;c<b.length;c++)if(this.get(a+c)!==b[c])return!1;return!0},function(){let a={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let b in a)!function(b){null===a[b]?f.prototype[b]=function(a,c){return this.slice(a,a+c)[b](0,c)}:f.prototype[b]=function(c=0){return this.slice(c,c+a[b])[b](0)}}(b)}(),f.prototype._isBufferList=function(a){return a instanceof f||f.isBufferList(a)},f.isBufferList=function(a){return null!=a&&a[e]},a.exports=f},23294:function(a,b,c){"use strict";let d=c(86154);function e(a){return"function"==typeof a.stream?d(a.stream()):d(new Response(a).body)}a.exports=e},76701:function(a,b,c){let d=c(91607);a.exports=a=>{let b;"function"==typeof(a=a||{})?(b=a,a={}):b=a.onEnd;let c=new d,e,f,g,h=()=>{if(!c.isEmpty()){if(a.writev){let b,d=[];for(;!c.isEmpty();){if((b=c.shift()).error)throw b.error;d.push(b.value)}return{done:b.done,value:d}}let h=c.shift();if(h.error)throw h.error;return h}return g?{done:!0}:new Promise((b,c)=>{f=d=>(f=null,d.error?c(d.error):a.writev&&!d.done?b({done:d.done,value:[d.value]}):b(d),e)})},i=a=>f?f(a):(c.push(a),e),j=a=>(c=new d,f)?f({error:a}):(c.push({error:a}),e),k=a=>g?e:i({done:!1,value:a}),l=a=>g?e:(g=!0,a?j(a):i({done:!0})),m=()=>(c=new d,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l},!b)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),b&&(b(a),b=null),{done:!0}},return(){return o.return(),b&&(b(),b=null),{done:!0}},push:k,end(a){return o.end(a),b&&(b(a),b=null),e}}}},86154:function(a){"use strict";async function*b(a,b={}){let c=a.getReader();try{for(;;){let d=await c.read();if(d.done)return;yield d.value}}finally{!0!==b.preventCancel&&c.cancel(),c.releaseLock()}}a.exports=b},48764:function(a,b,c){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */ /* eslint-disable no-proto */ let d=c(79742),e=c(80645),f="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;b.Buffer=j,b.SlowBuffer=u,b.INSPECT_MAX_BYTES=50;let g=2147483647;function h(){try{let a=new Uint8Array(1),b={foo:function(){return 42}};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch(c){return!1}}function i(a){if(a>g)throw RangeError('The value "'+a+'" is invalid for option "size"');let b=new Uint8Array(a);return Object.setPrototypeOf(b,j.prototype),b}function j(a,b,c){if("number"==typeof a){if("string"==typeof b)throw TypeError('The "string" argument must be of type string. Received type number');return n(a)}return k(a,b,c)}function k(a,b,c){if("string"==typeof a)return o(a,b);if(ArrayBuffer.isView(a))return q(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(ag(a,ArrayBuffer)||a&&ag(a.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(ag(a,SharedArrayBuffer)||a&&ag(a.buffer,SharedArrayBuffer)))return r(a,b,c);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');let d=a.valueOf&&a.valueOf();if(null!=d&&d!==a)return j.from(d,b,c);let e=s(a);if(e)return e;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return j.from(a[Symbol.toPrimitive]("string"),b,c);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function l(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+a+'" is invalid for option "size"')}function m(a,b,c){return(l(a),a<=0)?i(a):void 0!==b?"string"==typeof c?i(a).fill(b,c):i(a).fill(b):i(a)}function n(a){return l(a),i(a<0?0:0|t(a))}function o(a,b){if(("string"!=typeof b||""===b)&&(b="utf8"),!j.isEncoding(b))throw TypeError("Unknown encoding: "+b);let c=0|v(a,b),d=i(c),e=d.write(a,b);return e!==c&&(d=d.slice(0,e)),d}function p(a){let b=a.length<0?0:0|t(a.length),c=i(b);for(let d=0;d<b;d+=1)c[d]=255&a[d];return c}function q(a){if(ag(a,Uint8Array)){let b=new Uint8Array(a);return r(b.buffer,b.byteOffset,b.byteLength)}return p(a)}function r(a,b,c){if(b<0||a.byteLength<b)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<b+(c||0))throw RangeError('"length" is outside of buffer bounds');let d;return Object.setPrototypeOf(d=void 0===b&& void 0===c?new Uint8Array(a):void 0===c?new Uint8Array(a,b):new Uint8Array(a,b,c),j.prototype),d}function s(a){if(j.isBuffer(a)){let b=0|t(a.length),c=i(b);return 0===c.length||a.copy(c,0,0,b),c}return void 0!==a.length?"number"!=typeof a.length||ah(a.length)?i(0):p(a):"Buffer"===a.type&&Array.isArray(a.data)?p(a.data):void 0}function t(a){if(a>=g)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g.toString(16)+" bytes");return 0|a}function u(a){return+a!=a&&(a=0),j.alloc(+a)}function v(a,b){if(j.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||ag(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);let c=a.length,d=arguments.length>2&& !0===arguments[2];if(!d&&0===c)return 0;let e=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return ab(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return ae(a).length;default:if(e)return d?-1:ab(a).length;b=(""+b).toLowerCase(),e=!0}}function w(a,b,c){let d=!1;if((void 0===b||b<0)&&(b=0),b>this.length||((void 0===c||c>this.length)&&(c=this.length),c<=0||(c>>>=0)<=(b>>>=0)))return"";for(a||(a="utf8");;)switch(a){case"hex":return L(this,b,c);case"utf8":case"utf-8":return G(this,b,c);case"ascii":return J(this,b,c);case"latin1":case"binary":return K(this,b,c);case"base64":return F(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,b,c);default:if(d)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function x(a,b,c){let d=a[b];a[b]=a[c],a[c]=d}function y(a,b,c,d,e){if(0===a.length)return -1;if("string"==typeof c?(d=c,c=0):c>2147483647?c=2147483647:c< -2147483648&&(c=-2147483648),ah(c=+c)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return -1;c=a.length-1}else if(c<0){if(!e)return -1;c=0}if("string"==typeof b&&(b=j.from(b,d)),j.isBuffer(b))return 0===b.length?-1:z(a,b,c,d,e);if("number"==typeof b)return(b&=255,"function"==typeof Uint8Array.prototype.indexOf)?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):z(a,[b],c,d,e);throw TypeError("val must be string, number or Buffer")}function z(a,b,c,d,e){let f=1,g=a.length,h=b.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return -1;f=2,g/=2,h/=2,c/=2}function i(a,b){return 1===f?a[b]:a.readUInt16BE(b*f)}let j;if(e){let k=-1;for(j=c;j<g;j++)if(i(a,j)===i(b,-1===k?0:j-k)){if(-1===k&&(k=j),j-k+1===h)return k*f}else -1!==k&&(j-=j-k),k=-1}else for(c+h>g&&(c=g-h),j=c;j>=0;j--){let l=!0;for(let m=0;m<h;m++)if(i(a,j+m)!==i(b,m)){l=!1;break}if(l)return j}return -1}function A(a,b,c,d){c=Number(c)||0;let e=a.length-c;d?(d=Number(d))>e&&(d=e):d=e;let f=b.length;d>f/2&&(d=f/2);let g;for(g=0;g<d;++g){let h=parseInt(b.substr(2*g,2),16);if(ah(h))break;a[c+g]=h}return g}function B(a,b,c,d){return af(ab(b,a.length-c),a,c,d)}function C(a,b,c,d){return af(ac(b),a,c,d)}function D(a,b,c,d){return af(ae(b),a,c,d)}function E(a,b,c,d){return af(ad(b,a.length-c),a,c,d)}function F(a,b,c){return 0===b&&c===a.length?d.fromByteArray(a):d.fromByteArray(a.slice(b,c))}function G(a,b,c){c=Math.min(a.length,c);let d=[],e=b;for(;e<c;){let f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){let i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:(192&(i=a[e+1]))==128&&(l=(31&f)<<6|63&i)>127&&(g=l);break;case 3:i=a[e+1],j=a[e+2],(192&i)==128&&(192&j)==128&&(l=(15&f)<<12|(63&i)<<6|63&j)>2047&&(l<55296||l>57343)&&(g=l);break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],(192&i)==128&&(192&j)==128&&(192&k)==128&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k)>65535&&l<1114112&&(g=l)}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return I(d)}b.kMaxLength=g,j.TYPED_ARRAY_SUPPORT=h(),j.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(j.prototype,"parent",{enumerable:!0,get:function(){if(j.isBuffer(this))return this.buffer}}),Object.defineProperty(j.prototype,"offset",{enumerable:!0,get:function(){if(j.isBuffer(this))return this.byteOffset}}),j.poolSize=8192,j.from=function(a,b,c){return k(a,b,c)},Object.setPrototypeOf(j.prototype,Uint8Array.prototype),Object.setPrototypeOf(j,Uint8Array),j.alloc=function(a,b,c){return m(a,b,c)},j.allocUnsafe=function(a){return n(a)},j.allocUnsafeSlow=function(a){return n(a)},j.isBuffer=function(a){return null!=a&& !0===a._isBuffer&&a!==j.prototype},j.compare=function(a,b){if(ag(a,Uint8Array)&&(a=j.from(a,a.offset,a.byteLength)),ag(b,Uint8Array)&&(b=j.from(b,b.offset,b.byteLength)),!j.isBuffer(a)||!j.isBuffer(b))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;let c=a.length,d=b.length;for(let e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:d<c?1:0},j.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},j.concat=function(a,b){if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return j.alloc(0);let c;if(void 0===b)for(c=0,b=0;c<a.length;++c)b+=a[c].length;let d=j.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){let f=a[c];if(ag(f,Uint8Array))e+f.length>d.length?(j.isBuffer(f)||(f=j.from(f)),f.copy(d,e)):Uint8Array.prototype.set.call(d,f,e);else if(j.isBuffer(f))f.copy(d,e);else throw TypeError('"list" argument must be an Array of Buffers');e+=f.length}return d},j.byteLength=v,j.prototype._isBuffer=!0,j.prototype.swap16=function(){let a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<a;b+=2)x(this,b,b+1);return this},j.prototype.swap32=function(){let a=this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<a;b+=4)x(this,b,b+3),x(this,b+1,b+2);return this},j.prototype.swap64=function(){let a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<a;b+=8)x(this,b,b+7),x(this,b+1,b+6),x(this,b+2,b+5),x(this,b+3,b+4);return this},j.prototype.toString=function(){let a=this.length;return 0===a?"":0===arguments.length?G(this,0,a):w.apply(this,arguments)},j.prototype.toLocaleString=j.prototype.toString,j.prototype.equals=function(a){if(!j.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===j.compare(this,a)},j.prototype.inspect=function(){let a="",c=b.INSPECT_MAX_BYTES;return a=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(a+=" ... "),"<Buffer "+a+">"},f&&(j.prototype[f]=j.prototype.inspect),j.prototype.compare=function(a,b,c,d,e){if(ag(a,Uint8Array)&&(a=j.from(a,a.offset,a.byteLength)),!j.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return -1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;let f=e-d,g=c-b,h=Math.min(f,g),i=this.slice(d,e),k=a.slice(b,c);for(let l=0;l<h;++l)if(i[l]!==k[l]){f=i[l],g=k[l];break}return f<g?-1:g<f?1:0},j.prototype.includes=function(a,b,c){return -1!==this.indexOf(a,b,c)},j.prototype.indexOf=function(a,b,c){return y(this,a,b,c,!0)},j.prototype.lastIndexOf=function(a,b,c){return y(this,a,b,c,!1)},j.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let f=!1;for(;;)switch(d){case"hex":return A(this,a,b,c);case"utf8":case"utf-8":return B(this,a,b,c);case"ascii":case"latin1":case"binary":return C(this,a,b,c);case"base64":return D(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,a,b,c);default:if(f)throw TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},j.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};let H=4096;function I(a){let b=a.length;if(b<=H)return String.fromCharCode.apply(String,a);let c="",d=0;for(;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=H));return c}function J(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function K(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function L(a,b,c){let d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);let e="";for(let f=b;f<c;++f)e+=ai[a[f]];return e}function M(a,b,c){let d=a.slice(b,c),e="";for(let f=0;f<d.length-1;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function N(a,b,c){if(a%1!=0||a<0)throw RangeError("offset is not uint");if(a+b>c)throw RangeError("Trying to access beyond buffer length")}function O(a,b,c,d,e,f){if(!j.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw RangeError('"value" argument is out of bounds');if(c+d>a.length)throw RangeError("Index out of range")}function P(a,b,c,d,e){Y(b,d,e,a,c,7);let f=Number(b&BigInt(4294967295));a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f;let g=Number(b>>BigInt(32)&BigInt(4294967295));return a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,c}function Q(a,b,c,d,e){Y(b,d,e,a,c,7);let f=Number(b&BigInt(4294967295));a[c+7]=f,f>>=8,a[c+6]=f,f>>=8,a[c+5]=f,f>>=8,a[c+4]=f;let g=Number(b>>BigInt(32)&BigInt(4294967295));return a[c+3]=g,g>>=8,a[c+2]=g,g>>=8,a[c+1]=g,g>>=8,a[c]=g,c+8}function R(a,b,c,d,e,f){if(c+d>a.length||c<0)throw RangeError("Index out of range")}function S(a,b,c,d,f){return b=+b,c>>>=0,f||R(a,b,c,4,34028234663852886e22,-34028234663852886e22),e.write(a,b,c,d,23,4),c+4}function T(a,b,c,d,f){return b=+b,c>>>=0,f||R(a,b,c,8,17976931348623157e292,-17976931348623157e292),e.write(a,b,c,d,52,8),c+8}j.prototype.slice=function(a,b){let c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);let d=this.subarray(a,b);return Object.setPrototypeOf(d,j.prototype),d},j.prototype.readUintLE=j.prototype.readUIntLE=function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d},j.prototype.readUintBE=j.prototype.readUIntBE=function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a+ --b],e=1;for(;b>0&&(e*=256);)d+=this[a+ --b]*e;return d},j.prototype.readUint8=j.prototype.readUInt8=function(a,b){return a>>>=0,b||N(a,1,this.length),this[a]},j.prototype.readUint16LE=j.prototype.readUInt16LE=function(a,b){return a>>>=0,b||N(a,2,this.length),this[a]|this[a+1]<<8},j.prototype.readUint16BE=j.prototype.readUInt16BE=function(a,b){return a>>>=0,b||N(a,2,this.length),this[a]<<8|this[a+1]},j.prototype.readUint32LE=j.prototype.readUInt32LE=function(a,b){return a>>>=0,b||N(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},j.prototype.readUint32BE=j.prototype.readUInt32BE=function(a,b){return a>>>=0,b||N(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},j.prototype.readBigUInt64LE=aj(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b|| void 0===c)&&$(a,this.length-8);let d=b+256*this[++a]+65536*this[++a]+16777216*this[++a],e=this[++a]+256*this[++a]+65536*this[++a]+16777216*c;return BigInt(d)+(BigInt(e)<<BigInt(32))}),j.prototype.readBigUInt64BE=aj(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b|| void 0===c)&&$(a,this.length-8);let d=16777216*b+65536*this[++a]+256*this[++a]+this[++a],e=16777216*this[++a]+65536*this[++a]+256*this[++a]+c;return(BigInt(d)<<BigInt(32))+BigInt(e)}),j.prototype.readIntLE=function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d>=(e*=128)&&(d-=Math.pow(2,8*b)),d},j.prototype.readIntBE=function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=b,e=1,f=this[a+ --d];for(;d>0&&(e*=256);)f+=this[a+ --d]*e;return f>=(e*=128)&&(f-=Math.pow(2,8*b)),f},j.prototype.readInt8=function(a,b){return(a>>>=0,b||N(a,1,this.length),128&this[a])?-((255-this[a]+1)*1):this[a]},j.prototype.readInt16LE=function(a,b){a>>>=0,b||N(a,2,this.length);let c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},j.prototype.readInt16BE=function(a,b){a>>>=0,b||N(a,2,this.length);let c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},j.prototype.readInt32LE=function(a,b){return a>>>=0,b||N(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},j.prototype.readInt32BE=function(a,b){return a>>>=0,b||N(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},j.prototype.readBigInt64LE=aj(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b|| void 0===c)&&$(a,this.length-8);let d=this[a+4]+256*this[a+5]+65536*this[a+6]+(c<<24);return(BigInt(d)<<BigInt(32))+BigInt(b+256*this[++a]+65536*this[++a]+16777216*this[++a])}),j.prototype.readBigInt64BE=aj(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b|| void 0===c)&&$(a,this.length-8);let d=(b<<24)+65536*this[++a]+256*this[++a]+this[++a];return(BigInt(d)<<BigInt(32))+BigInt(16777216*this[++a]+65536*this[++a]+256*this[++a]+c)}),j.prototype.readFloatLE=function(a,b){return a>>>=0,b||N(a,4,this.length),e.read(this,a,!0,23,4)},j.prototype.readFloatBE=function(a,b){return a>>>=0,b||N(a,4,this.length),e.read(this,a,!1,23,4)},j.prototype.readDoubleLE=function(a,b){return a>>>=0,b||N(a,8,this.length),e.read(this,a,!0,52,8)},j.prototype.readDoubleBE=function(a,b){return a>>>=0,b||N(a,8,this.length),e.read(this,a,!1,52,8)},j.prototype.writeUintLE=j.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b>>>=0,c>>>=0,!d){let e=Math.pow(2,8*c)-1;O(this,a,b,c,e,0)}let f=1,g=0;for(this[b]=255&a;++g<c&&(f*=256);)this[b+g]=a/f&255;return b+c},j.prototype.writeUintBE=j.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b>>>=0,c>>>=0,!d){let e=Math.pow(2,8*c)-1;O(this,a,b,c,e,0)}let f=c-1,g=1;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=a/g&255;return b+c},j.prototype.writeUint8=j.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,1,255,0),this[b]=255&a,b+1},j.prototype.writeUint16LE=j.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},j.prototype.writeUint16BE=j.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},j.prototype.writeUint32LE=j.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,4,4294967295,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},j.prototype.writeUint32BE=j.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,4,4294967295,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},j.prototype.writeBigUInt64LE=aj(function(a,b=0){return P(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))}),j.prototype.writeBigUInt64BE=aj(function(a,b=0){return Q(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))}),j.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b>>>=0,!d){let e=Math.pow(2,8*c-1);O(this,a,b,c,e-1,-e)}let f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)a<0&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},j.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b>>>=0,!d){let e=Math.pow(2,8*c-1);O(this,a,b,c,e-1,-e)}let f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)a<0&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},j.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},j.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},j.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},j.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,4,2147483647,-2147483648),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},j.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||O(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},j.prototype.writeBigInt64LE=aj(function(a,b=0){return P(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),j.prototype.writeBigInt64BE=aj(function(a,b=0){return Q(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),j.prototype.writeFloatLE=function(a,b,c){return S(this,a,b,!0,c)},j.prototype.writeFloatBE=function(a,b,c){return S(this,a,b,!1,c)},j.prototype.writeDoubleLE=function(a,b,c){return T(this,a,b,!0,c)},j.prototype.writeDoubleBE=function(a,b,c){return T(this,a,b,!1,c)},j.prototype.copy=function(a,b,c,d){if(!j.isBuffer(a))throw TypeError("argument should be a Buffer");if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c||0===a.length||0===this.length)return 0;if(b<0)throw RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw RangeError("Index out of range");if(d<0)throw RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);let e=d-c;return this===a&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(b,c,d):Uint8Array.prototype.set.call(a,this.subarray(c,d),b),e},j.prototype.fill=function(a,b,c,d){if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),void 0!==d&&"string"!=typeof d)throw TypeError("encoding must be a string");if("string"==typeof d&&!j.isEncoding(d))throw TypeError("Unknown encoding: "+d);if(1===a.length){let e=a.charCodeAt(0);("utf8"===d&&e<128||"latin1"===d)&&(a=e)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(b<0||this.length<b||this.length<c)throw RangeError("Out of range index");if(c<=b)return this;b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0);let f;if("number"==typeof a)for(f=b;f<c;++f)this[f]=a;else{let g=j.isBuffer(a)?a:j.from(a,d),h=g.length;if(0===h)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(f=0;f<c-b;++f)this[f+b]=g[f%h]}return this};let U={};function V(a,b,c){U[a]=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,this.stack,delete this.name}get code(){return a}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}}}function W(a){let b="",c=a.length,d="-"===a[0]?1:0;for(;c>=d+4;c-=3)b=`_${a.slice(c-3,c)}${b}`;return`${a.slice(0,c)}${b}`}function X(a,b,c){Z(b,"offset"),(void 0===a[b]|| void 0===a[b+c])&&$(b,a.length-(c+1))}function Y(a,b,c,d,e,f){if(a>c||a<b){let g="bigint"==typeof b?"n":"",h;throw h=f>3?0===b||b===BigInt(0)?`>= 0${g} and < 2${g} ** ${(f+1)*8}${g}`:`>= -(2${g} ** ${(f+1)*8-1}${g}) and < 2 ** ${(f+1)*8-1}${g}`:`>= ${b}${g} and <= ${c}${g}`,new U.ERR_OUT_OF_RANGE("value",h,a)}X(d,e,f)}function Z(a,b){if("number"!=typeof a)throw new U.ERR_INVALID_ARG_TYPE(b,"number",a)}function $(a,b,c){if(Math.floor(a)!==a)throw Z(a,c),new U.ERR_OUT_OF_RANGE(c||"offset","an integer",a);if(b<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(c||"offset",`>= ${c?1:0} and <= ${b}`,a)}V("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(a,b){return`The "${a}" argument must be of type number. Received type ${typeof b}`},TypeError),V("ERR_OUT_OF_RANGE",function(a,b,c){let d=`The value of "${a}" is out of range.`,e=c;return Number.isInteger(c)&&Math.abs(c)>4294967296?e=W(String(c)):"bigint"==typeof c&&(e=String(c),(c>BigInt(2)**BigInt(32)||c< -(BigInt(2)**BigInt(32)))&&(e=W(e)),e+="n"),d+=` It must be ${b}. Received ${e}`},RangeError);let _=/[^+/0-9A-Za-z-_]/g;function aa(a){if((a=(a=a.split("=")[0]).trim().replace(_,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}function ab(a,b){b=b||1/0;let c,d=a.length,e=null,f=[];for(let g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319||g+1===d){(b-=3)> -1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)> -1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)> -1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else if(c<1114112){if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}else throw Error("Invalid code point")}return f}function ac(a){let b=[];for(let c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function ad(a,b){let c,d,e,f=[];for(let g=0;g<a.length&&!((b-=2)<0);++g)d=(c=a.charCodeAt(g))>>8,e=c%256,f.push(e),f.push(d);return f}function ae(a){return d.toByteArray(aa(a))}function af(a,b,c,d){let e;for(e=0;e<d&&!(e+c>=b.length)&&!(e>=a.length);++e)b[e+c]=a[e];return e}function ag(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function ah(a){return a!=a}let ai=function(){let a="0123456789abcdef",b=Array(256);for(let c=0;c<16;++c){let d=16*c;for(let e=0;e<16;++e)b[d+e]=a[c]+a[e]}return b}();function aj(a){return"undefined"==typeof BigInt?ak:a}function ak(){throw Error("BigInt not supported")}},79830:function(a){"use strict";/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */ a.exports=f,a.exports.format=g,a.exports.parse=h;var b=/\B(?=(\d{3})+(?!\d))/g,c=/(?:\.0*|(\.[^0]+)0+)$/,d={b:1,kb:1024,mb:1048576,gb:1073741824,tb:1099511627776,pb:0x4000000000000},e=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function f(a,b){return"string"==typeof a?h(a):"number"==typeof a?g(a,b):null}function g(a,e){if(!Number.isFinite(a))return null;var f=Math.abs(a),g=e&&e.thousandsSeparator||"",h=e&&e.unitSeparator||"",i=e&& void 0!==e.decimalPlaces?e.decimalPlaces:2,j=Boolean(e&&e.fixedDecimals),k=e&&e.unit||"";k&&d[k.toLowerCase()]||(k=f>=d.pb?"PB":f>=d.tb?"TB":f>=d.gb?"GB":f>=d.mb?"MB":f>=d.kb?"KB":"B");var l=a/d[k.toLowerCase()],m=l.toFixed(i);return j||(m=m.replace(c,"$1")),g&&(m=m.split(".").map(function(a,c){return 0===c?a.replace(b,g):a}).join(".")),m+h+k}function h(a){if("number"==typeof a&&!isNaN(a))return a;if("string"!=typeof a)return null;var b,c=e.exec(a),f="b";return(c?(b=parseFloat(c[1]),f=c[4].toLowerCase()):(b=parseInt(a,10),f="b"),isNaN(b))?null:Math.floor(d[f]*b)}},16957:function(a,b,c){"use strict";var d=c(90886);b.fromCallback=function(a,b){if(void 0===a){var c=new Promise(function(b,c){a=function(a,d){a?c(a):b(d)}});a[void 0!==b?b:"promise"]=c}else if("function"!=typeof a)throw TypeError("Callback must be a function");return a},b.fromPromise=function(a,b){if(void 0===b)return a;a.then(function(a){d(()=>b(null,a))}).catch(function(a){d(()=>b(a))})}},90886:function(a){a.exports="function"==typeof queueMicrotask?queueMicrotask:a=>Promise.resolve().then(a)},18254:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(57135);function e(a){let[b,c,d,e,f]=a,g={ciphertext:e,iv:d,protected:b,tag:f};return c&&(g.recipients=[{encrypted_key:c}]),g}function f(a){let b={};return a.encrypted_key&&(b.encrypted_key=d.fromBase64url(a.encrypted_key)),a.header&&(b.header=a.header),b}function g(a){let b={ciphertext:d.fromBase64url(a.ciphertext),protected:d.fromBase64url(a.protected),iv:d.fromBase64url(a.iv),tag:d.fromBase64url(a.tag)};return a.aad&&(b.aad=d.fromBase64url(a.aad)),a.recipients&&(b.recipients=a.recipients.map(f)),a.unprotected&&(b.unprotected=a.unprotected),b}function h(a){let b={};return a.encrypted_key&&(b.encrypted_key=d.toBase64url(a.encrypted_key)),a.header&&(b.header=a.header),b}function i(a){let b={ciphertext:d.toBase64url(a.ciphertext),protected:d.toBase64url(a.protected),iv:d.toBase64url(a.iv),tag:d.toBase64url(a.tag)};return a.aad&&(b.aad=d.toBase64url(a.aad)),a.recipients&&(b.recipients=a.recipients.map(h)),a.unprotected&&(b.unprotected=a.unprotected),b}b.default={fromSplit:e,decode:i,encode:g}},28630:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b},g=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0}),b.decode=b.encode=b.toGeneral=b.code=b.name=void 0;let h=g(c(41446)),i=g(c(18254)),j=f(c(37548));function k(a){return"payload"in a&&"string"==typeof a.payload&&"signatures"in a&&Array.isArray(a.signatures)}function l(a){return"payload"in a&&a.payload instanceof Uint8Array&&"signatures"in a&&Array.isArray(a.signatures)}function m(a){return"ciphertext"in a&&a.ciphertext instanceof Uint8Array&&"iv"in a&&a.iv instanceof Uint8Array&&"protected"in a&&a.protected instanceof Uint8Array&&"tag"in a&&a.tag instanceof Uint8Array}function n(a){return"ciphertext"in a&&"string"==typeof a.ciphertext&&"iv"in a&&"string"==typeof a.iv&&"protected"in a&&"string"==typeof a.protected&&"tag"in a&&"string"==typeof a.tag}function o(a){if("string"==typeof a){let b=a.split(".");if(3===b.length)return h.default.fromSplit(b);if(5===b.length)return i.default.fromSplit(b);throw Error("Not a valid JOSE string")}if(k(a)||n(a))return a;throw Error("Not a valid unencoded JOSE object")}function p(a){"string"==typeof a&&(a=o(a));let b;if(k(a))b=h.default.encode(a);else if(n(a))b=i.default.encode(a);else throw Error("Not a valid JOSE object");return new Uint8Array(j.encode(b))}function q(a){let b;try{b=j.decode(a)}catch(c){throw Error("Not a valid DAG-JOSE object")}if(l(b))return h.default.decode(b);if(m(b))return i.default.decode(b);throw Error("Not a valid DAG-JOSE object")}b.name="dag-jose",b.code=133,b.toGeneral=o,b.encode=p,b.decode=q},41446:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(57135),e=c(81362);function f(a){let[b,c,f]=a;return{payload:c,signatures:[{protected:b,signature:f}],link:e.CID.decode(d.fromBase64url(c))}}function g(a){let b={signature:d.fromBase64url(a.signature)};return a.header&&(b.header=a.header),a.protected&&(b.protected=d.fromBase64url(a.protected)),b}function h(a){let b=d.fromBase64url(a.payload);try{e.CID.decode(b)}catch(c){throw Error("Not a valid DagJWS")}let f={payload:b,signatures:a.signatures.map(g)};return f}function i(a){let b={signature:d.toBase64url(a.signature)};return a.header&&(b.header=a.header),a.protected&&(b.protected=d.toBase64url(a.protected)),b}function j(a){let b={payload:d.toBase64url(a.payload),signatures:a.signatures.map(i)};return b.link=e.CID.decode(new Uint8Array(a.payload)),b}b.default={fromSplit:f,encode:h,decode:j}},57135:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.fromBase64url=b.toBase64url=void 0;let d=c(9885);function e(a){return d.base64url.encode(a).slice(1)}function f(a){return d.base64url.decode(`u${a}`)}b.toBase64url=e,b.fromBase64url=f},74664:function(a){let b=(...a)=>{let b;for(;a.length;)b=a.shift()(b);return b},c=a=>a&&("function"==typeof a[Symbol.asyncIterator]||"function"==typeof a[Symbol.iterator]||"function"==typeof a.next),d=a=>a&&"function"==typeof a.sink&&c(a.source),e=a=>b=>(a.sink(b),a.source),f=(...a)=>{if(d(a[0])){let f=a[0];a[0]=()=>f.source}else if(c(a[0])){let g=a[0];a[0]=()=>g}if(a.length>1&&d(a[a.length-1])&&(a[a.length-1]=a[a.length-1].sink),a.length>2)for(let h=1;h<a.length-1;h++)d(a[h])&&(a[h]=e(a[h]));return b(...a)};a.exports=f,a.exports.pipe=f,a.exports.rawPipe=b,a.exports.isIterable=c,a.exports.isDuplex=d},77416:function(a,b,c){let d=c(91607);a.exports=a=>{let b;"function"==typeof(a=a||{})?(b=a,a={}):b=a.onEnd;let c=new d,e,f,g,h=()=>{if(!c.isEmpty()){if(a.writev){let b,d=[];for(;!c.isEmpty();){if((b=c.shift()).error)throw b.error;d.push(b.value)}return{done:b.done,value:d}}let h=c.shift();if(h.error)throw h.error;return h}return g?{done:!0}:new Promise((b,c)=>{f=d=>(f=null,d.error?c(d.error):a.writev&&!d.done?b({done:d.done,value:[d.value]}):b(d),e)})},i=a=>f?f(a):(c.push(a),e),j=a=>(c=new d,f)?f({error:a}):(c.push({error:a}),e),k=a=>g?e:i({done:!1,value:a}),l=a=>g?e:(g=!0,a?j(a):i({done:!0})),m=()=>(c=new d,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l},!b)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),b&&(b(a),b=null),{done:!0}},return(){return o.return(),b&&(b(),b=null),{done:!0}},push:k,end(a){return o.end(a),b&&(b(a),b=null),e}}}},11227:function(a,b,c){var d=c(83454);b.formatArgs=g,b.save=h,b.load=i,b.useColors=f,b.storage=j();let e;function f(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)|| !("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function g(b){if(b[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+b[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;b.splice(1,0,c,"color: inherit");let d=0,e=0;b[0].replace(/%[a-zA-Z%]/g,a=>{"%%"!==a&&(d++,"%c"===a&&(e=d))}),b.splice(e,0,c)}function h(a){try{a?b.storage.setItem("debug",a):b.storage.removeItem("debug")}catch(c){}}function i(){let a;try{a=b.storage.getItem("debug")}catch(c){}return!a&& void 0!==d&&"env"in d&&(a=d.env.DEBUG),a}function j(){try{return localStorage}catch(a){}}b.destroy=(e=!1,()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),b.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],b.log=console.debug||console.log||(()=>{}),a.exports=c(82447)(b);let{formatters:k}=a.exports;k.j=function(a){try{return JSON.stringify(a)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}}},82447:function(a,b,c){function d(a){function b(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b|=0;return d.colors[Math.abs(b)%d.colors.length]}function d(a){let b,c=null,f,g;function h(...a){if(!h.enabled)return;let c=h,e=Number(new Date),f=e-(b||e);c.diff=f,c.prev=b,c.curr=e,b=e,a[0]=d.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");let g=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(b,e)=>{if("%%"===b)return"%";g++;let f=d.formatters[e];if("function"==typeof f){let h=a[g];b=f.call(c,h),a.splice(g,1),g--}return b}),d.formatArgs.call(c,a);let i=c.log||d.log;i.apply(c,a)}return h.namespace=a,h.useColors=d.useColors(),h.color=d.selectColor(a),h.extend=e,h.destroy=d.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==c?c:(f!==d.namespaces&&(f=d.namespaces,g=d.enabled(a)),g),set:a=>{c=a}}),"function"==typeof d.init&&d.init(h),h}function e(a,b){let c=d(this.namespace+(void 0===b?":":b)+a);return c.log=this.log,c}function f(a){d.save(a),d.namespaces=a,d.names=[],d.skips=[];let b,c=("string"==typeof a?a:"").split(/[\s,]+/),e=c.length;for(b=0;b<e;b++)c[b]&&("-"===(a=c[b].replace(/\*/g,".*?"))[0]?d.skips.push(RegExp("^"+a.slice(1)+"$")):d.names.push(RegExp("^"+a+"$")))}function g(){let a=[...d.names.map(i),...d.skips.map(i).map(a=>"-"+a)].join(",");return d.enable(""),a}function h(a){if("*"===a[a.length-1])return!0;let b,c;for(b=0,c=d.skips.length;b<c;b++)if(d.skips[b].test(a))return!1;for(b=0,c=d.names.length;b<c;b++)if(d.names[b].test(a))return!0;return!1}function i(a){return a.toString().substring(2,a.toString().length-2).replace(/\.\*\?$/,"*")}function j(a){return a instanceof Error?a.stack||a.message:a}function k(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return d.debug=d,d.default=d,d.coerce=j,d.disable=g,d.enable=f,d.enabled=h,d.humanize=c(57824),d.destroy=k,Object.keys(a).forEach(b=>{d[b]=a[b]}),d.names=[],d.skips=[],d.formatters={},d.selectColor=b,d.enable(d.load()),d}a.exports=d},7171:function(a,b,c){"use strict";let{AbstractChainedBatch:d}=c(24012),e=Symbol("operations");a.exports=class extends d{constructor(a){super(a),this[e]=[]}_put(a,b,c){this[e].push({...c,type:"put",key:a,value:b})}_del(a,b){this[e].push({...b,type:"del",key:a})}_clear(){this[e]=[]}_write(a,b){this.db.batch(this[e],a,b)}}},32790:function(a,b,c){"use strict";let{AbstractIterator:d}=c(24012),e=c(35717),f=c(72502).R,g=Symbol("options"),h=Symbol("iterator"),i=Symbol("operations"),j=Symbol("promise");function k(a,b){d.call(this,a),this[g]=b,this[h]=null,this[i]=[]}for(let l of(e(k,d),k.prototype.setDb=function(a){for(let b of(this[h]=a.iterator(this[g]),this[i].splice(0,this[i].length)))this[h][b.method](...b.args)},k.prototype.next=function(...a){if("open"===this.db.status)return this[h].next(...a);let b=f(a,j,function(a,b){if(void 0!==a|| void 0!==b)return[a,b]});return"opening"===this.db.status?this[i].push({method:"next",args:a}):this._nextTick(b,Error("Database is not open")),b[j]||this},k.prototype.seek=function(...a){if("open"===this.db.status)this[h].seek(...a);else if("opening"===this.db.status)this[i].push({method:"seek",args:a});else throw Error("Database is not open")},k.prototype.end=function(...a){if("open"===this.db.status)return this[h].end(...a);let b=f(a,j);return"opening"===this.db.status?this[i].push({method:"end",args:a}):this._nextTick(b,Error("Database is not open")),b[j]||this},["next","seek","end"]))k.prototype["_"+l]=function(){throw Error("Did not expect private method to be called: "+l)};a.exports=k},66944:function(a,b,c){"use strict";let{AbstractLevelDOWN:d}=c(24012),e=c(35717),f=c(32790),g=c(7171),h=c(72502).R,i=["put","get","getMany","del","batch","clear"],j=["approximateSize","compactRange"],k=Symbol("innerDb"),l=Symbol("operations"),m=Symbol("promise");function n(a){for(let b of(d.call(this,a.supports||{}),j))"function"!=typeof a[b]||this.supports.additionalMethods[b]||(this.supports.additionalMethods[b]=!0);this[k]=a,this[l]=[],o(this)}function o(a){let b=Object.keys(a.supports.additionalMethods);for(let c of i.concat(b))a[c]=function(...a){if("batch"===c&&0===a.length)return new g(this);if("open"===this.status)return this[k][c](...a);let b=h(a,m);return"opening"===this.status?this[l].push({method:c,args:a}):this._nextTick(b,Error("Database is not open")),b[m]};for(let d of(a.iterator=function(a){if("open"===this.status)return this[k].iterator(a);if("opening"===this.status){let b=new f(this,a);return this[l].push({iterator:b}),b}throw Error("Database is not open")},i.concat(["iterator"])))a["_"+d]=function(){throw Error("Did not expect private method to be called: "+d)}}e(n,d),n.prototype.type="deferred-leveldown",Object.defineProperty(n.prototype,"_db",{enumerable:!0,get(){return this[k]}}),n.prototype._open=function(a,b){let c=a=>{if(a||"open"!==this[k].status)return b(a||Error("Database is not open"));let c=this[l];for(let d of(this[l]=[],c))d.iterator?d.iterator.setDb(this[k]):this[k][d.method](...d.args);if(this[l].length>0)throw Error("Did not expect further operations");b()};"new"===this[k].status||"closed"===this[k].status?this[k].open(a,c):this._nextTick(c)},n.prototype._close=function(a){this[k].close(a)},n.prototype._isOperational=function(){return"opening"===this.status},a.exports=n,a.exports.DeferredIterator=f},72502:function(a,b){"use strict";b.R=function(a,b,c){let d=a[a.length-1];if("function"!=typeof d){let e=new Promise((b,e)=>{a.push(d=function(a,...d){a?e(a):b(c?c(...d):d[0])})});d[b]=e}return d}},65780:function(a){"use strict";let b=(a,b)=>Math.floor(Math.random()*(b-a+1)+a),c=()=>{let a=Error("Delay aborted");return a.name="AbortError",a},d=({clearTimeout:a,setTimeout:b,willResolve:d})=>(e,{value:f,signal:g}={})=>{if(g&&g.aborted)return Promise.reject(c());let h,i,j,k=a||clearTimeout,l=()=>{k(h),j(c())},m=()=>{g&&g.removeEventListener("abort",l)},n=new Promise((a,c)=>{i=()=>{m(),d?a(f):c(f)},j=c,h=(b||setTimeout)(i,e)});return g&&g.addEventListener("abort",l,{once:!0}),n.clear=()=>{k(h),h=null,i()},n},e=a=>{let c=d({...a,willResolve:!0});return c.reject=d({...a,willResolve:!1}),c.range=(a,d,e)=>c(b(a,d),e),c},f=e();f.createWithTimers=e,a.exports=f,a.exports.default=f},45001:function(a){"use strict";function b(a,b){var b=b||{};this._head=0,this._tail=0,this._capacity=b.capacity,this._capacityMask=3,this._list=[,,,,],Array.isArray(a)&&this._fromArray(a)}b.prototype.peekAt=function(a){var b=a;if(b===(0|b)){var c=this.size();if(!(b>=c)&&!(b< -c))return b<0&&(b+=c),b=this._head+b&this._capacityMask,this._list[b]}},b.prototype.get=function(a){return this.peekAt(a)},b.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},b.prototype.peekFront=function(){return this.peek()},b.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(b.prototype,"length",{get:function(){return this.size()}}),b.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},b.prototype.unshift=function(a){if(void 0===a)return this.size();var b=this._list.length;return(this._head=this._head-1+b&this._capacityMask,this._list[this._head]=a,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail)?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},b.prototype.shift=function(){var a=this._head;if(a!==this._tail){var b=this._list[a];return this._list[a]=void 0,this._head=a+1&this._capacityMask,a<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),b}},b.prototype.push=function(a){if(void 0===a)return this.size();var b=this._tail;return(this._list[b]=a,this._tail=b+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail)?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},b.prototype.pop=function(){var a=this._tail;if(a!==this._head){var b=this._list.length;this._tail=a-1+b&this._capacityMask;var c=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&a>1e4&&a<=b>>>2&&this._shrinkArray(),c}},b.prototype.removeOne=function(a){var b,c=a;if(c===(0|c)&&this._head!==this._tail){var d=this.size(),e=this._list.length;if(!(c>=d)&&!(c< -d)){c<0&&(c+=d),c=this._head+c&this._capacityMask;var f=this._list[c];if(a<d/2){for(b=a;b>0;b--)this._list[c]=this._list[c=c-1+e&this._capacityMask];this._list[c]=void 0,this._head=this._head+1+e&this._capacityMask}else{for(b=d-1-a;b>0;b--)this._list[c]=this._list[c=c+1+e&this._capacityMask];this._list[c]=void 0,this._tail=this._tail-1+e&this._capacityMask}return f}}},b.prototype.remove=function(a,b){var c,d,e=a,f=b;if(e===(0|e)&&this._head!==this._tail){var g=this.size(),h=this._list.length;if(!(e>=g)&&!(e< -g)&&!(b<1)){if(e<0&&(e+=g),1===b||!b)return(c=[,])[0]=this.removeOne(e),c;if(0===e&&e+b>=g)return c=this.toArray(),this.clear(),c;for(e+b>g&&(b=g-e),c=Array(b),d=0;d<b;d++)c[d]=this._list[this._head+e+d&this._capacityMask];if(e=this._head+e&this._capacityMask,a+b===g){for(this._tail=this._tail-b+h&this._capacityMask,d=b;d>0;d--)this._list[e=e+1+h&this._capacityMask]=void 0;return c}if(0===a){for(this._head=this._head+b+h&this._capacityMask,d=b-1;d>0;d--)this._list[e=e+1+h&this._capacityMask]=void 0;return c}if(e<g/2){for(this._head=this._head+a+b+h&this._capacityMask,d=a;d>0;d--)this.unshift(this._list[e=e-1+h&this._capacityMask]);for(e=this._head-1+h&this._capacityMask;f>0;)this._list[e=e-1+h&this._capacityMask]=void 0,f--;a<0&&(this._tail=e)}else{for(this._tail=e,e=e+b+h&this._capacityMask,d=g-(b+a);d>0;d--)this.push(this._list[e++]);for(e=this._tail;f>0;)this._list[e=e+1+h&this._capacityMask]=void 0,f--}return this._head<2&&this._tail>1e4&&this._tail<=h>>>2&&this._shrinkArray(),c}}},b.prototype.splice=function(a,b){var c=a;if(c===(0|c)){var d=this.size();if(c<0&&(c+=d),!(c>d)){if(!(arguments.length>2))return this.remove(c,b);var e,f,g,h=arguments.length,i=this._list.length,j=2;if(!d||c<d/2){for(e=0,f=Array(c);e<c;e++)f[e]=this._list[this._head+e&this._capacityMask];for(0===b?(g=[],c>0&&(this._head=this._head+c+i&this._capacityMask)):(g=this.remove(c,b),this._head=this._head+c+i&this._capacityMask);h>j;)this.unshift(arguments[--h]);for(e=c;e>0;e--)this.unshift(f[e-1])}else{var k=(f=Array(d-(c+b))).length;for(e=0;e<k;e++)f[e]=this._list[this._head+c+b+e&this._capacityMask];for(0===b?(g=[],c!=d&&(this._tail=this._head+c+i&this._capacityMask)):(g=this.remove(c,b),this._tail=this._tail-k+i&this._capacityMask);j<h;)this.push(arguments[j++]);for(e=0;e<k;e++)this.push(f[e])}return g}}},b.prototype.clear=function(){this._head=0,this._tail=0},b.prototype.isEmpty=function(){return this._head===this._tail},b.prototype.toArray=function(){return this._copyArray(!1)},b.prototype._fromArray=function(a){for(var b=0;b<a.length;b++)this.push(a[b])},b.prototype._copyArray=function(a){var b,c=[],d=this._list,e=d.length;if(a||this._head>this._tail){for(b=this._head;b<e;b++)c.push(d[b]);for(b=0;b<this._tail;b++)c.push(d[b])}else for(b=this._head;b<this._tail;b++)c.push(d[b]);return c},b.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},b.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},a.exports=b},26905:function(a){var b;b=this,a.exports=function(a,b,c,d,e){for(b=b.split?b.split("."):b,d=0;d<b.length;d++)a=a?a[b[d]]:e;return a===e?c:a}},50780:function(a,b,c){"use strict";let d=c(24012).AbstractLevelDOWN,e=c(24012).AbstractChainedBatch,f=c(24012).AbstractIterator,g=c(35717),h=c(84124),i=c(56604).EncodingError,j=["approximateSize","compactRange"];function k(a,b){if(!(this instanceof k))return new k(a,b);let c=a.supports||{},e=c.additionalMethods||{};d.call(this,c),this.supports.encodings=!0,this.supports.additionalMethods={},j.forEach(function(b){let c="function"==typeof a[b];(e[b]||c)&&(this.supports.additionalMethods[b]=!0,this[b]=function(a,c,d,e){return a=this.codec.encodeKey(a,d),c=this.codec.encodeKey(c,d),this.db[b](a,c,d,e)})},this),void 0===(b=b||{}).keyEncoding&&(b.keyEncoding="utf8"),void 0===b.valueEncoding&&(b.valueEncoding="utf8"),this.db=a,this.codec=new h(b)}function l(a,b){f.call(this,a),this.codec=a.codec,this.keys=b.keys,this.values=b.values,this.opts=this.codec.encodeLtgt(b),this.it=a.db.iterator(this.opts)}function m(a,b){e.call(this,a),this.codec=a.codec,this.batch=a.db.batch()}a.exports=k,g(k,d),k.prototype.type="encoding-down",k.prototype._serializeKey=k.prototype._serializeValue=function(a){return a},k.prototype._open=function(a,b){this.db.open(a,b)},k.prototype._close=function(a){this.db.close(a)},k.prototype._put=function(a,b,c,d){a=this.codec.encodeKey(a,c),b=this.codec.encodeValue(b,c),this.db.put(a,b,c,d)},k.prototype._get=function(a,b,c){a=this.codec.encodeKey(a,b),b.asBuffer=this.codec.valueAsBuffer(b),this.db.get(a,b,(a,d)=>{if(a)return c(a);try{d=this.codec.decodeValue(d,b)}catch(e){return c(new i(e))}c(null,d)})},k.prototype._getMany=function(a,b,c){a=a.map(a=>this.codec.encodeKey(a,b)),b.asBuffer=this.codec.valueAsBuffer(b),this.db.getMany(a,b,(a,d)=>{if(a)return c(a);let e=Array(d.length);for(let f=0;f<d.length;f++){if(void 0===d[f]){e[f]=void 0;continue}try{e[f]=this.codec.decodeValue(d[f],b)}catch(g){return c(new i(g))}}c(null,e)})},k.prototype._del=function(a,b,c){a=this.codec.encodeKey(a,b),this.db.del(a,b,c)},k.prototype._chainedBatch=function(){return new m(this)},k.prototype._batch=function(a,b,c){a=this.codec.encodeBatch(a,b),this.db.batch(a,b,c)},k.prototype._iterator=function(a){return a.keyAsBuffer=this.codec.keyAsBuffer(a),a.valueAsBuffer=this.codec.valueAsBuffer(a),new l(this,a)},k.prototype._clear=function(a,b){a=this.codec.encodeLtgt(a),this.db.clear(a,b)},g(l,f),l.prototype._next=function(a){this.it.next((b,c,d)=>{if(b)return a(b);try{c=this.keys&& void 0!==c?this.codec.decodeKey(c,this.opts):void 0,d=this.values&& void 0!==d?this.codec.decodeValue(d,this.opts):void 0}catch(e){return a(new i(e))}a(null,c,d)})},l.prototype._seek=function(a){a=this.codec.encodeKey(a,this.opts),this.it.seek(a)},l.prototype._end=function(a){this.it.end(a)},g(m,e),m.prototype._put=function(a,b,c){a=this.codec.encodeKey(a,c),b=this.codec.encodeValue(b,c),this.batch.put(a,b)},m.prototype._del=function(a,b){a=this.codec.encodeKey(a,b),this.batch.del(a)},m.prototype._clear=function(){this.batch.clear()},m.prototype._write=function(a,b){this.batch.write(a,b)}},32114:function(a){"use strict";function b(a,b){for(let c in b)Object.defineProperty(a,c,{value:b[c],enumerable:!0,configurable:!0});return a}function c(a,c,d){if(!a||"string"==typeof a)throw TypeError("Please pass an Error to err-code");d||(d={}),"object"==typeof c&&(d=c,c=""),c&&(d.code=c);try{return b(a,d)}catch(e){d.message=a.message,d.stack=a.stack;let f=function(){};f.prototype=Object.create(Object.getPrototypeOf(a));let g=b(new f,d);return g}}a.exports=c},90507:function(a,b,c){"use strict";var d;d={value:!0};let e=c(8231);function f(a,b,c){return new e.EventIterator(({push:c})=>(this.addEventListener(a,c,b),()=>this.removeEventListener(a,c,b)),c)}b.zN=e.EventIterator,d=f,d=e.EventIterator},8231:function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});class c{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(a){if(this.isStopped)return;let b={value:a,done:!1};if(this.pullQueue.length){let c=this.pullQueue.shift();c&&c.resolve(b)}else this.pushQueue.push(Promise.resolve(b)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){for(let a of(this.isStopped=!0,this.remove(),this.pullQueue))a.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(a){if(!this.isStopped){if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let b of this.pullQueue)b.reject(a);this.pullQueue.length=0}else{let c=Promise.reject(a);c.catch(()=>{}),this.pushQueue.push(c)}}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:a=>{let b=this.pushQueue.shift();return b?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),b):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((a,b)=>{this.pullQueue.push({resolve:a,reject:b})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class d{constructor(a,{highWaterMark:b=100,lowWaterMark:d=1}={}){let e=new c;e.highWaterMark=b,e.lowWaterMark=d,e.removeCallback=a({push:a=>e.push(a),stop:()=>e.stop(),fail:a=>e.fail(a),on:(a,b)=>{e.eventHandlers[a]=b}})||(()=>{}),this[Symbol.asyncIterator]=()=>e[Symbol.asyncIterator](),Object.freeze(this)}}b.EventIterator=d,b.default=d},26729:function(a){"use strict";var b=Object.prototype.hasOwnProperty,c="~";function d(){}function e(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function f(a,b,d,f,g){if("function"!=typeof d)throw TypeError("The listener must be a function");var h=new e(d,f||a,g),i=c?c+b:b;return a._events[i]?a._events[i].fn?a._events[i]=[a._events[i],h]:a._events[i].push(h):(a._events[i]=h,a._eventsCount++),a}function g(a,b){0== --a._eventsCount?a._events=new d:delete a._events[b]}function h(){this._events=new d,this._eventsCount=0}Object.create&&(d.prototype=Object.create(null),new d().__proto__||(c=!1)),h.prototype.eventNames=function(){var a,d,e=[];if(0===this._eventsCount)return e;for(d in a=this._events)b.call(a,d)&&e.push(c?d.slice(1):d);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(a)):e},h.prototype.listeners=function(a){var b=c?c+a:a,d=this._events[b];if(!d)return[];if(d.fn)return[d.fn];for(var e=0,f=d.length,g=Array(f);e<f;e++)g[e]=d[e].fn;return g},h.prototype.listenerCount=function(a){var b=c?c+a:a,d=this._events[b];return d?d.fn?1:d.length:0},h.prototype.emit=function(a,b,d,e,f,g){var h=c?c+a:a;if(!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if(k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,d),!0;case 4:return k.fn.call(k.context,b,d,e),!0;case 5:return k.fn.call(k.context,b,d,e,f),!0;case 6:return k.fn.call(k.context,b,d,e,f,g),!0}for(j=1,i=Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,d);break;case 4:k[j].fn.call(k[j].context,b,d,e);break;default:if(!i)for(m=1,i=Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},h.prototype.on=function(a,b,c){return f(this,a,b,c,!1)},h.prototype.once=function(a,b,c){return f(this,a,b,c,!0)},h.prototype.removeListener=function(a,b,d,e){var f=c?c+a:a;if(!this._events[f])return this;if(!b)return g(this,f),this;var h=this._events[f];if(h.fn)h.fn!==b||e&&!h.once||d&&h.context!==d||g(this,f);else{for(var i=0,j=[],k=h.length;i<k;i++)(h[i].fn!==b||e&&!h[i].once||d&&h[i].context!==d)&&j.push(h[i]);j.length?this._events[f]=1===j.length?j[0]:j:g(this,f)}return this},h.prototype.removeAllListeners=function(a){var b;return a?(b=c?c+a:a,this._events[b]&&g(this,b)):(this._events=new d,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=c,h.EventEmitter=h,a.exports=h},17187:function(a){"use strict";var b,c="object"==typeof Reflect?Reflect:null,d=c&&"function"==typeof c.apply?c.apply:function(a,b,c){return Function.prototype.apply.call(a,b,c)};function e(a){console&&console.warn&&console.warn(a)}b=c&&"function"==typeof c.ownKeys?c.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};var f=Number.isNaN||function(a){return a!=a};function g(){g.init.call(this)}a.exports=g,a.exports.once=s,g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var h=10;function i(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function j(a){return void 0===a._maxListeners?g.defaultMaxListeners:a._maxListeners}function k(a,b,c,d){if(i(c),void 0===(g=a._events)?(g=a._events=Object.create(null),a._eventsCount=0):(void 0!==g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]),void 0===h)h=g[b]=c,++a._eventsCount;else if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),(f=j(a))>0&&h.length>f&&!h.warned){h.warned=!0;var f,g,h,k=Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=a,k.type=b,k.count=h.length,e(k)}return a}function l(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=l.bind(d);return e.listener=c,d.wrapFn=e,e}function n(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?r(e):p(e,e.length)}function o(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function p(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function q(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}function r(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function s(a,b){return new Promise(function(c,d){function e(c){a.removeListener(b,f),d(c)}function f(){"function"==typeof a.removeListener&&a.removeListener("error",e),c([].slice.call(arguments))}u(a,b,f,{once:!0}),"error"!==b&&t(a,e,{once:!0})})}function t(a,b,c){"function"==typeof a.on&&u(a,"error",b,c)}function u(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,function e(f){d.once&&a.removeEventListener(b,e),c(f)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(a){if("number"!=typeof a||a<0||f(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");h=a}}),g.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||f(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},g.prototype.getMaxListeners=function(){return j(this)},g.prototype.emit=function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var e="error"===a,f=this._events;if(void 0!==f)e=e&& void 0===f.error;else if(!e)return!1;if(e){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)d(i,this,b);else for(var j=i.length,k=p(i,j),c=0;c<j;++c)d(k[c],this,b);return!0},g.prototype.addListener=function(a,b){return k(this,a,b,!1)},g.prototype.on=g.prototype.addListener,g.prototype.prependListener=function(a,b){return k(this,a,b,!0)},g.prototype.once=function(a,b){return i(b),this.on(a,m(this,a,b)),this},g.prototype.prependOnceListener=function(a,b){return i(b),this.prependListener(a,m(this,a,b)),this},g.prototype.removeListener=function(a,b){var c,d,e,f,g;if(i(b),void 0===(d=this._events)|| void 0===(c=d[a]))return this;if(c===b||c.listener===b)0== --this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():q(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,g||b)}return this},g.prototype.off=g.prototype.removeListener,g.prototype.removeAllListeners=function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0== --this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0===arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},g.prototype.listeners=function(a){return n(this,a,!0)},g.prototype.rawListeners=function(a){return n(this,a,!1)},g.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):o.call(a,b)},g.prototype.listenerCount=o,g.prototype.eventNames=function(){return this._eventsCount>0?b(this._events):[]}},3975:function(a){a.exports=class{constructor(a){if(!(a>0)||(a-1&a)!=0)throw Error("Max size for a FixedFIFO should be a power of two");this.buffer=Array(a),this.mask=a-1,this.top=0,this.btm=0,this.next=null}push(a){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=a,this.top=this.top+1&this.mask,!0)}shift(){let a=this.buffer[this.btm];if(void 0!==a)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,a}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},91607:function(a,b,c){let d=c(3975);a.exports=class{constructor(a){this.hwm=a||16,this.head=new d(this.hwm),this.tail=this.head}push(a){if(!this.head.push(a)){let b=this.head;this.head=b.next=new d(2*this.head.buffer.length),this.head.push(a)}}shift(){let a=this.tail.shift();if(void 0===a&&this.tail.next){let b=this.tail.next;return this.tail.next=null,this.tail=b,this.tail.shift()}return a}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},96132:function(a,b){"use strict";function c(a,b=c.BASE){let d=a.length;for(let e=0;e<d;e++)b^=a.charCodeAt(e),b+=(b<<1)+(b<<4)+(b<<7)+(b<<8)+(b<<24);return b>>>0}Object.defineProperty(b,"__esModule",{value:!0}),c.BASE=2166136261,b.default=c,a.exports=c},30043:function(a,b,c){"use strict";let d=c(20544),{fromString:e}=c(52217);class f{constructor(a,b,c=0){this._options=a,this._popCount=0,this._parent=b,this._posAtParent=c,this._children=new d,this.key=null}async put(a,b){let c=await this._findNewBucketAndPos(a);await c.bucket._putAt(c,a,b)}async get(a){let b=await this._findChild(a);if(b)return b.value}async del(a){let b=await this._findPlace(a),c=b.bucket._at(b.pos);c&&c.key===a&&b.bucket._delAt(b.pos)}leafCount(){let a=this._children.compactArray();return a.reduce((a,b)=>b instanceof f?a+b.leafCount():a+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let a=this._children.compactArray();for(let b of a)b instanceof f?yield*b.eachLeafSeries():yield b;return[]}serialize(a,b){let c=[];return b(this._children.reduce((c,d,e)=>(d&&(d instanceof f?c.push(d.serialize(a,b)):c.push(a(d,e))),c),c))}asyncTransform(a,b){return j(this,a,b)}toJSON(){return this.serialize(h,i)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(a){let b=await this._findPlace(a),c=b.bucket._at(b.pos);if(!(c instanceof f)&&c&&c.key===a)return c}async _findPlace(a){let b=this._options.hash("string"==typeof a?e(a):a),c=await b.take(this._options.bits),d=this._children.get(c);return d instanceof f?d._findPlace(b):{bucket:this,pos:c,hash:b,existingChild:d}}async _findNewBucketAndPos(a){let b=await this._findPlace(a);if(b.existingChild&&b.existingChild.key!==a){let c=new f(this._options,b.bucket,b.pos);b.bucket._putObjectAt(b.pos,c);let d=await c._findPlace(b.existingChild.hash);return d.bucket._putAt(d,b.existingChild.key,b.existingChild.value),c._findNewBucketAndPos(b.hash)}return b}_putAt(a,b,c){this._putObjectAt(a.pos,{key:b,value:c,hash:a.hash})}_putObjectAt(a,b){!this._children.get(a)&&this._popCount++,this._children.set(a,b)}_delAt(a){if(-1===a)throw Error("Invalid position");this._children.get(a)&&this._popCount--,this._children.unset(a),this._level()}_level(){if(this._parent&&this._popCount<=1){if(1===this._popCount){let a=this._children.find(g);if(a&&!(a instanceof f)){let b=a.hash;b.untake(this._options.bits);let c={pos:this._posAtParent,hash:b,bucket:this._parent};this._parent._putAt(c,a.key,a.value)}}else this._parent._delAt(this._posAtParent)}}_at(a){return this._children.get(a)}}function g(a){return Boolean(a)}function h(a,b){return a.key}function i(a){return a}async function j(a,b,c){let d=[];for(let e of a._children.compactArray())if(e instanceof f)await j(e,b,c);else{let g=await b(e);d.push({bitField:a._children.bitField(),children:g})}return c(d)}a.exports=f},51536:function(a){"use strict";let b=[255,254,252,248,240,224,192,128],c=[1,3,7,15,31,63,127,255];function d(a,b,c){let d=e(b,c);return(a&d)>>>b}function e(a,d){return b[a]&c[Math.min(d+a-1,7)]}a.exports=class{constructor(a){this._value=a,this._currentBytePos=a.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(a){let b=a,c=0;for(;b&&this._haveBits();){let e=this._value[this._currentBytePos],f=this._currentBitPos+1,g=Math.min(f,b),h=d(e,f-g,g);c=(c<<g)+h,b-=g,this._currentBitPos-=g,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return c}untake(a){for(this._currentBitPos+=a;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}},31712:function(a,b,c){"use strict";let d=c(51536),{concat:e}=c(20605);function f(a){function b(b){return b instanceof g?b:new g(b,a)}return b}class g{constructor(a,b){if(!(a instanceof Uint8Array))throw Error("can only hash Uint8Arrays");this._value=a,this._hashFn=b,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(a){let b=a;for(;this._availableBits<b;)await this._produceMoreBits();let c=0;for(;b>0;){let d=this._buffers[this._currentBufferIndex],e=Math.min(d.availableBits(),b),f=d.take(e);c=(c<<e)+f,b-=e,this._availableBits-=e,0===d.availableBits()&&this._currentBufferIndex++}return c}untake(a){let b=a;for(;b>0;){let c=this._buffers[this._currentBufferIndex],d=Math.min(c.totalBits()-c.availableBits(),b);c.untake(d),b-=d,this._availableBits+=d,this._currentBufferIndex>0&&c.totalBits()===c.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let a=this._depth?e([this._value,Uint8Array.from([this._depth])]):this._value,b=await this._hashFn(a),c=new d(b);this._buffers.push(c),this._availableBits+=c.availableBits()}}a.exports=f,a.exports.InfiniteHash=g},54563:function(a,b,c){"use strict";let d=c(30043),e=c(31712);function f(a){if(!a||!a.hashFn)throw Error("please define an options.hashFn");let b={bits:a.bits||8,hash:e(a.hashFn)};return new d(b)}a.exports={createHAMT:f,Bucket:d}},70248:function(a){a.exports=function(a){if(!a)throw Error("hashlru must have a max value, of type number, greater than 0");var b=0,c=Object.create(null),d=Object.create(null);function e(e,f){c[e]=f,++b>=a&&(b=0,d=c,c=Object.create(null))}return{has:function(a){return void 0!==c[a]|| void 0!==d[a]},remove:function(a){void 0!==c[a]&&(c[a]=void 0),void 0!==d[a]&&(d[a]=void 0)},get:function(a){var b=c[a];return void 0!==b?b:void 0!==(b=d[a])?(e(a,b),b):void 0},set:function(a,b){void 0!==c[a]?c[a]=b:e(a,b)},clear:function(){c=Object.create(null),d=Object.create(null)}}}},80645:function(a,b){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ b.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<< -k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<< -k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},b.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?5960464477539062e-23:0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(isNaN(b=Math.abs(b))||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?b+=m/i:b+=m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},35717:function(a){"function"==typeof Object.create?a.exports=function(a,b){b&&(a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(a,b){if(b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}}},56512:function(a){!function(b){"use strict";let c="(0?\\d+|0x[a-f0-9]+)",d={fourOctet:RegExp(`^${c}\\.${c}\\.${c}\\.${c}$`,"i"),threeOctet:RegExp(`^${c}\\.${c}\\.${c}$`,"i"),twoOctet:RegExp(`^${c}\\.${c}$`,"i"),longValue:RegExp(`^${c}$`,"i")},e=RegExp("^0[0-7]+$","i"),f=RegExp("^0x[a-f0-9]+$","i"),g="%[0-9a-z]{1,}",h="(?:[0-9a-f]+::?)+",i={zoneIndex:RegExp(g,"i"),native:RegExp(`^(::)?(${h})?([0-9a-f]+)?(::)?(${g})?$`,"i"),deprecatedTransitional:RegExp(`^(?:::)(${c}\\.${c}\\.${c}\\.${c}(${g})?)$`,"i"),transitional:RegExp(`^((?:${h})|(?:::)(?:${h})?)${c}\\.${c}\\.${c}\\.${c}(${g})?$`,"i")};function j(a,b){if(a.indexOf("::")!==a.lastIndexOf("::"))return null;let c=0,d=-1,e=(a.match(i.zoneIndex)||[])[0],f,g;for(e&&(e=e.substring(1),a=a.replace(/%.+$/,""));(d=a.indexOf(":",d+1))>=0;)c++;if("::"===a.substr(0,2)&&c--,"::"===a.substr(-2,2)&&c--,c>b)return null;for(g=b-c,f=":";g--;)f+="0:";return":"===(a=a.replace("::",f))[0]&&(a=a.slice(1)),":"===a[a.length-1]&&(a=a.slice(0,-1)),{parts:b=function(){let b=a.split(":"),c=[];for(let d=0;d<b.length;d++)c.push(parseInt(b[d],16));return c}(),zoneId:e}}function k(a,b,c,d){if(a.length!==b.length)throw Error("ipaddr: cannot match CIDR for objects with different lengths");let e=0,f;for(;d>0;){if((f=c-d)<0&&(f=0),a[e]>>f!=b[e]>>f)return!1;d-=c,e+=1}return!0}function l(a){if(f.test(a))return parseInt(a,16);if("0"===a[0]&&!isNaN(parseInt(a[1],10))){if(e.test(a))return parseInt(a,8);throw Error(`ipaddr: cannot parse ${a} as octal`)}return parseInt(a,10)}function m(a,b){for(;a.length<b;)a=`0${a}`;return a}let n={};n.IPv4=function(){function a(a){if(4!==a.length)throw Error("ipaddr: ipv4 octet count should be 4");let b,c;for(b=0;b<a.length;b++)if(!(0<=(c=a[b])&&c<=255))throw Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=a}return a.prototype.SpecialRanges={unspecified:[[new a([0,0,0,0]),8]],broadcast:[[new a([255,255,255,255]),32]],multicast:[[new a([224,0,0,0]),4]],linkLocal:[[new a([169,254,0,0]),16]],loopback:[[new a([127,0,0,0]),8]],carrierGradeNat:[[new a([100,64,0,0]),10]],private:[[new a([10,0,0,0]),8],[new a([172,16,0,0]),12],[new a([192,168,0,0]),16]],reserved:[[new a([192,0,0,0]),24],[new a([192,0,2,0]),24],[new a([192,88,99,0]),24],[new a([198,51,100,0]),24],[new a([203,0,113,0]),24],[new a([240,0,0,0]),4]]},a.prototype.kind=function(){return"ipv4"},a.prototype.match=function(a,b){let c;if(void 0===b&&(a=(c=a)[0],b=c[1]),"ipv4"!==a.kind())throw Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return k(this.octets,a.octets,8,b)},a.prototype.prefixLengthFromSubnetMask=function(){let a=0,b=!1,c={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},d,e,f;for(d=3;d>=0;d-=1){if(!((e=this.octets[d])in c)||(f=c[e],b&&0!==f))return null;8!==f&&(b=!0),a+=f}return 32-a},a.prototype.range=function(){return n.subnetMatch(this,this.SpecialRanges)},a.prototype.toByteArray=function(){return this.octets.slice(0)},a.prototype.toIPv4MappedAddress=function(){return n.IPv6.parse(`::ffff:${this.toString()}`)},a.prototype.toNormalizedString=function(){return this.toString()},a.prototype.toString=function(){return this.octets.join(".")},a}(),n.IPv4.broadcastAddressFromCIDR=function(a){try{let b=this.parseCIDR(a),c=b[0].toByteArray(),d=this.subnetMaskFromPrefixLength(b[1]).toByteArray(),e=[],f=0;for(;f<4;)e.push(parseInt(c[f],10)|255^parseInt(d[f],10)),f++;return new this(e)}catch(g){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},n.IPv4.isIPv4=function(a){return null!==this.parser(a)},n.IPv4.isValid=function(a){try{return new this(this.parser(a)),!0}catch(b){return!1}},n.IPv4.isValidFourPartDecimal=function(a){return!!(n.IPv4.isValid(a)&&a.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},n.IPv4.networkAddressFromCIDR=function(a){let b,c,d,e,f;try{for(d=(b=this.parseCIDR(a))[0].toByteArray(),f=this.subnetMaskFromPrefixLength(b[1]).toByteArray(),e=[],c=0;c<4;)e.push(parseInt(d[c],10)&parseInt(f[c],10)),c++;return new this(e)}catch(g){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},n.IPv4.parse=function(a){let b=this.parser(a);if(null===b)throw Error("ipaddr: string is not formatted like an IPv4 Address");return new this(b)},n.IPv4.parseCIDR=function(a){let b;if(b=a.match(/^(.+)\/(\d+)$/)){let c=parseInt(b[2]);if(c>=0&&c<=32){let d=[this.parse(b[1]),c];return Object.defineProperty(d,"toString",{value:function(){return this.join("/")}}),d}}throw Error("ipaddr: string is not formatted like an IPv4 CIDR range")},n.IPv4.parser=function(a){let b,c,e;if(b=a.match(d.fourOctet))return function(){let a=b.slice(1,6),d=[];for(let e=0;e<a.length;e++)d.push(l(c=a[e]));return d}();if(b=a.match(d.longValue)){if((e=l(b[1]))>4294967295||e<0)throw Error("ipaddr: address outside defined range");return(function(){let a=[],b;for(b=0;b<=24;b+=8)a.push(e>>b&255);return a})().reverse()}return(b=a.match(d.twoOctet))?function(){let a=b.slice(1,4),c=[];if((e=l(a[1]))>16777215||e<0)throw Error("ipaddr: address outside defined range");return c.push(l(a[0])),c.push(e>>16&255),c.push(e>>8&255),c.push(255&e),c}():(b=a.match(d.threeOctet))?function(){let a=b.slice(1,5),c=[];if((e=l(a[2]))>65535||e<0)throw Error("ipaddr: address outside defined range");return c.push(l(a[0])),c.push(l(a[1])),c.push(e>>8&255),c.push(255&e),c}():null},n.IPv4.subnetMaskFromPrefixLength=function(a){if((a=parseInt(a))<0||a>32)throw Error("ipaddr: invalid IPv4 prefix length");let b=[0,0,0,0],c=0,d=Math.floor(a/8);for(;c<d;)b[c]=255,c++;return d<4&&(b[d]=Math.pow(2,a%8)-1<<8-a%8),new this(b)},n.IPv6=function(){function a(a,b){let c,d;if(16===a.length)for(c=0,this.parts=[];c<=14;c+=2)this.parts.push(a[c]<<8|a[c+1]);else if(8===a.length)this.parts=a;else throw Error("ipaddr: ipv6 part count should be 8 or 16");for(c=0;c<this.parts.length;c++)if(!(0<=(d=this.parts[c])&&d<=65535))throw Error("ipaddr: ipv6 part should fit in 16 bits");b&&(this.zoneId=b)}return a.prototype.SpecialRanges={unspecified:[new a([0,0,0,0,0,0,0,0]),128],linkLocal:[new a([65152,0,0,0,0,0,0,0]),10],multicast:[new a([65280,0,0,0,0,0,0,0]),8],loopback:[new a([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new a([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new a([0,0,0,0,0,65535,0,0]),96],rfc6145:[new a([0,0,0,0,65535,0,0,0]),96],rfc6052:[new a([100,65435,0,0,0,0,0,0]),96],"6to4":[new a([8194,0,0,0,0,0,0,0]),16],teredo:[new a([8193,0,0,0,0,0,0,0]),32],reserved:[[new a([8193,3512,0,0,0,0,0,0]),32]]},a.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},a.prototype.kind=function(){return"ipv6"},a.prototype.match=function(a,b){let c;if(void 0===b&&(a=(c=a)[0],b=c[1]),"ipv6"!==a.kind())throw Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return k(this.parts,a.parts,16,b)},a.prototype.prefixLengthFromSubnetMask=function(){let a=0,b=!1,c={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},d,e;for(let f=7;f>=0;f-=1){if(!((d=this.parts[f])in c)||(e=c[d],b&&0!==e))return null;16!==e&&(b=!0),a+=e}return 128-a},a.prototype.range=function(){return n.subnetMatch(this,this.SpecialRanges)},a.prototype.toByteArray=function(){let a,b=[],c=this.parts;for(let d=0;d<c.length;d++)b.push((a=c[d])>>8),b.push(255&a);return b},a.prototype.toFixedLengthString=function(){let a=(function(){let a=[];for(let b=0;b<this.parts.length;b++)a.push(m(this.parts[b].toString(16),4));return a}).call(this).join(":"),b="";return this.zoneId&&(b=`%${this.zoneId}`),a+b},a.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let a=this.parts.slice(-2),b=a[0],c=a[1];return new n.IPv4([b>>8,255&b,c>>8,255&c])},a.prototype.toNormalizedString=function(){let a=(function(){let a=[];for(let b=0;b<this.parts.length;b++)a.push(this.parts[b].toString(16));return a}).call(this).join(":"),b="";return this.zoneId&&(b=`%${this.zoneId}`),a+b},a.prototype.toRFC5952String=function(){let a=/((^|:)(0(:|$)){2,})/g,b=this.toNormalizedString(),c=0,d=-1,e;for(;e=a.exec(b);)e[0].length>d&&(c=e.index,d=e[0].length);return d<0?b:`${b.substring(0,c)}::${b.substring(c+d)}`},a.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},a}(),n.IPv6.broadcastAddressFromCIDR=function(a){try{let b=this.parseCIDR(a),c=b[0].toByteArray(),d=this.subnetMaskFromPrefixLength(b[1]).toByteArray(),e=[],f=0;for(;f<16;)e.push(parseInt(c[f],10)|255^parseInt(d[f],10)),f++;return new this(e)}catch(g){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${g})`)}},n.IPv6.isIPv6=function(a){return null!==this.parser(a)},n.IPv6.isValid=function(a){if("string"==typeof a&& -1===a.indexOf(":"))return!1;try{let b=this.parser(a);return new this(b.parts,b.zoneId),!0}catch(c){return!1}},n.IPv6.networkAddressFromCIDR=function(a){let b,c,d,e,f;try{for(d=(b=this.parseCIDR(a))[0].toByteArray(),f=this.subnetMaskFromPrefixLength(b[1]).toByteArray(),e=[],c=0;c<16;)e.push(parseInt(d[c],10)&parseInt(f[c],10)),c++;return new this(e)}catch(g){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${g})`)}},n.IPv6.parse=function(a){let b=this.parser(a);if(null===b.parts)throw Error("ipaddr: string is not formatted like an IPv6 Address");return new this(b.parts,b.zoneId)},n.IPv6.parseCIDR=function(a){let b,c,d;if((c=a.match(/^(.+)\/(\d+)$/))&&(b=parseInt(c[2]))>=0&&b<=128)return Object.defineProperty(d=[this.parse(c[1]),b],"toString",{value:function(){return this.join("/")}}),d;throw Error("ipaddr: string is not formatted like an IPv6 CIDR range")},n.IPv6.parser=function(a){let b,c,d,e,f,g;if(d=a.match(i.deprecatedTransitional))return this.parser(`::ffff:${d[1]}`);if(i.native.test(a))return j(a,8);if((d=a.match(i.transitional))&&(g=d[6]||"",b=j(d[1].slice(0,-1)+g,6),b.parts)){for(c=0,f=[parseInt(d[2]),parseInt(d[3]),parseInt(d[4]),parseInt(d[5])];c<f.length;c++)if(!(0<=(e=f[c])&&e<=255))return null;return b.parts.push(f[0]<<8|f[1]),b.parts.push(f[2]<<8|f[3]),{parts:b.parts,zoneId:b.zoneId}}return null},n.IPv6.subnetMaskFromPrefixLength=function(a){if((a=parseInt(a))<0||a>128)throw Error("ipaddr: invalid IPv6 prefix length");let b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0,d=Math.floor(a/8);for(;c<d;)b[c]=255,c++;return d<16&&(b[d]=Math.pow(2,a%8)-1<<8-a%8),new this(b)},n.fromByteArray=function(a){let b=a.length;if(4===b)return new n.IPv4(a);if(16===b)return new n.IPv6(a);throw Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},n.isValid=function(a){return n.IPv6.isValid(a)||n.IPv4.isValid(a)},n.parse=function(a){if(n.IPv6.isValid(a))return n.IPv6.parse(a);if(n.IPv4.isValid(a))return n.IPv4.parse(a);throw Error("ipaddr: the address has neither IPv6 nor IPv4 format")},n.parseCIDR=function(a){try{return n.IPv6.parseCIDR(a)}catch(b){try{return n.IPv4.parseCIDR(a)}catch(c){throw Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},n.process=function(a){let b=this.parse(a);return"ipv6"===b.kind()&&b.isIPv4MappedAddress()?b.toIPv4Address():b},n.subnetMatch=function(a,b,c){let d,e,f,g;for(e in null==c&&(c="unicast"),b)if(Object.prototype.hasOwnProperty.call(b,e)){for(!(f=b[e])[0]||f[0]instanceof Array||(f=[f]),d=0;d<f.length;d++)if(g=f[d],a.kind()===g[0].kind()&&a.match.apply(a,g))return e}return c},a.exports?a.exports=n:b.ipaddr=n}(this)},25457:function(a){let b=(...a)=>{let b;for(;a.length;)b=a.shift()(b);return b},c=a=>a&&("function"==typeof a[Symbol.asyncIterator]||"function"==typeof a[Symbol.iterator]||"function"==typeof a.next),d=a=>a&&"function"==typeof a.sink&&c(a.source),e=a=>b=>(a.sink(b),a.source),f=(...a)=>{if(d(a[0])){let f=a[0];a[0]=()=>f.source}else if(c(a[0])){let g=a[0];a[0]=()=>g}if(a.length>1&&d(a[a.length-1])&&(a[a.length-1]=a[a.length-1].sink),a.length>2)for(let h=1;h<a.length-1;h++)d(a[h])&&(a[h]=e(a[h]));return b(...a)};a.exports=f,a.exports.pipe=f,a.exports.rawPipe=b,a.exports.isIterable=c,a.exports.isDuplex=d},40677:function(a,b,c){let d=c(91607);a.exports=a=>{let b;"function"==typeof(a=a||{})?(b=a,a={}):b=a.onEnd;let c=new d,e,f,g,h=()=>{if(!c.isEmpty()){if(a.writev){let b,d=[];for(;!c.isEmpty();){if((b=c.shift()).error)throw b.error;d.push(b.value)}return{done:b.done,value:d}}let h=c.shift();if(h.error)throw h.error;return h}return g?{done:!0}:new Promise((b,c)=>{f=d=>(f=null,d.error?c(d.error):a.writev&&!d.done?b({done:d.done,value:[d.value]}):b(d),e)})},i=a=>f?f(a):(c.push(a),e),j=a=>(c=new d,f)?f({error:a}):(c.push({error:a}),e),k=a=>g?e:i({done:!1,value:a}),l=a=>g?e:(g=!0,a?j(a):i({done:!0})),m=()=>(c=new d,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l},!b)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),b&&(b(a),b=null),{done:!0}},return(){return o.return(),b&&(b(),b=null),{done:!0}},push:k,end(a){return o.end(a),b&&(b(a),b=null),e}}}},57027:function(a){function b(a,b,d){var e,f,g;if(Array.isArray(b)&&(e=b.slice(0)),"string"==typeof b&&(e=b.split(".")),"symbol"==typeof b&&(e=[b]),!Array.isArray(e))throw Error("props arg must be an array, a string or a symbol");if(!(f=e.pop()))return!1;for(c(f);g=e.shift();)if(c(g),void 0===a[g]&&(a[g]={}),!(a=a[g])||"object"!=typeof a)return!1;return a[f]=d,!0}function c(a){if("__proto__"===a||"constructor"===a||"prototype"===a)throw Error("setting of prototype values not supported")}a.exports=b},34134:function(a,b,c){let d=c(17187).EventEmitter,{nanoid:e}=c(78647),{WORKER_REQUEST_READ_LOCK:f,WORKER_RELEASE_READ_LOCK:g,MASTER_GRANT_READ_LOCK:h,WORKER_REQUEST_WRITE_LOCK:i,WORKER_RELEASE_WRITE_LOCK:j,MASTER_GRANT_WRITE_LOCK:k}=c(2932),l=c(43049),m=(a,b,c,d,e)=>(f,g)=>{if(!g||!g.data||g.data.type!==c)return;let h={type:g.data.type,name:g.data.name,identifier:g.data.identifier};a.emit(b,h.name,()=>(f.postMessage({type:e,name:h.name,identifier:h.identifier}),new Promise(a=>{let b=c=>{if(!c||!c.data)return;let e={type:c.data.type,name:c.data.name,identifier:c.data.identifier};e&&e.type===d&&e.identifier===h.identifier&&(f.removeEventListener("message",b),a())};f.addEventListener("message",b)})))},n=(a,b,c,d)=>()=>{let f=e();return globalThis.postMessage({type:b,identifier:f,name:a}),new Promise(b=>{let e=g=>{if(!g||!g.data)return;let h={type:g.data.type,identifier:g.data.identifier};h&&h.type===c&&h.identifier===f&&(globalThis.removeEventListener("message",e),b(()=>{globalThis.postMessage({type:d,identifier:f,name:a})}))};globalThis.addEventListener("message",e)})},o={singleProcess:!1};a.exports=a=>{a=Object.assign({},o,a);let b=!!globalThis.document||a.singleProcess;if(b){let c=new d;return l.addEventListener("message",m(c,"requestReadLock",f,g,h)),l.addEventListener("message",m(c,"requestWriteLock",i,j,k)),c}return{isWorker:!0,readLock:a=>n(a,f,h,g),writeLock:a=>n(a,i,k,j)}}},2932:function(a){a.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}},59526:function(a,b,c){let d=c(94930),e=c(34134),{default:f}=c(56827),{timeout:g}=c(54501),h=c(43049),i={},j;function k(a,b){let c,d=new Promise(a=>{c=a});return a.add(()=>g(new Promise(a=>{c(()=>{a()})}),b.timeout)),d}let l=(a,b)=>{if(j.isWorker)return{readLock:j.readLock(a,b),writeLock:j.writeLock(a,b)};let c=new f({concurrency:1}),d=null;return{readLock:()=>{if(d)return k(d,b);d=new f({concurrency:b.concurrency,autoStart:!1});let a=d,e=k(d,b);return c.add(()=>(a.start(),a.onIdle().then(()=>{d===a&&(d=null)}))),e},writeLock:()=>(d=null,k(c,b))}},m={concurrency:1/0,timeout:846e5,global:c.g,singleProcess:!1};a.exports=(a,b)=>(b||(b={}),"object"==typeof a&&(b=a,a="lock"),a||(a="lock"),b=Object.assign({},m,b),j||(j=d(b)||e(b)).isWorker||(j.on("requestReadLock",(a,b)=>{i[a]&&i[a].readLock().then(a=>b().finally(()=>a()))}),j.on("requestWriteLock",async(a,b)=>{i[a]&&i[a].writeLock().then(a=>b().finally(()=>a()))})),i[a]||(i[a]=l(a,b)),i[a]),a.exports.Worker=function(a,b){b=b||c.g.Worker;let d;try{d=new b(a)}catch(e){e.message.includes("not a constructor")&&(d=b(a))}if(!d)throw Error("Could not create Worker from",b);return h(d),d}},94930:function(a,b,c){var d=c(83454);let e=c(17187).EventEmitter,{nanoid:f}=c(78647),{WORKER_REQUEST_READ_LOCK:g,WORKER_RELEASE_READ_LOCK:h,MASTER_GRANT_READ_LOCK:i,WORKER_REQUEST_WRITE_LOCK:j,WORKER_RELEASE_WRITE_LOCK:k,MASTER_GRANT_WRITE_LOCK:l}=c(2932),m,n=(a,b,c,d,e)=>(f,g)=>{g&&g.type===c&&a.emit(b,g.name,()=>(f.send({type:e,name:g.name,identifier:g.identifier}),new Promise(a=>{let b=c=>{c&&c.type===d&&c.identifier===g.identifier&&(f.removeListener("message",b),a())};f.on("message",b)})))},o=(a,b,c,e)=>()=>{let g=f();return d.send({type:b,identifier:g,name:a}),new Promise(b=>{let f=h=>{h&&h.type===c&&h.identifier===g&&(d.removeListener("message",f),b(()=>{d.send({type:e,identifier:g,name:a})}))};d.on("message",f)})};a.exports=a=>{try{if(m=c(79156),!Object.keys(m).length)return}catch(b){return}if(m.isMaster||a.singleProcess){let d=new e;return m.on("message",n(d,"requestReadLock",g,h,i)),m.on("message",n(d,"requestWriteLock",j,k,l)),d}return{isWorker:!0,readLock:a=>o(a,g,i,h),writeLock:a=>o(a,j,l,k)}}},43049:function(a){let b={},c=a=>{a.addEventListener("message",b=>{c.dispatchEvent("message",a,b)}),a.port&&a.port.addEventListener("message",b=>{c.dispatchEvent("message",a,b)})};c.addEventListener=(a,c)=>{b[a]||(b[a]=[]),b[a].push(c)},c.removeEventListener=(a,c)=>{b[a]&&(b[a]=b[a].filter(a=>a===c))},c.dispatchEvent=function(){let a=Array.prototype.slice.call(arguments),c=a.shift();b[c]&&b[c].forEach(b=>b.apply(null,a))},a.exports=c},56827:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(26729),e=c(59554),f=c(74956),g=()=>{},h=new e.TimeoutError;class i extends d{constructor(a){var b,c,d,e;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=g,this._resolveIdle=g,!("number"==typeof(a=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:f.default},a)).intervalCap&&a.intervalCap>=1))throw TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(c=null===(b=a.intervalCap)|| void 0===b?void 0:b.toString())&& void 0!==c?c:""}\` (${typeof a.intervalCap})`);if(void 0===a.interval||!(Number.isFinite(a.interval)&&a.interval>=0))throw TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(e=null===(d=a.interval)|| void 0===d?void 0:d.toString())&& void 0!==e?e:""}\` (${typeof a.interval})`);this._carryoverConcurrencyCount=a.carryoverConcurrencyCount,this._isIntervalIgnored=a.intervalCap===1/0||0===a.interval,this._intervalCap=a.intervalCap,this._interval=a.interval,this._queue=new a.queueClass,this._queueClass=a.queueClass,this.concurrency=a.concurrency,this._timeout=a.timeout,this._throwOnTimeout=!0===a.throwOnTimeout,this._isPaused=!1===a.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=g,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=g,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let a=Date.now();if(void 0===this._intervalId){let b=this._intervalEnd-a;if(!(b<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},b)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let a=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let b=this._queue.dequeue();return!!b&&(this.emit("active"),b(),a&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){!this._isIntervalIgnored&& void 0===this._intervalId&&(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(a){if(!("number"==typeof a&&a>=1))throw TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${a}\` (${typeof a})`);this._concurrency=a,this._processQueue()}async add(a,b={}){return new Promise((c,d)=>{let f=async()=>{this._pendingCount++,this._intervalCount++;try{let f=void 0===this._timeout&& void 0===b.timeout?a():e.default(Promise.resolve(a()),void 0===b.timeout?this._timeout:b.timeout,()=>{(void 0===b.throwOnTimeout?this._throwOnTimeout:b.throwOnTimeout)&&d(h)});c(await f)}catch(g){d(g)}this._next()};this._queue.enqueue(f,b),this._tryToStartAnother(),this.emit("add")})}async addAll(a,b){return Promise.all(a.map(async a=>this.add(a,b)))}start(){return this._isPaused&&(this._isPaused=!1,this._processQueue()),this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(a=>{let b=this._resolveEmpty;this._resolveEmpty=()=>{b(),a()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(a=>{let b=this._resolveIdle;this._resolveIdle=()=>{b(),a()}})}get size(){return this._queue.size}sizeBy(a){return this._queue.filter(a).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(a){this._timeout=a}}b.default=i},22405:function(a,b){"use strict";function c(a,b,c){let d=0,e=a.length;for(;e>0;){let f=e/2|0,g=d+f;0>=c(a[g],b)?(d=++g,e-=f+1):e=f}return d}Object.defineProperty(b,"__esModule",{value:!0}),b.default=c},74956:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(22405);class e{constructor(){this._queue=[]}enqueue(a,b){b=Object.assign({priority:0},b);let c={priority:b.priority,run:a};if(this.size&&this._queue[this.size-1].priority>=b.priority){this._queue.push(c);return}let e=d.default(this._queue,c,(a,b)=>b.priority-a.priority);this._queue.splice(e,0,c)}dequeue(){let a=this._queue.shift();return null==a?void 0:a.run}filter(a){return this._queue.filter(b=>b.priority===a.priority).map(a=>a.run)}get size(){return this._queue.length}}b.default=e},59554:function(a,b,c){"use strict";let d=c(27345);class e extends Error{constructor(a){super(a),this.name="TimeoutError"}}let f=(a,b,c)=>new Promise((f,g)=>{if("number"!=typeof b||b<0)throw TypeError("Expected `milliseconds` to be a positive number");if(b===1/0){f(a);return}let h=setTimeout(()=>{if("function"==typeof c){try{f(c())}catch(d){g(d)}return}let h="string"==typeof c?c:`Promise timed out after ${b} milliseconds`,i=c instanceof Error?c:new e(h);"function"==typeof a.cancel&&a.cancel(),g(i)},b);d(a.then(f,g),()=>{clearTimeout(h)})});a.exports=f,a.exports.default=f,a.exports.TimeoutError=e},42413:function(a,b,c){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?a.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:a.exports={default:c(83300).default,Headers:c(83300).Headers,Request:c(83300).Request,Response:c(83300).Response}},106:function(a,b,c){"use strict";var d=c(83454);let e=c(59134),f="object"==typeof window&&"object"==typeof document&&9===document.nodeType,g=e(),h=f&&!g,i=g&&!f,j=g&&f,k=void 0!==d&& void 0!==d.release&&"node"===d.release.name&&!g,l="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,m=void 0!==d&& void 0!==d.env,n="undefined"!=typeof navigator&&"ReactNative"===navigator.product;a.exports={isTest:m,isElectron:g,isElectronMain:i,isElectronRenderer:j,isNode:k,isBrowser:h,isWebWorker:l,isEnvWithDom:f,isReactNative:n}},38688:function(a,b,c){"use strict";a.exports=c(42413)},46953:function(a,b,c){"use strict";let d=c(67137),e=(a,b)=>({path:decodeURIComponent(new URL(a).pathname.split("/").pop()||""),content:f(a,b)});async function*f(a,b){let c=new d,e=await c.get(a,b);yield*e.iterator()}a.exports=e},67137:function(a,b,c){"use strict";let{fetch:d,Request:e,Headers:f}=c(50730),{TimeoutError:g,HTTPError:h}=c(44171),i=c(70942).bind({ignoreUndefined:!0}),{URL:j,URLSearchParams:k}=c(17745),l=c(32044),m=(a,b,c)=>{if(void 0===b)return a;let d=Date.now(),e=()=>{let a=Date.now()-d;return a>=b};return new Promise((d,f)=>{let h=setTimeout(()=>{e()&&(f(new g),c.abort())},b),i=a=>{let b=b=>{if(clearTimeout(h),e()){f(new g);return}a(b)};return b};a.then(i(d),i(f))})},n={throwHttpErrors:!0,credentials:"same-origin"};class o{constructor(a={}){this.opts=i(n,a)}async fetch(a,b={}){let c=i(this.opts,b),g=new f(c.headers);if("string"!=typeof a&&!(a instanceof j||a instanceof e))throw TypeError("`resource` must be a string, URL, or Request");let n=new j(a.toString(),c.base),{searchParams:o,transformSearchParams:r,json:s}=c;o&&("function"==typeof r?n.search=r(new k(c.searchParams)):n.search=new k(c.searchParams)),s&&(c.body=JSON.stringify(c.json),g.set("content-type","application/json"));let t=new AbortController,u=l([t.signal,c.signal]),v=await m(d(n.toString(),{...c,signal:u,timeout:void 0,headers:g}),c.timeout,t);if(!v.ok&&c.throwHttpErrors)throw c.handleError&&await c.handleError(v),new h(v);return v.iterator=async function*(){yield*q(v.body)},v.ndjson=async function*(){for await(let a of p(v.iterator()))b.transform?yield b.transform(a):yield a},v}post(a,b={}){return this.fetch(a,{...b,method:"POST"})}get(a,b={}){return this.fetch(a,{...b,method:"GET"})}put(a,b={}){return this.fetch(a,{...b,method:"PUT"})}delete(a,b={}){return this.fetch(a,{...b,method:"DELETE"})}options(a,b={}){return this.fetch(a,{...b,method:"OPTIONS"})}}let p=async function*(a){let b=new TextDecoder,c="";for await(let d of a){c+=b.decode(d,{stream:!0});let e=c.split(/\r?\n/);for(let f=0;f<e.length-1;f++){let g=e[f].trim();g.length>0&&(yield JSON.parse(g))}c=e[e.length-1]}c+=b.decode(),0!==(c=c.trim()).length&&(yield JSON.parse(c))},q=a=>{if(t(a)){let b=a[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:b.next.bind(b),return(c){return(a.destroy(),"function"==typeof b.return)?b.return():Promise.resolve({done:!0,value:c})}}}}}if(s(a)){let c=a.getReader();return async function*(){try{for(;;){let{done:a,value:b}=await c.read();if(a)return;b&&(yield b)}}finally{c.releaseLock()}}()}if(r(a))return a;throw TypeError("Body can't be converted to AsyncIterable")},r=a=>"object"==typeof a&&null!==a&&"function"==typeof a[Symbol.asyncIterator],s=a=>a&&"function"==typeof a.getReader,t=a=>Object.prototype.hasOwnProperty.call(a,"readable")&&Object.prototype.hasOwnProperty.call(a,"writable");o.HTTPError=h,o.TimeoutError=g,o.streamToAsyncIterator=q,o.post=(a,b)=>new o(b).post(a,b),o.get=(a,b)=>new o(b).get(a,b),o.put=(a,b)=>new o(b).put(a,b),o.delete=(a,b)=>new o(b).delete(a,b),o.options=(a,b)=>new o(b).options(a,b),a.exports=o},44171:function(a,b){"use strict";class c extends Error{constructor(a="Request timed out"){super(a),this.name="TimeoutError"}}b.TimeoutError=c;class d extends Error{constructor(a="The operation was aborted."){super(a),this.name="AbortError"}}b.AbortError=d;class e extends Error{constructor(a){super(a.statusText),this.name="HTTPError",this.response=a}}b.HTTPError=e},50730:function(a,b,c){"use strict";let{TimeoutError:d,AbortError:e}=c(44171),{Response:f,Request:g,Headers:h,default:i}=c(38688),j=(a,b={})=>{let c=new XMLHttpRequest;c.open(b.method||"GET",a.toString(),!0);let{timeout:g,headers:i}=b;if(g&&g>0&&g<1/0&&(c.timeout=g),null!=b.overrideMimeType&&c.overrideMimeType(b.overrideMimeType),i)for(let[j,k]of new h(i))c.setRequestHeader(j,k);return b.signal&&(b.signal.onabort=()=>c.abort()),b.onUploadProgress&&(c.upload.onprogress=b.onUploadProgress),c.responseType="arraybuffer",new Promise((a,g)=>{let h=b=>{switch(b.type){case"error":a(f.error());break;case"load":a(new n(c.responseURL,c.response,{status:c.status,statusText:c.statusText,headers:m(c.getAllResponseHeaders())}));break;case"timeout":g(new d);break;case"abort":g(new e)}};c.onerror=h,c.onload=h,c.ontimeout=h,c.onabort=h,c.send(b.body)})},k=i,l=(a,b={})=>null!=b.onUploadProgress?j(a,b):k(a,b),m=a=>{let b=new h;for(let c of a.trim().split(/[\r\n]+/)){let d=c.indexOf(": ");d>0&&b.set(c.slice(0,d),c.slice(d+1))}return b};class n extends f{constructor(a,b,c){super(b,c),Object.defineProperty(this,"url",{value:a})}}a.exports={fetch:l,Request:g,Headers:h}},48738:function(a){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */ a.exports=function(a){return null!=a&&null!=a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}},82734:function(a){"use strict";var b=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;a.exports=function(a,c){if(null==c&&(c=!1),a.length<2||a.length>255)return!1;var d=a[a.length-1];if(c){if("."!==d)return!1}else if("."===d)return!1;return b.test(a)}},59134:function(a,b,c){var d=c(83454);function e(){return!!("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type|| void 0!==d&&"object"==typeof d.versions&&d.versions.electron||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}a.exports=e},24981:function(a,b,c){"use strict";let{base58btc:d}=c(99086),{base32:e}=c(22817),f=c(28924),{Multiaddr:g}=c(46584),h=c(29175),{CID:i}=c(81362),{URL:j}=c(17745),{toString:k}=c(92263),l=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,m=/^\/(ip[fn]s)\/([^/?#]+)/,n=1,o=2,p=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,q=1,r=2,s=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function t(a){let b=B(a);try{f.decode(d.decode("z"+b))}catch{return!1}return!0}function u(a){try{e.decode(a)}catch{return!1}return!0}function v(a){try{if("string"==typeof a)return Boolean(i.parse(a));if(a instanceof Uint8Array)return Boolean(i.decode(a));return Boolean(i.asCID(a))}catch(b){return!1}}function w(a){if(!a)return!1;if(g.isMultiaddr(a))return!0;try{return new g(a),!0}catch(b){return!1}}function x(a){return w(a)&&h.P2P.matches(a)}function y(a,b,c=n,d=o){let e=B(a);if(!e)return!1;let f=e.match(b);if(!f||"ipfs"!==f[c])return!1;let g=f[d];return g&&b===p&&(g=g.toLowerCase()),v(g)}function z(a,b,c=n,d=o){let e=B(a);if(!e)return!1;let f=e.match(b);if(!f||"ipns"!==f[c])return!1;let g=f[d];if(g&&b===p){if(v(g=g.toLowerCase()))return!0;try{!g.includes(".")&&g.includes("-")&&(g=g.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:h}=new j(`http://${g}`);return s.test(h)}catch(i){return!1}}return!0}function A(a){return"string"==typeof a}function B(a){return a instanceof Uint8Array?k(a,"base58btc"):!!A(a)&&a}let C=a=>y(a,p,r,q),D=a=>z(a,p,r,q),E=a=>C(a)||D(a),F=a=>y(a,l)||C(a),G=a=>z(a,l)||D(a),H=a=>F(a)||G(a)||E(a),I=a=>y(a,m)||z(a,m);a.exports={multihash:t,multiaddr:w,peerMultiaddr:x,cid:v,base32cid:a=>u(a)&&v(a),ipfsSubdomain:C,ipnsSubdomain:D,subdomain:E,subdomainGatewayPattern:p,ipfsUrl:F,ipnsUrl:G,url:H,pathGatewayPattern:l,ipfsPath:a=>y(a,m),ipnsPath:a=>z(a,m),path:I,pathPattern:m,urlOrPath:a=>H(a)||I(a),cidPath:a=>A(a)&&!v(a)&&y(`/ipfs/${a}`,m)}},33310:function(a){"use strict";a.exports=a=>{if("[object Object]"!==Object.prototype.toString.call(a))return!1;let b=Object.getPrototypeOf(a);return null===b||b===Object.prototype}},71993:function(a){"use strict";a.exports={E2BIG:7,EACCES:13,EADDRINUSE:100,EADDRNOTAVAIL:101,EAFNOSUPPORT:102,EAGAIN:11,EALREADY:103,EBADF:9,EBADMSG:104,EBUSY:16,ECANCELED:105,ECHILD:10,ECONNABORTED:106,ECONNREFUSED:107,ECONNRESET:108,EDEADLK:36,EDESTADDRREQ:109,EDOM:33,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:110,EIDRM:111,EILSEQ:42,EINPROGRESS:112,EINTR:4,EINVAL:22,EIO:5,EISCONN:113,EISDIR:21,ELOOP:114,EMFILE:24,EMLINK:31,EMSGSIZE:115,ENAMETOOLONG:38,ENETDOWN:116,ENETRESET:117,ENETUNREACH:118,ENFILE:23,ENOBUFS:119,ENODATA:120,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:39,ENOLINK:121,ENOMEM:12,ENOMSG:122,ENOPROTOOPT:123,ENOSPC:28,ENOSR:124,ENOSTR:125,ENOSYS:40,ENOTCONN:126,ENOTDIR:20,ENOTEMPTY:41,ENOTSOCK:128,ENOTSUP:129,ENOTTY:25,ENXIO:6,EOPNOTSUPP:130,EOVERFLOW:132,EPERM:1,EPIPE:32,EPROTO:134,EPROTONOSUPPORT:135,EPROTOTYPE:136,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ETIME:137,ETIMEDOUT:138,ETXTBSY:139,EWOULDBLOCK:140,EXDEV:18,WSAEINTR:10004,WSAEBADF:10009,WSAEACCES:10013,WSAEFAULT:10014,WSAEINVAL:10022,WSAEMFILE:10024,WSAEWOULDBLOCK:10035,WSAEINPROGRESS:10036,WSAEALREADY:10037,WSAENOTSOCK:10038,WSAEDESTADDRREQ:10039,WSAEMSGSIZE:10040,WSAEPROTOTYPE:10041,WSAENOPROTOOPT:10042,WSAEPROTONOSUPPORT:10043,WSAESOCKTNOSUPPORT:10044,WSAEOPNOTSUPP:10045,WSAEPFNOSUPPORT:10046,WSAEAFNOSUPPORT:10047,WSAEADDRINUSE:10048,WSAEADDRNOTAVAIL:10049,WSAENETDOWN:10050,WSAENETUNREACH:10051,WSAENETRESET:10052,WSAECONNABORTED:10053,WSAECONNRESET:10054,WSAENOBUFS:10055,WSAEISCONN:10056,WSAENOTCONN:10057,WSAESHUTDOWN:10058,WSAETOOMANYREFS:10059,WSAETIMEDOUT:10060,WSAECONNREFUSED:10061,WSAELOOP:10062,WSAENAMETOOLONG:10063,WSAEHOSTDOWN:10064,WSAEHOSTUNREACH:10065,WSAENOTEMPTY:10066,WSAEPROCLIM:10067,WSAEUSERS:10068,WSAEDQUOT:10069,WSAESTALE:10070,WSAEREMOTE:10071,WSASYSNOTREADY:10091,WSAVERNOTSUPPORTED:10092,WSANOTINITIALISED:10093,WSAEDISCON:10101,WSAENOMORE:10102,WSAECANCELLED:10103,WSAEINVALIDPROCTABLE:10104,WSAEINVALIDPROVIDER:10105,WSAEPROVIDERFAILEDINIT:10106,WSASYSCALLFAILURE:10107,WSASERVICE_NOT_FOUND:10108,WSATYPE_NOT_FOUND:10109,WSA_E_NO_MORE:10110,WSA_E_CANCELLED:10111,WSAEREFUSED:10112,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGILL:4,SIGABRT:22,SIGFPE:8,SIGKILL:9,SIGSEGV:11,SIGTERM:15,SIGBREAK:21,SIGWINCH:28,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFLNK:40960,O_CREAT:256,O_EXCL:1024,UV_FS_O_FILEMAP:536870912,O_TRUNC:512,O_APPEND:8,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488367,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},29309:function(a,b,c){"use strict";let{Readable:d}=c(88473),e=c(1914),f=(a=1/0)=>{let b=0;return new d({read(c){if(b>=a)return this.push(null);b+c>=a&&(c=a-b),b+=c,this.push(e(c))}})};a.exports={randomStream:f,randomBytes:e}},1914:function(a){"use strict";let b=65536;function c(a){let c=new Uint8Array(a),d=0;if(a>0){if(a>b)for(;d<a;)d+b>a?(crypto.getRandomValues(c.subarray(d,d+(a-d))),d+=a-d):(crypto.getRandomValues(c.subarray(d,d+b)),d+=b);else crypto.getRandomValues(c)}return c}a.exports=c},17745:function(a,b,c){"use strict";let{URLWithLegacySupport:d,format:e,URLSearchParams:f,defaultBase:g}=c(82049),h=c(15939);a.exports={URL:d,URLSearchParams:f,format:e,relative:h,defaultBase:g}},15939:function(a,b,c){"use strict";let{URLWithLegacySupport:d,format:e}=c(82049);a.exports=(a,b={},c={},f)=>{let g=b.protocol?b.protocol.replace(":",""):"http";g=(c[g]||f||g)+":";let h;try{h=new d(a)}catch(i){h={}}let j=Object.assign({},b,{protocol:g||h.protocol,host:b.host||h.host});return new d(a,e(j)).toString()}},82049:function(a){"use strict";let b="undefined"!=typeof navigator&&"ReactNative"===navigator.product;function c(){return b?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}let d=self.URL,e=c();class f{constructor(a="",b=e){this.super=new d(a,b),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(a){this.super.hash=a}set host(a){this.super.host=a}set hostname(a){this.super.hostname=a}set href(a){this.super.href=a}set password(a){this.super.password=a}set pathname(a){this.super.pathname=a}set port(a){this.super.port=a}set protocol(a){this.super.protocol=a}set search(a){this.super.search=a}set username(a){this.super.username=a}static createObjectURL(a){return d.createObjectURL(a)}static revokeObjectURL(a){d.revokeObjectURL(a)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function g(a){if("string"==typeof a){let b=new d(a);return b.toString()}if(!(a instanceof d)){let c=a.username&&a.password?`${a.username}:${a.password}@`:"",e=a.auth?a.auth+"@":"",f=a.port?":"+a.port:"",g=a.protocol?a.protocol+"//":"",h=a.host||"",i=a.hostname||"",j=a.search||(a.query?"?"+a.query:""),k=a.hash||"",l=a.pathname||"",m=a.path||l+j;return`${g}${c||e}${h||i+f}${m}${k}`}}a.exports={URLWithLegacySupport:f,URLSearchParams:self.URLSearchParams,defaultBase:e,format:g}},31303:function(a){"use strict";let b=async a=>{let b=[];for await(let c of a)b.push(c);return b};a.exports=b},78165:function(a){"use strict";async function*b(a,b=1){let c=[];for await(let d of(b<1&&(b=1),a))for(c.push(d);c.length>=b;)yield c.slice(0,b),c=c.slice(b);for(;c.length;)yield c.slice(0,b),c=c.slice(b)}a.exports=b},64593:function(a){"use strict";let b=async a=>{for await(let b of a);};a.exports=b},55565:function(a){"use strict";let b=async function*(a,b){for await(let c of a)await b(c)&&(yield c)};a.exports=b},72262:function(a){"use strict";let b=async a=>{for await(let b of a)return b};a.exports=b},4321:function(a){"use strict";let b=async function*(a,b){for await(let c of a)await b(c),yield c};a.exports=b},93093:function(a){"use strict";let b=async a=>{let b;for await(let c of a)b=c;return b};a.exports=b},93975:function(a){"use strict";let b=async a=>{let b=0;for await(let c of a)b++;return b};a.exports=b},32121:function(a){"use strict";let b=async function*(a,b){for await(let c of a)yield b(c)};a.exports=b},74014:function(a,b,c){"use strict";let d=c(78580),e=async function*(...a){let b=d();setTimeout(async()=>{try{await Promise.all(a.map(async a=>{for await(let c of a)b.push(c)})),b.end()}catch(c){b.end(c)}},0),yield*b};a.exports=e},78580:function(a,b,c){let d=c(91607);a.exports=a=>{let b;"function"==typeof(a=a||{})?(b=a,a={}):b=a.onEnd;let c=new d,e,f,g,h=()=>{if(!c.isEmpty()){if(a.writev){let b,d=[];for(;!c.isEmpty();){if((b=c.shift()).error)throw b.error;d.push(b.value)}return{done:b.done,value:d}}let h=c.shift();if(h.error)throw h.error;return h}return g?{done:!0}:new Promise((b,c)=>{f=d=>(f=null,d.error?c(d.error):a.writev&&!d.done?b({done:d.done,value:[d.value]}):b(d),e)})},i=a=>f?f(a):(c.push(a),e),j=a=>(c=new d,f)?f({error:a}):(c.push({error:a}),e),k=a=>g?e:i({done:!1,value:a}),l=a=>g?e:(g=!0,a?j(a):i({done:!0})),m=()=>(c=new d,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l},!b)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),b&&(b(a),b=null),{done:!0}},return(){return o.return(),b&&(b(),b=null),{done:!0}},push:k,end(a){return o.end(a),b&&(b(a),b=null),e}}}},84810:function(a,b,c){"use strict";let d=c(78165);async function*e(a,b=1){for await(let c of d(a,b)){let e=c.map(a=>a().then(a=>({ok:!0,value:a}),a=>({ok:!1,err:a})));for(let f=0;f<e.length;f++){let g=await e[f];if(g.ok)yield g.value;else throw g.err}}}a.exports=e},58869:function(a,b,c){"use strict";let d=c(1590),e=c(17187).EventEmitter;async function*f(a,b={}){let c=b.concurrency||1/0;c<1&&(c=1/0);let f=null!=b.ordered&&b.ordered,g=new e,h=[],i=d(),j=d(),k=!1,l,m=!1;function n(){return f?Boolean(h[0]&&h[0].done):Boolean(h.find(a=>a.done))}function*o(){for(;h.length&&h[0].done;){let a=h[0];if(h.shift(),a.ok)yield a.value;else throw m=!0,i.resolve(),a.err;i.resolve()}}function*p(){for(;n();)for(let a=0;a<h.length;a++)if(h[a].done){let b=h[a];if(h.splice(a,1),a--,b.ok)yield b.value;else throw m=!0,i.resolve(),b.err;i.resolve()}}for(g.on("task-complete",()=>{j.resolve()}),Promise.resolve().then(async()=>{try{for await(let b of a){if(h.length===c&&await (i=d()).promise,m)break;let e={done:!1};h.push(e),b().then(a=>{e.done=!0,e.ok=!0,e.value=a,g.emit("task-complete")},a=>{e.done=!0,e.err=a,g.emit("task-complete")})}k=!0,g.emit("task-complete")}catch(f){l=f,g.emit("task-complete")}});;){if(n()||await (j=d()).promise,l)throw l;if(f?yield*o():yield*p(),k&&0===h.length)break}}a.exports=f},1590:function(a){"use strict";let b=()=>{let a={};return a.promise=new Promise((b,c)=>{a.resolve=b,a.reject=c}),a};a.exports=b},28132:function(a){"use strict";function b(a){let[b,c]=a[Symbol.asyncIterator]?[a[Symbol.asyncIterator](),Symbol.asyncIterator]:[a[Symbol.iterator](),Symbol.iterator],d=[];return{peek:()=>b.next(),push:a=>{d.push(a)},next:()=>d.length?{done:!1,value:d.shift()}:b.next(),[c](){return this}}}a.exports=b},97515:function(a,b,c){"use strict";let d=c(31303),e=async function*(a,b){let c=await d(a);yield*c.sort(b)};a.exports=e},37939:function(a){"use strict";let b=async function*(a,b){let c=0;if(!(b<1)){for await(let d of a)if(yield d,++c===b)return}};a.exports=b},33053:function(a,b,c){"use strict";let{concat:d}=c(20605);async function e(a){let b=new Uint8Array(0);for await(let c of a)b=d([b,c],b.length+c.length);return b}a.exports=e},44874:function(a){a.exports=b;function b(a,b,c){var d,e;if(!a)return c;if(Array.isArray(b)&&(d=b.slice(0)),"string"==typeof b&&(d=b.split(".")),"symbol"==typeof b&&(d=[b]),!Array.isArray(d))throw Error("props arg must be an array, a string or a symbol");for(;d.length;)if(e=d.shift(),!a|| void 0===(a=a[e]))return c;return a}},99507:function(a,b,c){"use strict";let d=c(61798),{EventEmitter:e}=c(17187);function f(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;for(let c=0,d=a.length;c<d;++c)if(a[c]!==b[c])return!1;return!0}function g(){return{contacts:[],dontSplit:!1,left:null,right:null}}function h(a,b){if(!(b instanceof Uint8Array))throw TypeError(a+" is not a Uint8Array")}class i extends e{constructor(a={}){super(),this.localNodeId=a.localNodeId||d(20),this.numberOfNodesPerKBucket=a.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=a.numberOfNodesToPing||3,this.distance=a.distance||i.distance,this.arbiter=a.arbiter||i.arbiter,this.metadata=Object.assign({},a.metadata),h("option.localNodeId as parameter 1",this.localNodeId),this.root=g()}static arbiter(a,b){return a.vectorClock>b.vectorClock?a:b}static distance(a,b){let c=0,d=0,e=Math.min(a.length,b.length),f=Math.max(a.length,b.length);for(;d<e;++d)c=256*c+(a[d]^b[d]);for(;d<f;++d)c=256*c+255;return c}add(a){h("contact.id",(a||{}).id);let b=0,c=this.root;for(;null===c.contacts;)c=this._determineNode(c,a.id,b++);let d=this._indexOf(c,a.id);return d>=0?(this._update(c,d,a),this):c.contacts.length<this.numberOfNodesPerKBucket?(c.contacts.push(a),this.emit("added",a),this):c.dontSplit?(this.emit("ping",c.contacts.slice(0,this.numberOfNodesToPing),a),this):(this._split(c,b),this.add(a))}closest(a,b=1/0){if(h("id",a),!Number.isInteger(b)&&b!==1/0||b<=0)throw TypeError("n is not positive number");let c=[];for(let d=[this.root],e=0;d.length>0&&c.length<b;){let f=d.pop();if(null===f.contacts){let g=this._determineNode(f,a,e++);d.push(f.left===g?f.right:f.left),d.push(g)}else c=c.concat(f.contacts)}return c.map(b=>[this.distance(b.id,a),b]).sort((a,b)=>a[0]-b[0]).slice(0,b).map(a=>a[1])}count(){let a=0;for(let b=[this.root];b.length>0;){let c=b.pop();null===c.contacts?b.push(c.right,c.left):a+=c.contacts.length}return a}_determineNode(a,b,c){let d=c>>3,e=c%8;if(b.length<=d&&0!==e)return a.left;let f=b[d];return f&1<<7-e?a.right:a.left}get(a){h("id",a);let b=0,c=this.root;for(;null===c.contacts;)c=this._determineNode(c,a,b++);let d=this._indexOf(c,a);return d>=0?c.contacts[d]:null}_indexOf(a,b){for(let c=0;c<a.contacts.length;++c)if(f(a.contacts[c].id,b))return c;return -1}remove(a){h("the id as parameter 1",a);let b=0,c=this.root;for(;null===c.contacts;)c=this._determineNode(c,a,b++);let d=this._indexOf(c,a);if(d>=0){let e=c.contacts.splice(d,1)[0];this.emit("removed",e)}return this}_split(a,b){for(let c of(a.left=g(),a.right=g(),a.contacts))this._determineNode(a,c.id,b).contacts.push(c);a.contacts=null;let d=this._determineNode(a,this.localNodeId,b),e=a.left===d?a.right:a.left;e.dontSplit=!0}toArray(){let a=[];for(let b=[this.root];b.length>0;){let c=b.pop();null===c.contacts?b.push(c.right,c.left):a=a.concat(c.contacts)}return a}*toIterable(){for(let a=[this.root];a.length>0;){let b=a.pop();null===b.contacts?a.push(b.right,b.left):yield*b.contacts}}_update(a,b,c){if(!f(a.contacts[b].id,c.id))throw Error("wrong index for _update");let d=a.contacts[b],e=this.arbiter(d,c);(e!==d||d===c)&&(a.contacts.splice(b,1),a.contacts.push(e),this.emit("updated",d,e))}}a.exports=i},84124:function(a,b,c){"use strict";let d=c(964),e=new Set(["lt","gt","lte","gte"]);function f(a){if(!(this instanceof f))return new f(a);this.opts=a||{},this.encodings=d}a.exports=f,f.prototype._encoding=function(a){return"string"==typeof a&&(a=d[a]),a||(a=d.id),a},f.prototype._keyEncoding=function(a,b){return this._encoding(b&&b.keyEncoding||a&&a.keyEncoding||this.opts.keyEncoding)},f.prototype._valueEncoding=function(a,b){return this._encoding(b&&(b.valueEncoding||b.encoding)||a&&(a.valueEncoding||a.encoding)||this.opts.valueEncoding||this.opts.encoding)},f.prototype.encodeKey=function(a,b,c){return this._keyEncoding(b,c).encode(a)},f.prototype.encodeValue=function(a,b,c){return this._valueEncoding(b,c).encode(a)},f.prototype.decodeKey=function(a,b){return this._keyEncoding(b).decode(a)},f.prototype.decodeValue=function(a,b){return this._valueEncoding(b).decode(a)},f.prototype.encodeBatch=function(a,b){return a.map(a=>{let c={type:a.type,key:this.encodeKey(a.key,b,a)};return this.keyAsBuffer(b,a)&&(c.keyEncoding="binary"),a.prefix&&(c.prefix=a.prefix),"value"in a&&(c.value=this.encodeValue(a.value,b,a),this.valueAsBuffer(b,a)&&(c.valueEncoding="binary")),c})},f.prototype.encodeLtgt=function(a){let b={};for(let c of Object.keys(a)){if("start"===c||"end"===c)throw Error('Legacy range options ("start" and "end") have been removed');b[c]=e.has(c)?this.encodeKey(a[c],a):a[c]}return b},f.prototype.createStreamDecoder=function(a){return a.keys&&a.values?(b,c)=>({key:this.decodeKey(b,a),value:this.decodeValue(c,a)}):a.keys?b=>this.decodeKey(b,a):a.values?(b,c)=>this.decodeValue(c,a):function(){}},f.prototype.keyAsBuffer=function(a){return this._keyEncoding(a).buffer},f.prototype.valueAsBuffer=function(a){return this._valueEncoding(a).buffer}},964:function(a,b,c){"use strict";let{Buffer:d}=c(48764);b.utf8=b["utf-8"]={encode:function(a){return h(a)?a:String(a)},decode:g,buffer:!1,type:"utf8"},b.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},b.binary={encode:function(a){return h(a)?a:d.from(a)},decode:g,buffer:!0,type:"binary"},b.none={encode:g,decode:g,buffer:!1,type:"id"},b.id=b.none;let e=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let f of e)b[f]={encode:function(a){return h(a)?a:d.from(a,f)},decode:function(a){return a.toString(f)},buffer:!0,type:f};function g(a){return a}function h(a){return null==a||d.isBuffer(a)}},56604:function(a){"use strict";function b(a,b){let c=function(b,d){if("object"==typeof b&&null!==b&&(d=d||b,b=b.message||b.name),b=b||"","object"==typeof(d=d||void 0)&&d.type===a&&d.message===b)return d;Object.defineProperty(this,"type",{value:a,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:a,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:d,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:b,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,c)};return c.prototype=new b,c}let c=b("LevelUPError",Error);a.exports={LevelUPError:c,InitializationError:b("InitializationError",c),OpenError:b("OpenError",c),ReadError:b("ReadError",c),WriteError:b("WriteError",c),NotFoundError:b("NotFoundError",c),EncodingError:b("EncodingError",c)},a.exports.NotFoundError.prototype.notFound=!0,a.exports.NotFoundError.prototype.status=404},3462:function(a,b,c){"use strict";let d=c(35717),{Readable:e}=c(88473);function f(a,b){if(!(this instanceof f))return new f(a,b);b=b||{},e.call(this,Object.assign({},b,{objectMode:!0})),this._iterator=a,this._options=b,this.on("end",this.destroy.bind(this,null,null))}a.exports=f,d(f,e),f.prototype._read=function(){this.destroyed||this._iterator.next((a,b,c)=>{if(!this.destroyed){if(a)return this.destroy(a);void 0===b&& void 0===c?this.push(null):!1!==this._options.keys&& !1===this._options.values?this.push(b):!1===this._options.keys&& !1!==this._options.values?this.push(c):this.push({key:b,value:c})}})},f.prototype._destroy=function(a,b){this._iterator.end(function(c){b(a||c)})}},99558:function(a,b,c){"use strict";a.exports=n;let d=c(24012).AbstractLevelDOWN,e=c(35717),f=c(29967),g=c(43016),h=c(55568),i=c(38450),j=c(71228),k=c(82854),l=c(78950),m="level-js-";function n(a,b){if(!(this instanceof n))return new n(a,b);if(d.call(this,{bufferKeys:j.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),b=b||{},"string"!=typeof a)throw Error("constructor requires a location string argument");this.location=a,this.prefix=null==b.prefix?m:b.prefix,this.version=parseInt(b.version||1,10)}e(n,d),n.prototype.type="level-js",n.prototype._open=function(a,b){let c=indexedDB.open(this.prefix+this.location,this.version);c.onerror=function(){b(c.error||Error("unknown error"))},c.onsuccess=()=>{this.db=c.result,b()},c.onupgradeneeded=a=>{let b=a.target.result;b.objectStoreNames.contains(this.location)||b.createObjectStore(this.location)}},n.prototype.store=function(a){let b=this.db.transaction([this.location],a);return b.objectStore(this.location)},n.prototype.await=function(a,b){let c=a.transaction;c.onabort=function(){b(c.error||Error("aborted by user"))},c.oncomplete=function(){b(null,a.result)}},n.prototype._get=function(a,b,c){let d=this.store("readonly"),e;try{e=d.get(a)}catch(f){return this._nextTick(c,f)}this.await(e,function(a,d){return a?c(a):void 0===d?c(Error("NotFound")):void c(null,i(d,b.asBuffer))})},n.prototype._getMany=function(a,b,c){let d=b.asBuffer,e=this.store("readonly"),g=a.map(a=>b=>{let c;try{c=e.get(a)}catch(f){return b(f)}c.onsuccess=()=>{let a=c.result;b(null,void 0===a?a:i(a,d))},c.onerror=a=>{a.stopPropagation(),b(c.error)}});f(g,16,c)},n.prototype._del=function(a,b,c){let d=this.store("readwrite"),e;try{e=d.delete(a)}catch(f){return this._nextTick(c,f)}this.await(e,c)},n.prototype._put=function(a,b,c,d){let e=this.store("readwrite"),f;try{f=e.put(b,a)}catch(g){return this._nextTick(d,g)}this.await(f,d)},n.prototype._serializeKey=function(a){return h(a,this.supports.bufferKeys)},n.prototype._serializeValue=function(a){return h(a,!0)},n.prototype._iterator=function(a){return new g(this,this.location,a)},n.prototype._batch=function(a,b,c){if(0===a.length)return this._nextTick(c);let d=this.store("readwrite"),e=d.transaction,f=0,g;function h(){let b=a[f++],c=b.key,i;try{i="del"===b.type?d.delete(c):d.put(b.value,c)}catch(j){g=j,e.abort();return}f<a.length&&(i.onsuccess=h)}e.onabort=function(){c(g||e.error||Error("aborted by user"))},e.oncomplete=function(){c()},h()},n.prototype._clear=function(a,b){let c,d;try{c=l(a)}catch(e){return this._nextTick(b)}if(a.limit>=0)return k(this,this.location,c,a,b);try{let f=this.store("readwrite");d=c?f.delete(c):f.clear()}catch(g){return this._nextTick(b,g)}this.await(d,b)},n.prototype._close=function(a){this.db.close(),this._nextTick(a)},n.prototype.upgrade=function(a){if("open"!==this.status)return this._nextTick(a,Error("cannot upgrade() before open()"));let b=this.iterator(),c={},d=this;function e(a){if(a)return g(a);b.next(f)}function f(a,b,f){if(a|| void 0===b)return g(a);let h=d._serializeKey(i(b,!0)),j=d._serializeValue(i(f,!0));d._batch([{type:"del",key:b},{type:"put",key:h,value:j}],c,e)}function g(c){b.end(function(b){a(c||b)})}function h(a){return a}b._deserializeKey=b._deserializeValue=h,e()},n.destroy=function(a,b,c){"function"==typeof b&&(c=b,b=m);let d=indexedDB.deleteDatabase(b+a);d.onsuccess=function(){c()},d.onerror=function(a){c(a)}}},43016:function(a,b,c){"use strict";let d=c(35717),e=c(24012).AbstractIterator,f=c(78950),g=c(38450),h=function(){};function i(a,b,c){if(e.call(this,a),this._limit=c.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=c.keys,this._values=c.values,this._keyAsBuffer=c.keyAsBuffer,this._valueAsBuffer=c.valueAsBuffer,0===this._limit){this._completed=!0;return}let d;try{d=f(c)}catch(g){this._completed=!0;return}this.createIterator(b,d,c.reverse)}a.exports=i,d(i,e),i.prototype.createIterator=function(a,b,c){let d=this.db.db.transaction([a],"readonly"),e=d.objectStore(a),f=e.openCursor(b,c?"prev":"next");f.onsuccess=a=>{let b=a.target.result;b&&this.onItem(b)},this._transaction=d,d.onabort=()=>{this.onAbort(this._transaction.error||Error("aborted by user"))},d.oncomplete=()=>{this.onComplete()}},i.prototype.onItem=function(a){this._cache.push(a.key,a.value),(this._limit<=0|| ++this._count<this._limit)&&a.continue(),this.maybeNext()},i.prototype.onAbort=function(a){this._aborted=!0,this._error=a,this.maybeNext()},i.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},i.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},i.prototype._next=function(a){if(this._aborted){let b=this._error;this._error=null,this._nextTick(a,b)}else if(this._cache.length>0){let c=this._cache.shift(),d=this._cache.shift();c=this._keys&& void 0!==c?this._deserializeKey(c,this._keyAsBuffer):void 0,d=this._values&& void 0!==d?this._deserializeValue(d,this._valueAsBuffer):void 0,this._nextTick(a,null,c,d)}else this._completed?this._nextTick(a):this._callback=a},i.prototype._deserializeKey=g,i.prototype._deserializeValue=g,i.prototype._end=function(a){if(this._aborted||this._completed)return this._nextTick(a,this._error);this.onItem=h,this.onAbort=a,this.onComplete=a}},82854:function(a){"use strict";a.exports=function(a,b,c,d,e){if(0===d.limit)return a._nextTick(e);let f=a.db.transaction([b],"readwrite"),g=f.objectStore(b),h=0;f.oncomplete=function(){e()},f.onabort=function(){e(f.error||Error("aborted by user"))};let i=g.openKeyCursor?"openKeyCursor":"openCursor",j=d.reverse?"prev":"next";g[i](c,j).onsuccess=function(a){let b=a.target.result;b&&(g.delete(b.key).onsuccess=function(){(d.limit<=0|| ++h<d.limit)&&b.continue()})}}},38450:function(a,b,c){"use strict";let d=c(48764).Buffer,e=function(){if(!c.g.TextDecoder)return function(a){return g(a).toString()};{let a=new TextDecoder("utf-8");return a.decode.bind(a)}}(),f=function(){if(!c.g.TextDecoder)return function(a){return d.from(a).toString()};{let a=new TextDecoder("utf-8");return a.decode.bind(a)}}();function g(a){let b=d.from(a.buffer);return a.byteLength===a.buffer.byteLength?b:b.slice(a.byteOffset,a.byteOffset+a.byteLength)}a.exports=function(a,b){return a instanceof Uint8Array?b?g(a):e(a):a instanceof ArrayBuffer?b?d.from(a):f(a):b?d.from(String(a)):String(a)}},78950:function(a,b,c){"use strict";let d=c(82303),e=Symbol("none");a.exports=function(a){let b=d.lowerBound(a,e),c=d.upperBound(a,e),f=d.lowerBoundExclusive(a,e),g=d.upperBoundExclusive(a,e);return b!==e&&c!==e?IDBKeyRange.bound(b,c,f,g):b!==e?IDBKeyRange.lowerBound(b,f):c!==e?IDBKeyRange.upperBound(c,g):null}},55568:function(a,b,c){"use strict";let d=c(48764).Buffer,e=function(){if(!c.g.TextEncoder)return d.from;{let a=new TextEncoder("utf-8");return a.encode.bind(a)}}();a.exports=function(a,b){return b?d.isBuffer(a)?a:e(String(a)):String(a)}},71228:function(a,b,c){"use strict";let d=c(48764).Buffer;b.test=function(a){return function(b){try{return b.cmp(a,0),!0}catch(c){return!1}}},b.bufferKeys=b.test(d.alloc(0))},82147:function(a,b,c){"use strict";let d=c(34918),e=c(50780);function f(a){function b(b,f,g){return"function"==typeof b?g=b:"function"==typeof f&&(g=f),c(f)||(f=c(b)?b:{}),d(e(a(b,f),f),f,g)}function c(a){return"object"==typeof a&&null!==a}for(let f of["destroy","repair"])"function"==typeof a[f]&&(b[f]=function(...b){a[f](...b)});return b.errors=d.errors,b}a.exports=f},51675:function(a){"use strict";function b(a){return!!a&&Object.assign({},a)}a.exports=function(...a){let c=a.reduce((a,b)=>Object.assign(a,b),{});return Object.assign(c,{bufferKeys:c.bufferKeys||!1,snapshots:c.snapshots||!1,permanence:c.permanence||!1,seek:c.seek||!1,clear:c.clear||!1,getMany:c.getMany||!1,keyIterator:c.keyIterator||!1,valueIterator:c.valueIterator||!1,iteratorNextv:c.iteratorNextv||!1,iteratorAll:c.iteratorAll||!1,status:c.status||!1,idempotentOpen:c.idempotentOpen||!1,passiveOpen:c.passiveOpen||!1,serialize:c.serialize||!1,createIfMissing:c.createIfMissing||!1,errorIfExists:c.errorIfExists||!1,deferredOpen:c.deferredOpen||!1,openCallback:c.openCallback||!1,promises:c.promises||!1,streams:c.streams||!1,encodings:b(c.encodings),events:b(c.events),additionalMethods:Object.assign({},c.additionalMethods)})}},63145:function(a,b,c){a.exports=c(82147)(c(99558))},48133:function(a,b,c){"use strict";let d=c(56604).WriteError,e=c(16957),f=c(52369).R,g=c(52369).F;function h(a){this.db=a,this.batch=a.db.batch(),this.ops=[],this.length=0}h.prototype.put=function(a,b,c){try{this.batch.put(a,b,c)}catch(e){throw new d(e)}return this.ops.push({...c,type:"put",key:a,value:b}),this.length++,this},h.prototype.del=function(a,b){try{this.batch.del(a,b)}catch(c){throw new d(c)}return this.ops.push({...b,type:"del",key:a}),this.length++,this},h.prototype.clear=function(){try{this.batch.clear()}catch(a){throw new d(a)}return this.ops=[],this.length=0,this},h.prototype.write=function(a,b){let c=this.db,h=this.ops;b=f(a,b),b=e.fromCallback(b),a=g(a);try{this.batch.write(a,function(a){if(a)return b(new d(a));c.emit("batch",h),b()})}catch(i){throw new d(i)}return b.promise},a.exports=h},52369:function(a,b){"use strict";b.R=function(a,b){return"function"==typeof a?a:b},b.F=function(a){return"object"==typeof a&&null!==a?a:{}}},34918:function(a,b,c){"use strict";let d=c(17187).EventEmitter,e=c(79720).inherits,f=c(66944),g=c(3462),h=c(48133),i=c(56604),j=c(51675),k=c(16957),l=c(52369).R,m=c(52369).F,n=c(69350),o=i.WriteError,p=i.ReadError,q=i.NotFoundError,r=i.OpenError,s=i.InitializationError;function t(a,b,c){if(!(this instanceof t))return new t(a,b,c);let e;if(d.call(this),this.setMaxListeners(1/0),"function"==typeof b&&(c=b,b={}),b=b||{},!a||"object"!=typeof a){if(e=new s("First argument must be an abstract-leveldown compliant store"),"function"==typeof c)return n(c,e);throw e}if("string"!=typeof a.status)throw Error(".status required, old abstract-leveldown");for(let f of(this.options=m(b),this._db=a,this.db=null,this.open(c||(a=>{a&&this.emit("error",a)})),this.supports=j(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0}),Object.keys(this.supports.additionalMethods)))null==this[f]&&(this[f]=function(...a){return this.db[f](...a)})}function u(a,b){return!a.isOperational()&&(n(b,new p("Database is not open")),!0)}t.prototype.emit=d.prototype.emit,t.prototype.once=d.prototype.once,e(t,d),Object.defineProperty(t.prototype,"status",{enumerable:!0,get(){return this.db.status}}),t.prototype.isOperational=function(){return"open"===this.db.status||"opening"===this.db.status},t.prototype.open=function(a,b){return("function"==typeof a&&(b=a,a=null),b=k.fromCallback(b),a||(a=this.options),this.db&&this.isOpen())?(n(b,null,this),b.promise):this.db&&this._isOpening()?(this.once("open",()=>{b(null,this)}),b.promise):(this.db=new f(this._db),this.emit("opening"),this.db.open(a,a=>{if(a)return b(new r(a));this.db=this._db,b(null,this),this.emit("open"),this.emit("ready")}),b.promise)},t.prototype.close=function(a){return a=k.fromCallback(a),this.isOpen()?(this.db.close((b,...c)=>{this.emit("closed"),a(b,...c)}),this.emit("closing")):this.isClosed()?n(a):"closing"===this.db.status?this.once("closed",a):this._isOpening()&&this.once("open",()=>{this.close(a)}),a.promise},t.prototype.isOpen=function(){return"open"===this.db.status},t.prototype._isOpening=function(){return"opening"===this.db.status},t.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},t.prototype.get=function(a,b,c){return c=l(b,c),u(this,c=k.fromCallback(c))||(b=m(b),this.db.get(a,b,function(b,d){if(b)return c(b=/notfound/i.test(b)||b.notFound?new q("Key not found in database ["+a+"]",b):new p(b));c(null,d)})),c.promise},t.prototype.getMany=function(a,b,c){return this.db.getMany(a,b,c)},t.prototype.put=function(a,b,c,d){return d=l(c,d),u(this,d=k.fromCallback(d))||(c=m(c),this.db.put(a,b,c,c=>{if(c)return d(new o(c));this.emit("put",a,b),d()})),d.promise},t.prototype.del=function(a,b,c){return c=l(b,c),u(this,c=k.fromCallback(c))||(b=m(b),this.db.del(a,b,b=>{if(b)return c(new o(b));this.emit("del",a),c()})),c.promise},t.prototype.batch=function(a,b,c){return arguments.length?(c="function"==typeof a?a:l(b,c),u(this,c=k.fromCallback(c))||(b=m(b),this.db.batch(a,b,b=>{if(b)return c(new o(b));this.emit("batch",a),c()})),c.promise):new h(this)},t.prototype.iterator=function(a){return this.db.iterator(a)},t.prototype.clear=function(a,b){return b=l(a,b),a=m(a),u(this,b=k.fromCallback(b))||this.db.clear(a,c=>{if(c)return b(new o(c));this.emit("clear",a),b()}),b.promise},t.prototype.readStream=t.prototype.createReadStream=function(a){return"number"!=typeof(a=Object.assign({keys:!0,values:!0},a)).limit&&(a.limit=-1),new g(this.db.iterator(a),a)},t.prototype.keyStream=t.prototype.createKeyStream=function(a){return this.createReadStream(Object.assign({},a,{keys:!0,values:!1}))},t.prototype.valueStream=t.prototype.createValueStream=function(a){return this.createReadStream(Object.assign({},a,{keys:!1,values:!0}))},t.prototype.toString=function(){return"LevelUP"},t.prototype.type="levelup",t.prototype._nextTick=n,t.errors=i,a.exports=t},69350:function(a,b,c){"use strict";let d=c(54375);a.exports=function(a,...b){0===b.length?d(a):d(()=>a(...b))}},82303:function(a,b,c){var d=c(48764).Buffer;function e(a){return void 0!==a&&""!==a}function f(a,b){return Object.hasOwnProperty.call(a,b)}function g(a,b){return Object.hasOwnProperty.call(a,b)&&b}b.compare=function(a,b){if(d.isBuffer(a)){for(var c=Math.min(a.length,b.length),e=0;e<c;e++){var f=a[e]-b[e];if(f)return f}return a.length-b.length}return a<b?-1:a>b?1:0};var h=b.lowerBoundKey=function(a){return g(a,"gt")||g(a,"gte")||g(a,"min")||(a.reverse?g(a,"end"):g(a,"start"))||void 0},i=b.lowerBound=function(a,b){var c=h(a);return c?a[c]:b},j=b.lowerBoundInclusive=function(a){return!f(a,"gt")},k=b.upperBoundInclusive=function(a){return!f(a,"lt")},l=b.lowerBoundExclusive=function(a){return!j(a)},m=b.upperBoundExclusive=function(a){return!k(a)},n=b.upperBoundKey=function(a){return g(a,"lt")||g(a,"lte")||g(a,"max")||(a.reverse?g(a,"start"):g(a,"end"))||void 0},o=b.upperBound=function(a,b){var c=n(a);return c?a[c]:b};function p(a){return a}b.start=function(a,b){return a.reverse?o(a,b):i(a,b)},b.end=function(a,b){return a.reverse?i(a,b):o(a,b)},b.startInclusive=function(a){return a.reverse?k(a):j(a)},b.endInclusive=function(a){return a.reverse?j(a):k(a)},b.toLtgt=function(a,c,d,e,g){c=c||{},d=d||p;var h=arguments.length>3,i=b.lowerBoundKey(a),j=b.upperBoundKey(a);return i?"gt"===i?c.gt=d(a.gt,!1):c.gte=d(a[i],!1):h&&(c.gte=d(e,!1)),j?"lt"===j?c.lt=d(a.lt,!0):c.lte=d(a[j],!0):h&&(c.lte=d(g,!0)),null!=a.reverse&&(c.reverse=!!a.reverse),f(c,"max")&&delete c.max,f(c,"min")&&delete c.min,f(c,"start")&&delete c.start,f(c,"end")&&delete c.end,c},b.contains=function(a,c,d){d=d||b.compare;var f=i(a);if(e(f)){var g=d(c,f);if(g<0||0===g&&l(a))return!1}var h=o(a);if(e(h)){var g=d(c,h);if(g>0||0===g&&m(a))return!1}return!0},b.filter=function(a,c){return function(d){return b.contains(a,d,c)}}},29175:function(a,b,c){"use strict";let{Multiaddr:d}=c(46584),e=E("dns4"),f=E("dns6"),g=E("dnsaddr"),h=D(E("dns"),g,e,f),i=D(E("ip4"),E("ip6")),j=D(C(i,E("tcp")),C(h,E("tcp"))),k=C(i,E("udp")),l=C(k,E("utp")),m=C(k,E("quic")),n=D(C(j,E("ws")),C(h,E("ws"))),o=D(C(j,E("wss")),C(h,E("wss"))),p=D(C(j,E("http")),C(i,E("http")),C(h,E("http"))),q=D(C(j,E("https")),C(i,E("https")),C(h,E("https"))),r=D(C(n,E("p2p-webrtc-star"),E("p2p")),C(o,E("p2p-webrtc-star"),E("p2p")),C(n,E("p2p-webrtc-star")),C(o,E("p2p-webrtc-star"))),s=D(C(n,E("p2p-websocket-star"),E("p2p")),C(o,E("p2p-websocket-star"),E("p2p")),C(n,E("p2p-websocket-star")),C(o,E("p2p-websocket-star"))),t=D(C(p,E("p2p-webrtc-direct"),E("p2p")),C(q,E("p2p-webrtc-direct"),E("p2p")),C(p,E("p2p-webrtc-direct")),C(q,E("p2p-webrtc-direct"))),u=D(n,o,p,q,r,t,j,l,m,h),v=D(C(u,E("p2p-stardust"),E("p2p")),C(u,E("p2p-stardust"))),w=D(C(u,E("p2p")),r,t,E("p2p")),x=D(C(w,E("p2p-circuit"),w),C(w,E("p2p-circuit")),C(E("p2p-circuit"),w),C(u,E("p2p-circuit")),C(E("p2p-circuit"),u),E("p2p-circuit")),y=()=>D(C(x,y),x),z=y(),A=D(C(z,w,z),C(w,z),C(z,w),z,w);function B(a){function b(b){if(!d.isMultiaddr(b))try{b=new d(b)}catch(c){return!1}let e=a(b.protoNames());return null!==e&&(!0===e|| !1===e?e:0===e.length)}return b}function C(...a){function b(b){if(b.length<a.length)return null;let c=b;return a.some(a=>(Array.isArray(c="function"==typeof a?a().partialMatch(b):a.partialMatch(b))&&(b=c),null===c)),c}return{toString:function(){return"{ "+a.join(" ")+" }"},input:a,matches:B(b),partialMatch:b}}function D(...a){function b(b){let c=null;return a.some(a=>{let d="function"==typeof a?a().partialMatch(b):a.partialMatch(b);return!!d&&(c=d,!0)}),c}let c={toString:function(){return"{ "+a.join(" ")+" }"},input:a,matches:B(b),partialMatch:b};return c}function E(a){let b=a;function c(a){let c;if("string"==typeof a||a instanceof Uint8Array)try{c=new d(a)}catch(e){return!1}else c=a;let f=c.protoNames();return 1===f.length&&f[0]===b}function e(a){return 0===a.length?null:a[0]===b?a.slice(1):null}return{toString:function(){return b},matches:c,partialMatch:e}}a.exports={DNS:h,DNS4:e,DNS6:f,DNSADDR:g,IP:i,TCP:j,UDP:k,QUIC:m,UTP:l,HTTP:p,HTTPS:q,WebSockets:n,WebSocketsSecure:o,WebSocketStar:s,WebRTCStar:r,WebRTCDirect:t,Reliable:u,Stardust:v,Circuit:z,P2P:A,IPFS:A}},70942:function(a,b,c){"use strict";let d=c(33310),{hasOwnProperty:e}=Object.prototype,{propertyIsEnumerable:f}=Object,g=(a,b,c)=>Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0}),h=this,i={concatArrays:!1,ignoreUndefined:!1},j=a=>{let b=[];for(let c in a)e.call(a,c)&&b.push(c);if(Object.getOwnPropertySymbols){let d=Object.getOwnPropertySymbols(a);for(let g of d)f.call(a,g)&&b.push(g)}return b};function k(a){return Array.isArray(a)?l(a):d(a)?m(a):a}function l(a){let b=a.slice(0,0);return j(a).forEach(c=>{g(b,c,k(a[c]))}),b}function m(a){let b=null===Object.getPrototypeOf(a)?Object.create(null):{};return j(a).forEach(c=>{g(b,c,k(a[c]))}),b}let n=(a,b,c,d)=>(c.forEach(c=>{(void 0!==b[c]||!d.ignoreUndefined)&&(c in a&&a[c]!==Object.getPrototypeOf(a)?g(a,c,p(a[c],b[c],d)):g(a,c,k(b[c])))}),a),o=(a,b,c)=>{let d=a.slice(0,0),f=0;return[a,b].forEach(b=>{let h=[];for(let i=0;i<b.length;i++)e.call(b,i)&&(h.push(String(i)),b===a?g(d,f++,b[i]):g(d,f++,k(b[i])));d=n(d,b,j(b).filter(a=>!h.includes(a)),c)}),d};function p(a,b,c){return c.concatArrays&&Array.isArray(a)&&Array.isArray(b)?o(a,b,c):d(b)&&d(a)?n(a,b,j(b),c):k(b)}a.exports=function(...a){let b=p(k(i),this!==h&&this||{},i),c={_:{}};for(let e of a)if(void 0!==e){if(!d(e))throw TypeError("`"+e+"` is not an Option Object");c=p(c,{_:e},b)}return c._}},57824:function(a){var b=1e3,c=60*b,d=60*c,e=24*d,f=7*e,g=365.25*e;function h(a){if(!((a=String(a)).length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(h){var i=parseFloat(h[1]),j=(h[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return i*g;case"weeks":case"week":case"w":return i*f;case"days":case"day":case"d":return i*e;case"hours":case"hour":case"hrs":case"hr":case"h":return i*d;case"minutes":case"minute":case"mins":case"min":case"m":return i*c;case"seconds":case"second":case"secs":case"sec":case"s":return i*b;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function i(a){var f=Math.abs(a);return f>=e?Math.round(a/e)+"d":f>=d?Math.round(a/d)+"h":f>=c?Math.round(a/c)+"m":f>=b?Math.round(a/b)+"s":a+"ms"}function j(a){var f=Math.abs(a);return f>=e?k(a,f,e,"day"):f>=d?k(a,f,d,"hour"):f>=c?k(a,f,c,"minute"):f>=b?k(a,f,b,"second"):a+" ms"}function k(a,b,c,d){var e=b>=1.5*c;return Math.round(a/c)+" "+d+(e?"s":"")}a.exports=function(a,b){b=b||{};var c=typeof a;if("string"===c&&a.length>0)return h(a);if("number"===c&&isFinite(a))return b.long?j(a):i(a);throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},65381:function(a){"use strict";let b="[a-fA-F\\d:]",c=a=>a&&a.includeBoundaries?`(?:(?<=\\s|^)(?=${b})|(?<=${b})(?=\\s|$))`:"",d="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",e="[a-fA-F\\d]{1,4}",f=`
(?:
(?:${e}:){7}(?:${e}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${e}:){6}(?:${d}|:${e}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${e}:){5}(?::${d}|(?::${e}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${e}:){4}(?:(?::${e}){0,1}:${d}|(?::${e}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${e}:){3}(?:(?::${e}){0,2}:${d}|(?::${e}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${e}:){2}(?:(?::${e}){0,3}:${d}|(?::${e}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${e}:){1}(?:(?::${e}){0,4}:${d}|(?::${e}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${e}){0,5}:${d}|(?::${e}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),g=RegExp(`(?:^${d}$)|(?:^${f}$)`),h=RegExp(`^${d}$`),i=RegExp(`^${f}$`),j=a=>a&&a.exact?g:RegExp(`(?:${c(a)}${d}${c(a)})|(?:${c(a)}${f}${c(a)})`,"g");j.v4=a=>a&&a.exact?h:RegExp(`${c(a)}${d}${c(a)}`,"g"),j.v6=a=>a&&a.exact?i:RegExp(`${c(a)}${f}${c(a)}`,"g"),a.exports=j},87602:function(a,b,c){"use strict";let d=c(65381),e=a=>d({exact:!0}).test(a);e.v4=a=>d.v4({exact:!0}).test(a),e.v6=a=>d.v6({exact:!0}).test(a),e.version=a=>e(a)?e.v4(a)?4:6:void 0,a.exports=e},18190:function(a,b,c){"use strict";let d=c(99918),e=c(89768),f=c(94676),{concat:g}=c(20605),{toString:h}=c(92263);function i(a){let b=[],c=a.split("/").slice(1);if(1===c.length&&""===c[0])return[];for(let d=0;d<c.length;d++){let f=c[d],g=e(f);if(0===g.size){b.push([f]);continue}if(++d>=c.length)throw w("invalid address: "+a);if(g.path){b.push([f,v(c.slice(d).join("/"))]);break}b.push([f,c[d]])}return b}function j(a){let b=[];return a.map(a=>{let c=x(a);return b.push(c.name),a.length>1&&b.push(a[1]),null}),v(b.join("/"))}function k(a){return a.map(a=>{Array.isArray(a)||(a=[a]);let b=x(a);return a.length>1?[b.code,d.toBytes(b.code,a[1])]:[b.code]})}function l(a){return a.map(a=>{let b=x(a);return a[1]?[b.code,d.toString(b.code,a[1])]:[b.code]})}function m(a){return s(g(a.map(a=>{let b=x(a),c=Uint8Array.from(f.encode(b.code));return a.length>1&&(c=g([c,a[1]])),c})))}function n(a,b){if(a.size>0)return a.size/8;if(0===a.size)return 0;{let c=f.decode(b);return c+f.decode.bytes}}function o(a){let b=[],c=0;for(;c<a.length;){let d=f.decode(a,c),g=f.decode.bytes,i=e(d),j=n(i,a.slice(c+g));if(0===j){b.push([d]),c+=g;continue}let k=a.slice(c+g,c+g+j);if((c+=j+g)>a.length)throw w("Invalid address Uint8Array: "+h(a,"base16"));b.push([d,k])}return b}function p(a){let b=o(a),c=l(b);return j(c)}function q(a){a=v(a);let b=i(a),c=k(b);return m(c)}function r(a){return q(a)}function s(a){let b=t(a);if(b)throw b;return Uint8Array.from(a)}function t(a){try{o(a)}catch(b){return b}}function u(a){return void 0===t(a)}function v(a){return"/"+a.trim().split("/").filter(a=>a).join("/")}function w(a){return Error("Error parsing address: "+a)}function x(a){let b=e(a[0]);return b}a.exports={stringToStringTuples:i,stringTuplesToString:j,tuplesToStringTuples:l,stringTuplesToTuples:k,bytesToTuples:o,tuplesToBytes:m,bytesToString:p,stringToBytes:q,fromString:r,fromBytes:s,validateBytes:t,isValidBytes:u,cleanPath:v,ParseError:w,protoFromTuple:x,sizeForAddr:n}},99918:function(a,b,c){"use strict";let d=c(33692),e=c(89768),{CID:f}=c(81362),{base32:g}=c(22817),{base58btc:h}=c(99086),i=c(28924),j=c(94676),{toString:k}=c(92263),{fromString:l}=c(52217),{concat:m}=c(20605);function n(a,b){return b instanceof Uint8Array?n.toString(a,b):n.toBytes(a,b)}function o(a){if(!d.isIP(a))throw Error("invalid ip address");return d.toBytes(a)}function p(a){let b=d.toString(a);if(!b||!d.isIP(b))throw Error("invalid ip address");return b}function q(a){let b=new ArrayBuffer(2),c=new DataView(b);return c.setUint16(0,a),new Uint8Array(b)}function r(a){let b=new DataView(a.buffer);return b.getUint16(a.byteOffset)}function s(a){let b=l(a),c=Uint8Array.from(j.encode(b.length));return m([c,b],c.length+b.length)}function t(a){let b=j.decode(a);if((a=a.slice(j.decode.bytes)).length!==b)throw Error("inconsistent lengths");return k(a)}function u(a){let b;b="Q"===a[0]||"1"===a[0]?i.decode(h.decode(`z${a}`)).bytes:f.parse(a).multihash.bytes;let c=Uint8Array.from(j.encode(b.length));return m([c,b],c.length+b.length)}function v(a){let b=j.decode(a),c=a.slice(j.decode.bytes);if(c.length!==b)throw Error("inconsistent lengths");return k(c,"base58btc")}function w(a){let b=a.split(":");if(2!==b.length)throw Error("failed to parse onion addr: "+b+" does not contain a port number");if(16!==b[0].length)throw Error("failed to parse onion addr: "+b[0]+" not a Tor onion address.");let c=g.decode("b"+b[0]),d=parseInt(b[1],10);if(d<1||d>65536)throw Error("Port number is not in range(1, 65536)");let e=q(d);return m([c,e],c.length+e.length)}function x(a){let b=a.split(":");if(2!==b.length)throw Error("failed to parse onion addr: "+b+" does not contain a port number");if(56!==b[0].length)throw Error("failed to parse onion addr: "+b[0]+" not a Tor onion3 address.");let c=g.decode("b"+b[0]),d=parseInt(b[1],10);if(d<1||d>65536)throw Error("Port number is not in range(1, 65536)");let e=q(d);return m([c,e],c.length+e.length)}function y(a){let b=a.slice(0,a.length-2),c=a.slice(a.length-2),d=k(b,"base32"),e=r(c);return d+":"+e}a.exports=n,n.toString=function(a,b){let c=e(a);switch(c.code){case 4:case 41:return p(b);case 6:case 273:case 33:case 132:return r(b).toString();case 53:case 54:case 55:case 56:case 400:case 777:return t(b);case 421:return v(b);case 444:case 445:return y(b);default:return k(b,"base16")}},n.toBytes=function(a,b){let c=e(a);switch(c.code){case 4:case 41:return o(b);case 6:case 273:case 33:case 132:return q(parseInt(b,10));case 53:case 54:case 55:case 56:case 400:case 777:return s(b);case 421:return u(b);case 444:return w(b);case 445:return x(b);default:return l(b,"base16")}}},46584:function(a,b,c){"use strict";let d=c(18190),e=c(89768),f=c(94676),{CID:g}=c(81362),{base58btc:h}=c(99086),i=c(32114),j=Symbol.for("nodejs.util.inspect.custom"),{toString:k}=c(92263),{equals:l}=c(19588),m=new Map,n=Symbol.for("@multiformats/js-multiaddr/multiaddr");class o{constructor(a){if(null==a&&(a=""),Object.defineProperty(this,n,{value:!0}),a instanceof Uint8Array)this.bytes=d.fromBytes(a);else if("string"==typeof a){if(a.length>0&&"/"!==a.charAt(0))throw Error(`multiaddr "${a}" must start with a "/"`);this.bytes=d.fromString(a)}else if(o.isMultiaddr(a))this.bytes=d.fromBytes(a.bytes);else throw Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return d.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let a={},b=this.toString().split("/");return a.family="ip4"===b[1]?4:6,a.host=b[2],a.transport=b[3],a.port=parseInt(b[4]),a}protos(){return this.protoCodes().map(a=>Object.assign({},e(a)))}protoCodes(){let a=[],b=this.bytes,c=0;for(;c<b.length;){let g=f.decode(b,c),h=f.decode.bytes,i=e(g),j=d.sizeForAddr(i,b.slice(c+h));c+=j+h,a.push(g)}return a}protoNames(){return this.protos().map(a=>a.name)}tuples(){return d.bytesToTuples(this.bytes)}stringTuples(){let a=d.bytesToTuples(this.bytes);return d.tuplesToStringTuples(a)}encapsulate(a){return a=new o(a),new o(this.toString()+a.toString())}decapsulate(a){let b=a.toString(),c=this.toString(),d=c.lastIndexOf(b);if(d<0)throw Error("Address "+this+" does not contain subaddress: "+a);return new o(c.slice(0,d))}decapsulateCode(a){let b=this.tuples();for(let c=b.length-1;c>=0;c--)if(b[c][0]===a)return new o(d.tuplesToBytes(b.slice(0,c)));return this}getPeerId(){try{let a=this.stringTuples().filter(a=>a[0]===e.names.ipfs.code),b=a.pop();if(b&&b[1]){let c=b[1];if("Q"===c[0]||"1"===c[0])return k(h.decode(`z${c}`),"base58btc");return k(g.parse(c).multihash.bytes,"base58btc")}return null}catch(d){return null}}getPath(){let a=null;try{(a=this.stringTuples().filter(a=>{let b=e(a[0]);return!!b.path})[0][1])||(a=null)}catch(b){a=null}return a}equals(a){return l(this.bytes,a.bytes)}async resolve(){let a=this.protos().find(a=>a.resolvable);if(!a)return[this];let b=m.get(a.name);if(!b)throw i(Error(`no available resolver for ${a.name}`),"ERR_NO_AVAILABLE_RESOLVER");let c=await b(this);return c.map(a=>new o(a))}nodeAddress(){let a=this.protoCodes(),b=this.protoNames(),c=this.toString().split("/").slice(1);if(c.length<4)throw Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(4!==a[0]&&41!==a[0]&&54!==a[0]&&55!==a[0])throw Error(`no protocol with name: "'${b[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if("tcp"!==c[2]&&"udp"!==c[2])throw Error(`no protocol with name: "'${b[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:41===a[0]||55===a[0]?6:4,address:c[1],port:parseInt(c[3])}}isThinWaistAddress(a){let b=(a||this).protos();return 2===b.length&&(4===b[0].code||41===b[0].code)&&(6===b[1].code||273===b[1].code)}static fromNodeAddress(a,b){if(!a)throw Error("requires node address object");if(!b)throw Error("requires transport protocol");let c;switch(a.family){case 4:c="ip4";break;case 6:c="ip6";break;default:throw Error(`Invalid addr family. Got '${a.family}' instead of 4 or 6`)}return new o("/"+[c,a.address,b,a.port].join("/"))}static isName(a){return!!o.isMultiaddr(a)&&a.protos().some(a=>a.resolvable)}static isMultiaddr(a){return a instanceof o||Boolean(a&&a[n])}[j](){return"<Multiaddr "+k(this.bytes,"base16")+" - "+d.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+k(this.bytes,"base16")+" - "+d.bytesToString(this.bytes)+">"}}function p(a){return new o(a)}o.protocols=e,o.resolvers=m,a.exports={Multiaddr:o,multiaddr:p,protocols:e,resolvers:m}},33692:function(a,b,c){"use strict";let d=c(87602),{toString:e}=c(92263),f=d,g=d.v4,h=d.v6,i=function(a,b,c){c=~~c;let d;if(g(a))d=b||new Uint8Array(c+4),a.split(/\./g).map(function(a){d[c++]=255&parseInt(a,10)});else if(h(a)){let f=a.split(":",8),j;for(j=0;j<f.length;j++){let k=g(f[j]),l;k&&(l=i(f[j]),f[j]=e(l.slice(0,2),"base16")),l&& ++j<8&&f.splice(j,0,e(l.slice(2,4),"base16"))}if(""===f[0])for(;f.length<8;)f.unshift("0");else if(""===f[f.length-1])for(;f.length<8;)f.push("0");else if(f.length<8){for(j=0;j<f.length&&""!==f[j];j++);let m=[j,"1"];for(j=9-f.length;j>0;j--)m.push("0");f.splice.apply(f,m)}for(j=0,d=b||new Uint8Array(c+16);j<f.length;j++){let n=parseInt(f[j],16);d[c++]=n>>8&255,d[c++]=255&n}}if(!d)throw Error("Invalid ip address: "+a);return d},j=function(a,b,c){b=~~b,c=c||a.length-b;let d=[],e,f=new DataView(a.buffer);if(4===c){for(let g=0;g<c;g++)d.push(a[b+g]);e=d.join(".")}else if(16===c){for(let h=0;h<c;h+=2)d.push(f.getUint16(b+h).toString(16));e=(e=(e=d.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return e};a.exports={isIP:f,isV4:g,isV6:h,toBytes:i,toString:j}},89768:function(a){"use strict";function b(a){if("number"==typeof a){if(b.codes[a])return b.codes[a];throw Error("no protocol with code: "+a)}if("string"==typeof a){if(b.names[a])return b.names[a];throw Error("no protocol with name: "+a)}throw Error("invalid protocol id type: "+a)}let c=-1;function d(a,b,c,d,e){return{code:a,size:b,name:c,resolvable:Boolean(d),path:Boolean(e)}}b.lengthPrefixedVarSize=c,b.V=c,b.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,c,"ip6zone"],[53,c,"dns","resolvable"],[54,c,"dns4","resolvable"],[55,c,"dns6","resolvable"],[56,c,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,c,"unix",!1,"path"],[421,c,"ipfs"],[421,c,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,c,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,c,"memory"]],b.names={},b.codes={},b.table.map(a=>{let c=d.apply(null,a);return b.codes[c.code]=c,b.names[c.name]=c,null}),b.object=d,a.exports=b},40469:function(a,b,c){a.exports=c(18027)},18027:function(a,b){!function(c,d){"use strict";var e={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function f(a){if(!Array.isArray(a)&&!ArrayBuffer.isView(a))return!1;for(var b=0;b<a.length;b++)if(!Number.isInteger(a[b])||a[b]<0||a[b]>255)return!1;return!0}function g(a,b){return(65535&a)*b+(((a>>>16)*b&65535)<<16)}function h(a,b){return a<<b|a>>>32-b}function i(a){return a^=a>>>16,a=g(a,2246822507),a^=a>>>13,a=g(a,3266489909),a^=a>>>16}function j(a,b){a=[a[0]>>>16,65535&a[0],a[1]>>>16,65535&a[1]],b=[b[0]>>>16,65535&b[0],b[1]>>>16,65535&b[1]];var c=[0,0,0,0];return c[3]+=a[3]+b[3],c[2]+=c[3]>>>16,c[3]&=65535,c[2]+=a[2]+b[2],c[1]+=c[2]>>>16,c[2]&=65535,c[1]+=a[1]+b[1],c[0]+=c[1]>>>16,c[1]&=65535,c[0]+=a[0]+b[0],c[0]&=65535,[c[0]<<16|c[1],c[2]<<16|c[3]]}function k(a,b){a=[a[0]>>>16,65535&a[0],a[1]>>>16,65535&a[1]],b=[b[0]>>>16,65535&b[0],b[1]>>>16,65535&b[1]];var c=[0,0,0,0];return c[3]+=a[3]*b[3],c[2]+=c[3]>>>16,c[3]&=65535,c[2]+=a[2]*b[3],c[1]+=c[2]>>>16,c[2]&=65535,c[2]+=a[3]*b[2],c[1]+=c[2]>>>16,c[2]&=65535,c[1]+=a[1]*b[3],c[0]+=c[1]>>>16,c[1]&=65535,c[1]+=a[2]*b[2],c[0]+=c[1]>>>16,c[1]&=65535,c[1]+=a[3]*b[1],c[0]+=c[1]>>>16,c[1]&=65535,c[0]+=a[0]*b[3]+a[1]*b[2]+a[2]*b[1]+a[3]*b[0],c[0]&=65535,[c[0]<<16|c[1],c[2]<<16|c[3]]}function l(a,b){return 32==(b%=64)?[a[1],a[0]]:b<32?[a[0]<<b|a[1]>>>32-b,a[1]<<b|a[0]>>>32-b]:(b-=32,[a[1]<<b|a[0]>>>32-b,a[0]<<b|a[1]>>>32-b])}function m(a,b){return 0==(b%=64)?a:b<32?[a[0]<<b|a[1]>>>32-b,a[1]<<b]:[a[1]<<b-32,0]}function n(a,b){return[a[0]^b[0],a[1]^b[1]]}function o(a){return a=k(a=n(a,[0,a[0]>>>1]),[4283543511,3981806797]),a=n(a,[0,a[0]>>>1]),a=k(a,[3301882366,444984403]),a=n(a,[0,a[0]>>>1])}e.x86.hash32=function(a,b){if(!e.inputValidation||f(a)){b=b||0;for(var c=a.length%4,d=a.length-c,j=b,k=0,l=3432918353,m=461845907,n=0;n<d;n+=4)k=h(k=g(k=a[n]|a[n+1]<<8|a[n+2]<<16|a[n+3]<<24,l),15),k=g(k,m),j^=k,j=h(j,13),j=g(j,5)+3864292196;switch(k=0,c){case 3:k^=a[n+2]<<16;case 2:k^=a[n+1]<<8;case 1:k^=a[n],k=h(k=g(k,l),15),k=g(k,m),j^=k}return j^=a.length,(j=i(j))>>>0}},e.x86.hash128=function(a,b){if(!e.inputValidation||f(a)){b=b||0;for(var c=a.length%16,d=a.length-c,j=b,k=b,l=b,m=b,n=0,o=0,p=0,q=0,r=597399067,s=2869860233,t=951274213,u=2716044179,v=0;v<d;v+=16)n=a[v]|a[v+1]<<8|a[v+2]<<16|a[v+3]<<24,o=a[v+4]|a[v+5]<<8|a[v+6]<<16|a[v+7]<<24,p=a[v+8]|a[v+9]<<8|a[v+10]<<16|a[v+11]<<24,q=a[v+12]|a[v+13]<<8|a[v+14]<<16|a[v+15]<<24,n=g(n,r),n=h(n,15),n=g(n,s),j^=n,j=h(j,19),j+=k,j=g(j,5)+1444728091,o=g(o,s),o=h(o,16),o=g(o,t),k^=o,k=h(k,17),k+=l,k=g(k,5)+197830471,p=g(p,t),p=h(p,17),p=g(p,u),l^=p,l=h(l,15),l+=m,l=g(l,5)+2530024501,q=g(q,u),q=h(q,18),q=g(q,r),m^=q,m=h(m,13),m+=j,m=g(m,5)+850148119;switch(n=0,o=0,p=0,q=0,c){case 15:q^=a[v+14]<<16;case 14:q^=a[v+13]<<8;case 13:q^=a[v+12],q=h(q=g(q,u),18),q=g(q,r),m^=q;case 12:p^=a[v+11]<<24;case 11:p^=a[v+10]<<16;case 10:p^=a[v+9]<<8;case 9:p^=a[v+8],p=h(p=g(p,t),17),p=g(p,u),l^=p;case 8:o^=a[v+7]<<24;case 7:o^=a[v+6]<<16;case 6:o^=a[v+5]<<8;case 5:o^=a[v+4],o=h(o=g(o,s),16),o=g(o,t),k^=o;case 4:n^=a[v+3]<<24;case 3:n^=a[v+2]<<16;case 2:n^=a[v+1]<<8;case 1:n^=a[v],n=h(n=g(n,r),15),n=g(n,s),j^=n}return j^=a.length,k^=a.length,l^=a.length,m^=a.length,j+=k,j+=l,j+=m,k+=j,l+=j,m+=j,j=i(j),k=i(k),l=i(l),m=i(m),j+=k,j+=l,j+=m,k+=j,l+=j,m+=j,("00000000"+(j>>>0).toString(16)).slice(-8)+("00000000"+(k>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(m>>>0).toString(16)).slice(-8)}},e.x64.hash128=function(a,b){if(!e.inputValidation||f(a)){b=b||0;for(var c=a.length%16,d=a.length-c,g=[0,b],h=[0,b],i=[0,0],p=[0,0],q=[2277735313,289559509],r=[1291169091,658871167],s=0;s<d;s+=16)i=[a[s+4]|a[s+5]<<8|a[s+6]<<16|a[s+7]<<24,a[s]|a[s+1]<<8|a[s+2]<<16|a[s+3]<<24],p=[a[s+12]|a[s+13]<<8|a[s+14]<<16|a[s+15]<<24,a[s+8]|a[s+9]<<8|a[s+10]<<16|a[s+11]<<24],i=k(i,q),i=l(i,31),i=k(i,r),g=n(g,i),g=l(g,27),g=j(g,h),g=j(k(g,[0,5]),[0,1390208809]),p=k(p,r),p=l(p,33),p=k(p,q),h=n(h,p),h=l(h,31),h=j(h,g),h=j(k(h,[0,5]),[0,944331445]);switch(i=[0,0],p=[0,0],c){case 15:p=n(p,m([0,a[s+14]],48));case 14:p=n(p,m([0,a[s+13]],40));case 13:p=n(p,m([0,a[s+12]],32));case 12:p=n(p,m([0,a[s+11]],24));case 11:p=n(p,m([0,a[s+10]],16));case 10:p=n(p,m([0,a[s+9]],8));case 9:p=l(p=k(p=n(p,[0,a[s+8]]),r),33),p=k(p,q),h=n(h,p);case 8:i=n(i,m([0,a[s+7]],56));case 7:i=n(i,m([0,a[s+6]],48));case 6:i=n(i,m([0,a[s+5]],40));case 5:i=n(i,m([0,a[s+4]],32));case 4:i=n(i,m([0,a[s+3]],24));case 3:i=n(i,m([0,a[s+2]],16));case 2:i=n(i,m([0,a[s+1]],8));case 1:i=l(i=k(i=n(i,[0,a[s]]),q),31),i=k(i,r),g=n(g,i)}return g=n(g,[0,a.length]),h=n(h,[0,a.length]),g=j(g,h),h=j(h,g),g=o(g),h=o(h),g=j(g,h),h=j(h,g),("00000000"+(g[0]>>>0).toString(16)).slice(-8)+("00000000"+(g[1]>>>0).toString(16)).slice(-8)+("00000000"+(h[0]>>>0).toString(16)).slice(-8)+("00000000"+(h[1]>>>0).toString(16)).slice(-8)}},a.exports&&(b=a.exports=e),b.murmurHash3=e}(this)},99633:function(a){"use strict";function b(a){if(!Array.isArray(a))return Array.from(a);for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}a.exports=function(a){var c=void 0,d=void 0;function e(a){if(!(a instanceof Object))throw Error('Target "'+a+'" is not an object');d=a}function f(a){Object.keys(a).forEach(function(b){var c=a[b];if("function"!=typeof c)throw Error('Trap "'+b+": "+c+'" is not a function');if(!Reflect[b])throw Error('Trap "'+b+": "+c+'" is not a valid trap')}),c=a}e(function(){}),a&&e(a),f(Reflect);var g=new Proxy({},{get:function(a,e){return function(){for(var a=arguments.length,f=Array(a),g=0;g<a;g++)f[g]=arguments[g];return c[e].apply(null,[d].concat(b(f.slice(1))))}}});return{setTarget:e,setHandler:f,getTarget:function(){return d},getHandler:function(){return c},proxy:new Proxy(d,g)}}},28951:function(a,b){(function(){var a,c,d,e,f,g,h,i;i=function(a){var b,c,d,e;return b=(-16777216&a)>>>24,c=(16711680&a)>>>16,d=(65280&a)>>>8,e=255&a,[b,c,d,e].join(".")},h=function(a){var b,d,e,f,g,h;for(b=[],e=f=0;f<=3&&0!==a.length;e=++f){if(e>0){if("."!==a[0])throw Error("Invalid IP");a=a.substring(1)}g=(h=c(a))[0],d=h[1],a=a.substring(d),b.push(g)}if(0!==a.length)throw Error("Invalid IP");switch(b.length){case 1:if(b[0]>4294967295)throw Error("Invalid IP");return b[0]>>>0;case 2:if(b[0]>255||b[1]>16777215)throw Error("Invalid IP");return(b[0]<<24|b[1])>>>0;case 3:if(b[0]>255||b[1]>255||b[2]>65535)throw Error("Invalid IP");return(b[0]<<24|b[1]<<16|b[2])>>>0;case 4:if(b[0]>255||b[1]>255||b[2]>255||b[3]>255)throw Error("Invalid IP");return(b[0]<<24|b[1]<<16|b[2]<<8|b[3])>>>0;default:throw Error("Invalid IP")}},e=(d=function(a){return a.charCodeAt(0)})("0"),g=d("a"),f=d("A"),c=function(a){var b,c,h,i,j;for(i=0,b=10,c="9",h=0,a.length>1&&"0"===a[h]&&("x"===a[h+1]||"X"===a[h+1]?(h+=2,b=16):"0"<=a[h+1]&&a[h+1]<="9"&&(h++,b=8,c="7")),j=h;h<a.length;){if("0"<=a[h]&&a[h]<=c)i=i*b+(d(a[h])-e)>>>0;else if(16===b){if("a"<=a[h]&&a[h]<="f")i=i*b+(10+d(a[h])-g)>>>0;else if("A"<=a[h]&&a[h]<="F")i=i*b+(10+d(a[h])-f)>>>0;else break}else break;if(i>4294967295)throw Error("too large");h++}if(h===j)throw Error("empty octet");return[i,h]},a=function(){function a(a,b){var c,d,e,f;if("string"!=typeof a)throw Error("Missing `net' parameter");if(b||(a=(f=a.split("/",2))[0],b=f[1]),b||(b=32),"string"==typeof b&&b.indexOf(".")> -1){try{this.maskLong=h(b)}catch(g){throw c=g,Error("Invalid mask: "+b)}for(d=e=32;e>=0;d=--e)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(b||0===b)this.bitmask=parseInt(b,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw Error("Invalid mask: empty");try{this.netLong=(h(a)&this.maskLong)>>>0}catch(j){throw c=j,Error("Invalid net address: "+a)}if(!(this.bitmask<=32))throw Error("Invalid mask for ip4: "+b);this.size=Math.pow(2,32-this.bitmask),this.base=i(this.netLong),this.mask=i(this.maskLong),this.hostmask=i(~this.maskLong),this.first=this.bitmask<=30?i(this.netLong+1):this.base,this.last=this.bitmask<=30?i(this.netLong+this.size-2):i(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?i(this.netLong+this.size-1):void 0}return a.prototype.contains=function(b){return("string"==typeof b&&(b.indexOf("/")>0||4!==b.split(".").length)&&(b=new a(b)),b instanceof a)?this.contains(b.base)&&this.contains(b.broadcast||b.last):(h(b)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},a.prototype.next=function(b){return null==b&&(b=1),new a(i(this.netLong+this.size*b),this.mask)},a.prototype.forEach=function(a){var b,c,d;for(d=h(this.first),c=h(this.last),b=0;d<=c;)a(i(d),d,b),b++,d++},a.prototype.toString=function(){return this.base+"/"+this.bitmask},a}(),b.ip2long=h,b.long2ip=i,b.Netmask=a}).call(this)},83454:function(a,b,c){"use strict";var d,e;a.exports=(null==(d=c.g.process)?void 0:d.env)&&"object"==typeof(null==(e=c.g.process)?void 0:e.env)?c.g.process:c(77663)},77663:function(a){var b="/";!function(){var c={308:function(a){var b,c,d,e=a.exports={};function f(){throw Error("setTimeout has not been defined")}function g(){throw Error("clearTimeout has not been defined")}function h(a){if(b===setTimeout)return setTimeout(a,0);if((b===f||!b)&&setTimeout)return b=setTimeout,setTimeout(a,0);try{return b(a,0)}catch(c){try{return b.call(null,a,0)}catch(d){return b.call(this,a,0)}}}function i(a){if(c===clearTimeout)return clearTimeout(a);if((c===g||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(a);try{return c(a)}catch(b){try{return c.call(null,a)}catch(d){return c.call(this,a)}}}!function(){try{b="function"==typeof setTimeout?setTimeout:f}catch(a){b=f}try{c="function"==typeof clearTimeout?clearTimeout:g}catch(d){c=g}}();var j=[],k=!1,l=-1;function m(){k&&d&&(k=!1,d.length?j=d.concat(j):l=-1,j.length&&n())}function n(){if(!k){var a=h(m);k=!0;for(var b=j.length;b;){for(d=j,j=[];++l<b;)d&&d[l].run();l=-1,b=j.length}d=null,k=!1,i(a)}}function o(a,b){this.fun=a,this.array=b}function p(){}e.nextTick=function(a){var b=Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new o(a,b)),1!==j.length||k||h(n)},o.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.prependListener=p,e.prependOnceListener=p,e.listeners=function(a){return[]},e.binding=function(a){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(a){throw Error("process.chdir is not supported")},e.umask=function(){return 0}}},d={};function e(a){var b=d[a];if(void 0!==b)return b.exports;var f=d[a]={exports:{}},g=!0;try{c[a](f,f.exports,e),g=!1}finally{g&&delete d[a]}return f.exports}e.ab=b+"/";var f=e(308);a.exports=f}()},79720:function(module,__unused_webpack_exports,__webpack_require__){var __dirname="/",Buffer=__webpack_require__(48764).Buffer,process=__webpack_require__(83454);!function(){var r={997:function(a){a.exports=function(a,c,d){if(a.filter)return a.filter(c,d);if(null==a||"function"!=typeof c)throw TypeError();for(var e=[],f=0;f<a.length;f++)if(b.call(a,f)){var g=a[f];c.call(d,g,f,a)&&e.push(g)}return e};var b=Object.prototype.hasOwnProperty},171:function(a,b,c){"use strict";var d=c(627),e=c(302),f=e(d("String.prototype.indexOf"));a.exports=function(a,b){var c=d(a,!!b);return"function"==typeof c&&f(a,".prototype.")> -1?e(c):c}},302:function(a,b,c){"use strict";var d=c(194),e=c(627),f=e("%Function.prototype.apply%"),g=e("%Function.prototype.call%"),h=e("%Reflect.apply%",!0)||d.call(g,f),i=e("%Object.getOwnPropertyDescriptor%",!0),j=e("%Object.defineProperty%",!0),k=e("%Math.max%");if(j)try{j({},"a",{value:1})}catch(l){j=null}a.exports=function(a){var b=h(d,g,arguments);return i&&j&&i(b,"length").configurable&&j(b,"length",{value:1+k(0,a.length-(arguments.length-1))}),b};var m=function(){return h(d,f,arguments)};j?j(a.exports,"apply",{value:m}):a.exports.apply=m},981:function(a){var b=Object.prototype.hasOwnProperty,c=Object.prototype.toString;a.exports=function(a,d,e){if("[object Function]"!==c.call(d))throw TypeError("iterator must be a function");var f=a.length;if(f=== +f)for(var g=0;g<f;g++)d.call(e,a[g],g,a);else for(var h in a)b.call(a,h)&&d.call(e,a[h],h,a)}},861:function(a){"use strict";var b="Function.prototype.bind called on incompatible ",c=Array.prototype.slice,d=Object.prototype.toString,e="[object Function]";a.exports=function(a){var f,g=this;if("function"!=typeof g||d.call(g)!==e)throw TypeError(b+g);for(var h=c.call(arguments,1),i=function(){if(!(this instanceof f))return g.apply(a,h.concat(c.call(arguments)));var b=g.apply(this,h.concat(c.call(arguments)));return Object(b)===b?b:this},j=Math.max(0,g.length-h.length),k=[],l=0;l<j;l++)k.push("$"+l);if(f=Function("binder","return function ("+k.join(",")+"){ return binder.apply(this,arguments); }")(i),g.prototype){var m=function(){};m.prototype=g.prototype,f.prototype=new m,m.prototype=null}return f}},194:function(a,b,c){"use strict";var d=c(861);a.exports=Function.prototype.bind||d},627:function(r,e,t){"use strict";var n,o=SyntaxError,i=Function,a=TypeError,getEvalledConstructor=function(a){try{return i('"use strict"; return ('+a+").constructor;")()}catch(b){}},f=Object.getOwnPropertyDescriptor;if(f)try{f({},"")}catch(r){f=null}var throwTypeError=function(){throw new a},u=f?function(){try{return arguments.callee,throwTypeError}catch(a){try{return f(arguments,"callee").get}catch(b){return throwTypeError}}}():throwTypeError,s=t(567)(),c=Object.getPrototypeOf||function(a){return a.__proto__},y={},p="undefined"==typeof Uint8Array?n:c(Uint8Array),l={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":s?c([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":y,"%AsyncGenerator%":y,"%AsyncGeneratorFunction%":y,"%AsyncIteratorPrototype%":y,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":y,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":s?c(c([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&s?c((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&s?c((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":s?c(""[Symbol.iterator]()):n,"%Symbol%":s?Symbol:n,"%SyntaxError%":o,"%ThrowTypeError%":u,"%TypedArray%":p,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},g=function a(b){var d;if("%AsyncFunction%"===b)d=getEvalledConstructor("async function () {}");else if("%GeneratorFunction%"===b)d=getEvalledConstructor("function* () {}");else if("%AsyncGeneratorFunction%"===b)d=getEvalledConstructor("async function* () {}");else if("%AsyncGenerator%"===b){var e=a("%AsyncGeneratorFunction%");e&&(d=e.prototype)}else if("%AsyncIteratorPrototype%"===b){var f=a("%AsyncGenerator%");f&&(d=c(f.prototype))}return l[b]=d,d},d={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=t(194),b=t(646),A=v.call(Function.call,Array.prototype.concat),m=v.call(Function.apply,Array.prototype.splice),S=v.call(Function.call,String.prototype.replace),h=v.call(Function.call,String.prototype.slice),O=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,w=/\\(\\)?/g,j=function(a){var b=h(a,0,1),c=h(a,-1);if("%"===b&&"%"!==c)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===c&&"%"!==b)throw new o("invalid intrinsic syntax, expected opening `%`");var d=[];return S(a,O,function(a,b,c,e){d[d.length]=c?S(e,w,"$1"):b||a}),d},P=function(c,e){var f,h=c;if(b(d,h)&&(h="%"+(f=d[h])[0]+"%"),b(l,h)){var i=l[h];if(i===y&&(i=g(h)),void 0===i&&!e)throw new a("intrinsic "+c+" exists, but is not available. Please file an issue!");return{alias:f,name:h,value:i}}throw new o("intrinsic "+c+" does not exist!")};r.exports=function(c,d){if("string"!=typeof c||0===c.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof d)throw new a('"allowMissing" argument must be a boolean');var e=j(c),g=e.length>0?e[0]:"",i=P("%"+g+"%",d),k=i.name,n=i.value,p=!1,q=i.alias;q&&(g=q[0],m(e,A([0,1],q)));for(var r=1,s=!0;r<e.length;r+=1){var t=e[r],u=h(t,0,1),v=h(t,-1);if(('"'===u||"'"===u||"`"===u||'"'===v||"'"===v||"`"===v)&&u!==v)throw new o("property names with quotes must have matching quotes");if("constructor"!==t&&s||(p=!0),g+="."+t,b(l,k="%"+g+"%"))n=l[k];else if(null!=n){if(!(t in n)){if(!d)throw new a("base intrinsic for "+c+" exists, but the property is not available.");return}if(f&&r+1>=e.length){var w=f(n,t);n=(s=!!w)&&"get"in w&&!("originalValue"in w.get)?w.get:n[t]}else s=b(n,t),n=n[t];s&&!p&&(l[k]=n)}}return n}},567:function(a,b,c){"use strict";var d="undefined"!=typeof Symbol&&Symbol,e=c(186);a.exports=function(){return"function"==typeof d&&"function"==typeof Symbol&&"symbol"==typeof d("foo")&&"symbol"==typeof Symbol("bar")&&e()}},186:function(a){"use strict";a.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var a={},b=Symbol("test"),c=Object(b);if("string"==typeof b||"[object Symbol]"!==Object.prototype.toString.call(b)||"[object Symbol]"!==Object.prototype.toString.call(c))return!1;var d=42;for(b in a[b]=d,a)return!1;if("function"==typeof Object.keys&&0!==Object.keys(a).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(a).length)return!1;var e=Object.getOwnPropertySymbols(a);if(1!==e.length||e[0]!==b||!Object.prototype.propertyIsEnumerable.call(a,b))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var f=Object.getOwnPropertyDescriptor(a,b);if(f.value!==d|| !0!==f.enumerable)return!1}return!0}},646:function(a,b,c){"use strict";var d=c(194);a.exports=d.call(Function.call,Object.prototype.hasOwnProperty)},140:function(a){"function"==typeof Object.create?a.exports=function(a,b){b&&(a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(a,b){if(b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}}},749:function(a){"use strict";var b="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,c=Object.prototype.toString,d=function(a){return(!b||!a||"object"!=typeof a||!(Symbol.toStringTag in a))&&"[object Arguments]"===c.call(a)},e=function(a){return!!d(a)||null!==a&&"object"==typeof a&&"number"==typeof a.length&&a.length>=0&&"[object Array]"!==c.call(a)&&"[object Function]"===c.call(a.callee)},f=function(){return d(arguments)}();d.isLegacyArguments=e,a.exports=f?d:e},611:function(a){"use strict";var b=Object.prototype.toString,c=Function.prototype.toString,d=/^\s*(?:function)?\*/,e="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,f=Object.getPrototypeOf,g=function(){if(!e)return!1;try{return Function("return function*() {}")()}catch(a){}}(),h=g?f(g):{};a.exports=function(a){return"function"==typeof a&&(!!d.test(c.call(a))||(e?f(a)===h:"[object GeneratorFunction]"===b.call(a)))}},387:function(a,b,c){"use strict";var d=c(981),e=c(382),f=c(171),g=f("Object.prototype.toString"),h=c(567)(),i=h&&"symbol"==typeof Symbol.toStringTag,j=e(),k=f("Array.prototype.indexOf",!0)||function(a,b){for(var c=0;c<a.length;c+=1)if(a[c]===b)return c;return -1},l=f("String.prototype.slice"),m={},n=c(30),o=Object.getPrototypeOf;i&&n&&o&&d(j,function(a){var b=new __webpack_require__.g[a];if(!(Symbol.toStringTag in b))throw EvalError("this engine has support for Symbol.toStringTag, but "+a+" does not have the property! Please report this.");var c=o(b),d=n(c,Symbol.toStringTag);if(!d){var e=o(c);d=n(e,Symbol.toStringTag)}m[a]=d.get});var p=function(a){var b=!1;return d(m,function(c,d){if(!b)try{b=c.call(a)===d}catch(e){}}),b};a.exports=function(a){if(!a||"object"!=typeof a)return!1;if(!i){var b=l(g(a),8,-1);return k(j,b)> -1}return!!n&&p(a)}},913:function(a){a.exports=function(a){return a instanceof Buffer}},989:function(a,b,c){"use strict";var d=c(749),e=c(611),f=c(728),g=c(387);function h(a){return a.call.bind(a)}var i="undefined"!=typeof BigInt,j="undefined"!=typeof Symbol,k=h(Object.prototype.toString),l=h(Number.prototype.valueOf),m=h(String.prototype.valueOf),n=h(Boolean.prototype.valueOf);if(i)var o=h(BigInt.prototype.valueOf);if(j)var p=h(Symbol.prototype.valueOf);function q(a,b){if("object"!=typeof a)return!1;try{return b(a),!0}catch(c){return!1}}function r(a){return"undefined"!=typeof Promise&&a instanceof Promise||null!==a&&"object"==typeof a&&"function"==typeof a.then&&"function"==typeof a.catch}function s(a){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(a):g(a)||P(a)}function t(a){return"Uint8Array"===f(a)}function u(a){return"Uint8ClampedArray"===f(a)}function v(a){return"Uint16Array"===f(a)}function w(a){return"Uint32Array"===f(a)}function x(a){return"Int8Array"===f(a)}function y(a){return"Int16Array"===f(a)}function z(a){return"Int32Array"===f(a)}function A(a){return"Float32Array"===f(a)}function B(a){return"Float64Array"===f(a)}function C(a){return"BigInt64Array"===f(a)}function D(a){return"BigUint64Array"===f(a)}function E(a){return"[object Map]"===k(a)}function F(a){return"undefined"!=typeof Map&&(E.working?E(a):a instanceof Map)}function G(a){return"[object Set]"===k(a)}function H(a){return"undefined"!=typeof Set&&(G.working?G(a):a instanceof Set)}function I(a){return"[object WeakMap]"===k(a)}function J(a){return"undefined"!=typeof WeakMap&&(I.working?I(a):a instanceof WeakMap)}function K(a){return"[object WeakSet]"===k(a)}function L(a){return K(a)}function M(a){return"[object ArrayBuffer]"===k(a)}function N(a){return"undefined"!=typeof ArrayBuffer&&(M.working?M(a):a instanceof ArrayBuffer)}function O(a){return"[object DataView]"===k(a)}function P(a){return"undefined"!=typeof DataView&&(O.working?O(a):a instanceof DataView)}b.isArgumentsObject=d,b.isGeneratorFunction=e,b.isTypedArray=g,b.isPromise=r,b.isArrayBufferView=s,b.isUint8Array=t,b.isUint8ClampedArray=u,b.isUint16Array=v,b.isUint32Array=w,b.isInt8Array=x,b.isInt16Array=y,b.isInt32Array=z,b.isFloat32Array=A,b.isFloat64Array=B,b.isBigInt64Array=C,b.isBigUint64Array=D,E.working="undefined"!=typeof Map&&E(new Map),b.isMap=F,G.working="undefined"!=typeof Set&&G(new Set),b.isSet=H,I.working="undefined"!=typeof WeakMap&&I(new WeakMap),b.isWeakMap=J,K.working="undefined"!=typeof WeakSet&&K(new WeakSet),b.isWeakSet=L,M.working="undefined"!=typeof ArrayBuffer&&M(new ArrayBuffer),b.isArrayBuffer=N,O.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&O(new DataView(new ArrayBuffer(1),0,1)),b.isDataView=P;var Q="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function R(a){return"[object SharedArrayBuffer]"===k(a)}function S(a){return void 0!==Q&&(void 0===R.working&&(R.working=R(new Q)),R.working?R(a):a instanceof Q)}function T(a){return"[object AsyncFunction]"===k(a)}function U(a){return"[object Map Iterator]"===k(a)}function V(a){return"[object Set Iterator]"===k(a)}function W(a){return"[object Generator]"===k(a)}function X(a){return"[object WebAssembly.Module]"===k(a)}function Y(a){return q(a,l)}function Z(a){return q(a,m)}function $(a){return q(a,n)}function _(a){return i&&q(a,o)}function aa(a){return j&&q(a,p)}function ab(a){return Y(a)||Z(a)||$(a)||_(a)||aa(a)}function ac(a){return"undefined"!=typeof Uint8Array&&(N(a)||S(a))}b.isSharedArrayBuffer=S,b.isAsyncFunction=T,b.isMapIterator=U,b.isSetIterator=V,b.isGeneratorObject=W,b.isWebAssemblyCompiledModule=X,b.isNumberObject=Y,b.isStringObject=Z,b.isBooleanObject=$,b.isBigIntObject=_,b.isSymbolObject=aa,b.isBoxedPrimitive=ab,b.isAnyArrayBuffer=ac,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(a){Object.defineProperty(b,a,{enumerable:!1,value:function(){throw Error(a+" is not supported in userland")}})})},467:function(a,b,c){var d=Object.getOwnPropertyDescriptors||function(a){for(var b=Object.keys(a),c={},d=0;d<b.length;d++)c[b[d]]=Object.getOwnPropertyDescriptor(a,b[d]);return c},e=/%[sdj%]/g;b.format=function(a){if(!x(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(i(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(e,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])u(h)||!B(h)?g+=" "+h:g+=" "+i(h);return g},b.deprecate=function(a,c){if(void 0!==process&& !0===process.noDeprecation)return a;if(void 0===process)return function(){return b.deprecate(a,c).apply(this,arguments)};var d=!1;function e(){if(!d){if(process.throwDeprecation)throw Error(c);process.traceDeprecation?console.trace(c):console.error(c),d=!0}return a.apply(this,arguments)}return e};var f={},g=/^$/;if(process.env.NODE_DEBUG){var h=process.env.NODE_DEBUG;g=RegExp("^"+(h=h.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase())+"$","i")}function i(a,c){var d={seen:[],stylize:k};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),t(c)?d.showHidden=c:c&&b._extend(d,c),z(d.showHidden)&&(d.showHidden=!1),z(d.depth)&&(d.depth=2),z(d.colors)&&(d.colors=!1),z(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=j),m(d,a,d.depth)}function j(a,b){var c=i.styles[b];return c?"\x1b["+i.colors[c][0]+"m"+a+"\x1b["+i.colors[c][1]+"m":a}function k(a,b){return a}function l(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function m(a,c,d){if(a.customInspect&&c&&E(c.inspect)&&c.inspect!==b.inspect&&!(c.constructor&&c.constructor.prototype===c)){var e,f=c.inspect(d,a);return x(f)||(f=m(a,f,d)),f}var g=n(a,c);if(g)return g;var h=Object.keys(c),i=l(h);if(a.showHidden&&(h=Object.getOwnPropertyNames(c)),D(c)&&(h.indexOf("message")>=0||h.indexOf("description")>=0))return o(c);if(0===h.length){if(E(c)){var j=c.name?": "+c.name:"";return a.stylize("[Function"+j+"]","special")}if(A(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(C(c))return a.stylize(Date.prototype.toString.call(c),"date");if(D(c))return o(c)}var k="",t=!1,u=["{","}"];return(s(c)&&(t=!0,u=["[","]"]),E(c)&&(k=" [Function"+(c.name?": "+c.name:"")+"]"),A(c)&&(k=" "+RegExp.prototype.toString.call(c)),C(c)&&(k=" "+Date.prototype.toUTCString.call(c)),D(c)&&(k=" "+o(c)),0!==h.length||t&&0!=c.length)?d<0?A(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special"):(a.seen.push(c),e=t?p(a,c,d,i,h):h.map(function(b){return q(a,c,d,i,b,t)}),a.seen.pop(),r(e,k,u)):u[0]+k+u[1]}function n(a,b){if(z(b))return a.stylize("undefined","undefined");if(x(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return w(b)?a.stylize(""+b,"number"):t(b)?a.stylize(""+b,"boolean"):u(b)?a.stylize("null","null"):void 0}function o(a){return"["+Error.prototype.toString.call(a)+"]"}function p(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)K(b,String(g))?f.push(q(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(q(a,b,c,d,e,!0))}),f}function q(a,b,c,d,e,f){var g,h,i;if((i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]}).get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),K(d,e)||(g="["+e+"]"),!h&&(0>a.seen.indexOf(i.value)?(h=u(c)?m(a,i.value,null):m(a,i.value,c-1)).indexOf("\n")> -1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n")):h=a.stylize("[Circular]","special")),z(g)){if(f&&e.match(/^\d+$/))return h;(g=JSON.stringify(""+e)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function r(a,b,c){var d=0;return a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function s(a){return Array.isArray(a)}function t(a){return"boolean"==typeof a}function u(a){return null===a}function v(a){return null==a}function w(a){return"number"==typeof a}function x(a){return"string"==typeof a}function y(a){return"symbol"==typeof a}function z(a){return void 0===a}function A(a){return B(a)&&"[object RegExp]"===G(a)}function B(a){return"object"==typeof a&&null!==a}function C(a){return B(a)&&"[object Date]"===G(a)}function D(a){return B(a)&&("[object Error]"===G(a)||a instanceof Error)}function E(a){return"function"==typeof a}function F(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a|| void 0===a}function G(a){return Object.prototype.toString.call(a)}function H(a){return a<10?"0"+a.toString(10):a.toString(10)}b.debuglog=function(a){if(!f[a=a.toUpperCase()]){if(g.test(a)){var c=process.pid;f[a]=function(){var d=b.format.apply(b,arguments);console.error("%s %d: %s",a,c,d)}}else f[a]=function(){}}return f[a]},b.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},b.types=c(989),b.isArray=s,b.isBoolean=t,b.isNull=u,b.isNullOrUndefined=v,b.isNumber=w,b.isString=x,b.isSymbol=y,b.isUndefined=z,b.isRegExp=A,b.types.isRegExp=A,b.isObject=B,b.isDate=C,b.types.isDate=C,b.isError=D,b.types.isNativeError=D,b.isFunction=E,b.isPrimitive=F,b.isBuffer=c(913);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var a=new Date,b=[H(a.getHours()),H(a.getMinutes()),H(a.getSeconds())].join(":");return[a.getDate(),I[a.getMonth()],b].join(" ")}function K(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.log=function(){console.log("%s - %s",J(),b.format.apply(b,arguments))},b.inherits=c(140),b._extend=function(a,b){if(!b||!B(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a};var L="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function M(a,b){if(!a){var c=Error("Promise was rejected with a falsy value");c.reason=a,a=c}return b(a)}function N(a){if("function"!=typeof a)throw TypeError('The "original" argument must be of type Function');function b(){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c]);var d=b.pop();if("function"!=typeof d)throw TypeError("The last argument must be of type Function");var e=this,f=function(){return d.apply(e,arguments)};a.apply(this,b).then(function(a){process.nextTick(f.bind(null,null,a))},function(a){process.nextTick(M.bind(null,a,f))})}return Object.setPrototypeOf(b,Object.getPrototypeOf(a)),Object.defineProperties(b,d(a)),b}b.promisify=function(a){if("function"!=typeof a)throw TypeError('The "original" argument must be of type Function');if(L&&a[L]){var b=a[L];if("function"!=typeof b)throw TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(b,L,{value:b,enumerable:!1,writable:!1,configurable:!0}),b}function b(){for(var b,c,d=new Promise(function(a,d){b=a,c=d}),e=[],f=0;f<arguments.length;f++)e.push(arguments[f]);e.push(function(a,d){a?c(a):b(d)});try{a.apply(this,e)}catch(g){c(g)}return d}return Object.setPrototypeOf(b,Object.getPrototypeOf(a)),L&&Object.defineProperty(b,L,{value:b,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(b,d(a))},b.promisify.custom=L,b.callbackify=N},728:function(a,b,c){"use strict";var d=c(981),e=c(382),f=c(171),g=f("Object.prototype.toString"),h=c(567)(),i=h&&"symbol"==typeof Symbol.toStringTag,j=e(),k=f("String.prototype.slice"),l={},m=c(30),n=Object.getPrototypeOf;i&&m&&n&&d(j,function(a){if("function"==typeof __webpack_require__.g[a]){var b=new __webpack_require__.g[a];if(!(Symbol.toStringTag in b))throw EvalError("this engine has support for Symbol.toStringTag, but "+a+" does not have the property! Please report this.");var c=n(b),d=m(c,Symbol.toStringTag);if(!d){var e=n(c);d=m(e,Symbol.toStringTag)}l[a]=d.get}});var o=function(a){var b=!1;return d(l,function(c,d){if(!b)try{var e=c.call(a);e===d&&(b=e)}catch(f){}}),b},p=c(387);a.exports=function(a){return!!p(a)&&(i?o(a):k(g(a),8,-1))}},382:function(a,b,c){"use strict";var d=c(997);a.exports=function(){return d(["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],function(a){return"function"==typeof __webpack_require__.g[a]})}},30:function(a,b,c){"use strict";var d=c(627)("%Object.getOwnPropertyDescriptor%",!0);if(d)try{d([],"length")}catch(e){d=null}a.exports=d}},e={};function __nccwpck_require__(a){var b=e[a];if(void 0!==b)return b.exports;var c=e[a]={exports:{}},d=!0;try{r[a](c,c.exports,__nccwpck_require__),d=!1}finally{d&&delete e[a]}return c.exports}__nccwpck_require__.ab=__dirname+"/";var t=__nccwpck_require__(467);module.exports=t}()},83300:function(a,b){"use strict";var c=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==c)return c;throw Error("unable to locate global object")}();a.exports=b=c.fetch,c.fetch&&(b.default=c.fetch.bind(c)),b.Headers=c.Headers,b.Request=c.Request,b.Response=c.Response},8925:function(a,b,c){var d,e,f,g,h,i=c(3832);function j(a,b){var c=function(){return new i.aes.Algorithm(a,b)};i.cipher.registerAlgorithm(a,c)}c(85649),c(61967),c(97116),a.exports=i.aes=i.aes||{},i.aes.startEncrypting=function(a,b,c,d){var e=p({key:a,output:c,decrypt:!1,mode:d});return e.start(b),e},i.aes.createEncryptionCipher=function(a,b){return p({key:a,output:null,decrypt:!1,mode:b})},i.aes.startDecrypting=function(a,b,c,d){var e=p({key:a,output:c,decrypt:!0,mode:d});return e.start(b),e},i.aes.createDecryptionCipher=function(a,b){return p({key:a,output:null,decrypt:!0,mode:b})},i.aes.Algorithm=function(a,b){k||m();var c=this;c.name=a,c.mode=new b({blockSize:16,cipher:{encrypt:function(a,b){return o(c._w,a,b,!1)},decrypt:function(a,b){return o(c._w,a,b,!0)}}}),c._init=!1},i.aes.Algorithm.prototype.initialize=function(a){if(!this._init){var b,c=a.key;if("string"==typeof c&&(16===c.length||24===c.length||32===c.length))c=i.util.createBuffer(c);else if(i.util.isArray(c)&&(16===c.length||24===c.length||32===c.length)){b=c,c=i.util.createBuffer();for(var d=0;d<b.length;++d)c.putByte(b[d])}if(!i.util.isArray(c)){b=c,c=[];var e=b.length();if(16===e||24===e||32===e){e>>>=2;for(var d=0;d<e;++d)c.push(b.getInt32())}}if(!i.util.isArray(c)||!(4===c.length||6===c.length||8===c.length))throw Error("Invalid key parameter.");var f,g=-1!==["CFB","OFB","CTR","GCM"].indexOf(this.mode.name);this._w=n(c,a.decrypt&&!g),this._init=!0}},i.aes._expandKey=function(a,b){return k||m(),n(a,b)},i.aes._updateBlock=o,j("AES-ECB",i.cipher.modes.ecb),j("AES-CBC",i.cipher.modes.cbc),j("AES-CFB",i.cipher.modes.cfb),j("AES-OFB",i.cipher.modes.ofb),j("AES-CTR",i.cipher.modes.ctr),j("AES-GCM",i.cipher.modes.gcm);var k=!1,l=4;function m(){k=!0,f=[0,1,2,4,8,16,32,64,128,27,54];for(var a=Array(256),b=0;b<128;++b)a[b]=b<<1,a[b+128]=b+128<<1^283;d=Array(256),e=Array(256),g=[,,,,],h=[,,,,];for(var b=0;b<4;++b)g[b]=Array(256),h[b]=Array(256);for(var c,i,j,l,m,n,o,p=0,q=0,b=0;b<256;++b){l=(l=q^q<<1^q<<2^q<<3^q<<4)>>8^255&l^99,d[p]=l,e[l]=p,m=a[l],c=a[p],i=a[c],j=a[i],n=m<<24^l<<16^l<<8^(l^m),o=(c^i^j)<<24^(p^j)<<16^(p^i^j)<<8^(p^c^j);for(var r=0;r<4;++r)g[r][p]=n,h[r][l]=o,n=n<<24|n>>>8,o=o<<24|o>>>8;0===p?p=q=1:(p=c^a[a[a[c^j]]],q^=a[a[q]])}}function n(a,b){for(var c,e=a.slice(0),g=1,i=e.length,j=l*(i+6+1),k=i;k<j;++k)c=e[k-1],k%i==0?(c=d[c>>>16&255]<<24^d[c>>>8&255]<<16^d[255&c]<<8^d[c>>>24]^f[g]<<24,g++):i>6&&k%i==4&&(c=d[c>>>24]<<24^d[c>>>16&255]<<16^d[c>>>8&255]<<8^d[255&c]),e[k]=e[k-i]^c;if(b){var m,n=h[0],o=h[1],p=h[2],q=h[3],r=e.slice(0);j=e.length;for(var k=0,s=j-l;k<j;k+=l,s-=l)if(0===k||k===j-l)r[k]=e[s],r[k+1]=e[s+3],r[k+2]=e[s+2],r[k+3]=e[s+1];else for(var t=0;t<l;++t)m=e[s+t],r[k+(3& -t)]=n[d[m>>>24]]^o[d[m>>>16&255]]^p[d[m>>>8&255]]^q[d[255&m]];e=r}return e}function o(a,b,c,f){var i,j,k,l,m,n,o,p,q,r,s,t,u=a.length/4-1;f?(i=h[0],j=h[1],k=h[2],l=h[3],m=e):(i=g[0],j=g[1],k=g[2],l=g[3],m=d),n=b[0]^a[0],o=b[f?3:1]^a[1],p=b[2]^a[2],q=b[f?1:3]^a[3];for(var v=3,w=1;w<u;++w)r=i[n>>>24]^j[o>>>16&255]^k[p>>>8&255]^l[255&q]^a[++v],s=i[o>>>24]^j[p>>>16&255]^k[q>>>8&255]^l[255&n]^a[++v],t=i[p>>>24]^j[q>>>16&255]^k[n>>>8&255]^l[255&o]^a[++v],q=i[q>>>24]^j[n>>>16&255]^k[o>>>8&255]^l[255&p]^a[++v],n=r,o=s,p=t;c[0]=m[n>>>24]<<24^m[o>>>16&255]<<16^m[p>>>8&255]<<8^m[255&q]^a[++v],c[f?3:1]=m[o>>>24]<<24^m[p>>>16&255]<<16^m[q>>>8&255]<<8^m[255&n]^a[++v],c[2]=m[p>>>24]<<24^m[q>>>16&255]<<16^m[n>>>8&255]<<8^m[255&o]^a[++v],c[f?1:3]=m[q>>>24]<<24^m[n>>>16&255]<<16^m[o>>>8&255]<<8^m[255&p]^a[++v]}function p(a){var b,c="AES-"+((a=a||{}).mode||"CBC").toUpperCase(),d=(b=a.decrypt?i.cipher.createDecipher(c,a.key):i.cipher.createCipher(c,a.key)).start;return b.start=function(a,c){var e=null;c instanceof i.util.ByteBuffer&&(e=c,c={}),(c=c||{}).output=e,c.iv=a,d.call(b,c)},b}},3068:function(a,b,c){var d=c(3832);c(97116),c(66270);var e=a.exports=d.asn1=d.asn1||{};function f(a,b,c){if(c>b){var d=Error("Too few bytes to parse DER.");throw d.available=a.length(),d.remaining=b,d.requested=c,d}}e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(a,b,c,f,g){if(d.util.isArray(f)){for(var h=[],i=0;i<f.length;++i)void 0!==f[i]&&h.push(f[i]);f=h}var j={tagClass:a,type:b,constructed:c,composed:c||d.util.isArray(f),value:f};return g&&"bitStringContents"in g&&(j.bitStringContents=g.bitStringContents,j.original=e.copy(j)),j},e.copy=function(a,b){var c;if(d.util.isArray(a)){c=[];for(var f=0;f<a.length;++f)c.push(e.copy(a[f],b));return c}return"string"==typeof a?a:(c={tagClass:a.tagClass,type:a.type,constructed:a.constructed,composed:a.composed,value:e.copy(a.value,b)},b&&!b.excludeBitStringContents&&(c.bitStringContents=a.bitStringContents),c)},e.equals=function(a,b,c){if(d.util.isArray(a)){if(!d.util.isArray(b)||a.length!==b.length)return!1;for(var f=0;f<a.length;++f)if(!e.equals(a[f],b[f]))return!1;return!0}if(typeof a!=typeof b)return!1;if("string"==typeof a)return a===b;var g=a.tagClass===b.tagClass&&a.type===b.type&&a.constructed===b.constructed&&a.composed===b.composed&&e.equals(a.value,b.value);return c&&c.includeBitStringContents&&(g=g&&a.bitStringContents===b.bitStringContents),g},e.getBerValueLength=function(a){var b,c=a.getByte();if(128!==c)return 128&c?a.getInt((127&c)<<3):c};var g=function(a,b){var c,d=a.getByte();if(b--,128!==d){if(128&d){var e=127&d;f(a,b,e),c=a.getInt(e<<3)}else c=d;if(c<0)throw Error("Negative length: "+c);return c}};function h(a,b,c,d){f(a,b,2);var i,j,k,l=a.getByte();b--;var m=192&l,n=31&l;i=a.length();var o=g(a,b);if(b-=i-a.length(),void 0!==o&&o>b){if(d.strict){var p=Error("Too few bytes to read ASN.1 value.");throw p.available=a.length(),p.remaining=b,p.requested=o,p}o=b}var q=(32&l)==32;if(q){if(j=[],void 0===o)for(;;){if(f(a,b,2),a.bytes(2)===String.fromCharCode(0,0)){a.getBytes(2),b-=2;break}i=a.length(),j.push(h(a,b,c+1,d)),b-=i-a.length()}else for(;o>0;)i=a.length(),j.push(h(a,o,c+1,d)),b-=i-a.length(),o-=i-a.length()}if(void 0===j&&m===e.Class.UNIVERSAL&&n===e.Type.BITSTRING&&(k=a.bytes(o)),void 0===j&&d.decodeBitStrings&&m===e.Class.UNIVERSAL&&n===e.Type.BITSTRING&&o>1){var r=a.read,s=b,t=0;if(n===e.Type.BITSTRING&&(f(a,b,1),t=a.getByte(),b--),0===t)try{i=a.length();var u={strict:!0,decodeBitStrings:!0},v=h(a,b,c+1,u),w=i-a.length();b-=w,n==e.Type.BITSTRING&&w++;var x=v.tagClass;w===o&&(x===e.Class.UNIVERSAL||x===e.Class.CONTEXT_SPECIFIC)&&(j=[v])}catch(y){}void 0===j&&(a.read=r,b=s)}if(void 0===j){if(void 0===o){if(d.strict)throw Error("Non-constructed ASN.1 object of indefinite length.");o=b}if(n===e.Type.BMPSTRING)for(j="";o>0;o-=2)f(a,b,2),j+=String.fromCharCode(a.getInt16()),b-=2;else j=a.getBytes(o),b-=o}var z=void 0===k?null:{bitStringContents:k};return e.create(m,n,q,j,z)}e.fromDer=function(a,b){void 0===b&&(b={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof b&&(b={strict:b,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in b||(b.strict=!0),"parseAllBytes"in b||(b.parseAllBytes=!0),"decodeBitStrings"in b||(b.decodeBitStrings=!0),"string"==typeof a&&(a=d.util.createBuffer(a));var c=a.length(),e=h(a,a.length(),0,b);if(b.parseAllBytes&&0!==a.length()){var f=Error("Unparsed DER bytes remain after ASN.1 parsing.");throw f.byteCount=c,f.remaining=a.length(),f}return e},e.toDer=function(a){var b=d.util.createBuffer(),c=a.tagClass|a.type,f=d.util.createBuffer(),g=!1;if("bitStringContents"in a&&(g=!0,a.original&&(g=e.equals(a,a.original))),g)f.putBytes(a.bitStringContents);else if(a.composed){a.constructed?c|=32:f.putByte(0);for(var h=0;h<a.value.length;++h)void 0!==a.value[h]&&f.putBuffer(e.toDer(a.value[h]))}else if(a.type===e.Type.BMPSTRING)for(var h=0;h<a.value.length;++h)f.putInt16(a.value.charCodeAt(h));else a.type===e.Type.INTEGER&&a.value.length>1&&(0===a.value.charCodeAt(0)&&(128&a.value.charCodeAt(1))==0||255===a.value.charCodeAt(0)&&(128&a.value.charCodeAt(1))==128)?f.putBytes(a.value.substr(1)):f.putBytes(a.value);if(b.putByte(c),127>=f.length())b.putByte(127&f.length());else{var i=f.length(),j="";do j+=String.fromCharCode(255&i),i>>>=8;while(i>0);b.putByte(128|j.length);for(var h=j.length-1;h>=0;--h)b.putByte(j.charCodeAt(h))}return b.putBuffer(f),b},e.oidToDer=function(a){var b,c,e,f,g=a.split("."),h=d.util.createBuffer();h.putByte(40*parseInt(g[0],10)+parseInt(g[1],10));for(var i=2;i<g.length;++i){b=!0,c=[],e=parseInt(g[i],10);do f=127&e,e>>>=7,b||(f|=128),c.push(f),b=!1;while(e>0);for(var j=c.length-1;j>=0;--j)h.putByte(c[j])}return h},e.derToOid=function(a){"string"==typeof a&&(a=d.util.createBuffer(a));var b,c=a.getByte();b=Math.floor(c/40)+"."+c%40;for(var e=0;a.length()>0;)c=a.getByte(),e<<=7,128&c?e+=127&c:(b+="."+(e+c),e=0);return b},e.utcTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,2),10);c=c>=50?1900+c:2e3+c;var d=parseInt(a.substr(2,2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),g=parseInt(a.substr(8,2),10),h=0;if(a.length>11){var i=a.charAt(10),j=10;"+"!==i&&"-"!==i&&(h=parseInt(a.substr(10,2),10),j+=2)}if(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,0),j&&("+"===(i=a.charAt(j))||"-"===i)){var k=parseInt(a.substr(j+1,2),10),l=parseInt(a.substr(j+4,2),10),m=60*k+l;m*=6e4,"+"===i?b.setTime(+b-m):b.setTime(+b+m)}return b},e.generalizedTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,4),10),d=parseInt(a.substr(4,2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),g=parseInt(a.substr(10,2),10),h=parseInt(a.substr(12,2),10),i=0,j=0,k=!1;"Z"===a.charAt(a.length-1)&&(k=!0);var l=a.length-5,m=a.charAt(l);if("+"===m||"-"===m){var n=parseInt(a.substr(l+1,2),10),o=parseInt(a.substr(l+4,2),10);j=60*n+o,j*=6e4,"+"===m&&(j*=-1),k=!0}return"."===a.charAt(14)&&(i=1e3*parseFloat(a.substr(14),10)),k?(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,i),b.setTime(+b+j)):(b.setFullYear(c,d,e),b.setHours(f,g,h,i)),b},e.dateToUtcTime=function(a){if("string"==typeof a)return a;var b="",c=[];c.push((""+a.getUTCFullYear()).substr(2)),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+"Z"},e.dateToGeneralizedTime=function(a){if("string"==typeof a)return a;var b="",c=[];c.push(""+a.getUTCFullYear()),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+"Z"},e.integerToDer=function(a){var b=d.util.createBuffer();if(a>= -128&&a<128)return b.putSignedInt(a,8);if(a>= -32768&&a<32768)return b.putSignedInt(a,16);if(a>= -8388608&&a<8388608)return b.putSignedInt(a,24);if(a>= -2147483648&&a<2147483648)return b.putSignedInt(a,32);var c=Error("Integer too large; max is 32-bits.");throw c.integer=a,c},e.derToInteger=function(a){"string"==typeof a&&(a=d.util.createBuffer(a));var b=8*a.length();if(b>32)throw Error("Integer too large; max is 32-bits.");return a.getSignedInt(b)},e.validate=function(a,b,c,f){var g=!1;if((a.tagClass===b.tagClass|| void 0===b.tagClass)&&(a.type===b.type|| void 0===b.type)){if(a.constructed===b.constructed|| void 0===b.constructed){if(g=!0,b.value&&d.util.isArray(b.value))for(var h=0,i=0;g&&i<b.value.length;++i)g=b.value[i].optional||!1,a.value[h]&&((g=e.validate(a.value[h],b.value[i],c,f))?++h:b.value[i].optional&&(g=!0)),!g&&f&&f.push("["+b.name+'] Tag class "'+b.tagClass+'", type "'+b.type+'" expected value length "'+b.value.length+'", got "'+a.value.length+'"');if(g&&c&&(b.capture&&(c[b.capture]=a.value),b.captureAsn1&&(c[b.captureAsn1]=a),b.captureBitStringContents&&"bitStringContents"in a&&(c[b.captureBitStringContents]=a.bitStringContents),b.captureBitStringValue&&"bitStringContents"in a)){if(a.bitStringContents.length<2)c[b.captureBitStringValue]="";else{if(0!==a.bitStringContents.charCodeAt(0))throw Error("captureBitStringValue only supported for zero unused bits");c[b.captureBitStringValue]=a.bitStringContents.slice(1)}}}else f&&f.push("["+b.name+'] Expected constructed "'+b.constructed+'", got "'+a.constructed+'"')}else f&&(a.tagClass!==b.tagClass&&f.push("["+b.name+'] Expected tag class "'+b.tagClass+'", got "'+a.tagClass+'"'),a.type!==b.type&&f.push("["+b.name+'] Expected type "'+b.type+'", got "'+a.type+'"'));return g};var i=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(a,b,c){var f="";c=c||2,(b=b||0)>0&&(f+="\n");for(var g="",h=0;h<b*c;++h)g+=" ";switch(f+=g+"Tag: ",a.tagClass){case e.Class.UNIVERSAL:f+="Universal:";break;case e.Class.APPLICATION:f+="Application:";break;case e.Class.CONTEXT_SPECIFIC:f+="Context-Specific:";break;case e.Class.PRIVATE:f+="Private:"}if(a.tagClass===e.Class.UNIVERSAL)switch(f+=a.type,a.type){case e.Type.NONE:f+=" (None)";break;case e.Type.BOOLEAN:f+=" (Boolean)";break;case e.Type.INTEGER:f+=" (Integer)";break;case e.Type.BITSTRING:f+=" (Bit string)";break;case e.Type.OCTETSTRING:f+=" (Octet string)";break;case e.Type.NULL:f+=" (Null)";break;case e.Type.OID:f+=" (Object Identifier)";break;case e.Type.ODESC:f+=" (Object Descriptor)";break;case e.Type.EXTERNAL:f+=" (External or Instance of)";break;case e.Type.REAL:f+=" (Real)";break;case e.Type.ENUMERATED:f+=" (Enumerated)";break;case e.Type.EMBEDDED:f+=" (Embedded PDV)";break;case e.Type.UTF8:f+=" (UTF8)";break;case e.Type.ROID:f+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:f+=" (Sequence)";break;case e.Type.SET:f+=" (Set)";break;case e.Type.PRINTABLESTRING:f+=" (Printable String)";break;case e.Type.IA5String:f+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:f+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:f+=" (Generalized time)";break;case e.Type.BMPSTRING:f+=" (BMP String)"}else f+=a.type;if(f+="\n",f+=g+"Constructed: "+a.constructed+"\n",a.composed){for(var j=0,k="",h=0;h<a.value.length;++h)void 0!==a.value[h]&&(j+=1,k+=e.prettyPrint(a.value[h],b+1,c),h+1<a.value.length&&(k+=","));f+=g+"Sub values: "+j+k}else{if(f+=g+"Value: ",a.type===e.Type.OID){var l=e.derToOid(a.value);f+=l,d.pki&&d.pki.oids&&l in d.pki.oids&&(f+=" ("+d.pki.oids[l]+") ")}if(a.type===e.Type.INTEGER)try{f+=e.derToInteger(a.value)}catch(m){f+="0x"+d.util.bytesToHex(a.value)}else if(a.type===e.Type.BITSTRING){if(a.value.length>1?f+="0x"+d.util.bytesToHex(a.value.slice(1)):f+="(none)",a.value.length>0){var n=a.value.charCodeAt(0);1==n?f+=" (1 unused bit shown)":n>1&&(f+=" ("+n+" unused bits shown)")}}else if(a.type===e.Type.OCTETSTRING)i.test(a.value)||(f+="("+a.value+") "),f+="0x"+d.util.bytesToHex(a.value);else if(a.type===e.Type.UTF8)try{f+=d.util.decodeUtf8(a.value)}catch(o){if("URI malformed"===o.message)f+="0x"+d.util.bytesToHex(a.value)+" (malformed UTF8)";else throw o}else a.type===e.Type.PRINTABLESTRING||a.type===e.Type.IA5String?f+=a.value:i.test(a.value)?f+="0x"+d.util.bytesToHex(a.value):0===a.value.length?f+="[null]":f+=a.value}return f}},78807:function(a,b,c){var d=c(62678).Buffer,e={};a.exports=e;var f={};function g(a,b){var c=0,d=b.length,e=b.charAt(0),f=[0];for(c=0;c<a.length();++c){for(var g=0,h=a.at(c);g<f.length;++g)h+=f[g]<<8,f[g]=h%d,h=h/d|0;for(;h>0;)f.push(h%d),h=h/d|0}var i="";for(c=0;0===a.at(c)&&c<a.length()-1;++c)i+=e;for(c=f.length-1;c>=0;--c)i+=b[f[c]];return i}e.encode=function(a,b,c){if("string"!=typeof b)throw TypeError('"alphabet" must be a string.');if(void 0!==c&&"number"!=typeof c)throw TypeError('"maxline" must be a number.');var d="";if(a instanceof Uint8Array){var e=0,f=b.length,h=b.charAt(0),i=[0];for(e=0;e<a.length;++e){for(var j=0,k=a[e];j<i.length;++j)k+=i[j]<<8,i[j]=k%f,k=k/f|0;for(;k>0;)i.push(k%f),k=k/f|0}for(e=0;0===a[e]&&e<a.length-1;++e)d+=h;for(e=i.length-1;e>=0;--e)d+=b[i[e]]}else d=g(a,b);if(c){var l=RegExp(".{1,"+c+"}","g");d=d.match(l).join("\r\n")}return d},e.decode=function(a,b){if("string"!=typeof a)throw TypeError('"input" must be a string.');if("string"!=typeof b)throw TypeError('"alphabet" must be a string.');var c=f[b];if(!c){c=f[b]=[];for(var e=0;e<b.length;++e)c[b.charCodeAt(e)]=e}a=a.replace(/\s/g,"");for(var g=b.length,h=b.charAt(0),i=[0],e=0;e<a.length;e++){var j=c[a.charCodeAt(e)];if(void 0===j)return;for(var k=0,l=j;k<i.length;++k)l+=i[k]*g,i[k]=255&l,l>>=8;for(;l>0;)i.push(255&l),l>>=8}for(var m=0;a[m]===h&&m<a.length-1;++m)i.push(0);return void 0!==d?d.from(i.reverse()):new Uint8Array(i.reverse())}},85649:function(a,b,c){var d=c(3832);c(97116),a.exports=d.cipher=d.cipher||{},d.cipher.algorithms=d.cipher.algorithms||{},d.cipher.createCipher=function(a,b){var c=a;if("string"==typeof c&&(c=d.cipher.getAlgorithm(c))&&(c=c()),!c)throw Error("Unsupported algorithm: "+a);return new d.cipher.BlockCipher({algorithm:c,key:b,decrypt:!1})},d.cipher.createDecipher=function(a,b){var c=a;if("string"==typeof c&&(c=d.cipher.getAlgorithm(c))&&(c=c()),!c)throw Error("Unsupported algorithm: "+a);return new d.cipher.BlockCipher({algorithm:c,key:b,decrypt:!0})},d.cipher.registerAlgorithm=function(a,b){a=a.toUpperCase(),d.cipher.algorithms[a]=b},d.cipher.getAlgorithm=function(a){return(a=a.toUpperCase())in d.cipher.algorithms?d.cipher.algorithms[a]:null};var e=d.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};e.prototype.start=function(a){a=a||{};var b={};for(var c in a)b[c]=a[c];b.decrypt=this._decrypt,this._finish=!1,this._input=d.util.createBuffer(),this.output=a.output||d.util.createBuffer(),this.mode.start(b)},e.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(a){a&&("ECB"===this.mode.name||"CBC"===this.mode.name)&&(this.mode.pad=function(b){return a(this.blockSize,b,!1)},this.mode.unpad=function(b){return a(this.blockSize,b,!0)});var b={};return b.decrypt=this._decrypt,b.overflow=this._input.length()%this.blockSize,!!(this._decrypt||!this.mode.pad||this.mode.pad(this._input,b))&&(this._finish=!0,this.update(),(!this._decrypt||!this.mode.unpad||!!this.mode.unpad(this.output,b))&&(!this.mode.afterFinish||!!this.mode.afterFinish(this.output,b)))}},61967:function(a,b,c){var d=c(3832);c(97116),d.cipher=d.cipher||{};var e=a.exports=d.cipher.modes=d.cipher.modes||{};function f(a,b){if("string"==typeof a&&(a=d.util.createBuffer(a)),d.util.isArray(a)&&a.length>4){var c=a;a=d.util.createBuffer();for(var e=0;e<c.length;++e)a.putByte(c[e])}if(a.length()<b)throw Error("Invalid IV length; got "+a.length()+" bytes and expected "+b+" bytes.");if(!d.util.isArray(a)){for(var f=[],g=b/4,e=0;e<g;++e)f.push(a.getInt32());a=f}return a}function g(a){a[a.length-1]=a[a.length-1]+1&4294967295}function h(a){return[a/4294967296|0,4294967295&a]}e.ecb=function(a){a=a||{},this.name="ECB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints)},e.ecb.prototype.start=function(a){},e.ecb.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},e.ecb.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},e.ecb.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},e.ecb.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return!(d>this.blockSize<<2)&&(a.truncate(d),!0)},e.cbc=function(a){a=a||{},this.name="CBC",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints)},e.cbc.prototype.start=function(a){if(null===a.iv){if(!this._prev)throw Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in a)this._iv=f(a.iv,this.blockSize),this._prev=this._iv.slice(0);else throw Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=this._prev[d]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._prev[d]^this._outBlock[d]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},e.cbc.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return!(d>this.blockSize<<2)&&(a.truncate(d),!0)},e.cfb=function(a){a=a||{},this.name="CFB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=f(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize){for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32()^this._outBlock[e],b.putInt32(this._inBlock[e]);return}var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32()^this._outBlock[e],this._partialOutput.putInt32(this._partialBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize){for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32(),b.putInt32(this._inBlock[e]^this._outBlock[e]);return}var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[e]^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0},e.ofb=function(a){a=a||{},this.name="OFB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=f(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===a.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize){for(var e=0;e<this._ints;++e)b.putInt32(a.getInt32()^this._outBlock[e]),this._inBlock[e]=this._outBlock[e];return}var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialOutput.putInt32(a.getInt32()^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._outBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(a){a=a||{},this.name="CTR",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=f(a.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)b.putInt32(a.getInt32()^this._outBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialOutput.putInt32(a.getInt32()^this._outBlock[e]);if(f>0&&(a.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}g(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(a){a=a||{},this.name="GCM",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");var b,c=d.util.createBuffer(a.iv);if(this._cipherLength=0,b="additionalData"in a?d.util.createBuffer(a.additionalData):d.util.createBuffer(),"tagLength"in a?this._tagLength=a.tagLength:this._tagLength=128,this._tag=null,a.decrypt&&(this._tag=d.util.createBuffer(a.tag).getBytes(),this._tag.length!==this._tagLength/8))throw Error("Authentication tag does not match tag length.");this._hashBlock=Array(this._ints),this.tag=null,this._hashSubkey=Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var e=c.length();if(12===e)this._j0=[c.getInt32(),c.getInt32(),c.getInt32(),1];else{for(this._j0=[0,0,0,0];c.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(h(8*e)))}this._inBlock=this._j0.slice(0),g(this._inBlock),this._partialBytes=0,b=d.util.createBuffer(b),this._aDataLength=h(8*b.length());var f=b.length()%this.blockSize;for(f&&b.fillWithByte(0,this.blockSize-f),this._s=[0,0,0,0];b.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[b.getInt32(),b.getInt32(),b.getInt32(),b.getInt32()])},e.gcm.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize){for(var e=0;e<this._ints;++e)b.putInt32(this._outBlock[e]^=a.getInt32());this._cipherLength+=this.blockSize}else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialOutput.putInt32(a.getInt32()^this._outBlock[e]);if(f<=0||c){if(c){var h=d%this.blockSize;this._cipherLength+=h,this._partialOutput.truncate(this.blockSize-h)}else this._cipherLength+=this.blockSize;for(var e=0;e<this._ints;++e)this._outBlock[e]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return a.read-=this.blockSize,b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),g(this._inBlock)},e.gcm.prototype.decrypt=function(a,b,c){var d=a.length();if(d<this.blockSize&&!(c&&d>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),g(this._inBlock),this._hashBlock[0]=a.getInt32(),this._hashBlock[1]=a.getInt32(),this._hashBlock[2]=a.getInt32(),this._hashBlock[3]=a.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var e=0;e<this._ints;++e)b.putInt32(this._outBlock[e]^this._hashBlock[e]);d<this.blockSize?this._cipherLength+=d%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(a,b){var c=!0;b.decrypt&&b.overflow&&a.truncate(this.blockSize-b.overflow),this.tag=d.util.createBuffer();var e=this._aDataLength.concat(h(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,e);var f=[];this.cipher.encrypt(this._j0,f);for(var g=0;g<this._ints;++g)this.tag.putInt32(this._s[g]^f[g]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),b.decrypt&&this.tag.bytes()!==this._tag&&(c=!1),c},e.gcm.prototype.multiply=function(a,b){for(var c=[0,0,0,0],d=b.slice(0),e=0;e<128;++e)a[e/32|0]&1<<31-e%32&&(c[0]^=d[0],c[1]^=d[1],c[2]^=d[2],c[3]^=d[3]),this.pow(d,d);return c},e.gcm.prototype.pow=function(a,b){for(var c=1&a[3],d=3;d>0;--d)b[d]=a[d]>>>1|(1&a[d-1])<<31;b[0]=a[0]>>>1,c&&(b[0]^=this._R)},e.gcm.prototype.tableMultiply=function(a){for(var b=[0,0,0,0],c=0;c<32;++c){var d=a[c/8|0]>>>(7-c%8)*4&15,e=this._m[c][d];b[0]^=e[0],b[1]^=e[1],b[2]^=e[2],b[3]^=e[3]}return b},e.gcm.prototype.ghash=function(a,b,c){return b[0]^=c[0],b[1]^=c[1],b[2]^=c[2],b[3]^=c[3],this.tableMultiply(b)},e.gcm.prototype.generateHashTable=function(a,b){for(var c=8/b,d=4*c,e=16*c,f=Array(e),g=0;g<e;++g){var h=[0,0,0,0],i=g/d|0,j=(d-1-g%d)*b;h[i]=1<<b-1<<j,f[g]=this.generateSubHashTable(this.multiply(h,a),b)}return f},e.gcm.prototype.generateSubHashTable=function(a,b){var c=1<<b,d=c>>>1,e=Array(c);e[d]=a.slice(0);for(var f=d>>>1;f>0;)this.pow(e[2*f],e[f]=[]),f>>=1;for(f=2;f<d;){for(var g=1;g<f;++g){var h=e[f],i=e[g];e[f+g]=[h[0]^i[0],h[1]^i[1],h[2]^i[2],h[3]^i[3]]}f*=2}for(e[0]=[0,0,0,0],f=d+1;f<c;++f){var j=e[f^d];e[f]=[a[0]^j[0],a[1]^j[1],a[2]^j[2],a[3]^j[3]]}return e}},33480:function(a,b,c){var d=c(3832);function e(a,b){var c=function(){return new d.des.Algorithm(a,b)};d.cipher.registerAlgorithm(a,c)}c(85649),c(61967),c(97116),a.exports=d.des=d.des||{},d.des.startEncrypting=function(a,b,c,d){var e=p({key:a,output:c,decrypt:!1,mode:d||(null===b?"ECB":"CBC")});return e.start(b),e},d.des.createEncryptionCipher=function(a,b){return p({key:a,output:null,decrypt:!1,mode:b})},d.des.startDecrypting=function(a,b,c,d){var e=p({key:a,output:c,decrypt:!0,mode:d||(null===b?"ECB":"CBC")});return e.start(b),e},d.des.createDecryptionCipher=function(a,b){return p({key:a,output:null,decrypt:!0,mode:b})},d.des.Algorithm=function(a,b){var c=this;c.name=a,c.mode=new b({blockSize:8,cipher:{encrypt:function(a,b){return o(c._keys,a,b,!1)},decrypt:function(a,b){return o(c._keys,a,b,!0)}}}),c._init=!1},d.des.Algorithm.prototype.initialize=function(a){if(!this._init){var b=d.util.createBuffer(a.key);if(0===this.name.indexOf("3DES")&&24!==b.length())throw Error("Invalid Triple-DES key size: "+8*b.length());this._keys=n(b),this._init=!0}},e("DES-ECB",d.cipher.modes.ecb),e("DES-CBC",d.cipher.modes.cbc),e("DES-CFB",d.cipher.modes.cfb),e("DES-OFB",d.cipher.modes.ofb),e("DES-CTR",d.cipher.modes.ctr),e("3DES-ECB",d.cipher.modes.ecb),e("3DES-CBC",d.cipher.modes.cbc),e("3DES-CFB",d.cipher.modes.cfb),e("3DES-OFB",d.cipher.modes.ofb),e("3DES-CTR",d.cipher.modes.ctr);var f=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],g=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],h=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],i=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],j=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],k=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],l=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],m=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function n(a){for(var b,c=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],e=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],h=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],i=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],j=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],m=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],n=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],o=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],q=a.length()>8?3:1,r=[],s=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],t=0,u=0;u<q;u++){var v=a.getInt32(),w=a.getInt32();b=(v>>>4^w)&252645135,w^=b,v^=b<<4,b=(w>>> -16^v)&65535,v^=b,w^=b<< -16,b=(v>>>2^w)&858993459,w^=b,v^=b<<2,b=(w>>> -16^v)&65535,v^=b,w^=b<< -16,b=(v>>>1^w)&1431655765,w^=b,v^=b<<1,b=(w>>>8^v)&16711935,v^=b,w^=b<<8,b=(v>>>1^w)&1431655765,w^=b,v^=b<<1,b=v<<8|w>>>20&240,v=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=b;for(var x=0;x<s.length;++x){s[x]?(v=v<<2|v>>>26,w=w<<2|w>>>26):(v=v<<1|v>>>27,w=w<<1|w>>>27),w&=-15;var y=c[(v&=-15)>>>28]|d[v>>>24&15]|e[v>>>20&15]|f[v>>>16&15]|g[v>>>12&15]|h[v>>>8&15]|i[v>>>4&15],z=j[w>>>28]|k[w>>>24&15]|l[w>>>20&15]|m[w>>>16&15]|n[w>>>12&15]|o[w>>>8&15]|p[w>>>4&15];b=(z>>>16^y)&65535,r[t++]=y^b,r[t++]=z^b<<16}}return r}function o(a,b,c,d){var e,n,o=32===a.length?3:9;e=3===o?d?[30,-2,-2]:[0,32,2]:d?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var p=b[0],q=b[1];n=(p>>>4^q)&252645135,q^=n,p^=n<<4,n=(p>>>16^q)&65535,q^=n,p^=n<<16,n=(q>>>2^p)&858993459,p^=n,q^=n<<2,n=(q>>>8^p)&16711935,p^=n,q^=n<<8,n=(p>>>1^q)&1431655765,q^=n,p^=n<<1,p=p<<1|p>>>31,q=q<<1|q>>>31;for(var r=0;r<o;r+=3){for(var s=e[r+1],t=e[r+2],u=e[r];u!=s;u+=t){var v=q^a[u],w=(q>>>4|q<<28)^a[u+1];n=p,p=q,q=n^(g[v>>>24&63]|i[v>>>16&63]|k[v>>>8&63]|m[63&v]|f[w>>>24&63]|h[w>>>16&63]|j[w>>>8&63]|l[63&w])}n=p,p=q,q=n}n=((p=p>>>1|p<<31)>>>1^(q=q>>>1|q<<31))&1431655765,q^=n,p^=n<<1,n=(q>>>8^p)&16711935,p^=n,q^=n<<8,n=(q>>>2^p)&858993459,p^=n,q^=n<<2,n=(p>>>16^q)&65535,q^=n,p^=n<<16,n=(p>>>4^q)&252645135,q^=n,p^=n<<4,c[0]=p,c[1]=q}function p(a){var b,c="DES-"+((a=a||{}).mode||"CBC").toUpperCase(),e=(b=a.decrypt?d.cipher.createDecipher(c,a.key):d.cipher.createCipher(c,a.key)).start;return b.start=function(a,c){var f=null;c instanceof d.util.ByteBuffer&&(f=c,c={}),(c=c||{}).output=f,c.iv=a,e.call(b,c)},b}},3832:function(a){a.exports={options:{usePureJavaScript:!1}}},36607:function(a,b,c){var d=c(3832);c(28991),c(97116),(a.exports=d.hmac=d.hmac||{}).create=function(){var a=null,b=null,c=null,e=null,f={};return f.start=function(f,g){if(null!==f){if("string"==typeof f){if((f=f.toLowerCase())in d.md.algorithms)b=d.md.algorithms[f].create();else throw Error('Unknown hash algorithm "'+f+'"')}else b=f}if(null===g)g=a;else{if("string"==typeof g)g=d.util.createBuffer(g);else if(d.util.isArray(g)){var h=g;g=d.util.createBuffer();for(var i=0;i<h.length;++i)g.putByte(h[i])}var j=g.length();j>b.blockLength&&(b.start(),b.update(g.bytes()),g=b.digest()),c=d.util.createBuffer(),e=d.util.createBuffer(),j=g.length();for(var i=0;i<j;++i){var h=g.at(i);c.putByte(54^h),e.putByte(92^h)}if(j<b.blockLength)for(var h=b.blockLength-j,i=0;i<h;++i)c.putByte(54),e.putByte(92);a=g,c=c.bytes(),e=e.bytes()}b.start(),b.update(c)},f.update=function(a){b.update(a)},f.getMac=function(){var a=b.digest().bytes();return b.start(),b.update(e),b.update(a),b.digest()},f.digest=f.getMac,f}},15764:function(a,b,c){var d,e,f,g=c(3832);a.exports=g.jsbn=g.jsbn||{};var h=!0;function i(a,b,c){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function j(){return new i(null)}function k(a,b,c,d,e,f){for(;--f>=0;){var g=b*this.data[a++]+c.data[d]+e;e=Math.floor(g/67108864),c.data[d++]=67108863&g}return e}function l(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this.data[a],j=this.data[a++]>>15,k=h*i+j*g;e=((i=g*i+((32767&k)<<15)+c.data[d]+(1073741823&e))>>>30)+(k>>>15)+h*j+(e>>>30),c.data[d++]=1073741823&i}return e}function m(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this.data[a],j=this.data[a++]>>14,k=h*i+j*g;e=((i=g*i+((16383&k)<<14)+c.data[d]+e)>>28)+(k>>14)+h*j,c.data[d++]=268435455&i}return e}g.jsbn.BigInteger=i,"undefined"==typeof navigator?(i.prototype.am=m,d=28):h&&"Microsoft Internet Explorer"==navigator.appName?(i.prototype.am=l,d=30):h&&"Netscape"!=navigator.appName?(i.prototype.am=k,d=26):(i.prototype.am=m,d=28),i.prototype.DB=d,i.prototype.DM=(1<<d)-1,i.prototype.DV=1<<d;var n=52;i.prototype.FV=Math.pow(2,n),i.prototype.F1=n-d,i.prototype.F2=2*d-n;var o="0123456789abcdefghijklmnopqrstuvwxyz",p=[];for(f=0,e=48;f<=9;++f)p[e++]=f;for(f=10,e=97;f<36;++f)p[e++]=f;for(f=10,e=65;f<36;++f)p[e++]=f;function q(a){return o.charAt(a)}function r(a,b){var c=p[a.charCodeAt(b)];return null==c?-1:c}function s(a){for(var b=this.t-1;b>=0;--b)a.data[b]=this.data[b];a.t=this.t,a.s=this.s}function t(a){this.t=1,this.s=a<0?-1:0,a>0?this.data[0]=a:a< -1?this.data[0]=a+this.DV:this.t=0}function u(a){var b=j();return b.fromInt(a),b}function v(a,b){if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.t=0,this.s=0;for(var c,d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:r(a,d);if(g<0){"-"==a.charAt(d)&&(e=!0);continue}e=!1,0==f?this.data[this.t++]=g:f+c>this.DB?(this.data[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this.data[this.t++]=g>>this.DB-f):this.data[this.t-1]|=g<<f,(f+=c)>=this.DB&&(f-=this.DB)}8==c&&(128&a[0])!=0&&(this.s=-1,f>0&&(this.data[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&i.ZERO.subTo(this,this)}function w(){for(var a=this.s&this.DM;this.t>0&&this.data[this.t-1]==a;)--this.t}function x(a){if(this.s<0)return"-"+this.negate().toString(a);if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var b,c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-- >0)for(h<this.DB&&(c=this.data[g]>>h)>0&&(e=!0,f=q(c));g>=0;)h<b?(c=(this.data[g]&(1<<h)-1)<<b-h,c|=this.data[--g]>>(h+=this.DB-b)):(c=this.data[g]>>(h-=b)&d,h<=0&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=q(c));return e?f:"0"}function y(){var a=j();return i.ZERO.subTo(this,a),a}function z(){return this.s<0?this.negate():this}function A(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(0!=(b=c-a.t))return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this.data[c]-a.data[c]))return b;return 0}function B(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function C(){return this.t<=0?0:this.DB*(this.t-1)+B(this.data[this.t-1]^this.s&this.DM)}function D(a,b){var c;for(c=this.t-1;c>=0;--c)b.data[c+a]=this.data[c];for(c=a-1;c>=0;--c)b.data[c]=0;b.t=this.t+a,b.s=this.s}function E(a,b){for(var c=a;c<this.t;++c)b.data[c-a]=this.data[c];b.t=Math.max(this.t-a,0),b.s=this.s}function F(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b.data[c+g+1]=this.data[c]>>e|h,h=(this.data[c]&f)<<d;for(c=g-1;c>=0;--c)b.data[c]=0;b.data[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function G(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t){b.t=0;return}var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b.data[0]=this.data[c]>>d;for(var g=c+1;g<this.t;++g)b.data[g-c-1]|=(this.data[g]&f)<<e,b.data[g-c]=this.data[g]>>d;d>0&&(b.data[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function H(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this.data[c]-a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d< -1?b.data[c++]=this.DV+d:d>0&&(b.data[c++]=d),b.t=c,b.clamp()}function I(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b.data[e]=0;for(e=0;e<d.t;++e)b.data[e+c.t]=c.am(0,d.data[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&i.ZERO.subTo(b,b)}function J(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a.data[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.data[c],a,2*c,0,1);(a.data[c+b.t]+=b.am(c+1,2*b.data[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.data[c+b.t]-=b.DV,a.data[c+b.t+1]=1)}a.t>0&&(a.data[a.t-1]+=b.am(c,b.data[c],a,2*c,0,1)),a.s=0,a.clamp()}function K(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t){null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);return}null==c&&(c=j());var f=j(),g=this.s,h=a.s,k=this.DB-B(d.data[d.t-1]);k>0?(d.lShiftTo(k,f),e.lShiftTo(k,c)):(d.copyTo(f),e.copyTo(c));var l=f.t,m=f.data[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?f.data[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=c.t,s=r-l,t=null==b?j():b;for(f.dlShiftTo(s,t),c.compareTo(t)>=0&&(c.data[c.t++]=1,c.subTo(t,c)),i.ONE.dlShiftTo(l,t),t.subTo(f,f);f.t<l;)f.data[f.t++]=0;for(;--s>=0;){var u=c.data[--r]==m?this.DM:Math.floor(c.data[r]*o+(c.data[r-1]+q)*p);if((c.data[r]+=f.am(0,u,c,s,0,l))<u)for(f.dlShiftTo(s,t),c.subTo(t,c);c.data[r]< --u;)c.subTo(t,c)}null!=b&&(c.drShiftTo(l,b),g!=h&&i.ZERO.subTo(b,b)),c.t=l,c.clamp(),k>0&&c.rShiftTo(k,c),g<0&&i.ZERO.subTo(c,c)}}}function L(a){var b=j();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(i.ZERO)>0&&a.subTo(b,b),b}function M(a){this.m=a}function N(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function O(a){return a}function P(a){a.divRemTo(this.m,null,a)}function Q(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function R(a,b){a.squareTo(b),this.reduce(b)}function S(){if(this.t<1)return 0;var a=this.data[0];if((1&a)==0)return 0;var b=3&a;return(b=(b=(b=(b=b*(2-(15&a)*b)&15)*(2-(255&a)*b)&255)*(2-((65535&a)*b&65535))&65535)*(2-a*b%this.DV)%this.DV)>0?this.DV-b:-b}function T(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function U(a){var b=j();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(i.ZERO)>0&&this.m.subTo(b,b),b}function V(a){var b=j();return a.copyTo(b),this.reduce(b),b}function W(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a.data[b],d=c*this.mpl+((c*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a.data[c]+=this.m.am(0,d,a,b,0,this.m.t);a.data[c]>=a.DV;)a.data[c]-=a.DV,a.data[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function X(a,b){a.squareTo(b),this.reduce(b)}function Y(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Z(){return(this.t>0?1&this.data[0]:this.s)==0}function $(a,b){if(a>4294967295||a<1)return i.ONE;var c=j(),d=j(),e=b.convert(this),f=B(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)}function _(a,b){var c;return c=a<256||b.isEven()?new M(b):new T(b),this.exp(a,c)}function aa(){var a=j();return this.copyTo(a),a}function ab(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return -1}else if(1==this.t)return this.data[0];else if(0==this.t)return 0;return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function ac(){return 0==this.t?this.s:this.data[0]<<24>>24}function ad(){return 0==this.t?this.s:this.data[0]<<16>>16}function ae(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function af(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function ag(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=u(c),e=j(),f=j(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g}function ah(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var j=r(a,h);if(j<0){"-"==a.charAt(h)&&0==this.signum()&&(e=!0);continue}g=b*g+j,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0)}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&i.ZERO.subTo(this,this)}function ai(a,b,c){if("number"==typeof b){if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(i.ONE.shiftLeft(a-1),aq,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(i.ONE.shiftLeft(a-1),this)}else{var d=[],e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d[0]&=(1<<e)-1:d[0]=0,this.fromString(d,256)}}function aj(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this.data[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?(c=(this.data[a]&(1<<d)-1)<<8-d,c|=this.data[--a]>>(d+=this.DB-8)):(c=this.data[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),(128&c)!=0&&(c|=-256),0==e&&(128&this.s)!=(128&c)&& ++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function ak(a){return 0==this.compareTo(a)}function al(a){return 0>this.compareTo(a)?this:a}function am(a){return this.compareTo(a)>0?this:a}function an(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c.data[d]=b(this.data[d],a.data[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c.data[d]=b(this.data[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c.data[d]=b(e,a.data[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ao(a,b){return a&b}function ap(a){var b=j();return this.bitwiseTo(a,ao,b),b}function aq(a,b){return a|b}function ar(a){var b=j();return this.bitwiseTo(a,aq,b),b}function as(a,b){return a^b}function at(a){var b=j();return this.bitwiseTo(a,as,b),b}function au(a,b){return a& ~b}function av(a){var b=j();return this.bitwiseTo(a,au,b),b}function aw(){for(var a=j(),b=0;b<this.t;++b)a.data[b]=this.DM& ~this.data[b];return a.t=this.t,a.s=~this.s,a}function ax(a){var b=j();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function ay(a){var b=j();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function az(a){if(0==a)return -1;var b=0;return(65535&a)==0&&(a>>=16,b+=16),(255&a)==0&&(a>>=8,b+=8),(15&a)==0&&(a>>=4,b+=4),(3&a)==0&&(a>>=2,b+=2),(1&a)==0&& ++b,b}function aA(){for(var a=0;a<this.t;++a)if(0!=this.data[a])return a*this.DB+az(this.data[a]);return this.s<0?this.t*this.DB:-1}function aB(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function aC(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=aB(this.data[c]^b);return a}function aD(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:(this.data[b]&1<<a%this.DB)!=0}function aE(a,b){var c=i.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c}function aF(a){return this.changeBit(a,aq)}function aG(a){return this.changeBit(a,au)}function aH(a){return this.changeBit(a,as)}function aI(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this.data[c]+a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b.data[c++]=d:d< -1&&(b.data[c++]=this.DV+d),b.t=c,b.clamp()}function aJ(a){var b=j();return this.addTo(a,b),b}function aK(a){var b=j();return this.subTo(a,b),b}function aL(a){var b=j();return this.multiplyTo(a,b),b}function aM(a){var b=j();return this.divRemTo(a,b,null),b}function aN(a){var b=j();return this.divRemTo(a,null,b),b}function aO(a){var b=j(),c=j();return this.divRemTo(a,b,c),[b,c]}function aP(a){this.data[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function aQ(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function aR(){}function aS(a){return a}function aT(a,b,c){a.multiplyTo(b,c)}function aU(a,b){a.squareTo(b)}function aV(a){return this.exp(a,new aR)}function aW(a,b,c){var d,e=Math.min(this.t+a.t,b);for(c.s=0,c.t=e;e>0;)c.data[--e]=0;for(d=c.t-this.t;e<d;++e)c.data[e+this.t]=this.am(0,a.data[e],c,e,0,this.t);for(d=Math.min(a.t,b);e<d;++e)this.am(0,a.data[e],c,e,0,b-e);c.clamp()}function aX(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c.data[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.data[this.t+d-b]=this.am(b-d,a.data[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function aY(a){this.r2=j(),this.q3=j(),i.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function aZ(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=j();return a.copyTo(b),this.reduce(b),b}function a$(a){return a}function a_(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function a0(a,b){a.squareTo(b),this.reduce(b)}function a1(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function a2(a,b){var c,d,e=a.bitLength(),f=u(1);if(e<=0)return f;c=e<18?1:e<48?3:e<144?4:e<768?5:6,d=e<8?new M(b):b.isEven()?new aY(b):new T(b);var g=[],h=3,i=c-1,k=(1<<c)-1;if(g[1]=d.convert(this),c>1){var l=j();for(d.sqrTo(g[1],l);h<=k;)g[h]=j(),d.mulTo(l,g[h-2],g[h]),h+=2}var m,n,o=a.t-1,p=!0,q=j();for(e=B(a.data[o])-1;o>=0;){for(e>=i?m=a.data[o]>>e-i&k:(m=(a.data[o]&(1<<e+1)-1)<<i-e,o>0&&(m|=a.data[o-1]>>this.DB+e-i)),h=c;(1&m)==0;)m>>=1,--h;if((e-=h)<0&&(e+=this.DB,--o),p)g[m].copyTo(f),p=!1;else{for(;h>1;)d.sqrTo(f,q),d.sqrTo(q,f),h-=2;h>0?d.sqrTo(f,q):(n=f,f=q,q=n),d.mulTo(q,g[m],f)}for(;o>=0&&(a.data[o]&1<<e)==0;)d.sqrTo(f,q),n=f,f=q,q=n,--e<0&&(e=this.DB-1,--o)}return d.revert(f)}function a3(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(0>b.compareTo(c)){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function a4(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0){if(0==b)c=this.data[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this.data[d])%a}return c}function a5(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return i.ZERO;for(var c=a.clone(),d=this.clone(),e=u(1),f=u(0),g=u(0),h=u(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(i.ONE)?i.ZERO:h.compareTo(a)>=0?h.subtract(a):0>h.signum()&&(h.addTo(a,h),0>h.signum())?h.add(a):h}M.prototype.convert=N,M.prototype.revert=O,M.prototype.reduce=P,M.prototype.mulTo=Q,M.prototype.sqrTo=R,T.prototype.convert=U,T.prototype.revert=V,T.prototype.reduce=W,T.prototype.mulTo=Y,T.prototype.sqrTo=X,i.prototype.copyTo=s,i.prototype.fromInt=t,i.prototype.fromString=v,i.prototype.clamp=w,i.prototype.dlShiftTo=D,i.prototype.drShiftTo=E,i.prototype.lShiftTo=F,i.prototype.rShiftTo=G,i.prototype.subTo=H,i.prototype.multiplyTo=I,i.prototype.squareTo=J,i.prototype.divRemTo=K,i.prototype.invDigit=S,i.prototype.isEven=Z,i.prototype.exp=$,i.prototype.toString=x,i.prototype.negate=y,i.prototype.abs=z,i.prototype.compareTo=A,i.prototype.bitLength=C,i.prototype.mod=L,i.prototype.modPowInt=_,i.ZERO=u(0),i.ONE=u(1),aR.prototype.convert=aS,aR.prototype.revert=aS,aR.prototype.mulTo=aT,aR.prototype.sqrTo=aU,aY.prototype.convert=aZ,aY.prototype.revert=a$,aY.prototype.reduce=a_,aY.prototype.mulTo=a1,aY.prototype.sqrTo=a0;var a6=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],a7=67108864/a6[a6.length-1];function a8(a){var b,c=this.abs();if(1==c.t&&c.data[0]<=a6[a6.length-1]){for(b=0;b<a6.length;++b)if(c.data[0]==a6[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<a6.length;){for(var d=a6[b],e=b+1;e<a6.length&&d<a7;)d*=a6[e++];for(d=c.modInt(d);b<e;)if(d%a6[b++]==0)return!1}return c.millerRabin(a)}function a9(a){var b,c=this.subtract(i.ONE),d=c.getLowestSetBit();if(d<=0)return!1;for(var e=c.shiftRight(d),f=ba(),g=0;g<a;++g){do b=new i(this.bitLength(),f);while(0>=b.compareTo(i.ONE)||b.compareTo(c)>=0);var h=b.modPow(e,this);if(0!=h.compareTo(i.ONE)&&0!=h.compareTo(c)){for(var j=1;(j++)<d&&0!=h.compareTo(c);)if(0==(h=h.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=h.compareTo(c))return!1}}return!0}function ba(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(256*Math.random())}}}i.prototype.chunkSize=ae,i.prototype.toRadix=ag,i.prototype.fromRadix=ah,i.prototype.fromNumber=ai,i.prototype.bitwiseTo=an,i.prototype.changeBit=aE,i.prototype.addTo=aI,i.prototype.dMultiply=aP,i.prototype.dAddOffset=aQ,i.prototype.multiplyLowerTo=aW,i.prototype.multiplyUpperTo=aX,i.prototype.modInt=a4,i.prototype.millerRabin=a9,i.prototype.clone=aa,i.prototype.intValue=ab,i.prototype.byteValue=ac,i.prototype.shortValue=ad,i.prototype.signum=af,i.prototype.toByteArray=aj,i.prototype.equals=ak,i.prototype.min=al,i.prototype.max=am,i.prototype.and=ap,i.prototype.or=ar,i.prototype.xor=at,i.prototype.andNot=av,i.prototype.not=aw,i.prototype.shiftLeft=ax,i.prototype.shiftRight=ay,i.prototype.getLowestSetBit=aA,i.prototype.bitCount=aC,i.prototype.testBit=aD,i.prototype.setBit=aF,i.prototype.clearBit=aG,i.prototype.flipBit=aH,i.prototype.add=aJ,i.prototype.subtract=aK,i.prototype.multiply=aL,i.prototype.divide=aM,i.prototype.remainder=aN,i.prototype.divideAndRemainder=aO,i.prototype.modPow=a2,i.prototype.modInverse=a5,i.prototype.pow=aV,i.prototype.gcd=a3,i.prototype.isProbablePrime=a8},28991:function(a,b,c){var d=c(3832);a.exports=d.md=d.md||{},d.md.algorithms=d.md.algorithms||{}},86971:function(a,b,c){var d=c(3832);c(83453),a.exports=d.mgf=d.mgf||{},d.mgf.mgf1=d.mgf1},83453:function(a,b,c){var d=c(3832);c(97116),d.mgf=d.mgf||{},(a.exports=d.mgf.mgf1=d.mgf1=d.mgf1||{}).create=function(a){return{generate:function(b,c){for(var e=new d.util.ByteBuffer,f=Math.ceil(c/a.digestLength),g=0;g<f;g++){var h=new d.util.ByteBuffer;h.putInt32(g),a.start(),a.update(b+h.getBytes()),e.putBuffer(a.digest())}return e.truncate(e.length()-c),e.getBytes()}}}},66270:function(a,b,c){var d=c(3832);d.pki=d.pki||{};var e=a.exports=d.pki.oids=d.oids=d.oids||{};function f(a,b){e[a]=b,e[b]=a}function g(a,b){e[a]=b}f("1.2.840.113549.1.1.1","rsaEncryption"),f("1.2.840.113549.1.1.4","md5WithRSAEncryption"),f("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),f("1.2.840.113549.1.1.7","RSAES-OAEP"),f("1.2.840.113549.1.1.8","mgf1"),f("1.2.840.113549.1.1.9","pSpecified"),f("1.2.840.113549.1.1.10","RSASSA-PSS"),f("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),f("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),f("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),f("1.3.101.112","EdDSA25519"),f("1.2.840.10040.4.3","dsa-with-sha1"),f("1.3.14.3.2.7","desCBC"),f("1.3.14.3.2.26","sha1"),f("1.3.14.3.2.29","sha1WithRSASignature"),f("2.16.840.1.101.3.4.2.1","sha256"),f("2.16.840.1.101.3.4.2.2","sha384"),f("2.16.840.1.101.3.4.2.3","sha512"),f("2.16.840.1.101.3.4.2.4","sha224"),f("2.16.840.1.101.3.4.2.5","sha512-224"),f("2.16.840.1.101.3.4.2.6","sha512-256"),f("1.2.840.113549.2.2","md2"),f("1.2.840.113549.2.5","md5"),f("1.2.840.113549.1.7.1","data"),f("1.2.840.113549.1.7.2","signedData"),f("1.2.840.113549.1.7.3","envelopedData"),f("1.2.840.113549.1.7.4","signedAndEnvelopedData"),f("1.2.840.113549.1.7.5","digestedData"),f("1.2.840.113549.1.7.6","encryptedData"),f("1.2.840.113549.1.9.1","emailAddress"),f("1.2.840.113549.1.9.2","unstructuredName"),f("1.2.840.113549.1.9.3","contentType"),f("1.2.840.113549.1.9.4","messageDigest"),f("1.2.840.113549.1.9.5","signingTime"),f("1.2.840.113549.1.9.6","counterSignature"),f("1.2.840.113549.1.9.7","challengePassword"),f("1.2.840.113549.1.9.8","unstructuredAddress"),f("1.2.840.113549.1.9.14","extensionRequest"),f("1.2.840.113549.1.9.20","friendlyName"),f("1.2.840.113549.1.9.21","localKeyId"),f("1.2.840.113549.1.9.22.1","x509Certificate"),f("1.2.840.113549.1.12.10.1.1","keyBag"),f("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),f("1.2.840.113549.1.12.10.1.3","certBag"),f("1.2.840.113549.1.12.10.1.4","crlBag"),f("1.2.840.113549.1.12.10.1.5","secretBag"),f("1.2.840.113549.1.12.10.1.6","safeContentsBag"),f("1.2.840.113549.1.5.13","pkcs5PBES2"),f("1.2.840.113549.1.5.12","pkcs5PBKDF2"),f("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),f("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),f("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),f("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),f("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),f("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),f("1.2.840.113549.2.7","hmacWithSHA1"),f("1.2.840.113549.2.8","hmacWithSHA224"),f("1.2.840.113549.2.9","hmacWithSHA256"),f("1.2.840.113549.2.10","hmacWithSHA384"),f("1.2.840.113549.2.11","hmacWithSHA512"),f("1.2.840.113549.3.7","des-EDE3-CBC"),f("2.16.840.1.101.3.4.1.2","aes128-CBC"),f("2.16.840.1.101.3.4.1.22","aes192-CBC"),f("2.16.840.1.101.3.4.1.42","aes256-CBC"),f("2.5.4.3","commonName"),f("2.5.4.4","surname"),f("2.5.4.5","serialNumber"),f("2.5.4.6","countryName"),f("2.5.4.7","localityName"),f("2.5.4.8","stateOrProvinceName"),f("2.5.4.9","streetAddress"),f("2.5.4.10","organizationName"),f("2.5.4.11","organizationalUnitName"),f("2.5.4.12","title"),f("2.5.4.13","description"),f("2.5.4.15","businessCategory"),f("2.5.4.17","postalCode"),f("2.5.4.42","givenName"),f("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),f("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),f("2.16.840.1.113730.1.1","nsCertType"),f("2.16.840.1.113730.1.13","nsComment"),g("2.5.29.1","authorityKeyIdentifier"),g("2.5.29.2","keyAttributes"),g("2.5.29.3","certificatePolicies"),g("2.5.29.4","keyUsageRestriction"),g("2.5.29.5","policyMapping"),g("2.5.29.6","subtreesConstraint"),g("2.5.29.7","subjectAltName"),g("2.5.29.8","issuerAltName"),g("2.5.29.9","subjectDirectoryAttributes"),g("2.5.29.10","basicConstraints"),g("2.5.29.11","nameConstraints"),g("2.5.29.12","policyConstraints"),g("2.5.29.13","basicConstraints"),f("2.5.29.14","subjectKeyIdentifier"),f("2.5.29.15","keyUsage"),g("2.5.29.16","privateKeyUsagePeriod"),f("2.5.29.17","subjectAltName"),f("2.5.29.18","issuerAltName"),f("2.5.29.19","basicConstraints"),g("2.5.29.20","cRLNumber"),g("2.5.29.21","cRLReason"),g("2.5.29.22","expirationDate"),g("2.5.29.23","instructionCode"),g("2.5.29.24","invalidityDate"),g("2.5.29.25","cRLDistributionPoints"),g("2.5.29.26","issuingDistributionPoint"),g("2.5.29.27","deltaCRLIndicator"),g("2.5.29.28","issuingDistributionPoint"),g("2.5.29.29","certificateIssuer"),g("2.5.29.30","nameConstraints"),f("2.5.29.31","cRLDistributionPoints"),f("2.5.29.32","certificatePolicies"),g("2.5.29.33","policyMappings"),g("2.5.29.34","policyConstraints"),f("2.5.29.35","authorityKeyIdentifier"),g("2.5.29.36","policyConstraints"),f("2.5.29.37","extKeyUsage"),g("2.5.29.46","freshestCRL"),g("2.5.29.54","inhibitAnyPolicy"),f("1.3.6.1.4.1.11129.2.4.2","timestampList"),f("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),f("1.3.6.1.5.5.7.3.1","serverAuth"),f("1.3.6.1.5.5.7.3.2","clientAuth"),f("1.3.6.1.5.5.7.3.3","codeSigning"),f("1.3.6.1.5.5.7.3.4","emailProtection"),f("1.3.6.1.5.5.7.3.8","timeStamping")},97450:function(a,b,c){var d=c(3832);if(c(8925),c(3068),c(33480),c(28991),c(66270),c(98960),c(26953),c(49563),c(69372),c(28095),c(97116),void 0===e)var e=d.jsbn.BigInteger;var f=d.asn1,g=d.pki=d.pki||{};a.exports=g.pbe=d.pbe=d.pbe||{};var h=g.oids,i={name:"EncryptedPrivateKeyInfo",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},j={name:"PBES2Algorithms",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:f.Class.UNIVERSAL,type:f.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},k={name:"pkcs-12PbeParams",tagClass:f.Class.UNIVERSAL,type:f.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:f.Class.UNIVERSAL,type:f.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:f.Class.UNIVERSAL,type:f.Type.INTEGER,constructed:!1,capture:"iterations"}]};function l(a,b){return a.start().update(b).digest().getBytes()}function m(a){var b;if(a){if(!(b=g.oids[f.derToOid(a)])){var c=Error("Unsupported PRF OID.");throw c.oid=a,c.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],c}}else b="hmacWithSHA1";return n(b)}function n(a){var b=d.md;switch(a){case"hmacWithSHA224":b=d.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":a=a.substr(8).toLowerCase();break;default:var c=Error("Unsupported PRF algorithm.");throw c.algorithm=a,c.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],c}if(!b||!(a in b))throw Error("Unknown hash algorithm: "+a);return b[a].create()}function o(a,b,c,e){var h=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,a),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,b.getBytes())]);return"hmacWithSHA1"!==e&&h.value.push(f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,d.util.hexToBytes(c.toString(16))),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(g.oids[e]).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])),h}g.encryptPrivateKeyInfo=function(a,b,c){(c=c||{}).saltSize=c.saltSize||8,c.count=c.count||2048,c.algorithm=c.algorithm||"aes128",c.prfAlgorithm=c.prfAlgorithm||"sha1";var e=d.random.getBytesSync(c.saltSize),i=c.count,j=f.integerToDer(i);if(0===c.algorithm.indexOf("aes")||"des"===c.algorithm){switch(c.algorithm){case"aes128":k=16,p=16,q=h["aes128-CBC"],r=d.aes.createEncryptionCipher;break;case"aes192":k=24,p=16,q=h["aes192-CBC"],r=d.aes.createEncryptionCipher;break;case"aes256":k=32,p=16,q=h["aes256-CBC"],r=d.aes.createEncryptionCipher;break;case"des":k=8,p=8,q=h.desCBC,r=d.des.createEncryptionCipher;break;default:var k,l,m,p,q,r,s=Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=c.algorithm,s}var t="hmacWith"+c.prfAlgorithm.toUpperCase(),u=n(t),v=d.pkcs5.pbkdf2(b,e,i,k,u),w=d.random.getBytesSync(p),x=r(v);x.start(w),x.update(f.toDer(a)),x.finish(),m=x.output.getBytes();var y=o(e,j,k,t);l=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(h.pkcs5PBES2).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(h.pkcs5PBKDF2).getBytes()),y]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(q).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,w)])])])}else if("3des"===c.algorithm){k=24;var z=new d.util.ByteBuffer(e),v=g.pbe.generatePkcs12Key(b,z,1,i,k),w=g.pbe.generatePkcs12Key(b,z,2,i,k),x=d.des.createEncryptionCipher(v);x.start(w),x.update(f.toDer(a)),x.finish(),m=x.output.getBytes(),l=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(h["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,j.getBytes())])])}else{var s=Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=c.algorithm,s}return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[l,f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,m)])},g.decryptPrivateKeyInfo=function(a,b){var c=null,e={},h=[];if(!f.validate(a,i,e,h)){var j=Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=h,j}var k=f.derToOid(e.encryptionOid),l=g.pbe.getCipher(k,e.encryptionParams,b),m=d.util.createBuffer(e.encryptedData);return l.update(m),l.finish()&&(c=f.fromDer(l.output)),c},g.encryptedPrivateKeyToPem=function(a,b){var c={type:"ENCRYPTED PRIVATE KEY",body:f.toDer(a).getBytes()};return d.pem.encode(c,{maxline:b})},g.encryptedPrivateKeyFromPem=function(a){var b=d.pem.decode(a)[0];if("ENCRYPTED PRIVATE KEY"!==b.type){var c=Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return f.fromDer(b.body)},g.encryptRsaPrivateKey=function(a,b,c){if(!(c=c||{}).legacy){var e,h,i,j,k=g.wrapRsaPrivateKey(g.privateKeyToAsn1(a));return k=g.encryptPrivateKeyInfo(k,b,c),g.encryptedPrivateKeyToPem(k)}switch(c.algorithm){case"aes128":e="AES-128-CBC",i=16,h=d.random.getBytesSync(16),j=d.aes.createEncryptionCipher;break;case"aes192":e="AES-192-CBC",i=24,h=d.random.getBytesSync(16),j=d.aes.createEncryptionCipher;break;case"aes256":e="AES-256-CBC",i=32,h=d.random.getBytesSync(16),j=d.aes.createEncryptionCipher;break;case"3des":e="DES-EDE3-CBC",i=24,h=d.random.getBytesSync(8),j=d.des.createEncryptionCipher;break;case"des":e="DES-CBC",i=8,h=d.random.getBytesSync(8),j=d.des.createEncryptionCipher;break;default:var l=Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+c.algorithm+'".');throw l.algorithm=c.algorithm,l}var m=d.pbe.opensslDeriveBytes(b,h.substr(0,8),i),n=j(m);n.start(h),n.update(f.toDer(g.privateKeyToAsn1(a))),n.finish();var o={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:e,parameters:d.util.bytesToHex(h).toUpperCase()},body:n.output.getBytes()};return d.pem.encode(o)},g.decryptRsaPrivateKey=function(a,b){var c=null,e=d.pem.decode(a)[0];if("ENCRYPTED PRIVATE KEY"!==e.type&&"PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type){var h=Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw h.headerType=h,h}if(e.procType&&"ENCRYPTED"===e.procType.type){switch(e.dekInfo.algorithm){case"DES-CBC":i=8,j=d.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,j=d.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,j=d.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,j=d.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,j=d.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,j=function(a){return d.rc2.createDecryptionCipher(a,40)};break;case"RC2-64-CBC":i=8,j=function(a){return d.rc2.createDecryptionCipher(a,64)};break;case"RC2-128-CBC":i=16,j=function(a){return d.rc2.createDecryptionCipher(a,128)};break;default:var i,j,h=Error('Could not decrypt private key; unsupported encryption algorithm "'+e.dekInfo.algorithm+'".');throw h.algorithm=e.dekInfo.algorithm,h}var k=d.util.hexToBytes(e.dekInfo.parameters),l=d.pbe.opensslDeriveBytes(b,k.substr(0,8),i),m=j(l);if(m.start(k),m.update(d.util.createBuffer(e.body)),!m.finish())return c;c=m.output.getBytes()}else c=e.body;return null!==(c="ENCRYPTED PRIVATE KEY"===e.type?g.decryptPrivateKeyInfo(f.fromDer(c),b):f.fromDer(c))&&(c=g.privateKeyFromAsn1(c)),c},g.pbe.generatePkcs12Key=function(a,b,c,e,f,g){if(null==g){if(!("sha1"in d.md))throw Error('"sha1" hash algorithm unavailable.');g=d.md.sha1.create()}var h,i,j=g.digestLength,k=g.blockLength,l=new d.util.ByteBuffer,m=new d.util.ByteBuffer;if(null!=a){for(i=0;i<a.length;i++)m.putInt16(a.charCodeAt(i));m.putInt16(0)}var n=m.length(),o=b.length(),p=new d.util.ByteBuffer;p.fillWithByte(c,k);var q=k*Math.ceil(o/k),r=new d.util.ByteBuffer;for(i=0;i<q;i++)r.putByte(b.at(i%o));var s=k*Math.ceil(n/k),t=new d.util.ByteBuffer;for(i=0;i<s;i++)t.putByte(m.at(i%n));var u=r;u.putBuffer(t);for(var v=Math.ceil(f/j),w=1;w<=v;w++){var x=new d.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(u.bytes());for(var y=0;y<e;y++)g.start(),g.update(x.getBytes()),x=g.digest();var z=new d.util.ByteBuffer;for(i=0;i<k;i++)z.putByte(x.at(i%j));var A=Math.ceil(o/k)+Math.ceil(n/k),B=new d.util.ByteBuffer;for(h=0;h<A;h++){var C=new d.util.ByteBuffer(u.getBytes(k)),D=511;for(i=z.length()-1;i>=0;i--)D>>=8,D+=z.at(i)+C.at(i),C.setAt(i,255&D);B.putBuffer(C)}u=B,l.putBuffer(x)}return l.truncate(l.length()-f),l},g.pbe.getCipher=function(a,b,c){switch(a){case g.oids.pkcs5PBES2:return g.pbe.getCipherForPBES2(a,b,c);case g.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case g.oids["pbewithSHAAnd40BitRC2-CBC"]:return g.pbe.getCipherForPKCS12PBE(a,b,c);default:var d=Error("Cannot read encrypted PBE data block. Unsupported OID.");throw d.oid=a,d.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],d}},g.pbe.getCipherForPBES2=function(a,b,c){var e,h,i={},k=[];if(!f.validate(b,j,i,k)){var l=Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=k,l}if((a=f.derToOid(i.kdfOid))!==g.oids.pkcs5PBKDF2){var l=Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw l.oid=a,l.supportedOids=["pkcs5PBKDF2"],l}if((a=f.derToOid(i.encOid))!==g.oids["aes128-CBC"]&&a!==g.oids["aes192-CBC"]&&a!==g.oids["aes256-CBC"]&&a!==g.oids["des-EDE3-CBC"]&&a!==g.oids.desCBC){var l=Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw l.oid=a,l.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],l}var n=i.kdfSalt,o=d.util.createBuffer(i.kdfIterationCount);switch(o=o.getInt(o.length()<<3),g.oids[a]){case"aes128-CBC":e=16,h=d.aes.createDecryptionCipher;break;case"aes192-CBC":e=24,h=d.aes.createDecryptionCipher;break;case"aes256-CBC":e=32,h=d.aes.createDecryptionCipher;break;case"des-EDE3-CBC":e=24,h=d.des.createDecryptionCipher;break;case"desCBC":e=8,h=d.des.createDecryptionCipher}var p=m(i.prfOid),q=d.pkcs5.pbkdf2(c,n,o,e,p),r=i.encIv,s=h(q);return s.start(r),s},g.pbe.getCipherForPKCS12PBE=function(a,b,c){var e,h,i,j={},l=[];if(!f.validate(b,k,j,l)){var n=Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=l,n}var o=d.util.createBuffer(j.salt),p=d.util.createBuffer(j.iterations);switch(p=p.getInt(p.length()<<3),a){case g.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:e=24,h=8,i=d.des.startDecrypting;break;case g.oids["pbewithSHAAnd40BitRC2-CBC"]:e=5,h=8,i=function(a,b){var c=d.rc2.createDecryptionCipher(a,40);return c.start(b,null),c};break;default:var n=Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw n.oid=a,n}var q=m(j.prfOid),r=g.pbe.generatePkcs12Key(c,o,1,p,e,q);q.start();var s=g.pbe.generatePkcs12Key(c,o,2,p,h,q);return i(r,s)},g.pbe.opensslDeriveBytes=function(a,b,c,e){if(null==e){if(!("md5"in d.md))throw Error('"md5" hash algorithm unavailable.');e=d.md.md5.create()}null===b&&(b="");for(var f=[l(e,a+b)],g=16,h=1;g<c;++h,g+=16)f.push(l(e,f[h-1]+a+b));return f.join("").substr(0,c)}},98960:function(a,b,c){var d,e=c(62678).Buffer,f=c(3832);c(36607),c(28991),c(97116);var g=f.pkcs5=f.pkcs5||{};f.util.isNodejs&&!f.options.usePureJavaScript&&(d=c(25819)),a.exports=f.pbkdf2=g.pbkdf2=function(a,b,c,g,h,i){if("function"==typeof h&&(i=h,h=null),f.util.isNodejs&&!f.options.usePureJavaScript&&d.pbkdf2&&(null===h||"object"!=typeof h)&&(d.pbkdf2Sync.length>4||!h||"sha1"===h))return("string"!=typeof h&&(h="sha1"),a=e.from(a,"binary"),b=e.from(b,"binary"),i)?4===d.pbkdf2Sync.length?d.pbkdf2(a,b,c,g,function(a,b){if(a)return i(a);i(null,b.toString("binary"))}):d.pbkdf2(a,b,c,g,h,function(a,b){if(a)return i(a);i(null,b.toString("binary"))}):4===d.pbkdf2Sync.length?d.pbkdf2Sync(a,b,c,g).toString("binary"):d.pbkdf2Sync(a,b,c,g,h).toString("binary");if(null==h&&(h="sha1"),"string"==typeof h){if(!(h in f.md.algorithms))throw Error("Unknown hash algorithm: "+h);h=f.md[h].create()}var j=h.digestLength;if(g>4294967295*j){var k=Error("Derived key is too long.");if(i)return i(k);throw k}var l=Math.ceil(g/j),m=g-(l-1)*j,n=f.hmac.create();n.start(h,a);var o="";if(!i){for(var p=1;p<=l;++p){n.start(null,null),n.update(b),n.update(f.util.int32ToBytes(p)),r=t=n.digest().getBytes();for(var q=2;q<=c;++q)n.start(null,null),n.update(t),s=n.digest().getBytes(),r=f.util.xorBytes(r,s,j),t=s;o+=p<l?r:r.substr(0,m)}return o}var r,s,t,q,p=1;function u(){if(p>l)return i(null,o);n.start(null,null),n.update(b),n.update(f.util.int32ToBytes(p)),r=t=n.digest().getBytes(),q=2,v()}function v(){if(q<=c)return n.start(null,null),n.update(t),s=n.digest().getBytes(),r=f.util.xorBytes(r,s,j),t=s,++q,f.util.setImmediate(v);o+=p<l?r:r.substr(0,m),++p,u()}u()}},26953:function(a,b,c){var d=c(3832);c(97116);var e=a.exports=d.pem=d.pem||{};function f(a){for(var b=a.name+": ",c=[],d=function(a,b){return" "+b},e=0;e<a.values.length;++e)c.push(a.values[e].replace(/^(\S+\r\n)/,d));b+=c.join(",")+"\r\n";for(var f=0,g=-1,e=0;e<b.length;++e,++f)if(f>65&& -1!==g){var h=b[g];","===h?(++g,b=b.substr(0,g)+"\r\n "+b.substr(g)):b=b.substr(0,g)+"\r\n"+h+b.substr(g+1),f=e-g-1,g=-1,++e}else(" "===b[e]||"	"===b[e]||","===b[e])&&(g=e);return b}function g(a){return a.replace(/^\s+/,"")}e.encode=function(a,b){b=b||{};var c,e="-----BEGIN "+a.type+"-----\r\n";if(a.procType&&(e+=f(c={name:"Proc-Type",values:[String(a.procType.version),a.procType.type]})),a.contentDomain&&(e+=f(c={name:"Content-Domain",values:[a.contentDomain]})),a.dekInfo&&(c={name:"DEK-Info",values:[a.dekInfo.algorithm]},a.dekInfo.parameters&&c.values.push(a.dekInfo.parameters),e+=f(c)),a.headers)for(var g=0;g<a.headers.length;++g)e+=f(a.headers[g]);return a.procType&&(e+="\r\n"),e+=d.util.encode64(a.body,b.maxline||64)+"\r\n",e+="-----END "+a.type+"-----\r\n"},e.decode=function(a){for(var b,c=[],e=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,f=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/;b=e.exec(a);){var i=b[1];"NEW CERTIFICATE REQUEST"===i&&(i="CERTIFICATE REQUEST");var j={type:i,procType:null,contentDomain:null,dekInfo:null,headers:[],body:d.util.decode64(b[3])};if(c.push(j),b[2]){for(var k=b[2].split(h),l=0;b&&l<k.length;){for(var m=k[l].replace(/\s+$/,""),n=l+1;n<k.length;++n){var o=k[n];if(!/\s/.test(o[0]))break;m+=o,l=n}if(b=m.match(f)){for(var p={name:b[1],values:[]},q=b[2].split(","),r=0;r<q.length;++r)p.values.push(g(q[r]));if(j.procType){if(j.contentDomain||"Content-Domain"!==p.name){if(j.dekInfo||"DEK-Info"!==p.name)j.headers.push(p);else{if(0===p.values.length)throw Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');j.dekInfo={algorithm:q[0],parameters:q[1]||null}}}else j.contentDomain=q[0]||""}else{if("Proc-Type"!==p.name)throw Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');j.procType={version:q[0],type:q[1]}}}++l}if("ENCRYPTED"===j.procType&&!j.dekInfo)throw Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===c.length)throw Error("Invalid PEM formatted message.");return c}},18936:function(a,b,c){var d=c(3832);c(97116),c(49563),c(137);var e=a.exports=d.pkcs1=d.pkcs1||{};function f(a,b,c){c||(c=d.md.sha1.create());for(var e="",f=Math.ceil(b/c.digestLength),g=0;g<f;++g){var h=String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,255&g);c.start(),c.update(a+h),e+=c.digest().getBytes()}return e.substring(0,b)}e.encode_rsa_oaep=function(a,b,c){"string"==typeof c?(e=c,g=arguments[3]||void 0,h=arguments[4]||void 0):c&&(e=c.label||void 0,g=c.seed||void 0,h=c.md||void 0,c.mgf1&&c.mgf1.md&&(i=c.mgf1.md)),h?h.start():h=d.md.sha1.create(),i||(i=h);var e,g,h,i,j=Math.ceil(a.n.bitLength()/8),k=j-2*h.digestLength-2;if(b.length>k){var l=Error("RSAES-OAEP input message length is too long.");throw l.length=b.length,l.maxLength=k,l}e||(e=""),h.update(e,"raw");for(var m=h.digest(),n="",o=k-b.length,p=0;p<o;p++)n+="\0";var q=m.getBytes()+n+"\x01"+b;if(g){if(g.length!==h.digestLength){var l=Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=g.length,l.digestLength=h.digestLength,l}}else g=d.random.getBytes(h.digestLength);var r=f(g,j-h.digestLength-1,i),s=d.util.xorBytes(q,r,q.length),t=f(s,h.digestLength,i);return"\0"+d.util.xorBytes(g,t,g.length)+s},e.decode_rsa_oaep=function(a,b,c){"string"==typeof c?(e=c,g=arguments[3]||void 0):c&&(e=c.label||void 0,g=c.md||void 0,c.mgf1&&c.mgf1.md&&(h=c.mgf1.md));var e,g,h,i=Math.ceil(a.n.bitLength()/8);if(b.length!==i){var j=Error("RSAES-OAEP encoded message length is invalid.");throw j.length=b.length,j.expectedLength=i,j}if(void 0===g?g=d.md.sha1.create():g.start(),h||(h=g),i<2*g.digestLength+2)throw Error("RSAES-OAEP key is too short for the hash function.");e||(e=""),g.update(e,"raw");for(var k=g.digest().getBytes(),l=b.charAt(0),m=b.substring(1,g.digestLength+1),n=b.substring(1+g.digestLength),o=f(n,g.digestLength,h),p=d.util.xorBytes(m,o,m.length),q=f(p,i-g.digestLength-1,h),r=d.util.xorBytes(n,q,n.length),s=r.substring(0,g.digestLength),j="\0"!==l,t=0;t<g.digestLength;++t)j|=k.charAt(t)!==s.charAt(t);for(var u=1,v=g.digestLength,w=g.digestLength;w<r.length;w++){var x=r.charCodeAt(w),y=1&x^1,z=u?65534:0;j|=x&z,u&=y,v+=u}if(j||1!==r.charCodeAt(v))throw Error("Invalid RSAES-OAEP padding.");return r.substring(v+1)}},79437:function(a,b,c){var d=c(3832);c(8925),c(3068),c(33480),c(66270),c(26953),c(95496),c(49563),c(97116),c(25414);var e=d.asn1,f=a.exports=d.pkcs7=d.pkcs7||{};function g(a){var b={},c=[];if(!e.validate(a,f.asn1.recipientInfoValidator,b,c)){var g=Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw g.errors=c,g}return{version:b.version.charCodeAt(0),issuer:d.pki.RDNAttributesAsArray(b.issuer),serialNumber:d.util.createBuffer(b.serial).toHex(),encryptedContent:{algorithm:e.derToOid(b.encAlgorithm),parameter:b.encParameter?b.encParameter.value:void 0,content:b.encKey}}}function h(a){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[d.pki.distinguishedNameToAsn1({attributes:a.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,d.util.hexToBytes(a.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a.encryptedContent.content)])}function i(a){for(var b=[],c=0;c<a.length;++c)b.push(g(a[c]));return b}function j(a){for(var b=[],c=0;c<a.length;++c)b.push(h(a[c]));return b}function k(a){var b=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[d.pki.distinguishedNameToAsn1({attributes:a.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,d.util.hexToBytes(a.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(a.authenticatedAttributesAsn1&&b.value.push(a.authenticatedAttributesAsn1),b.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),b.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a.signature)),a.unauthenticatedAttributes.length>0){for(var c=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),f=0;f<a.unauthenticatedAttributes.length;++f){var g=a.unauthenticatedAttributes[f];c.values.push(m(g))}b.value.push(c)}return b}function l(a){for(var b=[],c=0;c<a.length;++c)b.push(k(a[c]));return b}function m(a){var b;if(a.type===d.pki.oids.contentType)b=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.value).getBytes());else if(a.type===d.pki.oids.messageDigest)b=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a.value.bytes());else if(a.type===d.pki.oids.signingTime){var c=new Date("1950-01-01T00:00:00Z"),f=new Date("2050-01-01T00:00:00Z"),g=a.value;if("string"==typeof g){var h=Date.parse(g);g=isNaN(h)?13===g.length?e.utcTimeToDate(g):e.generalizedTimeToDate(g):new Date(h)}b=g>=c&&g<f?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(g)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(g))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[b])])}function n(a){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.algorithm).getBytes()),a.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,a.content.getBytes())])]}function o(a,b,c){var f={},g=[];if(!e.validate(b,c,f,g)){var h=Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw h.errors=h,h}if(e.derToOid(f.contentType)!==d.pki.oids.data)throw Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(f.encryptedContent){var i="";if(d.util.isArray(f.encryptedContent))for(var j=0;j<f.encryptedContent.length;++j){if(f.encryptedContent[j].type!==e.Type.OCTETSTRING)throw Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");i+=f.encryptedContent[j].value}else i=f.encryptedContent;a.encryptedContent={algorithm:e.derToOid(f.encAlgorithm),parameter:d.util.createBuffer(f.encParameter.value),content:d.util.createBuffer(i)}}if(f.content){var i="";if(d.util.isArray(f.content))for(var j=0;j<f.content.length;++j){if(f.content[j].type!==e.Type.OCTETSTRING)throw Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");i+=f.content[j].value}else i=f.content;a.content=d.util.createBuffer(i)}return a.version=f.version.charCodeAt(0),a.rawCapture=f,f}function p(a){if(void 0===a.encryptedContent.key)throw Error("Symmetric key not available.");if(void 0===a.content){var b;switch(a.encryptedContent.algorithm){case d.pki.oids["aes128-CBC"]:case d.pki.oids["aes192-CBC"]:case d.pki.oids["aes256-CBC"]:b=d.aes.createDecryptionCipher(a.encryptedContent.key);break;case d.pki.oids.desCBC:case d.pki.oids["des-EDE3-CBC"]:b=d.des.createDecryptionCipher(a.encryptedContent.key);break;default:throw Error("Unsupported symmetric cipher, OID "+a.encryptedContent.algorithm)}if(b.start(a.encryptedContent.parameter),b.update(a.encryptedContent.content),!b.finish())throw Error("Symmetric decryption failed.");a.content=b.output}}f.messageFromPem=function(a){var b=d.pem.decode(a)[0];if("PKCS7"!==b.type){var c=Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var g=e.fromDer(b.body);return f.messageFromAsn1(g)},f.messageToPem=function(a,b){var c={type:"PKCS7",body:e.toDer(a.toAsn1()).getBytes()};return d.pem.encode(c,{maxline:b})},f.messageFromAsn1=function(a){var b,c={},g=[];if(!e.validate(a,f.asn1.contentInfoValidator,c,g)){var h=Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw h.errors=g,h}var i=e.derToOid(c.contentType);switch(i){case d.pki.oids.envelopedData:b=f.createEnvelopedData();break;case d.pki.oids.encryptedData:b=f.createEncryptedData();break;case d.pki.oids.signedData:b=f.createSignedData();break;default:throw Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return b.fromAsn1(c.content.value[0]),b},f.createSignedData=function(){var a=null;return a={type:d.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(b){if(o(a,b,f.asn1.signedDataValidator),a.certificates=[],a.crls=[],a.digestAlgorithmIdentifiers=[],a.contentInfo=null,a.signerInfos=[],a.rawCapture.certificates)for(var c=a.rawCapture.certificates.value,e=0;e<c.length;++e)a.certificates.push(d.pki.certificateFromAsn1(c[e]))},toAsn1:function(){a.contentInfo||a.sign();for(var b=[],c=0;c<a.certificates.length;++c)b.push(d.pki.certificateToAsn1(a.certificates[c]));var f=[],g=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,a.digestAlgorithmIdentifiers),a.contentInfo])]);return b.length>0&&g.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,b)),f.length>0&&g.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,f)),g.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,a.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.type).getBytes()),g])},addSigner:function(b){var c=b.issuer,e=b.serialNumber;if(b.certificate){var f=b.certificate;"string"==typeof f&&(f=d.pki.certificateFromPem(f)),c=f.issuer.attributes,e=f.serialNumber}var g=b.key;if(!g)throw Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof g&&(g=d.pki.privateKeyFromPem(g));var h=b.digestAlgorithm||d.pki.oids.sha1;switch(h){case d.pki.oids.sha1:case d.pki.oids.sha256:case d.pki.oids.sha384:case d.pki.oids.sha512:case d.pki.oids.md5:break;default:throw Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+h)}var i=b.authenticatedAttributes||[];if(i.length>0){for(var j=!1,k=!1,l=0;l<i.length;++l){var m=i[l];if(!j&&m.type===d.pki.oids.contentType){if(j=!0,k)break;continue}if(!k&&m.type===d.pki.oids.messageDigest){if(k=!0,j)break;continue}}if(!j||!k)throw Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}a.signers.push({key:g,version:1,issuer:c,serialNumber:e,digestAlgorithm:h,signatureAlgorithm:d.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:i,unauthenticatedAttributes:[]})},sign:function(f){if(f=f||{},("object"!=typeof a.content||null===a.contentInfo)&&(a.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.pki.oids.data).getBytes())]),"content"in a)){var g;a.content instanceof d.util.ByteBuffer?g=a.content.bytes():"string"==typeof a.content&&(g=d.util.encodeUtf8(a.content)),f.detached?a.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,g):a.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,g)]))}if(0!==a.signers.length){var h=b();c(h)}},verify:function(){throw Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(b){"string"==typeof b&&(b=d.pki.certificateFromPem(b)),a.certificates.push(b)},addCertificateRevokationList:function(a){throw Error("PKCS#7 CRL support not yet implemented.")}};function b(){for(var b={},c=0;c<a.signers.length;++c){var f=a.signers[c],g=f.digestAlgorithm;g in b||(b[g]=d.md[d.pki.oids[g]].create()),0===f.authenticatedAttributes.length?f.md=b[g]:f.md=d.md[d.pki.oids[g]].create()}for(var g in a.digestAlgorithmIdentifiers=[],b)a.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return b}function c(b){if(!(c=a.detachedContent?a.detachedContent:(c=a.contentInfo.value[1]).value[0]))throw Error("Could not sign PKCS#7 message; there is no content to sign.");var c,f=e.derToOid(a.contentInfo.value[0].value),g=e.toDer(c);for(var h in g.getByte(),e.getBerValueLength(g),g=g.getBytes(),b)b[h].start().update(g);for(var i=new Date,j=0;j<a.signers.length;++j){var k=a.signers[j];if(0===k.authenticatedAttributes.length){if(f!==d.pki.oids.data)throw Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{k.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var n=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),o=0;o<k.authenticatedAttributes.length;++o){var p=k.authenticatedAttributes[o];p.type===d.pki.oids.messageDigest?p.value=b[k.digestAlgorithm].digest():p.type!==d.pki.oids.signingTime||p.value||(p.value=i),n.value.push(m(p)),k.authenticatedAttributesAsn1.value.push(m(p))}g=e.toDer(n).getBytes(),k.md.start().update(g)}k.signature=k.key.sign(k.md,"RSASSA-PKCS1-V1_5")}a.signerInfos=l(a.signers)}},f.createEncryptedData=function(){var a=null;return a={type:d.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:d.pki.oids["aes256-CBC"]},fromAsn1:function(b){o(a,b,f.asn1.encryptedDataValidator)},decrypt:function(b){void 0!==b&&(a.encryptedContent.key=b),p(a)}}},f.createEnvelopedData=function(){var a=null;return a={type:d.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:d.pki.oids["aes256-CBC"]},fromAsn1:function(b){var c=o(a,b,f.asn1.envelopedDataValidator);a.recipients=i(c.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,j(a.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,n(a.encryptedContent))])])])},findRecipient:function(b){for(var c=b.issuer.attributes,d=0;d<a.recipients.length;++d){var e=a.recipients[d],f=e.issuer;if(e.serialNumber===b.serialNumber&&f.length===c.length){for(var g=!0,h=0;h<c.length;++h)if(f[h].type!==c[h].type||f[h].value!==c[h].value){g=!1;break}if(g)return e}}return null},decrypt:function(b,c){if(void 0===a.encryptedContent.key&& void 0!==b&& void 0!==c)switch(b.encryptedContent.algorithm){case d.pki.oids.rsaEncryption:case d.pki.oids.desCBC:var e=c.decrypt(b.encryptedContent.content);a.encryptedContent.key=d.util.createBuffer(e);break;default:throw Error("Unsupported asymmetric cipher, OID "+b.encryptedContent.algorithm)}p(a)},addRecipient:function(b){a.recipients.push({version:0,issuer:b.issuer.attributes,serialNumber:b.serialNumber,encryptedContent:{algorithm:d.pki.oids.rsaEncryption,key:b.publicKey}})},encrypt:function(b,c){if(void 0===a.encryptedContent.content){switch(c=c||a.encryptedContent.algorithm,b=b||a.encryptedContent.key,c){case d.pki.oids["aes128-CBC"]:e=16,f=16,g=d.aes.createEncryptionCipher;break;case d.pki.oids["aes192-CBC"]:e=24,f=16,g=d.aes.createEncryptionCipher;break;case d.pki.oids["aes256-CBC"]:e=32,f=16,g=d.aes.createEncryptionCipher;break;case d.pki.oids["des-EDE3-CBC"]:e=24,f=8,g=d.des.createEncryptionCipher;break;default:throw Error("Unsupported symmetric cipher, OID "+c)}if(void 0===b)b=d.util.createBuffer(d.random.getBytes(e));else if(b.length()!=e)throw Error("Symmetric key has wrong length; got "+b.length()+" bytes, expected "+e+".");a.encryptedContent.algorithm=c,a.encryptedContent.key=b,a.encryptedContent.parameter=d.util.createBuffer(d.random.getBytes(f));var e,f,g,h=g(b);if(h.start(a.encryptedContent.parameter.copy()),h.update(a.content),!h.finish())throw Error("Symmetric encryption failed.");a.encryptedContent.content=h.output}for(var i=0;i<a.recipients.length;++i){var j=a.recipients[i];if(void 0===j.encryptedContent.content){if(j.encryptedContent.algorithm===d.pki.oids.rsaEncryption)j.encryptedContent.content=j.encryptedContent.key.encrypt(a.encryptedContent.key.data);else throw Error("Unsupported asymmetric cipher, OID "+j.encryptedContent.algorithm)}}}}}},95496:function(a,b,c){var d=c(3832);c(3068),c(97116);var e=d.asn1,f=a.exports=d.pkcs7asn1=d.pkcs7asn1||{};d.pkcs7=d.pkcs7||{},d.pkcs7.asn1=f;var g={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};f.contentInfoValidator=g;var h={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};f.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(h)},f.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(h)};var i={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};f.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},g,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[i]}]},f.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},29654:function(a,b,c){var d=c(3832);c(97116),c(15764),c(49563),function(){if(d.prime){a.exports=d.prime;return}var b=a.exports=d.prime=d.prime||{},c=d.jsbn.BigInteger,e=[6,4,2,4,2,4,6,2],f=new c(null);f.fromInt(30);var g=function(a,b){return a|b};function h(a,b,c,d){return"workers"in c?k(a,b,c,d):i(a,b,c,d)}function i(a,b,c,d){var e=l(a,b),f=0,g=m(e.bitLength());"millerRabinTests"in c&&(g=c.millerRabinTests);var h=10;"maxBlockTime"in c&&(h=c.maxBlockTime),j(e,a,b,f,g,h,d)}function j(a,b,c,f,g,h,i){var k=+new Date;do{if(a.bitLength()>b&&(a=l(b,c)),a.isProbablePrime(g))return i(null,a);a.dAddOffset(e[(f++)%8],0)}while(h<0|| +new Date-k<h);d.util.setImmediate(function(){j(a,b,c,f,g,h,i)})}function k(a,b,e,f){if("undefined"==typeof Worker)return i(a,b,e,f);var g=l(a,b),h=e.workers,j=e.workLoad||100,k=30*j/8,m=e.workerScript||"forge/prime.worker.js";if(-1===h)return d.util.estimateCores(function(a,b){a&&(b=2),h=b-1,n()});function n(){h=Math.max(1,h);for(var d=[],e=0;e<h;++e)d[e]=new Worker(m);for(var i=h,e=0;e<h;++e)d[e].addEventListener("message",o);var n=!1;function o(e){if(!n){--i;var h=e.data;if(h.found){for(var m=0;m<d.length;++m)d[m].terminate();return n=!0,f(null,new c(h.prime,16))}g.bitLength()>a&&(g=l(a,b));var o=g.toString(16);e.target.postMessage({hex:o,workLoad:j}),g.dAddOffset(k,0)}}}n()}function l(a,b){var d=new c(a,b),e=a-1;return d.testBit(e)||d.bitwiseTo(c.ONE.shiftLeft(e),g,d),d.dAddOffset(31-d.mod(f).byteValue(),0),d}function m(a){return a<=100?27:a<=150?18:a<=200?15:a<=250?12:a<=300?9:a<=350?8:a<=400?7:a<=500?6:a<=600?5:a<=800?4:a<=1250?3:2}b.generateProbablePrime=function(a,b,c){"function"==typeof b&&(c=b,b={});var e=(b=b||{}).algorithm||"PRIMEINC";"string"==typeof e&&(e={name:e}),e.options=e.options||{};var f=b.prng||d.random,g={nextBytes:function(a){for(var b=f.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}};if("PRIMEINC"===e.name)return h(a,g,e.options,c);throw Error("Invalid prime generation algorithm: "+e.name)}}()},74933:function(a,b,c){var d=c(24112),e=c(3832);c(97116);var f=null;!e.util.isNodejs||e.options.usePureJavaScript||d.versions["node-webkit"]||(f=c(25819));var g=a.exports=e.prng=e.prng||{};g.create=function(a){for(var b={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},c=a.md,d=Array(32),g=0;g<32;++g)d[g]=c.create();function h(a){if(b.pools[0].messageLength>=32)return j(),a();var c=32-b.pools[0].messageLength<<5;b.seedFile(c,function(c,d){if(c)return a(c);b.collect(d),j(),a()})}function i(){if(b.pools[0].messageLength>=32)return j();var a=32-b.pools[0].messageLength<<5;b.collect(b.seedFileSync(a)),j()}function j(){b.reseeds=4294967295===b.reseeds?0:b.reseeds+1;var a=b.plugin.md.create();a.update(b.keyBytes);for(var c=1,d=0;d<32;++d)b.reseeds%c==0&&(a.update(b.pools[d].digest().getBytes()),b.pools[d].start()),c<<=1;b.keyBytes=a.digest().getBytes(),a.start(),a.update(b.keyBytes);var e=a.digest().getBytes();b.key=b.plugin.formatKey(b.keyBytes),b.seed=b.plugin.formatSeed(e),b.generated=0}function k(a){var b=null,c=e.util.globalScope,d=c.crypto||c.msCrypto;d&&d.getRandomValues&&(b=function(a){return d.getRandomValues(a)});var f=e.util.createBuffer();if(b)for(;f.length()<a;){var g=Math.max(1,Math.min(a-f.length(),65536)/4),h=new Uint32Array(Math.floor(g));try{b(h);for(var i=0;i<h.length;++i)f.putInt32(h[i])}catch(j){if(!("undefined"!=typeof QuotaExceededError&&j instanceof QuotaExceededError))throw j}}if(f.length()<a)for(var k,l,m,n=Math.floor(65536*Math.random());f.length()<a;){l=16807*(65535&n),k=16807*(n>>16),l+=(32767&k)<<16,l+=k>>15,l=(2147483647&l)+(l>>31),n=4294967295&l;for(var i=0;i<3;++i)m=n>>>(i<<3),m^=Math.floor(256*Math.random()),f.putByte(255&m)}return f.getBytes(a)}return b.pools=d,b.pool=0,b.generate=function(a,c){if(!c)return b.generateSync(a);var d=b.plugin.cipher,f=b.plugin.increment,g=b.plugin.formatKey,i=b.plugin.formatSeed,j=e.util.createBuffer();function k(l){if(l)return c(l);if(j.length()>=a)return c(null,j.getBytes(a));if(b.generated>1048575&&(b.key=null),null===b.key)return e.util.nextTick(function(){h(k)});var m=d(b.key,b.seed);b.generated+=m.length,j.putBytes(m),b.key=g(d(b.key,f(b.seed))),b.seed=i(d(b.key,b.seed)),e.util.setImmediate(k)}b.key=null,k()},b.generateSync=function(a){var c=b.plugin.cipher,d=b.plugin.increment,f=b.plugin.formatKey,g=b.plugin.formatSeed;b.key=null;for(var h=e.util.createBuffer();h.length()<a;){b.generated>1048575&&(b.key=null),null===b.key&&i();var j=c(b.key,b.seed);b.generated+=j.length,h.putBytes(j),b.key=f(c(b.key,d(b.seed))),b.seed=g(c(b.key,b.seed))}return h.getBytes(a)},f?(b.seedFile=function(a,b){f.randomBytes(a,function(a,c){if(a)return b(a);b(null,c.toString())})},b.seedFileSync=function(a){return f.randomBytes(a).toString()}):(b.seedFile=function(a,b){try{b(null,k(a))}catch(c){b(c)}},b.seedFileSync=k),b.collect=function(a){for(var c=a.length,d=0;d<c;++d)b.pools[b.pool].update(a.substr(d,1)),b.pool=31===b.pool?0:b.pool+1},b.collectInt=function(a,c){for(var d="",e=0;e<c;e+=8)d+=String.fromCharCode(a>>e&255);b.collect(d)},b.registerWorker=function(a){if(a===self)b.seedFile=function(a,b){function c(a){var d=a.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",c),b(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",c),self.postMessage({forge:{prng:{needed:a}}})};else{var c=function(c){var d=c.data;d.forge&&d.forge.prng&&b.seedFile(d.forge.prng.needed,function(b,c){a.postMessage({forge:{prng:{err:b,bytes:c}}})})};a.addEventListener("message",c)}},b}},96007:function(a,b,c){var d=c(3832);c(49563),c(97116),(a.exports=d.pss=d.pss||{}).create=function(a){3===arguments.length&&(a={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var b,c=a.md,e=a.mgf,f=c.digestLength,g=a.salt||null;if("string"==typeof g&&(g=d.util.createBuffer(g)),"saltLength"in a)b=a.saltLength;else if(null!==g)b=g.length();else throw Error("Salt length not specified or specific salt not given.");if(null!==g&&g.length()!==b)throw Error("Given salt length does not match length of given salt.");var h=a.prng||d.random,i={};return i.encode=function(a,i){var j,k,l=i-1,m=Math.ceil(l/8),n=a.digest().getBytes();if(m<f+b+2)throw Error("Message is too long to encrypt.");k=null===g?h.getBytesSync(b):g.bytes();var o=new d.util.ByteBuffer;o.fillWithByte(0,8),o.putBytes(n),o.putBytes(k),c.start(),c.update(o.getBytes());var p=c.digest().getBytes(),q=new d.util.ByteBuffer;q.fillWithByte(0,m-b-f-2),q.putByte(1),q.putBytes(k);var r=q.getBytes(),s=m-f-1,t=e.generate(p,s),u="";for(j=0;j<s;j++)u+=String.fromCharCode(r.charCodeAt(j)^t.charCodeAt(j));var v=65280>>8*m-l&255;return(u=String.fromCharCode(u.charCodeAt(0)& ~v)+u.substr(1))+p+"\xbc"},i.verify=function(a,g,h){var i,j=h-1,k=Math.ceil(j/8);if(g=g.substr(-k),k<f+b+2)throw Error("Inconsistent parameters to PSS signature verification.");if(188!==g.charCodeAt(k-1))throw Error("Encoded message does not end in 0xBC.");var l=k-f-1,m=g.substr(0,l),n=g.substr(l,f),o=65280>>8*k-j&255;if((m.charCodeAt(0)&o)!=0)throw Error("Bits beyond keysize not zero as expected.");var p=e.generate(n,l),q="";for(i=0;i<l;i++)q+=String.fromCharCode(m.charCodeAt(i)^p.charCodeAt(i));q=String.fromCharCode(q.charCodeAt(0)& ~o)+q.substr(1);var r=k-f-b-2;for(i=0;i<r;i++)if(0!==q.charCodeAt(i))throw Error("Leftmost octets not zero as expected");if(1!==q.charCodeAt(r))throw Error("Inconsistent PSS signature, 0x01 marker not found");var s=q.substr(-b),t=new d.util.ByteBuffer;return t.fillWithByte(0,8),t.putBytes(a),t.putBytes(s),c.start(),c.update(t.getBytes()),n===c.digest().getBytes()},i}},49563:function(a,b,c){var d=c(3832);c(8925),c(41668),c(74933),c(97116),function(){if(d.random&&d.random.getBytes){a.exports=d.random;return}!function(b){var c={},e=[,,,,],f=d.util.createBuffer();function g(){var a=d.prng.create(c);return a.getBytes=function(b,c){return a.generate(b,c)},a.getBytesSync=function(b){return a.generate(b)},a}c.formatKey=function(a){var b=d.util.createBuffer(a);return(a=[,,,,])[0]=b.getInt32(),a[1]=b.getInt32(),a[2]=b.getInt32(),a[3]=b.getInt32(),d.aes._expandKey(a,!1)},c.formatSeed=function(a){var b=d.util.createBuffer(a);return(a=[,,,,])[0]=b.getInt32(),a[1]=b.getInt32(),a[2]=b.getInt32(),a[3]=b.getInt32(),a},c.cipher=function(a,b){return d.aes._updateBlock(a,b,e,!1),f.putInt32(e[0]),f.putInt32(e[1]),f.putInt32(e[2]),f.putInt32(e[3]),f.getBytes()},c.increment=function(a){return++a[3],a},c.md=d.md.sha256;var h=g(),i=null,j=d.util.globalScope,k=j.crypto||j.msCrypto;if(k&&k.getRandomValues&&(i=function(a){return k.getRandomValues(a)}),d.options.usePureJavaScript|| !d.util.isNodejs&&!i){if("undefined"==typeof window||window.document,h.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var m in navigator)try{"string"==typeof navigator[m]&&(l+=navigator[m])}catch(n){}h.collect(l),l=null}b&&(b().mousemove(function(a){h.collectInt(a.clientX,16),h.collectInt(a.clientY,16)}),b().keypress(function(a){h.collectInt(a.charCode,8)}))}if(d.random)for(var m in h)d.random[m]=h[m];else d.random=h;d.random.createInstance=g,a.exports=d.random}("undefined"!=typeof jQuery?jQuery:null)}()},69372:function(a,b,c){var d=c(3832);c(97116);var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],f=[1,2,3,5],g=function(a,b){return a<<b&65535|(65535&a)>>16-b},h=function(a,b){return(65535&a)>>b|a<<16-b&65535};a.exports=d.rc2=d.rc2||{},d.rc2.expandKey=function(a,b){"string"==typeof a&&(a=d.util.createBuffer(a)),b=b||128;var c,f=a,g=a.length(),h=b,i=Math.ceil(h/8),j=255>>(7&h);for(c=g;c<128;c++)f.putByte(e[f.at(c-1)+f.at(c-g)&255]);for(f.setAt(128-i,e[f.at(128-i)&j]),c=127-i;c>=0;c--)f.setAt(c,e[f.at(c+1)^f.at(c+i)]);return f};var i=function(a,b,c){var e,i,j,k,l=!1,m=null,n=null,o=null,p=[];for(j=0,a=d.rc2.expandKey(a,b);j<64;j++)p.push(a.getInt16Le());c?(e=function(a){for(j=0;j<4;j++)a[j]+=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),a[j]=g(a[j],f[j]),k++},i=function(a){for(j=0;j<4;j++)a[j]+=p[63&a[(j+3)%4]]}):(e=function(a){for(j=3;j>=0;j--)a[j]=h(a[j],f[j]),a[j]-=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),k--},i=function(a){for(j=3;j>=0;j--)a[j]-=p[63&a[(j+3)%4]]});var q=function(a){var b=[];for(j=0;j<4;j++){var d=m.getInt16Le();null!==o&&(c?d^=o.getInt16Le():o.putInt16Le(d)),b.push(65535&d)}k=c?0:63;for(var e=0;e<a.length;e++)for(var f=0;f<a[e][0];f++)a[e][1](b);for(j=0;j<4;j++)null!==o&&(c?o.putInt16Le(b[j]):b[j]^=o.getInt16Le()),n.putInt16Le(b[j])},r=null;return r={start:function(a,b){a&&"string"==typeof a&&(a=d.util.createBuffer(a)),l=!1,m=d.util.createBuffer(),n=b||new d.util.createBuffer,o=a,r.output=n},update:function(a){for(l||m.putBuffer(a);m.length()>=8;)q([[5,e],[1,i],[6,e],[1,i],[5,e]])},finish:function(a){var b=!0;if(c){if(a)b=a(8,m,!c);else{var d=8===m.length()?8:8-m.length();m.fillWithByte(d,d)}}if(b&&(l=!0,r.update()),!c&&(b=0===m.length())){if(a)b=a(8,n,!c);else{var e=n.length(),f=n.at(e-1);f>e?b=!1:n.truncate(f)}}return b}}};d.rc2.startEncrypting=function(a,b,c){var e=d.rc2.createEncryptionCipher(a,128);return e.start(b,c),e},d.rc2.createEncryptionCipher=function(a,b){return i(a,b,!0)},d.rc2.startDecrypting=function(a,b,c){var e=d.rc2.createDecryptionCipher(a,128);return e.start(b,c),e},d.rc2.createDecryptionCipher=function(a,b){return i(a,b,!1)}},28095:function(a,b,c){var d=c(3832);if(c(3068),c(15764),c(66270),c(18936),c(29654),c(49563),c(97116),void 0===e)var e=d.jsbn.BigInteger;var f=d.util.isNodejs?c(25819):null,g=d.asn1,h=d.util;d.pki=d.pki||{},a.exports=d.pki.rsa=d.rsa=d.rsa||{};var i=d.pki,j=[6,4,2,4,2,4,6,2],k={name:"PrivateKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},l={name:"RSAPrivateKey",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},m={name:"RSAPublicKey",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},n=d.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:g.Class.UNIVERSAL,type:g.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},o={name:"DigestInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:g.Class.UNIVERSAL,type:g.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},p=function(a){if(a.algorithm in i.oids)b=i.oids[a.algorithm];else{var b,c=Error("Unknown message digest algorithm.");throw c.algorithm=a.algorithm,c}var d=g.oidToDer(b).getBytes(),e=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[]),f=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[]);f.value.push(g.create(g.Class.UNIVERSAL,g.Type.OID,!1,d)),f.value.push(g.create(g.Class.UNIVERSAL,g.Type.NULL,!1,""));var h=g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,a.digest().getBytes());return e.value.push(f),e.value.push(h),g.toDer(e).getBytes()},q=function(a,b,c){if(c)return a.modPow(b.e,b.n);if(!b.p||!b.q)return a.modPow(b.d,b.n);b.dP||(b.dP=b.d.mod(b.p.subtract(e.ONE))),b.dQ||(b.dQ=b.d.mod(b.q.subtract(e.ONE))),b.qInv||(b.qInv=b.q.modInverse(b.p));do f=new e(d.util.bytesToHex(d.random.getBytes(b.n.bitLength()/8)),16);while(f.compareTo(b.n)>=0||!f.gcd(b.n).equals(e.ONE));for(var f,g=(a=a.multiply(f.modPow(b.e,b.n)).mod(b.n)).mod(b.p).modPow(b.dP,b.p),h=a.mod(b.q).modPow(b.dQ,b.q);0>g.compareTo(h);)g=g.add(b.p);var i=g.subtract(h).multiply(b.qInv).mod(b.p).multiply(b.q).add(h);return i.multiply(f.modInverse(b.n)).mod(b.n)};function r(a,b,c){var e,f=d.util.createBuffer(),g=Math.ceil(b.n.bitLength()/8);if(a.length>g-11){var h=Error("Message is too long for PKCS#1 v1.5 padding.");throw h.length=a.length,h.max=g-11,h}f.putByte(0),f.putByte(c);var i=g-3-a.length;if(0===c||1===c){e=0===c?0:255;for(var j=0;j<i;++j)f.putByte(e)}else for(;i>0;){for(var k=0,l=d.random.getBytes(i),j=0;j<i;++j)0===(e=l.charCodeAt(j))?++k:f.putByte(e);i=k}return f.putByte(0),f.putBytes(a),f}function s(a,b,c,e){var f=Math.ceil(b.n.bitLength()/8),g=d.util.createBuffer(a),h=g.getByte(),i=g.getByte();if(0!==h||c&&0!==i&&1!==i|| !c&&2!=i||c&&0===i&& void 0===e)throw Error("Encryption block is invalid.");var j=0;if(0===i){j=f-3-e;for(var k=0;k<j;++k)if(0!==g.getByte())throw Error("Encryption block is invalid.")}else if(1===i)for(j=0;g.length()>1;){if(255!==g.getByte()){--g.read;break}++j}else if(2===i)for(j=0;g.length()>1;){if(0===g.getByte()){--g.read;break}++j}if(0!==g.getByte()||j!==f-3-g.length())throw Error("Encryption block is invalid.");return g.getBytes()}function t(a,b,c){"function"==typeof b&&(c=b,b={});var f={algorithm:{name:(b=b||{}).algorithm||"PRIMEINC",options:{workers:b.workers||2,workLoad:b.workLoad||100,workerScript:b.workerScript}}};function g(){h(a.pBits,function(b,d){return b?c(b):(a.p=d,null!==a.q)?j(b,a.q):void h(a.qBits,j)})}function h(a,b){d.prime.generateProbablePrime(a,f,b)}function j(b,d){if(b)return c(b);if(a.q=d,0>a.p.compareTo(a.q)){var f=a.p;a.p=a.q,a.q=f}if(0!==a.p.subtract(e.ONE).gcd(a.e).compareTo(e.ONE)){a.p=null,g();return}if(0!==a.q.subtract(e.ONE).gcd(a.e).compareTo(e.ONE)){a.q=null,h(a.qBits,j);return}if(a.p1=a.p.subtract(e.ONE),a.q1=a.q.subtract(e.ONE),a.phi=a.p1.multiply(a.q1),0!==a.phi.gcd(a.e).compareTo(e.ONE)){a.p=a.q=null,g();return}if(a.n=a.p.multiply(a.q),a.n.bitLength()!==a.bits){a.q=null,h(a.qBits,j);return}var k=a.e.modInverse(a.phi);a.keys={privateKey:i.rsa.setPrivateKey(a.n,a.e,k,a.p,a.q,k.mod(a.p1),k.mod(a.q1),a.q.modInverse(a.p)),publicKey:i.rsa.setPublicKey(a.n,a.e)},c(null,a.keys)}"prng"in b&&(f.prng=b.prng),g()}function u(a){var b=a.toString(16);b[0]>="8"&&(b="00"+b);var c=d.util.hexToBytes(b);return c.length>1&&(0===c.charCodeAt(0)&&(128&c.charCodeAt(1))==0||255===c.charCodeAt(0)&&(128&c.charCodeAt(1))==128)?c.substr(1):c}function v(a){return a<=100?27:a<=150?18:a<=200?15:a<=250?12:a<=300?9:a<=350?8:a<=400?7:a<=500?6:a<=600?5:a<=800?4:a<=1250?3:2}function w(a){return d.util.isNodejs&&"function"==typeof f[a]}function x(a){return void 0!==h.globalScope&&"object"==typeof h.globalScope.crypto&&"object"==typeof h.globalScope.crypto.subtle&&"function"==typeof h.globalScope.crypto.subtle[a]}function y(a){return void 0!==h.globalScope&&"object"==typeof h.globalScope.msCrypto&&"object"==typeof h.globalScope.msCrypto.subtle&&"function"==typeof h.globalScope.msCrypto.subtle[a]}function z(a){for(var b=d.util.hexToBytes(a.toString(16)),c=new Uint8Array(b.length),e=0;e<b.length;++e)c[e]=b.charCodeAt(e);return c}i.rsa.encrypt=function(a,b,c){var f,g=c,h=Math.ceil(b.n.bitLength()/8);!1!==c&& !0!==c?(g=2===c,f=r(a,b,c)):(f=d.util.createBuffer()).putBytes(a);for(var i=new e(f.toHex(),16),j=q(i,b,g).toString(16),k=d.util.createBuffer(),l=h-Math.ceil(j.length/2);l>0;)k.putByte(0),--l;return k.putBytes(d.util.hexToBytes(j)),k.getBytes()},i.rsa.decrypt=function(a,b,c,f){var g=Math.ceil(b.n.bitLength()/8);if(a.length!==g){var h=Error("Encrypted message length is invalid.");throw h.length=a.length,h.expected=g,h}var i=new e(d.util.createBuffer(a).toHex(),16);if(i.compareTo(b.n)>=0)throw Error("Encrypted message is invalid.");for(var j=q(i,b,c).toString(16),k=d.util.createBuffer(),l=g-Math.ceil(j.length/2);l>0;)k.putByte(0),--l;return(k.putBytes(d.util.hexToBytes(j)),!1!==f)?s(k.getBytes(),b,c):k.getBytes()},i.rsa.createKeyPairGenerationState=function(a,b,c){"string"==typeof a&&(a=parseInt(a,10)),a=a||2048;var f,g=(c=c||{}).prng||d.random,h={nextBytes:function(a){for(var b=g.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}},i=c.algorithm||"PRIMEINC";if("PRIMEINC"===i)(f={algorithm:i,state:0,bits:a,rng:h,eInt:b||65537,e:new e(null),p:null,q:null,qBits:a>>1,pBits:a-(a>>1),pqState:0,num:null,keys:null}).e.fromInt(f.eInt);else throw Error("Invalid key generation algorithm: "+i);return f},i.rsa.stepKeyPairGenerationState=function(a,b){"algorithm"in a||(a.algorithm="PRIMEINC");var c,d=new e(null);d.fromInt(30);for(var f=0,g=function(a,b){return a|b},h=+new Date,k=0;null===a.keys&&(b<=0||k<b);){if(0===a.state){var l=null===a.p?a.pBits:a.qBits,m=l-1;0===a.pqState?(a.num=new e(l,a.rng),a.num.testBit(m)||a.num.bitwiseTo(e.ONE.shiftLeft(m),g,a.num),a.num.dAddOffset(31-a.num.mod(d).byteValue(),0),f=0,++a.pqState):1===a.pqState?a.num.bitLength()>l?a.pqState=0:a.num.isProbablePrime(v(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(j[(f++)%8],0):2===a.pqState?a.pqState=0===a.num.subtract(e.ONE).gcd(a.e).compareTo(e.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&& ++a.state,a.num=null)}else if(1===a.state)0>a.p.compareTo(a.q)&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state;else if(2===a.state)a.p1=a.p.subtract(e.ONE),a.q1=a.q.subtract(e.ONE),a.phi=a.p1.multiply(a.q1),++a.state;else if(3===a.state)0===a.phi.gcd(a.e).compareTo(e.ONE)?++a.state:(a.p=null,a.q=null,a.state=0);else if(4===a.state)a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:(a.q=null,a.state=0);else if(5===a.state){var n=a.e.modInverse(a.phi);a.keys={privateKey:i.rsa.setPrivateKey(a.n,a.e,n,a.p,a.q,n.mod(a.p1),n.mod(a.q1),a.q.modInverse(a.p)),publicKey:i.rsa.setPublicKey(a.n,a.e)}}c=+new Date,k+=c-h,h=c}return null!==a.keys},i.rsa.generateKeyPair=function(a,b,c,e){if(1===arguments.length?"object"==typeof a?(c=a,a=void 0):"function"==typeof a&&(e=a,a=void 0):2===arguments.length?"number"==typeof a?"function"==typeof b?(e=b,b=void 0):"number"!=typeof b&&(c=b,b=void 0):(c=a,e=b,a=void 0,b=void 0):3===arguments.length&&("number"==typeof b?"function"==typeof c&&(e=c,c=void 0):(e=c,c=b,b=void 0)),c=c||{},void 0===a&&(a=c.bits||2048),void 0===b&&(b=c.e||65537),!d.options.usePureJavaScript&&!c.prng&&a>=256&&a<=16384&&(65537===b||3===b)){if(e){if(w("generateKeyPair"))return f.generateKeyPair("rsa",{modulusLength:a,publicExponent:b,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,b,c){if(a)return e(a);e(null,{privateKey:i.privateKeyFromPem(c),publicKey:i.publicKeyFromPem(b)})});if(x("generateKey")&&x("exportKey"))return h.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:z(b),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return h.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){e(a)}).then(function(a){if(a){var b=i.privateKeyFromAsn1(g.fromDer(d.util.createBuffer(a)));e(null,{privateKey:b,publicKey:i.setRsaPublicKey(b.n,b.e)})}});if(y("generateKey")&&y("exportKey")){var j=h.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:z(b),hash:{name:"SHA-256"}},!0,["sign","verify"]);j.oncomplete=function(a){var b=a.target.result,c=h.globalScope.msCrypto.subtle.exportKey("pkcs8",b.privateKey);c.oncomplete=function(a){var b=a.target.result,c=i.privateKeyFromAsn1(g.fromDer(d.util.createBuffer(b)));e(null,{privateKey:c,publicKey:i.setRsaPublicKey(c.n,c.e)})},c.onerror=function(a){e(a)}},j.onerror=function(a){e(a)};return}}else if(w("generateKeyPairSync")){var k=f.generateKeyPairSync("rsa",{modulusLength:a,publicExponent:b,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:i.privateKeyFromPem(k.privateKey),publicKey:i.publicKeyFromPem(k.publicKey)}}}var l=i.rsa.createKeyPairGenerationState(a,b,c);if(!e)return i.rsa.stepKeyPairGenerationState(l,0),l.keys;t(l,c,e)},i.setRsaPublicKey=i.rsa.setPublicKey=function(a,b){var c={n:a,e:b};return c.encrypt=function(a,b,e){if("string"==typeof b?b=b.toUpperCase():void 0===b&&(b="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===b)b={encode:function(a,b,c){return r(a,b,2).getBytes()}};else if("RSA-OAEP"===b||"RSAES-OAEP"===b)b={encode:function(a,b){return d.pkcs1.encode_rsa_oaep(b,a,e)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(b))b={encode:function(a){return a}};else if("string"==typeof b)throw Error('Unsupported encryption scheme: "'+b+'".');var f=b.encode(a,c,!0);return i.rsa.encrypt(f,c,!0)},c.verify=function(a,b,e,f){"string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSASSA-PKCS1-V1_5"),void 0===f&&(f={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in f||(f._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===e?e={verify:function(a,b){b=s(b,c,!0);var e=g.fromDer(b,{parseAllBytes:f._parseAllDigestBytes}),h={},i=[];if(!g.validate(e,o,h,i)){var j=Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw j.errors=i,j}var k=g.derToOid(h.algorithmIdentifier);if(!(k===d.oids.md2||k===d.oids.md5||k===d.oids.sha1||k===d.oids.sha224||k===d.oids.sha256||k===d.oids.sha384||k===d.oids.sha512||k===d.oids["sha512-224"]||k===d.oids["sha512-256"])){var j=Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw j.oid=k,j}if((k===d.oids.md2||k===d.oids.md5)&&!("parameters"in h))throw Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return a===h.digest}}:("NONE"===e||"NULL"===e||null===e)&&(e={verify:function(a,b){return b=s(b,c,!0),a===b}});var h=i.rsa.decrypt(b,c,!0,!1);return e.verify(a,h,c.n.bitLength())},c},i.setRsaPrivateKey=i.rsa.setPrivateKey=function(a,b,c,e,f,g,h,j){var k={n:a,e:b,d:c,p:e,q:f,dP:g,dQ:h,qInv:j};return k.decrypt=function(a,b,c){"string"==typeof b?b=b.toUpperCase():void 0===b&&(b="RSAES-PKCS1-V1_5");var e=i.rsa.decrypt(a,k,!1,!1);if("RSAES-PKCS1-V1_5"===b)b={decode:s};else if("RSA-OAEP"===b||"RSAES-OAEP"===b)b={decode:function(a,b){return d.pkcs1.decode_rsa_oaep(b,a,c)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(b))b={decode:function(a){return a}};else throw Error('Unsupported encryption scheme: "'+b+'".');return b.decode(e,k,!1)},k.sign=function(a,b){var c=!1;"string"==typeof b&&(b=b.toUpperCase()),void 0===b||"RSASSA-PKCS1-V1_5"===b?(b={encode:p},c=1):("NONE"===b||"NULL"===b||null===b)&&(b={encode:function(){return a}},c=1);var d=b.encode(a,k.n.bitLength());return i.rsa.encrypt(d,k,c)},k},i.wrapRsaPrivateKey=function(a){return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,g.integerToDer(0).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(i.oids.rsaEncryption).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,!1,"")]),g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,!1,g.toDer(a).getBytes())])},i.privateKeyFromAsn1=function(a){var b,c,f,h,j,m,n,o,p={},q=[];if(g.validate(a,k,p,q)&&(a=g.fromDer(d.util.createBuffer(p.privateKey))),p={},q=[],!g.validate(a,l,p,q)){var r=Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=q,r}return b=d.util.createBuffer(p.privateKeyModulus).toHex(),c=d.util.createBuffer(p.privateKeyPublicExponent).toHex(),f=d.util.createBuffer(p.privateKeyPrivateExponent).toHex(),h=d.util.createBuffer(p.privateKeyPrime1).toHex(),j=d.util.createBuffer(p.privateKeyPrime2).toHex(),m=d.util.createBuffer(p.privateKeyExponent1).toHex(),n=d.util.createBuffer(p.privateKeyExponent2).toHex(),o=d.util.createBuffer(p.privateKeyCoefficient).toHex(),i.setRsaPrivateKey(new e(b,16),new e(c,16),new e(f,16),new e(h,16),new e(j,16),new e(m,16),new e(n,16),new e(o,16))},i.privateKeyToAsn1=i.privateKeyToRSAPrivateKey=function(a){return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,g.integerToDer(0).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.n)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.e)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.d)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.p)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.q)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.dP)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.dQ)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.qInv))])},i.publicKeyFromAsn1=function(a){var b={},c=[];if(g.validate(a,n,b,c)){var f=g.derToOid(b.publicKeyOid);if(f!==i.oids.rsaEncryption){var h=Error("Cannot read public key. Unknown OID.");throw h.oid=f,h}a=b.rsaPublicKey}if(c=[],!g.validate(a,m,b,c)){var h=Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw h.errors=c,h}var j=d.util.createBuffer(b.publicKeyModulus).toHex(),k=d.util.createBuffer(b.publicKeyExponent).toHex();return i.setRsaPublicKey(new e(j,16),new e(k,16))},i.publicKeyToAsn1=i.publicKeyToSubjectPublicKeyInfo=function(a){return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.OID,!1,g.oidToDer(i.oids.rsaEncryption).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,!1,"")]),g.create(g.Class.UNIVERSAL,g.Type.BITSTRING,!1,[i.publicKeyToRSAPublicKey(a)])])},i.publicKeyToRSAPublicKey=function(a){return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,!0,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.n)),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,!1,u(a.e))])}},137:function(a,b,c){var d=c(3832);c(28991),c(97116);var e=a.exports=d.sha1=d.sha1||{};d.md.sha1=d.md.algorithms.sha1=e,e.create=function(){g||h();var a=null,b=d.util.createBuffer(),c=Array(80),e={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return e.start=function(){e.messageLength=0,e.fullMessageLength=e.messageLength64=[];for(var c=e.messageLengthSize/4,f=0;f<c;++f)e.fullMessageLength.push(0);return b=d.util.createBuffer(),a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},e},e.start(),e.update=function(f,g){"utf8"===g&&(f=d.util.encodeUtf8(f));var h=f.length;e.messageLength+=h,h=[h/4294967296>>>0,h>>>0];for(var j=e.fullMessageLength.length-1;j>=0;--j)e.fullMessageLength[j]+=h[1],h[1]=h[0]+(e.fullMessageLength[j]/4294967296>>>0),e.fullMessageLength[j]=e.fullMessageLength[j]>>>0,h[0]=h[1]/4294967296>>>0;return b.putBytes(f),i(a,c,b),(b.read>2048||0===b.length())&&b.compact(),e},e.digest=function(){var g,h,j=d.util.createBuffer();j.putBytes(b.bytes());var k=e.fullMessageLength[e.fullMessageLength.length-1]+e.messageLengthSize&e.blockLength-1;j.putBytes(f.substr(0,e.blockLength-k));for(var l=8*e.fullMessageLength[0],m=0;m<e.fullMessageLength.length-1;++m)l+=h=(g=8*e.fullMessageLength[m+1])/4294967296>>>0,j.putInt32(l>>>0),l=g>>>0;j.putInt32(l);var n={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4};i(n,c,j);var o=d.util.createBuffer();return o.putInt32(n.h0),o.putInt32(n.h1),o.putInt32(n.h2),o.putInt32(n.h3),o.putInt32(n.h4),o},e};var f=null,g=!1;function h(){f="\x80",f+=d.util.fillString("\0",64),g=!0}function i(a,b,c){for(var d,e,f,g,h,i,j,k,l=c.length();l>=64;){for(k=0,e=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4;k<16;++k)d=c.getInt32(),b[k]=d,d=(e<<5|e>>>27)+(j=h^f&(g^h))+i+1518500249+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<20;++k)d=(d=b[k-3]^b[k-8]^b[k-14]^b[k-16])<<1|d>>>31,b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<32;++k)d=(d=b[k-3]^b[k-8]^b[k-14]^b[k-16])<<1|d>>>31,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<40;++k)d=(d=b[k-6]^b[k-16]^b[k-28]^b[k-32])<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<60;++k)d=(d=b[k-6]^b[k-16]^b[k-28]^b[k-32])<<2|d>>>30,b[k]=d,j=f&g|h&(f^g),d=(e<<5|e>>>27)+j+i+2400959708+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;for(;k<80;++k)d=(d=b[k-6]^b[k-16]^b[k-28]^b[k-32])<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+3395469782+d,i=h,h=g,g=(f<<30|f>>>2)>>>0,f=e,e=d;a.h0=a.h0+e|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,a.h4=a.h4+i|0,l-=64}}},41668:function(a,b,c){var d=c(3832);c(28991),c(97116);var e=a.exports=d.sha256=d.sha256||{};d.md.sha256=d.md.algorithms.sha256=e,e.create=function(){g||i();var a=null,b=d.util.createBuffer(),c=Array(64),e={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return e.start=function(){e.messageLength=0,e.fullMessageLength=e.messageLength64=[];for(var c=e.messageLengthSize/4,f=0;f<c;++f)e.fullMessageLength.push(0);return b=d.util.createBuffer(),a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},e},e.start(),e.update=function(f,g){"utf8"===g&&(f=d.util.encodeUtf8(f));var h=f.length;e.messageLength+=h,h=[h/4294967296>>>0,h>>>0];for(var i=e.fullMessageLength.length-1;i>=0;--i)e.fullMessageLength[i]+=h[1],h[1]=h[0]+(e.fullMessageLength[i]/4294967296>>>0),e.fullMessageLength[i]=e.fullMessageLength[i]>>>0,h[0]=h[1]/4294967296>>>0;return b.putBytes(f),j(a,c,b),(b.read>2048||0===b.length())&&b.compact(),e},e.digest=function(){var g,h,i=d.util.createBuffer();i.putBytes(b.bytes());var k=e.fullMessageLength[e.fullMessageLength.length-1]+e.messageLengthSize&e.blockLength-1;i.putBytes(f.substr(0,e.blockLength-k));for(var l=8*e.fullMessageLength[0],m=0;m<e.fullMessageLength.length-1;++m)l+=h=(g=8*e.fullMessageLength[m+1])/4294967296>>>0,i.putInt32(l>>>0),l=g>>>0;i.putInt32(l);var n={h0:a.h0,h1:a.h1,h2:a.h2,h3:a.h3,h4:a.h4,h5:a.h5,h6:a.h6,h7:a.h7};j(n,c,i);var o=d.util.createBuffer();return o.putInt32(n.h0),o.putInt32(n.h1),o.putInt32(n.h2),o.putInt32(n.h3),o.putInt32(n.h4),o.putInt32(n.h5),o.putInt32(n.h6),o.putInt32(n.h7),o},e};var f=null,g=!1,h=null;function i(){f="\x80",f+=d.util.fillString("\0",64),h=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=!0}function j(a,b,c){for(var d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t=c.length();t>=64;){for(k=0;k<16;++k)b[k]=c.getInt32();for(;k<64;++k)d=((d=b[k-2])>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,e=b[k-15],e=(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3,b[k]=d+b[k-7]+e+b[k-16]|0;for(k=0,l=a.h0,m=a.h1,n=a.h2,o=a.h3,p=a.h4,q=a.h5,r=a.h6,s=a.h7;k<64;++k)g=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),i=r^p&(q^r),f=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),j=l&m|n&(l^m),d=s+g+i+h[k]+b[k],e=f+j,s=r,r=q,q=p,p=o+d>>>0,o=n,n=m,m=l,l=d+e>>>0;a.h0=a.h0+l|0,a.h1=a.h1+m|0,a.h2=a.h2+n|0,a.h3=a.h3+o|0,a.h4=a.h4+p|0,a.h5=a.h5+q|0,a.h6=a.h6+r|0,a.h7=a.h7+s|0,t-=64}}},63219:function(a,b,c){var d=c(3832);c(28991),c(97116);var e=a.exports=d.sha512=d.sha512||{};d.md.sha512=d.md.algorithms.sha512=e;var f=d.sha384=d.sha512.sha384=d.sha512.sha384||{};f.create=function(){return e.create("SHA-384")},d.md.sha384=d.md.algorithms.sha384=f,d.sha512.sha256=d.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},d.md["sha512/256"]=d.md.algorithms["sha512/256"]=d.sha512.sha256,d.sha512.sha224=d.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},d.md["sha512/224"]=d.md.algorithms["sha512/224"]=d.sha512.sha224,e.create=function(a){if(h||k(),void 0===a&&(a="SHA-512"),!(a in j))throw Error("Invalid SHA-512 algorithm: "+a);for(var b=j[a],c=null,e=d.util.createBuffer(),f=Array(80),i=0;i<80;++i)f[i]=[,,];var m=64;switch(a){case"SHA-384":m=48;break;case"SHA-512/256":m=32;break;case"SHA-512/224":m=28}var n={algorithm:a.replace("-","").toLowerCase(),blockLength:128,digestLength:m,messageLength:0,fullMessageLength:null,messageLengthSize:16};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength128=[];for(var a=n.messageLengthSize/4,f=0;f<a;++f)n.fullMessageLength.push(0);e=d.util.createBuffer(),c=Array(b.length);for(var f=0;f<b.length;++f)c[f]=b[f].slice(0);return n},n.start(),n.update=function(a,b){"utf8"===b&&(a=d.util.encodeUtf8(a));var g=a.length;n.messageLength+=g,g=[g/4294967296>>>0,g>>>0];for(var h=n.fullMessageLength.length-1;h>=0;--h)n.fullMessageLength[h]+=g[1],g[1]=g[0]+(n.fullMessageLength[h]/4294967296>>>0),n.fullMessageLength[h]=n.fullMessageLength[h]>>>0,g[0]=g[1]/4294967296>>>0;return e.putBytes(a),l(c,f,e),(e.read>2048||0===e.length())&&e.compact(),n},n.digest=function(){var b,h,i,j=d.util.createBuffer();j.putBytes(e.bytes());var k=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize&n.blockLength-1;j.putBytes(g.substr(0,n.blockLength-k));for(var m=8*n.fullMessageLength[0],o=0;o<n.fullMessageLength.length-1;++o)m+=h=(b=8*n.fullMessageLength[o+1])/4294967296>>>0,j.putInt32(m>>>0),m=b>>>0;j.putInt32(m);for(var p=Array(c.length),o=0;o<c.length;++o)p[o]=c[o].slice(0);l(p,f,j);var q=d.util.createBuffer();i="SHA-512"===a?p.length:"SHA-384"===a?p.length-2:p.length-4;for(var o=0;o<i;++o)q.putInt32(p[o][0]),(o!==i-1||"SHA-512/224"!==a)&&q.putInt32(p[o][1]);return q},n};var g=null,h=!1,i=null,j=null;function k(){g="\x80",g+=d.util.fillString("\0",128),i=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(j={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],j["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],j["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],j["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],h=!0}function l(a,b,c){for(var d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=c.length();N>=128;){for(G=0;G<16;++G)b[G][0]=c.getInt32()>>>0,b[G][1]=c.getInt32()>>>0;for(;G<80;++G)H=(J=b[G-2])[0],I=J[1],d=((H>>>19|I<<13)^(I>>>29|H<<3)^H>>>6)>>>0,e=((H<<13|I>>>19)^(I<<3|H>>>29)^(H<<26|I>>>6))>>>0,L=b[G-15],H=L[0],I=L[1],f=((H>>>1|I<<31)^(H>>>8|I<<24)^H>>>7)>>>0,g=((H<<31|I>>>1)^(H<<24|I>>>8)^(H<<25|I>>>7))>>>0,K=b[G-7],M=b[G-16],I=e+K[1]+g+M[1],b[G][0]=d+K[0]+f+M[0]+(I/4294967296>>>0)>>>0,b[G][1]=I>>>0;for(G=0,q=a[0][0],r=a[0][1],s=a[1][0],t=a[1][1],u=a[2][0],v=a[2][1],w=a[3][0],x=a[3][1],y=a[4][0],z=a[4][1],A=a[5][0],B=a[5][1],C=a[6][0],D=a[6][1],E=a[7][0],F=a[7][1];G<80;++G)k=((y>>>14|z<<18)^(y>>>18|z<<14)^(z>>>9|y<<23))>>>0,l=((y<<18|z>>>14)^(y<<14|z>>>18)^(z<<23|y>>>9))>>>0,m=(C^y&(A^C))>>>0,n=(D^z&(B^D))>>>0,h=((q>>>28|r<<4)^(r>>>2|q<<30)^(r>>>7|q<<25))>>>0,j=((q<<4|r>>>28)^(r<<30|q>>>2)^(r<<25|q>>>7))>>>0,o=(q&s|u&(q^s))>>>0,p=(r&t|v&(r^t))>>>0,I=F+l+n+i[G][1]+b[G][1],d=E+k+m+i[G][0]+b[G][0]+(I/4294967296>>>0)>>>0,e=I>>>0,I=j+p,f=h+o+(I/4294967296>>>0)>>>0,g=I>>>0,E=C,F=D,C=A,D=B,A=y,B=z,I=x+e,y=w+d+(I/4294967296>>>0)>>>0,z=I>>>0,w=u,x=v,u=s,v=t,s=q,t=r,I=e+g,q=d+f+(I/4294967296>>>0)>>>0,r=I>>>0;I=a[0][1]+r,a[0][0]=a[0][0]+q+(I/4294967296>>>0)>>>0,a[0][1]=I>>>0,I=a[1][1]+t,a[1][0]=a[1][0]+s+(I/4294967296>>>0)>>>0,a[1][1]=I>>>0,I=a[2][1]+v,a[2][0]=a[2][0]+u+(I/4294967296>>>0)>>>0,a[2][1]=I>>>0,I=a[3][1]+x,a[3][0]=a[3][0]+w+(I/4294967296>>>0)>>>0,a[3][1]=I>>>0,I=a[4][1]+z,a[4][0]=a[4][0]+y+(I/4294967296>>>0)>>>0,a[4][1]=I>>>0,I=a[5][1]+B,a[5][0]=a[5][0]+A+(I/4294967296>>>0)>>>0,a[5][1]=I>>>0,I=a[6][1]+D,a[6][0]=a[6][0]+C+(I/4294967296>>>0)>>>0,a[6][1]=I>>>0,I=a[7][1]+F,a[7][0]=a[7][0]+E+(I/4294967296>>>0)>>>0,a[7][1]=I>>>0,N-=128}}},97116:function(a,b,c){var d=c(24112),e=c(62678).Buffer,f=c(3832),g=c(78807),h=a.exports=f.util=f.util||{};function i(a){if(!(8===a||16===a||24===a||32===a))throw Error("Only 8, 16, 24, or 32 bits supported: "+a)}function j(a){if(this.data="",this.read=0,"string"==typeof a)this.data=a;else if(h.isArrayBuffer(a)||h.isArrayBufferView(a)){if(void 0!==e&&a instanceof e)this.data=a.toString("binary");else{var b=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,b)}catch(c){for(var d=0;d<b.length;++d)this.putByte(b[d])}}}else(a instanceof j||"object"==typeof a&&"string"==typeof a.data&&"number"==typeof a.read)&&(this.data=a.data,this.read=a.read);this._constructedStringLength=0}!function(){if(void 0!==d&&d.nextTick,"function"==typeof setImmediate){h.setImmediate=function(){return setImmediate.apply(void 0,arguments)},h.nextTick=function(a){return setImmediate(a)};return}if(h.setImmediate=function(a){setTimeout(a,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var a="forge.setImmediate",b=[];function c(c){if(c.source===window&&c.data===a){c.stopPropagation();var d=b.slice();b.length=0,d.forEach(function(a){a()})}}h.setImmediate=function(c){b.push(c),1===b.length&&window.postMessage(a,"*")},window.addEventListener("message",c,!0)}if("undefined"!=typeof MutationObserver){var e=Date.now(),f=!0,g=document.createElement("div"),b=[];new MutationObserver(function(){var a=b.slice();b.length=0,a.forEach(function(a){a()})}).observe(g,{attributes:!0});var i=h.setImmediate;h.setImmediate=function(a){Date.now()-e>15?(e=Date.now(),i(a)):(b.push(a),1===b.length&&g.setAttribute("a",f=!f))}}h.nextTick=h.setImmediate}(),h.isNodejs=void 0!==d&&d.versions&&d.versions.node,h.globalScope=h.isNodejs?c.g:"undefined"==typeof self?window:self,h.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},h.isArrayBuffer=function(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer},h.isArrayBufferView=function(a){return a&&h.isArrayBuffer(a.buffer)&& void 0!==a.byteLength},h.ByteBuffer=j,h.ByteStringBuffer=j;var k=4096;function l(a,b){b=b||{},this.read=b.readOffset||0,this.growSize=b.growSize||1024;var c=h.isArrayBuffer(a),d=h.isArrayBufferView(a);if(c||d){c?this.data=new DataView(a):this.data=new DataView(a.buffer,a.byteOffset,a.byteLength),this.write="writeOffset"in b?b.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=a&&this.putBytes(a),"writeOffset"in b&&(this.write=b.writeOffset)}h.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a,this._constructedStringLength>k&&(this.data.substr(0,1),this._constructedStringLength=0)},h.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},h.ByteStringBuffer.prototype.isEmpty=function(){return 0>=this.length()},h.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))},h.ByteStringBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var c=this.data;b>0;)1&b&&(c+=a),(b>>>=1)>0&&(a+=a);return this.data=c,this._optimizeConstructedString(b),this},h.ByteStringBuffer.prototype.putBytes=function(a){return this.data+=a,this._optimizeConstructedString(a.length),this},h.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(h.encodeUtf8(a))},h.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},h.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},h.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},h.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255))},h.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))},h.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))},h.ByteStringBuffer.prototype.putInt=function(a,b){i(b);var c="";do b-=8,c+=String.fromCharCode(a>>b&255);while(b>0);return this.putBytes(c)},h.ByteStringBuffer.prototype.putSignedInt=function(a,b){return a<0&&(a+=2<<b-1),this.putInt(a,b)},h.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())},h.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},h.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a},h.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a},h.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},h.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a},h.ByteStringBuffer.prototype.getInt24Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a},h.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a},h.ByteStringBuffer.prototype.getInt=function(a){i(a);var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(a>0);return b},h.ByteStringBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},h.ByteStringBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},h.ByteStringBuffer.prototype.bytes=function(a){return void 0===a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},h.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)},h.ByteStringBuffer.prototype.setAt=function(a,b){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1),this},h.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},h.ByteStringBuffer.prototype.copy=function(){var a=h.createBuffer(this.data);return a.read=this.read,a},h.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},h.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},h.ByteStringBuffer.prototype.truncate=function(a){var b=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,b),this.read=0,this},h.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);c<16&&(a+="0"),a+=c.toString(16)}return a},h.ByteStringBuffer.prototype.toString=function(){return h.decodeUtf8(this.bytes())},h.DataBuffer=l,h.DataBuffer.prototype.length=function(){return this.write-this.read},h.DataBuffer.prototype.isEmpty=function(){return 0>=this.length()},h.DataBuffer.prototype.accommodate=function(a,b){if(this.length()>=a)return this;b=Math.max(b||this.growSize,a);var c=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),d=new Uint8Array(this.length()+b);return d.set(c),this.data=new DataView(d.buffer),this},h.DataBuffer.prototype.putByte=function(a){return this.accommodate(1),this.data.setUint8(this.write++,a),this},h.DataBuffer.prototype.fillWithByte=function(a,b){this.accommodate(b);for(var c=0;c<b;++c)this.data.setUint8(a);return this},h.DataBuffer.prototype.putBytes=function(a,b){if(h.isArrayBufferView(a)){var c,d=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),e=d.byteLength-d.byteOffset;this.accommodate(e);var f=new Uint8Array(this.data.buffer,this.write);return f.set(d),this.write+=e,this}if(h.isArrayBuffer(a)){var d=new Uint8Array(a);this.accommodate(d.byteLength);var f=new Uint8Array(this.data.buffer);return f.set(d,this.write),this.write+=d.byteLength,this}if(a instanceof h.DataBuffer||"object"==typeof a&&"number"==typeof a.read&&"number"==typeof a.write&&h.isArrayBufferView(a.data)){var d=new Uint8Array(a.data.byteLength,a.read,a.length());this.accommodate(d.byteLength);var f=new Uint8Array(a.data.byteLength,this.write);return f.set(d),this.write+=d.byteLength,this}if(a instanceof h.ByteStringBuffer&&(a=a.data,b="binary"),b=b||"binary","string"==typeof a){if("hex"===b)return this.accommodate(Math.ceil(a.length/2)),c=new Uint8Array(this.data.buffer,this.write),this.write+=h.binary.hex.decode(a,c,this.write),this;if("base64"===b)return this.accommodate(3*Math.ceil(a.length/4)),c=new Uint8Array(this.data.buffer,this.write),this.write+=h.binary.base64.decode(a,c,this.write),this;if("utf8"===b&&(a=h.encodeUtf8(a),b="binary"),"binary"===b||"raw"===b)return this.accommodate(a.length),c=new Uint8Array(this.data.buffer,this.write),this.write+=h.binary.raw.decode(c),this;if("utf16"===b)return this.accommodate(2*a.length),c=new Uint16Array(this.data.buffer,this.write),this.write+=h.text.utf16.encode(c),this;throw Error("Invalid encoding: "+b)}throw Error("Invalid parameter: "+a)},h.DataBuffer.prototype.putBuffer=function(a){return this.putBytes(a),a.clear(),this},h.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")},h.DataBuffer.prototype.putInt16=function(a){return this.accommodate(2),this.data.setInt16(this.write,a),this.write+=2,this},h.DataBuffer.prototype.putInt24=function(a){return this.accommodate(3),this.data.setInt16(this.write,a>>8&65535),this.data.setInt8(this.write,a>>16&255),this.write+=3,this},h.DataBuffer.prototype.putInt32=function(a){return this.accommodate(4),this.data.setInt32(this.write,a),this.write+=4,this},h.DataBuffer.prototype.putInt16Le=function(a){return this.accommodate(2),this.data.setInt16(this.write,a,!0),this.write+=2,this},h.DataBuffer.prototype.putInt24Le=function(a){return this.accommodate(3),this.data.setInt8(this.write,a>>16&255),this.data.setInt16(this.write,a>>8&65535,!0),this.write+=3,this},h.DataBuffer.prototype.putInt32Le=function(a){return this.accommodate(4),this.data.setInt32(this.write,a,!0),this.write+=4,this},h.DataBuffer.prototype.putInt=function(a,b){i(b),this.accommodate(b/8);do b-=8,this.data.setInt8(this.write++,a>>b&255);while(b>0);return this},h.DataBuffer.prototype.putSignedInt=function(a,b){return i(b),this.accommodate(b/8),a<0&&(a+=2<<b-1),this.putInt(a,b)},h.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},h.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);return this.read+=2,a},h.DataBuffer.prototype.getInt24=function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,a},h.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);return this.read+=4,a},h.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);return this.read+=2,a},h.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,a},h.DataBuffer.prototype.getInt32Le=function(){var a=this.data.getInt32(this.read,!0);return this.read+=4,a},h.DataBuffer.prototype.getInt=function(a){i(a);var b=0;do b=(b<<8)+this.data.getInt8(this.read++),a-=8;while(a>0);return b},h.DataBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},h.DataBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},h.DataBuffer.prototype.bytes=function(a){return void 0===a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},h.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)},h.DataBuffer.prototype.setAt=function(a,b){return this.data.setUint8(a,b),this},h.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},h.DataBuffer.prototype.copy=function(){return new h.DataBuffer(this)},h.DataBuffer.prototype.compact=function(){if(this.read>0){var a=new Uint8Array(this.data.buffer,this.read),b=new Uint8Array(a.byteLength);b.set(a),this.data=new DataView(b),this.write-=this.read,this.read=0}return this},h.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},h.DataBuffer.prototype.truncate=function(a){return this.write=Math.max(0,this.length()-a),this.read=Math.min(this.read,this.write),this},h.DataBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.byteLength;++b){var c=this.data.getUint8(b);c<16&&(a+="0"),a+=c.toString(16)}return a},h.DataBuffer.prototype.toString=function(a){var b=new Uint8Array(this.data,this.read,this.length());if("binary"===(a=a||"utf8")||"raw"===a)return h.binary.raw.encode(b);if("hex"===a)return h.binary.hex.encode(b);if("base64"===a)return h.binary.base64.encode(b);if("utf8"===a)return h.text.utf8.decode(b);if("utf16"===a)return h.text.utf16.decode(b);throw Error("Invalid encoding: "+a)},h.createBuffer=function(a,b){return b=b||"raw",void 0!==a&&"utf8"===b&&(a=h.encodeUtf8(a)),new h.ByteBuffer(a)},h.fillString=function(a,b){for(var c="";b>0;)1&b&&(c+=a),(b>>>=1)>0&&(a+=a);return c},h.xorBytes=function(a,b,c){for(var d="",e="",f="",g=0,h=0;c>0;--c,++g)e=a.charCodeAt(g)^b.charCodeAt(g),h>=10&&(d+=f,f="",h=0),f+=String.fromCharCode(e),++h;return d+f},h.hexToBytes=function(a){var b="",c=0;for(!0&a.length&&(c=1,b+=String.fromCharCode(parseInt(a[0],16)));c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b},h.bytesToHex=function(a){return h.createBuffer(a).toHex()},h.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)};var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],o="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";h.encode64=function(a,b){for(var c,d,e,f="",g="",h=0;h<a.length;)c=a.charCodeAt(h++),d=a.charCodeAt(h++),e=a.charCodeAt(h++),f+=m.charAt(c>>2),f+=m.charAt((3&c)<<4|d>>4),isNaN(d)?f+="==":(f+=m.charAt((15&d)<<2|e>>6),f+=isNaN(e)?"=":m.charAt(63&e)),b&&f.length>b&&(g+=f.substr(0,b)+"\r\n",f=f.substr(b));return g+f},h.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b,c,d,e,f="",g=0;g<a.length;)b=n[a.charCodeAt(g++)-43],c=n[a.charCodeAt(g++)-43],d=n[a.charCodeAt(g++)-43],e=n[a.charCodeAt(g++)-43],f+=String.fromCharCode(b<<2|c>>4),64!==d&&(f+=String.fromCharCode((15&c)<<4|d>>2),64!==e&&(f+=String.fromCharCode((3&d)<<6|e)));return f},h.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},h.decodeUtf8=function(a){return decodeURIComponent(escape(a))},h.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:g.encode,decode:g.decode}},h.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)},h.binary.raw.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(a.length));for(var e=c=c||0,f=0;f<a.length;++f)d[e++]=a.charCodeAt(f);return b?e-c:d},h.binary.hex.encode=h.bytesToHex,h.binary.hex.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(Math.ceil(a.length/2)));var e=0,f=c=c||0;for(1&a.length&&(e=1,d[f++]=parseInt(a[0],16));e<a.length;e+=2)d[f++]=parseInt(a.substr(e,2),16);return b?f-c:d},h.binary.base64.encode=function(a,b){for(var c,d,e,f="",g="",h=0;h<a.byteLength;)c=a[h++],d=a[h++],e=a[h++],f+=m.charAt(c>>2),f+=m.charAt((3&c)<<4|d>>4),isNaN(d)?f+="==":(f+=m.charAt((15&d)<<2|e>>6),f+=isNaN(e)?"=":m.charAt(63&e)),b&&f.length>b&&(g+=f.substr(0,b)+"\r\n",f=f.substr(b));return g+f},h.binary.base64.decode=function(a,b,c){var d,e,f,g,h=b;h||(h=new Uint8Array(3*Math.ceil(a.length/4))),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var i=0,j=c=c||0;i<a.length;)d=n[a.charCodeAt(i++)-43],e=n[a.charCodeAt(i++)-43],f=n[a.charCodeAt(i++)-43],g=n[a.charCodeAt(i++)-43],h[j++]=d<<2|e>>4,64!==f&&(h[j++]=(15&e)<<4|f>>2,64!==g&&(h[j++]=(3&f)<<6|g));return b?j-c:h.subarray(0,j)},h.binary.base58.encode=function(a,b){return h.binary.baseN.encode(a,o,b)},h.binary.base58.decode=function(a,b){return h.binary.baseN.decode(a,o,b)},h.text={utf8:{},utf16:{}},h.text.utf8.encode=function(a,b,c){a=h.encodeUtf8(a);var d=b;d||(d=new Uint8Array(a.length));for(var e=c=c||0,f=0;f<a.length;++f)d[e++]=a.charCodeAt(f);return b?e-c:d},h.text.utf8.decode=function(a){return h.decodeUtf8(String.fromCharCode.apply(null,a))},h.text.utf16.encode=function(a,b,c){var d=b;d||(d=new Uint8Array(2*a.length));for(var e=new Uint16Array(d.buffer),f=c=c||0,g=c,h=0;h<a.length;++h)e[g++]=a.charCodeAt(h),f+=2;return b?f-c:d},h.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a.buffer))},h.deflate=function(a,b,c){if(b=h.decode64(a.deflate(h.encode64(b)).rval),c){var d=2;32&b.charCodeAt(1)&&(d=6),b=b.substring(d,b.length-4)}return b},h.inflate=function(a,b,c){var d=a.inflate(h.encode64(b)).rval;return null===d?null:h.decode64(d)};var p=function(a,b,c){if(!a)throw Error("WebStorage not available.");if(null===c?d=a.removeItem(b):(c=h.encode64(JSON.stringify(c)),d=a.setItem(b,c)),void 0!==d&& !0!==d.rval){var d,e=Error(d.error.message);throw e.id=d.error.id,e.name=d.error.name,e}},q=function(a,b){if(!a)throw Error("WebStorage not available.");var c=a.getItem(b);if(a.init){if(null===c.rval){if(c.error){var d=Error(c.error.message);throw d.id=c.error.id,d.name=c.error.name,d}c=null}else c=c.rval}return null!==c&&(c=JSON.parse(h.decode64(c))),c},r=function(a,b,c,d){var e=q(a,b);null===e&&(e={}),e[c]=d,p(a,b,e)},s=function(a,b,c){var d=q(a,b);return null!==d&&(d=c in d?d[c]:null),d},t=function(a,b,c){var d=q(a,b);if(null!==d&&c in d){delete d[c];var e=!0;for(var f in d){e=!1;break}e&&(d=null),p(a,b,d)}},u=function(a,b){p(a,b,null)},v=function(a,b,c){var d,e=null;void 0===c&&(c=["web","flash"]);var f=!1,g=null;for(var h in c){d=c[h];try{if("flash"===d||"both"===d){if(null===b[0])throw Error("Flash local storage not available.");e=a.apply(this,b),f="flash"===d}("web"===d||"both"===d)&&(b[0]=localStorage,e=a.apply(this,b),f=!0)}catch(i){g=i}if(f)break}if(!f)throw g;return e};h.setItem=function(a,b,c,d,e){v(r,arguments,e)},h.getItem=function(a,b,c,d){return v(s,arguments,d)},h.removeItem=function(a,b,c,d){v(t,arguments,d)},h.clearItems=function(a,b,c){v(u,arguments,c)},h.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},h.format=function(a){for(var b,c,d=/%./g,e=0,f=[],g=0;b=d.exec(a);){(c=a.substring(g,d.lastIndex-2)).length>0&&f.push(c),g=d.lastIndex;var h=b[0][1];switch(h){case"s":case"o":e<arguments.length?f.push(arguments[(e++)+1]):f.push("<?>");break;case"%":f.push("%");break;default:f.push("<%"+h+"?>")}}return f.push(a.substring(g)),f.join("")},h.formatNumber=function(a,b,c,d){var e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0===c?",":c,h=void 0===d?".":d,i=e<0?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f),10)+"",k=j.length>3?j.length%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")},h.formatSize=function(a){return a=a>=1073741824?h.formatNumber(a/1073741824,2,".","")+" GiB":a>=1048576?h.formatNumber(a/1048576,2,".","")+" MiB":a>=1024?h.formatNumber(a/1024,0)+" KiB":h.formatNumber(a,0)+" bytes"},h.bytesFromIP=function(a){return -1!==a.indexOf(".")?h.bytesFromIPv4(a):-1!==a.indexOf(":")?h.bytesFromIPv6(a):null},h.bytesFromIPv4=function(a){if(4!==(a=a.split(".")).length)return null;for(var b=h.createBuffer(),c=0;c<a.length;++c){var d=parseInt(a[c],10);if(isNaN(d))return null;b.putByte(d)}return b.getBytes()},h.bytesFromIPv6=function(a){for(var b=0,c=(8-(a=a.split(":").filter(function(a){return 0===a.length&& ++b,!0})).length+b)*2,d=h.createBuffer(),e=0;e<8;++e){if(!a[e]||0===a[e].length){d.fillWithByte(0,c),c=0;continue}var f=h.hexToBytes(a[e]);f.length<2&&d.putByte(0),d.putBytes(f)}return d.getBytes()},h.bytesToIP=function(a){return 4===a.length?h.bytesToIPv4(a):16===a.length?h.bytesToIPv6(a):null},h.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b.join(".")},h.bytesToIPv6=function(a){if(16!==a.length)return null;for(var b=[],c=[],d=0,e=0;e<a.length;e+=2){for(var f=h.bytesToHex(a[e]+a[e+1]);"0"===f[0]&&"0"!==f;)f=f.substr(1);if("0"===f){var g=c[c.length-1],i=b.length;g&&i===g.end+1?(g.end=i,g.end-g.start>c[d].end-c[d].start&&(d=c.length-1)):c.push({start:i,end:i})}b.push(f)}if(c.length>0){var j=c[d];j.end-j.start>0&&(b.splice(j.start,j.end-j.start+1,""),0===j.start&&b.unshift(""),7===j.end&&b.push(""))}return b.join(":")},h.estimateCores=function(a,b){if("function"==typeof a&&(b=a,a={}),a=a||{},"cores"in h&&!a.update)return b(null,h.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return h.cores=navigator.hardwareConcurrency,b(null,h.cores);if("undefined"==typeof Worker)return h.cores=1,b(null,h.cores);if("undefined"==typeof Blob)return h.cores=2,b(null,h.cores);var c=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(a){for(var b=Date.now(),c=b+4;Date.now()<c;);self.postMessage({st:b,et:c})})}).toString(),")()"],{type:"application/javascript"}));function d(a,g,i){if(0===g){var j=Math.floor(a.reduce(function(a,b){return a+b},0)/a.length);return h.cores=Math.max(1,j),URL.revokeObjectURL(c),b(null,h.cores)}e(i,function(b,c){a.push(f(i,c)),d(a,g-1,i)})}function e(a,b){for(var d=[],e=[],f=0;f<a;++f){var g=new Worker(c);g.addEventListener("message",function(c){if(e.push(c.data),e.length===a){for(var f=0;f<a;++f)d[f].terminate();b(null,e)}}),d.push(g)}for(var f=0;f<a;++f)d[f].postMessage(f)}function f(a,b){for(var c=[],d=0;d<a;++d)for(var e=b[d],f=c[d]=[],g=0;g<a;++g)if(d!==g){var h=b[g];(e.st>h.st&&e.st<h.et||h.st>e.st&&h.st<e.et)&&f.push(g)}return c.reduce(function(a,b){return Math.max(a,b.length)},0)}d([],5,16)}},25414:function(a,b,c){var d=c(3832);c(8925),c(3068),c(33480),c(28991),c(86971),c(66270),c(26953),c(96007),c(28095),c(97116);var e=d.asn1,f=a.exports=d.pki=d.pki||{},g=f.oids,h={};h.CN=g.commonName,h.commonName="CN",h.C=g.countryName,h.countryName="C",h.L=g.localityName,h.localityName="L",h.ST=g.stateOrProvinceName,h.stateOrProvinceName="ST",h.O=g.organizationName,h.organizationName="O",h.OU=g.organizationalUnitName,h.organizationalUnitName="OU",h.E=g.emailAddress,h.emailAddress="E";var i=d.pki.rsa.publicKeyValidator,j={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},i,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},k={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},l={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},i,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},m={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[l,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function n(a,b){"string"==typeof b&&(b={shortName:b});for(var c,d=null,e=0;null===d&&e<a.attributes.length;++e)c=a.attributes[e],b.type&&b.type===c.type?d=c:b.name&&b.name===c.name?d=c:b.shortName&&b.shortName===c.shortName&&(d=c);return d}f.RDNAttributesAsArray=function(a,b){for(var c,d,f,i=[],j=0;j<a.value.length;++j){c=a.value[j];for(var k=0;k<c.value.length;++k)f={},d=c.value[k],f.type=e.derToOid(d.value[0].value),f.value=d.value[1].value,f.valueTagClass=d.value[1].type,f.type in g&&(f.name=g[f.type],f.name in h&&(f.shortName=h[f.name])),b&&(b.update(f.type),b.update(f.value)),i.push(f)}return i},f.CRIAttributesAsArray=function(a){for(var b=[],c=0;c<a.length;++c)for(var d=a[c],i=e.derToOid(d.value[0].value),j=d.value[1].value,k=0;k<j.length;++k){var l={};if(l.type=i,l.value=j[k].value,l.valueTagClass=j[k].type,l.type in g&&(l.name=g[l.type],l.name in h&&(l.shortName=h[l.name])),l.type===g.extensionRequest){l.extensions=[];for(var m=0;m<l.value.length;++m)l.extensions.push(f.certificateExtensionFromAsn1(l.value[m]))}b.push(l)}return b};var o=function(a,b,c){var d={};if(a!==g["RSASSA-PSS"])return d;c&&(d={hash:{algorithmOid:g.sha1},mgf:{algorithmOid:g.mgf1,hash:{algorithmOid:g.sha1}},saltLength:20});var f={},h=[];if(!e.validate(b,k,f,h)){var i=Error("Cannot read RSASSA-PSS parameter block.");throw i.errors=h,i}return void 0!==f.hashOid&&(d.hash=d.hash||{},d.hash.algorithmOid=e.derToOid(f.hashOid)),void 0!==f.maskGenOid&&(d.mgf=d.mgf||{},d.mgf.algorithmOid=e.derToOid(f.maskGenOid),d.mgf.hash=d.mgf.hash||{},d.mgf.hash.algorithmOid=e.derToOid(f.maskGenHashOid)),void 0!==f.saltLength&&(d.saltLength=f.saltLength.charCodeAt(0)),d},p=function(a){switch(g[a.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return d.md.sha1.create();case"md5WithRSAEncryption":return d.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return d.md.sha256.create();case"sha384WithRSAEncryption":return d.md.sha384.create();case"sha512WithRSAEncryption":return d.md.sha512.create();default:var b=Error("Could not compute "+a.type+" digest. Unknown signature OID.");throw b.signatureOid=a.signatureOid,b}},q=function(a){var b,c,e,f=a.certificate;switch(f.signatureOid){case g.sha1WithRSAEncryption:case g.sha1WithRSASignature:break;case g["RSASSA-PSS"]:if(void 0===(c=g[f.signatureParameters.mgf.hash.algorithmOid])|| void 0===d.md[c]){var h=Error("Unsupported MGF hash function.");throw h.oid=f.signatureParameters.mgf.hash.algorithmOid,h.name=c,h}if(void 0===(e=g[f.signatureParameters.mgf.algorithmOid])|| void 0===d.mgf[e]){var h=Error("Unsupported MGF function.");throw h.oid=f.signatureParameters.mgf.algorithmOid,h.name=e,h}if(e=d.mgf[e].create(d.md[c].create()),void 0===(c=g[f.signatureParameters.hash.algorithmOid])|| void 0===d.md[c]){var h=Error("Unsupported RSASSA-PSS hash function.");throw h.oid=f.signatureParameters.hash.algorithmOid,h.name=c,h}b=d.pss.create(d.md[c].create(),e,f.signatureParameters.saltLength)}return f.publicKey.verify(a.md.digest().getBytes(),a.signature,b)};function r(a){for(var b,c,f=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),g=a.attributes,h=0;h<g.length;++h){var i=(b=g[h]).value,j=e.Type.PRINTABLESTRING;"valueTagClass"in b&&(j=b.valueTagClass)===e.Type.UTF8&&(i=d.util.encodeUtf8(i)),c=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(b.type).getBytes()),e.create(e.Class.UNIVERSAL,j,!1,i)])]),f.value.push(c)}return f}function s(a){for(var b,c=0;c<a.length;++c){if(void 0===(b=a[c]).name&&(b.type&&b.type in f.oids?b.name=f.oids[b.type]:b.shortName&&b.shortName in h&&(b.name=f.oids[h[b.shortName]])),void 0===b.type){if(b.name&&b.name in f.oids)b.type=f.oids[b.name];else{var d=Error("Attribute type not specified.");throw d.attribute=b,d}}if(void 0===b.shortName&&b.name&&b.name in h&&(b.shortName=h[b.name]),b.type===g.extensionRequest&&(b.valueConstructed=!0,b.valueTagClass=e.Type.SEQUENCE,!b.value&&b.extensions)){b.value=[];for(var i=0;i<b.extensions.length;++i)b.value.push(f.certificateExtensionToAsn1(t(b.extensions[i])))}if(void 0===b.value){var d=Error("Attribute value not specified.");throw d.attribute=b,d}}}function t(a,b){if(b=b||{},void 0===a.name&&a.id&&a.id in f.oids&&(a.name=f.oids[a.id]),void 0===a.id){if(a.name&&a.name in f.oids)a.id=f.oids[a.name];else{var c=Error("Extension ID not specified.");throw c.extension=a,c}}if(void 0!==a.value)return a;if("keyUsage"===a.name){var h=0,i=0,j=0;a.digitalSignature&&(i|=128,h=7),a.nonRepudiation&&(i|=64,h=6),a.keyEncipherment&&(i|=32,h=5),a.dataEncipherment&&(i|=16,h=4),a.keyAgreement&&(i|=8,h=3),a.keyCertSign&&(i|=4,h=2),a.cRLSign&&(i|=2,h=1),a.encipherOnly&&(i|=1,h=0),a.decipherOnly&&(j|=128,h=7);var k=String.fromCharCode(h);0!==j?k+=String.fromCharCode(i)+String.fromCharCode(j):0!==i&&(k+=String.fromCharCode(i)),a.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,k)}else if("basicConstraints"===a.name)a.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),a.cA&&a.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xff")),"pathLenConstraint"in a&&a.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.pathLenConstraint).getBytes()));else if("extKeyUsage"===a.name){a.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var l=a.value.value;for(var m in a)!0===a[m]&&(m in g?l.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g[m]).getBytes())):-1!==m.indexOf(".")&&l.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(m).getBytes())))}else if("nsCertType"===a.name){var h=0,i=0;a.client&&(i|=128,h=7),a.server&&(i|=64,h=6),a.email&&(i|=32,h=5),a.objsign&&(i|=16,h=4),a.reserved&&(i|=8,h=3),a.sslCA&&(i|=4,h=2),a.emailCA&&(i|=2,h=1),a.objCA&&(i|=1,h=0);var k=String.fromCharCode(h);0!==i&&(k+=String.fromCharCode(i)),a.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,k)}else if("subjectAltName"===a.name||"issuerAltName"===a.name){a.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var n,o=0;o<a.altNames.length;++o){var k=(n=a.altNames[o]).value;if(7===n.type&&n.ip){if(null===(k=d.util.bytesFromIP(n.ip))){var c=Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw c.extension=a,c}}else 8===n.type&&(k=n.oid?e.oidToDer(e.oidToDer(n.oid)):e.oidToDer(k));a.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,n.type,!1,k))}}else if("nsComment"===a.name&&b.cert){if(!/^[\x00-\x7F]*$/.test(a.comment)||a.comment.length<1||a.comment.length>128)throw Error('Invalid "nsComment" content.');a.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,a.comment)}else if("subjectKeyIdentifier"===a.name&&b.cert){var p=b.cert.generateSubjectKeyIdentifier();a.subjectKeyIdentifier=p.toHex(),a.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p.getBytes())}else if("authorityKeyIdentifier"===a.name&&b.cert){a.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var l=a.value.value;if(a.keyIdentifier){var q=!0===a.keyIdentifier?b.cert.generateSubjectKeyIdentifier().getBytes():a.keyIdentifier;l.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,q))}if(a.authorityCertIssuer){var s=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[r(!0===a.authorityCertIssuer?b.cert.issuer:a.authorityCertIssuer)])];l.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,s))}if(a.serialNumber){var t=d.util.hexToBytes(!0===a.serialNumber?b.cert.serialNumber:a.serialNumber);l.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,t))}}else if("cRLDistributionPoints"===a.name){a.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var n,l=a.value.value,u=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),v=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),o=0;o<a.altNames.length;++o){var k=(n=a.altNames[o]).value;if(7===n.type&&n.ip){if(null===(k=d.util.bytesFromIP(n.ip))){var c=Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw c.extension=a,c}}else 8===n.type&&(k=n.oid?e.oidToDer(e.oidToDer(n.oid)):e.oidToDer(k));v.value.push(e.create(e.Class.CONTEXT_SPECIFIC,n.type,!1,k))}u.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[v])),l.push(u)}if(void 0===a.value){var c=Error("Extension value not specified.");throw c.extension=a,c}return a}function u(a,b){if(a===g["RSASSA-PSS"]){var c=[];return void 0!==b.hash.algorithmOid&&c.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(b.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),void 0!==b.mgf.algorithmOid&&c.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(b.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(b.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),void 0!==b.saltLength&&c.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(b.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,c)}return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}function v(a){var b=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===a.attributes.length)return b;for(var c=a.attributes,f=0;f<c.length;++f){var g=c[f],h=g.value,i=e.Type.UTF8;"valueTagClass"in g&&(i=g.valueTagClass),i===e.Type.UTF8&&(h=d.util.encodeUtf8(h));var j=!1;"valueConstructed"in g&&(j=g.valueConstructed);var k=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(g.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,i,j,h)])]);b.value.push(k)}return b}f.certificateFromPem=function(a,b,c){var g=d.pem.decode(a)[0];if("CERTIFICATE"!==g.type&&"X509 CERTIFICATE"!==g.type&&"TRUSTED CERTIFICATE"!==g.type){var h=Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw h.headerType=g.type,h}if(g.procType&&"ENCRYPTED"===g.procType.type)throw Error("Could not convert certificate from PEM; PEM is encrypted.");var i=e.fromDer(g.body,c);return f.certificateFromAsn1(i,b)},f.certificateToPem=function(a,b){var c={type:"CERTIFICATE",body:e.toDer(f.certificateToAsn1(a)).getBytes()};return d.pem.encode(c,{maxline:b})},f.publicKeyFromPem=function(a){var b=d.pem.decode(a)[0];if("PUBLIC KEY"!==b.type&&"RSA PUBLIC KEY"!==b.type){var c=Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw c.headerType=b.type,c}if(b.procType&&"ENCRYPTED"===b.procType.type)throw Error("Could not convert public key from PEM; PEM is encrypted.");var g=e.fromDer(b.body);return f.publicKeyFromAsn1(g)},f.publicKeyToPem=function(a,b){var c={type:"PUBLIC KEY",body:e.toDer(f.publicKeyToAsn1(a)).getBytes()};return d.pem.encode(c,{maxline:b})},f.publicKeyToRSAPublicKeyPem=function(a,b){var c={type:"RSA PUBLIC KEY",body:e.toDer(f.publicKeyToRSAPublicKey(a)).getBytes()};return d.pem.encode(c,{maxline:b})},f.getPublicKeyFingerprint=function(a,b){var c,g=(b=b||{}).md||d.md.sha1.create(),h=b.type||"RSAPublicKey";switch(h){case"RSAPublicKey":c=e.toDer(f.publicKeyToRSAPublicKey(a)).getBytes();break;case"SubjectPublicKeyInfo":c=e.toDer(f.publicKeyToAsn1(a)).getBytes();break;default:throw Error('Unknown fingerprint type "'+b.type+'".')}g.start(),g.update(c);var i=g.digest();if("hex"===b.encoding){var j=i.toHex();return b.delimiter?j.match(/.{2}/g).join(b.delimiter):j}if("binary"===b.encoding)return i.getBytes();if(b.encoding)throw Error('Unknown encoding "'+b.encoding+'".');return i},f.certificationRequestFromPem=function(a,b,c){var g=d.pem.decode(a)[0];if("CERTIFICATE REQUEST"!==g.type){var h=Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw h.headerType=g.type,h}if(g.procType&&"ENCRYPTED"===g.procType.type)throw Error("Could not convert certification request from PEM; PEM is encrypted.");var i=e.fromDer(g.body,c);return f.certificationRequestFromAsn1(i,b)},f.certificationRequestToPem=function(a,b){var c={type:"CERTIFICATE REQUEST",body:e.toDer(f.certificationRequestToAsn1(a)).getBytes()};return d.pem.encode(c,{maxline:b})},f.createCertificate=function(){var a={};return a.version=2,a.serialNumber="00",a.signatureOid=null,a.signature=null,a.siginfo={},a.siginfo.algorithmOid=null,a.validity={},a.validity.notBefore=new Date,a.validity.notAfter=new Date,a.issuer={},a.issuer.getField=function(b){return n(a.issuer,b)},a.issuer.addField=function(b){s([b]),a.issuer.attributes.push(b)},a.issuer.attributes=[],a.issuer.hash=null,a.subject={},a.subject.getField=function(b){return n(a.subject,b)},a.subject.addField=function(b){s([b]),a.subject.attributes.push(b)},a.subject.attributes=[],a.subject.hash=null,a.extensions=[],a.publicKey=null,a.md=null,a.setSubject=function(b,c){s(b),a.subject.attributes=b,delete a.subject.uniqueId,c&&(a.subject.uniqueId=c),a.subject.hash=null},a.setIssuer=function(b,c){s(b),a.issuer.attributes=b,delete a.issuer.uniqueId,c&&(a.issuer.uniqueId=c),a.issuer.hash=null},a.setExtensions=function(b){for(var c=0;c<b.length;++c)t(b[c],{cert:a});a.extensions=b},a.getExtension=function(b){"string"==typeof b&&(b={name:b});for(var c,d=null,e=0;null===d&&e<a.extensions.length;++e)c=a.extensions[e],b.id&&c.id===b.id?d=c:b.name&&c.name===b.name&&(d=c);return d},a.sign=function(b,c){a.md=c||d.md.sha1.create();var h=g[a.md.algorithm+"WithRSAEncryption"];if(!h){var i=Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=a.md.algorithm,i}a.signatureOid=a.siginfo.algorithmOid=h,a.tbsCertificate=f.getTBSCertificate(a);var j=e.toDer(a.tbsCertificate);a.md.update(j.getBytes()),a.signature=b.sign(a.md)},a.verify=function(b){var c=!1;if(!a.issued(b)){var d=b.issuer,g=a.subject,h=Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw h.expectedIssuer=g.attributes,h.actualIssuer=d.attributes,h}var i=b.md;if(null===i){i=p({signatureOid:b.signatureOid,type:"certificate"});var j=b.tbsCertificate||f.getTBSCertificate(b),k=e.toDer(j);i.update(k.getBytes())}return null!==i&&(c=q({certificate:a,md:i,signature:b.signature})),c},a.isIssuer=function(b){var c=!1,d=a.issuer,e=b.subject;if(d.hash&&e.hash)c=d.hash===e.hash;else if(d.attributes.length===e.attributes.length){c=!0;for(var f,g,h=0;c&&h<d.attributes.length;++h)f=d.attributes[h],g=e.attributes[h],(f.type!==g.type||f.value!==g.value)&&(c=!1)}return c},a.issued=function(b){return b.isIssuer(a)},a.generateSubjectKeyIdentifier=function(){return f.getPublicKeyFingerprint(a.publicKey,{type:"RSAPublicKey"})},a.verifySubjectKeyIdentifier=function(){for(var b=g.subjectKeyIdentifier,c=0;c<a.extensions.length;++c){var e=a.extensions[c];if(e.id===b){var f=a.generateSubjectKeyIdentifier().getBytes();return d.util.hexToBytes(e.subjectKeyIdentifier)===f}}return!1},a},f.certificateFromAsn1=function(a,b){var c={},g=[];if(!e.validate(a,j,c,g)){var h=Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw h.errors=g,h}if(e.derToOid(c.publicKeyOid)!==f.oids.rsaEncryption)throw Error("Cannot read public key. OID is not RSA.");var i=f.createCertificate();i.version=c.certVersion?c.certVersion.charCodeAt(0):0;var k=d.util.createBuffer(c.certSerialNumber);i.serialNumber=k.toHex(),i.signatureOid=d.asn1.derToOid(c.certSignatureOid),i.signatureParameters=o(i.signatureOid,c.certSignatureParams,!0),i.siginfo.algorithmOid=d.asn1.derToOid(c.certinfoSignatureOid),i.siginfo.parameters=o(i.siginfo.algorithmOid,c.certinfoSignatureParams,!1),i.signature=c.certSignature;var l=[];if(void 0!==c.certValidity1UTCTime&&l.push(e.utcTimeToDate(c.certValidity1UTCTime)),void 0!==c.certValidity2GeneralizedTime&&l.push(e.generalizedTimeToDate(c.certValidity2GeneralizedTime)),void 0!==c.certValidity3UTCTime&&l.push(e.utcTimeToDate(c.certValidity3UTCTime)),void 0!==c.certValidity4GeneralizedTime&&l.push(e.generalizedTimeToDate(c.certValidity4GeneralizedTime)),l.length>2)throw Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(i.validity.notBefore=l[0],i.validity.notAfter=l[1],i.tbsCertificate=c.tbsCertificate,b){i.md=p({signatureOid:i.signatureOid,type:"certificate"});var m=e.toDer(i.tbsCertificate);i.md.update(m.getBytes())}var q=d.md.sha1.create(),r=e.toDer(c.certIssuer);q.update(r.getBytes()),i.issuer.getField=function(a){return n(i.issuer,a)},i.issuer.addField=function(a){s([a]),i.issuer.attributes.push(a)},i.issuer.attributes=f.RDNAttributesAsArray(c.certIssuer),c.certIssuerUniqueId&&(i.issuer.uniqueId=c.certIssuerUniqueId),i.issuer.hash=q.digest().toHex();var t=d.md.sha1.create(),u=e.toDer(c.certSubject);return t.update(u.getBytes()),i.subject.getField=function(a){return n(i.subject,a)},i.subject.addField=function(a){s([a]),i.subject.attributes.push(a)},i.subject.attributes=f.RDNAttributesAsArray(c.certSubject),c.certSubjectUniqueId&&(i.subject.uniqueId=c.certSubjectUniqueId),i.subject.hash=t.digest().toHex(),c.certExtensions?i.extensions=f.certificateExtensionsFromAsn1(c.certExtensions):i.extensions=[],i.publicKey=f.publicKeyFromAsn1(c.subjectPublicKeyInfo),i},f.certificateExtensionsFromAsn1=function(a){for(var b=[],c=0;c<a.value.length;++c)for(var d=a.value[c],e=0;e<d.value.length;++e)b.push(f.certificateExtensionFromAsn1(d.value[e]));return b},f.certificateExtensionFromAsn1=function(a){var b={};if(b.id=e.derToOid(a.value[0].value),b.critical=!1,a.value[1].type===e.Type.BOOLEAN?(b.critical=0!==a.value[1].value.charCodeAt(0),b.value=a.value[2].value):b.value=a.value[1].value,b.id in g){if(b.name=g[b.id],"keyUsage"===b.name){var c=e.fromDer(b.value),f=0,h=0;c.value.length>1&&(f=c.value.charCodeAt(1),h=c.value.length>2?c.value.charCodeAt(2):0),b.digitalSignature=(128&f)==128,b.nonRepudiation=(64&f)==64,b.keyEncipherment=(32&f)==32,b.dataEncipherment=(16&f)==16,b.keyAgreement=(8&f)==8,b.keyCertSign=(4&f)==4,b.cRLSign=(2&f)==2,b.encipherOnly=(1&f)==1,b.decipherOnly=(128&h)==128}else if("basicConstraints"===b.name){var c=e.fromDer(b.value);c.value.length>0&&c.value[0].type===e.Type.BOOLEAN?b.cA=0!==c.value[0].value.charCodeAt(0):b.cA=!1;var i=null;c.value.length>0&&c.value[0].type===e.Type.INTEGER?i=c.value[0].value:c.value.length>1&&(i=c.value[1].value),null!==i&&(b.pathLenConstraint=e.derToInteger(i))}else if("extKeyUsage"===b.name)for(var c=e.fromDer(b.value),j=0;j<c.value.length;++j){var k=e.derToOid(c.value[j].value);k in g?b[g[k]]=!0:b[k]=!0}else if("nsCertType"===b.name){var c=e.fromDer(b.value),f=0;c.value.length>1&&(f=c.value.charCodeAt(1)),b.client=(128&f)==128,b.server=(64&f)==64,b.email=(32&f)==32,b.objsign=(16&f)==16,b.reserved=(8&f)==8,b.sslCA=(4&f)==4,b.emailCA=(2&f)==2,b.objCA=(1&f)==1}else if("subjectAltName"===b.name||"issuerAltName"===b.name){b.altNames=[];for(var l,c=e.fromDer(b.value),m=0;m<c.value.length;++m){var n={type:(l=c.value[m]).type,value:l.value};switch(b.altNames.push(n),l.type){case 1:case 2:case 6:break;case 7:n.ip=d.util.bytesToIP(l.value);break;case 8:n.oid=e.derToOid(l.value)}}}else if("subjectKeyIdentifier"===b.name){var c=e.fromDer(b.value);b.subjectKeyIdentifier=d.util.bytesToHex(c.value)}}return b},f.certificationRequestFromAsn1=function(a,b){var c={},g=[];if(!e.validate(a,m,c,g)){var h=Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw h.errors=g,h}if(e.derToOid(c.publicKeyOid)!==f.oids.rsaEncryption)throw Error("Cannot read public key. OID is not RSA.");var i=f.createCertificationRequest();if(i.version=c.csrVersion?c.csrVersion.charCodeAt(0):0,i.signatureOid=d.asn1.derToOid(c.csrSignatureOid),i.signatureParameters=o(i.signatureOid,c.csrSignatureParams,!0),i.siginfo.algorithmOid=d.asn1.derToOid(c.csrSignatureOid),i.siginfo.parameters=o(i.siginfo.algorithmOid,c.csrSignatureParams,!1),i.signature=c.csrSignature,i.certificationRequestInfo=c.certificationRequestInfo,b){i.md=p({signatureOid:i.signatureOid,type:"certification request"});var j=e.toDer(i.certificationRequestInfo);i.md.update(j.getBytes())}var k=d.md.sha1.create();return i.subject.getField=function(a){return n(i.subject,a)},i.subject.addField=function(a){s([a]),i.subject.attributes.push(a)},i.subject.attributes=f.RDNAttributesAsArray(c.certificationRequestInfoSubject,k),i.subject.hash=k.digest().toHex(),i.publicKey=f.publicKeyFromAsn1(c.subjectPublicKeyInfo),i.getAttribute=function(a){return n(i,a)},i.addAttribute=function(a){s([a]),i.attributes.push(a)},i.attributes=f.CRIAttributesAsArray(c.certificationRequestInfoAttributes||[]),i},f.createCertificationRequest=function(){var a={};return a.version=0,a.signatureOid=null,a.signature=null,a.siginfo={},a.siginfo.algorithmOid=null,a.subject={},a.subject.getField=function(b){return n(a.subject,b)},a.subject.addField=function(b){s([b]),a.subject.attributes.push(b)},a.subject.attributes=[],a.subject.hash=null,a.publicKey=null,a.attributes=[],a.getAttribute=function(b){return n(a,b)},a.addAttribute=function(b){s([b]),a.attributes.push(b)},a.md=null,a.setSubject=function(b){s(b),a.subject.attributes=b,a.subject.hash=null},a.setAttributes=function(b){s(b),a.attributes=b},a.sign=function(b,c){a.md=c||d.md.sha1.create();var h=g[a.md.algorithm+"WithRSAEncryption"];if(!h){var i=Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=a.md.algorithm,i}a.signatureOid=a.siginfo.algorithmOid=h,a.certificationRequestInfo=f.getCertificationRequestInfo(a);var j=e.toDer(a.certificationRequestInfo);a.md.update(j.getBytes()),a.signature=b.sign(a.md)},a.verify=function(){var b=!1,c=a.md;if(null===c){c=p({signatureOid:a.signatureOid,type:"certification request"});var d=a.certificationRequestInfo||f.getCertificationRequestInfo(a),g=e.toDer(d);c.update(g.getBytes())}return null!==c&&(b=q({certificate:a,md:c,signature:a.signature})),b},a};var w=new Date("1950-01-01T00:00:00Z"),x=new Date("2050-01-01T00:00:00Z");function y(a){return a>=w&&a<x?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(a)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(a))}f.getTBSCertificate=function(a){var b=y(a.validity.notBefore),c=y(a.validity.notAfter),g=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,d.util.hexToBytes(a.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.siginfo.algorithmOid).getBytes()),u(a.siginfo.algorithmOid,a.siginfo.parameters)]),r(a.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[b,c]),r(a.subject),f.publicKeyToAsn1(a.publicKey)]);return a.issuer.uniqueId&&g.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+a.issuer.uniqueId)])),a.subject.uniqueId&&g.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+a.subject.uniqueId)])),a.extensions.length>0&&g.value.push(f.certificateExtensionsToAsn1(a.extensions)),g},f.getCertificationRequestInfo=function(a){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(a.version).getBytes()),r(a.subject),f.publicKeyToAsn1(a.publicKey),v(a)])},f.distinguishedNameToAsn1=function(a){return r(a)},f.certificateToAsn1=function(a){var b=a.tbsCertificate||f.getTBSCertificate(a);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[b,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.signatureOid).getBytes()),u(a.signatureOid,a.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+a.signature)])},f.certificateExtensionsToAsn1=function(a){var b=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),c=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);b.value.push(c);for(var d=0;d<a.length;++d)c.value.push(f.certificateExtensionToAsn1(a[d]));return b},f.certificateExtensionToAsn1=function(a){var b=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);b.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.id).getBytes())),a.critical&&b.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"\xff"));var c=a.value;return"string"!=typeof a.value&&(c=e.toDer(c).getBytes()),b.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c)),b},f.certificationRequestToAsn1=function(a){var b=a.certificationRequestInfo||f.getCertificationRequestInfo(a);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[b,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.signatureOid).getBytes()),u(a.signatureOid,a.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+a.signature)])},f.createCaStore=function(a){var b={certs:{}};function c(a){return g(a),b.certs[a.hash]||null}function g(a){if(!a.hash){var b=d.md.sha1.create();a.attributes=f.RDNAttributesAsArray(r(a),b),a.hash=b.digest().toHex()}}if(b.getIssuer=function(a){return c(a.issuer)},b.addCertificate=function(a){if("string"==typeof a&&(a=d.pki.certificateFromPem(a)),g(a.subject),!b.hasCertificate(a)){if(a.subject.hash in b.certs){var c=b.certs[a.subject.hash];d.util.isArray(c)||(c=[c]),c.push(a),b.certs[a.subject.hash]=c}else b.certs[a.subject.hash]=a}},b.hasCertificate=function(a){"string"==typeof a&&(a=d.pki.certificateFromPem(a));var b=c(a.subject);if(!b)return!1;d.util.isArray(b)||(b=[b]);for(var g=e.toDer(f.certificateToAsn1(a)).getBytes(),h=0;h<b.length;++h)if(g===e.toDer(f.certificateToAsn1(b[h])).getBytes())return!0;return!1},b.listAllCertificates=function(){var a=[];for(var c in b.certs)if(b.certs.hasOwnProperty(c)){var e=b.certs[c];if(d.util.isArray(e))for(var f=0;f<e.length;++f)a.push(e[f]);else a.push(e)}return a},b.removeCertificate=function(a){if("string"==typeof a&&(a=d.pki.certificateFromPem(a)),g(a.subject),!b.hasCertificate(a))return null;var h,i=c(a.subject);if(!d.util.isArray(i))return h=b.certs[a.subject.hash],delete b.certs[a.subject.hash],h;for(var j=e.toDer(f.certificateToAsn1(a)).getBytes(),k=0;k<i.length;++k)j===e.toDer(f.certificateToAsn1(i[k])).getBytes()&&(h=i[k],i.splice(k,1));return 0===i.length&&delete b.certs[a.subject.hash],h},a)for(var h=0;h<a.length;++h){var i=a[h];b.addCertificate(i)}return b},f.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},f.verifyCertificateChain=function(a,b,c){"function"==typeof c&&(c={verify:c}),c=c||{};var e=(b=b.slice(0)).slice(0),g=c.validityCheckDate;void 0===g&&(g=new Date);var h=!0,i=null,j=0;do{var k=b.shift(),l=null,m=!1;if(g&&(g<k.validity.notBefore||g>k.validity.notAfter)&&(i={message:"Certificate is not valid yet or has expired.",error:f.certificateError.certificate_expired,notBefore:k.validity.notBefore,notAfter:k.validity.notAfter,now:g}),null===i){if(null===(l=b[0]||a.getIssuer(k))&&k.isIssuer(k)&&(m=!0,l=k),l){var n=l;d.util.isArray(n)||(n=[n]);for(var o=!1;!o&&n.length>0;){l=n.shift();try{o=l.verify(k)}catch(p){}}o||(i={message:"Certificate signature is invalid.",error:f.certificateError.bad_certificate})}null!==i||l&&!m||a.hasCertificate(k)||(i={message:"Certificate is not trusted.",error:f.certificateError.unknown_ca})}if(null===i&&l&&!k.isIssuer(l)&&(i={message:"Certificate issuer is invalid.",error:f.certificateError.bad_certificate}),null===i)for(var q={keyUsage:!0,basicConstraints:!0},r=0;null===i&&r<k.extensions.length;++r){var s=k.extensions[r];!s.critical||s.name in q||(i={message:"Certificate has an unsupported critical extension.",error:f.certificateError.unsupported_certificate})}if(null===i&&(!h||0===b.length&&(!l||m))){var t=k.getExtension("basicConstraints"),u=k.getExtension("keyUsage");null===u||u.keyCertSign&&null!==t||(i={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:f.certificateError.bad_certificate}),null!==i||null===t||t.cA||(i={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:f.certificateError.bad_certificate}),null===i&&null!==u&&"pathLenConstraint"in t&&j-1>t.pathLenConstraint&&(i={message:"Certificate basicConstraints pathLenConstraint violated.",error:f.certificateError.bad_certificate})}var v=null===i||i.error,w=c.verify?c.verify(v,j,e):v;if(!0===w)i=null;else throw!0===v&&(i={message:"The application rejected the certificate.",error:f.certificateError.bad_certificate}),(w||0===w)&&("object"!=typeof w||d.util.isArray(w)?"string"==typeof w&&(i.error=w):(w.message&&(i.message=w.message),w.error&&(i.error=w.error))),i;h=!1,++j}while(b.length>0);return!0}},35103:function(a,b,c){let d=c(91607),e=c(50603);a.exports=class{constructor(){this._buffer=new d,this._waitingConsumers=new d}push(a){let{promise:b,resolve:c}=e();return this._buffer.push({chunk:a,resolve:c}),this._consume(),b}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let a=this._waitingConsumers.shift(),b=this._buffer.shift();a.resolve(b.chunk),b.resolve()}}shift(){let{promise:a,resolve:b}=e();return this._waitingConsumers.push({resolve:b}),this._consume(),a}isEmpty(){return this._buffer.isEmpty()}}},50603:function(a){"use strict";let b=()=>{let a={};return a.promise=new Promise((b,c)=>{a.resolve=b,a.reject=c}),a};a.exports=b},27345:function(a){"use strict";a.exports=(a,b)=>(b=b||(()=>{}),a.then(a=>new Promise(a=>{a(b())}).then(()=>a),a=>new Promise(a=>{a(b())}).then(()=>{throw a})))},290:function(a,b,c){"use strict";a.exports=c(96114).default},96114:function(a,b,c){"use strict";var d=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0});let e=c(28951),f=d(c(44189)),g=d(c(8967)),h=c(56512),i=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],j=i.map(a=>new e.Netmask(a));function k(a){for(let b of j)if(b.contains(a))return!0;return!1}function l(a){return/^::$/.test(a)||/^::1$/.test(a)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(a)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(a)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(a)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(a)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(a)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(a)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(a)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(a)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(a)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(a)||/^ff([0-9a-fA-F]{2,2}):/i.test(a)}b.default=a=>{if((0,h.isValid)(a)){let b=(0,h.parse)(a);if("ipv4"===b.kind())return k(b.toNormalizedString());if("ipv6"===b.kind())return l(a)}else if((0,g.default)(a)&&f.default.v6().test(a))return l(a)}},44189:function(a){"use strict";let b="[a-fA-F\\d:]",c=a=>a&&a.includeBoundaries?`(?:(?<=\\s|^)(?=${b})|(?<=${b})(?=\\s|$))`:"",d="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",e="[a-fA-F\\d]{1,4}",f=`
(?:
(?:${e}:){7}(?:${e}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${e}:){6}(?:${d}|:${e}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${e}:){5}(?::${d}|(?::${e}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${e}:){4}(?:(?::${e}){0,1}:${d}|(?::${e}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${e}:){3}(?:(?::${e}){0,2}:${d}|(?::${e}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${e}:){2}(?:(?::${e}){0,3}:${d}|(?::${e}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${e}:){1}(?:(?::${e}){0,4}:${d}|(?::${e}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${e}){0,5}:${d}|(?::${e}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),g=RegExp(`(?:^${d}$)|(?:^${f}$)`),h=RegExp(`^${d}$`),i=RegExp(`^${f}$`),j=a=>a&&a.exact?g:RegExp(`(?:${c(a)}${d}${c(a)})|(?:${c(a)}${f}${c(a)})`,"g");j.v4=a=>a&&a.exact?h:RegExp(`${c(a)}${d}${c(a)}`,"g"),j.v6=a=>a&&a.exact?i:RegExp(`${c(a)}${f}${c(a)}`,"g"),a.exports=j},8967:function(a,b,c){"use strict";let d=c(44189),e=a=>d({exact:!0}).test(a);e.v4=a=>d.v4({exact:!0}).test(a),e.v6=a=>d.v6({exact:!0}).test(a),e.version=a=>e(a)?e.v4(a)?4:6:void 0,a.exports=e},54501:function(a){"use strict";var b;a.exports.timeout=function(a,c){var d,e=new b;return Promise.race([a,new Promise(function(a,b){d=setTimeout(function(){b(e)},c)}),]).then(function(a){return clearTimeout(d),a},function(a){throw clearTimeout(d),a})},(b=a.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"}).prototype=Object.create(Error.prototype),b.prototype.name="TimeoutError"},62100:function(a,b,c){"use strict";a.exports=c(89482)},89482:function(a,b,c){"use strict";var d=b;function e(){d.util._configure(),d.Writer._configure(d.BufferWriter),d.Reader._configure(d.BufferReader)}d.build="minimal",d.Writer=c(41173),d.BufferWriter=c(43155),d.Reader=c(51408),d.BufferReader=c(50593),d.util=c(99693),d.rpc=c(35994),d.roots=c(85054),d.configure=e,e()},51408:function(a,b,c){"use strict";a.exports=i;var d,e=c(99693),f=e.LongBits,g=e.utf8;function h(a,b){return RangeError("index out of range: "+a.pos+" + "+(b||1)+" > "+a.len)}function i(a){this.buf=a,this.pos=0,this.len=a.length}var j,k="undefined"!=typeof Uint8Array?function(a){if(a instanceof Uint8Array||Array.isArray(a))return new i(a);throw Error("illegal buffer")}:function(a){if(Array.isArray(a))return new i(a);throw Error("illegal buffer")},l=function(){return e.Buffer?function(a){return(i.create=function(a){return e.Buffer.isBuffer(a)?new d(a):k(a)})(a)}:k};function m(){var a=new f(0,0),b=0;if(this.len-this.pos>4){for(;b<4;++b)if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(127&this.buf[this.pos])<<28)>>>0,a.hi=(a.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return a;b=0}else{for(;b<3;++b){if(this.pos>=this.len)throw h(this);if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(127&this.buf[this.pos++])<<7*b)>>>0,a}if(this.len-this.pos>4){for(;b<5;++b)if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}else for(;b<5;++b){if(this.pos>=this.len)throw h(this);if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}function n(a,b){return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0}function o(){if(this.pos+8>this.len)throw h(this,8);return new f(n(this.buf,this.pos+=4),n(this.buf,this.pos+=4))}i.create=l(),i.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,i.prototype.uint32=(j=4294967295,function(){if(j=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(j=(j|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(j=(j|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(j=(j|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(j=(j|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return j;if((this.pos+=5)>this.len)throw this.pos=this.len,h(this,10);return j}),i.prototype.int32=function(){return 0|this.uint32()},i.prototype.sint32=function(){var a=this.uint32();return a>>>1^ -(1&a)|0},i.prototype.bool=function(){return 0!==this.uint32()},i.prototype.fixed32=function(){if(this.pos+4>this.len)throw h(this,4);return n(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw h(this,4);return 0|n(this.buf,this.pos+=4)},i.prototype.float=function(){if(this.pos+4>this.len)throw h(this,4);var a=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a},i.prototype.double=function(){if(this.pos+8>this.len)throw h(this,4);var a=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a},i.prototype.bytes=function(){var a=this.uint32(),b=this.pos,c=this.pos+a;if(c>this.len)throw h(this,a);return(this.pos+=a,Array.isArray(this.buf))?this.buf.slice(b,c):b===c?new this.buf.constructor(0):this._slice.call(this.buf,b,c)},i.prototype.string=function(){var a=this.bytes();return g.read(a,0,a.length)},i.prototype.skip=function(a){if("number"==typeof a){if(this.pos+a>this.len)throw h(this,a);this.pos+=a}else do if(this.pos>=this.len)throw h(this);while(128&this.buf[this.pos++]);return this},i.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(a=7&this.uint32());)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},i._configure=function(a){d=a,i.create=l(),d._configure();var b=e.Long?"toLong":"toNumber";e.merge(i.prototype,{int64:function(){return m.call(this)[b](!1)},uint64:function(){return m.call(this)[b](!0)},sint64:function(){return m.call(this).zzDecode()[b](!1)},fixed64:function(){return o.call(this)[b](!0)},sfixed64:function(){return o.call(this)[b](!1)}})}},50593:function(a,b,c){"use strict";a.exports=f;var d=c(51408);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(99693);function f(a){d.call(this,a)}f._configure=function(){e.Buffer&&(f.prototype._slice=e.Buffer.prototype.slice)},f.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},f._configure()},85054:function(a){"use strict";a.exports={}},35994:function(a,b,c){"use strict";b.Service=c(77948)},77948:function(a,b,c){"use strict";a.exports=e;var d=c(99693);function e(a,b,c){if("function"!=typeof a)throw TypeError("rpcImpl must be a function");d.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=Boolean(b),this.responseDelimited=Boolean(c)}(e.prototype=Object.create(d.EventEmitter.prototype)).constructor=e,e.prototype.rpcCall=function a(b,c,e,f,g){if(!f)throw TypeError("request must be specified");var h=this;if(!g)return d.asPromise(a,h,b,c,e,f);if(!h.rpcImpl){setTimeout(function(){g(Error("already ended"))},0);return}try{return h.rpcImpl(b,c[h.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(a,c){if(a)return h.emit("error",a,b),g(a);if(null===c){h.end(!0);return}if(!(c instanceof e))try{c=e[h.responseDelimited?"decodeDelimited":"decode"](c)}catch(d){return h.emit("error",d,b),g(d)}return h.emit("data",c,b),g(null,c)})}catch(i){h.emit("error",i,b),setTimeout(function(){g(i)},0);return}},e.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(a,b,c){"use strict";a.exports=e;var d=c(99693);function e(a,b){this.lo=a>>>0,this.hi=b>>>0}var f=e.zero=new e(0,0);f.toNumber=function(){return 0},f.zzEncode=f.zzDecode=function(){return this},f.length=function(){return 1};var g=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(a){if(0===a)return f;var b=a<0;b&&(a=-a);var c=a>>>0,d=(a-c)/4294967296>>>0;return b&&(d=~d>>>0,c=~c>>>0,++c>4294967295&&(c=0,++d>4294967295&&(d=0))),new e(c,d)},e.from=function(a){if("number"==typeof a)return e.fromNumber(a);if(d.isString(a)){if(!d.Long)return e.fromNumber(parseInt(a,10));a=d.Long.fromString(a)}return a.low||a.high?new e(a.low>>>0,a.high>>>0):f},e.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var b=~this.lo+1>>>0,c=~this.hi>>>0;return b||(c=c+1>>>0),-(b+4294967296*c)}return this.lo+4294967296*this.hi},e.prototype.toLong=function(a){return d.Long?new d.Long(0|this.lo,0|this.hi,Boolean(a)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(a)}};var h=String.prototype.charCodeAt;e.fromHash=function(a){return a===g?f:new e((h.call(a,0)|h.call(a,1)<<8|h.call(a,2)<<16|h.call(a,3)<<24)>>>0,(h.call(a,4)|h.call(a,5)<<8|h.call(a,6)<<16|h.call(a,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},e.prototype.zzDecode=function(){var a=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},e.prototype.length=function(){var a=this.lo,b=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return 0===c?0===b?a<16384?a<128?1:2:a<2097152?3:4:b<16384?b<128?5:6:b<2097152?7:8:c<128?9:10}},99693:function(a,b,c){"use strict";var d=b;function e(a,b,c){for(var d=Object.keys(b),e=0;e<d.length;++e)void 0!==a[d[e]]&&c||(a[d[e]]=b[d[e]]);return a}function f(a){function b(a,c){if(!(this instanceof b))return new b(a,c);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,b):Object.defineProperty(this,"stack",{value:Error().stack||""}),c&&e(this,c)}return(b.prototype=Object.create(Error.prototype)).constructor=b,Object.defineProperty(b.prototype,"name",{get:function(){return a}}),b.prototype.toString=function(){return this.name+": "+this.message},b}d.asPromise=c(34537),d.base64=c(97419),d.EventEmitter=c(19211),d.float=c(10945),d.inquire=c(67199),d.utf8=c(94997),d.pool=c(76662),d.LongBits=c(1945),d.isNode=Boolean(void 0!==c.g&&c.g&&c.g.process&&c.g.process.versions&&c.g.process.versions.node),d.global=d.isNode&&c.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},d.isString=function(a){return"string"==typeof a||a instanceof String},d.isObject=function(a){return a&&"object"==typeof a},d.isset=d.isSet=function(a,b){var c=a[b];return!!(null!=c&&a.hasOwnProperty(b))&&("object"!=typeof c||(Array.isArray(c)?c.length:Object.keys(c).length)>0)},d.Buffer=function(){try{var a=d.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(b){return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(a){return"number"==typeof a?d.Buffer?d._Buffer_allocUnsafe(a):new d.Array(a):d.Buffer?d._Buffer_from(a):"undefined"==typeof Uint8Array?a:new Uint8Array(a)},d.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(a){return a?d.LongBits.from(a).toHash():d.LongBits.zeroHash},d.longFromHash=function(a,b){var c=d.LongBits.fromHash(a);return d.Long?d.Long.fromBits(c.lo,c.hi,b):c.toNumber(Boolean(b))},d.merge=e,d.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},d.newError=f,d.ProtocolError=f("ProtocolError"),d.oneOfGetter=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c> -1;--c)if(1===b[a[c]]&& void 0!==this[a[c]]&&null!==this[a[c]])return a[c]}},d.oneOfSetter=function(a){return function(b){for(var c=0;c<a.length;++c)a[c]!==b&&delete this[a[c]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var a=d.Buffer;if(!a){d._Buffer_from=d._Buffer_allocUnsafe=null;return}d._Buffer_from=a.from!==Uint8Array.from&&a.from||function(b,c){return new a(b,c)},d._Buffer_allocUnsafe=a.allocUnsafe||function(b){return new a(b)}}},41173:function(a,b,c){"use strict";a.exports=l;var d,e=c(99693),f=e.LongBits,g=e.base64,h=e.utf8;function i(a,b,c){this.fn=a,this.len=b,this.next=void 0,this.val=c}function j(){}function k(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function l(){this.len=0,this.head=new i(j,0,0),this.tail=this.head,this.states=null}var m=function(){return e.Buffer?function(){return(l.create=function(){return new d})()}:function(){return new l}};function n(a,b,c){b[c]=255&a}function o(a,b,c){for(;a>127;)b[c++]=127&a|128,a>>>=7;b[c]=a}function p(a,b){this.len=a,this.next=void 0,this.val=b}function q(a,b,c){for(;a.hi;)b[c++]=127&a.lo|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)b[c++]=127&a.lo|128,a.lo=a.lo>>>7;b[c++]=a.lo}function r(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}l.create=m(),l.alloc=function(a){return new e.Array(a)},e.Array!==Array&&(l.alloc=e.pool(l.alloc,e.Array.prototype.subarray)),l.prototype._push=function(a,b,c){return this.tail=this.tail.next=new i(a,b,c),this.len+=b,this},p.prototype=Object.create(i.prototype),p.prototype.fn=o,l.prototype.uint32=function(a){return this.len+=(this.tail=this.tail.next=new p((a>>>=0)<128?1:a<16384?2:a<2097152?3:a<268435456?4:5,a)).len,this},l.prototype.int32=function(a){return a<0?this._push(q,10,f.fromNumber(a)):this.uint32(a)},l.prototype.sint32=function(a){return this.uint32((a<<1^a>>31)>>>0)},l.prototype.uint64=function(a){var b=f.from(a);return this._push(q,b.length(),b)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(a){var b=f.from(a).zzEncode();return this._push(q,b.length(),b)},l.prototype.bool=function(a){return this._push(n,1,a?1:0)},l.prototype.fixed32=function(a){return this._push(r,4,a>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(a){var b=f.from(a);return this._push(r,4,b.lo)._push(r,4,b.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(a){return this._push(e.float.writeFloatLE,4,a)},l.prototype.double=function(a){return this._push(e.float.writeDoubleLE,8,a)};var s=e.Array.prototype.set?function(a,b,c){b.set(a,c)}:function(a,b,c){for(var d=0;d<a.length;++d)b[c+d]=a[d]};l.prototype.bytes=function(a){var b=a.length>>>0;if(!b)return this._push(n,1,0);if(e.isString(a)){var c=l.alloc(b=g.length(a));g.decode(a,c,0),a=c}return this.uint32(b)._push(s,b,a)},l.prototype.string=function(a){var b=h.length(a);return b?this.uint32(b)._push(h.write,b,a):this._push(n,1,0)},l.prototype.fork=function(){return this.states=new k(this),this.head=this.tail=new i(j,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(j,0,0),this.len=0),this},l.prototype.ldelim=function(){var a=this.head,b=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=a.next,this.tail=b,this.len+=c),this},l.prototype.finish=function(){for(var a=this.head.next,b=this.constructor.alloc(this.len),c=0;a;)a.fn(a.val,b,c),c+=a.len,a=a.next;return b},l._configure=function(a){d=a,l.create=m(),d._configure()}},43155:function(a,b,c){"use strict";a.exports=f;var d=c(41173);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(99693);function f(){d.call(this)}function g(a,b,c){a.length<40?e.utf8.write(a,b,c):b.utf8Write?b.utf8Write(a,c):b.write(a,c)}f._configure=function(){f.alloc=e._Buffer_allocUnsafe,f.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&"set"===e.Buffer.prototype.set.name?function(a,b,c){b.set(a,c)}:function(a,b,c){if(a.copy)a.copy(b,c,0,a.length);else for(var d=0;d<a.length;)b[c++]=a[d++]}},f.prototype.bytes=function(a){e.isString(a)&&(a=e._Buffer_from(a,"base64"));var b=a.length>>>0;return this.uint32(b),b&&this._push(f.writeBytesBuffer,b,a),this},f.prototype.string=function(a){var b=e.Buffer.byteLength(a);return this.uint32(b),b&&this._push(g,b,a),this},f._configure()},54375:function(a,b,c){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */ let d;a.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:c.g):a=>(d||(d=Promise.resolve())).then(a).catch(a=>setTimeout(()=>{throw a},0))},33286:function(a,b,c){let{instantiate:d}=c(19824);function e(a={}){if(!e.supported)return null;var b=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return d(new Response(new Blob([b],{type:"application/wasm"})),a)}e.supported="undefined"!=typeof WebAssembly,a.exports=e},63060:function(a,b,c){let d=c(57118),e=c(33286),f=async(a,b,c,f,g)=>{let h=await e();return new d(h,a,b,c,f,g)};a.exports={Rabin:d,create:f}},57118:function(a){class b{constructor(a,b=12,c=8192,d=32768,e=64,f){this.bits=b,this.min=c,this.max=d,this.asModule=a,this.rabin=new a.Rabin(b,c,d,e,f),this.polynomial=f}fingerprint(a){let{__retain:b,__release:c,__allocArray:d,__getInt32Array:e,Int32Array_ID:f,Uint8Array_ID:g}=this.asModule,h=new Int32Array(Math.ceil(a.length/this.min)),i=b(d(f,h)),j=b(d(g,a)),k=this.rabin.fingerprint(j,i),l=e(k);c(j),c(i);let m=l.indexOf(0);return m>=0?l.subarray(0,m):l}}a.exports=b},61798:function(a,b,c){"use strict";var d=c(83454),e=65536,f=4294967295;function g(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var h=c(89509).Buffer,i=c.g.crypto||c.g.msCrypto;function j(a,b){if(a>f)throw RangeError("requested too many random bytes");var c=h.allocUnsafe(a);if(a>0){if(a>e)for(var g=0;g<a;g+=e)i.getRandomValues(c.slice(g,g+e));else i.getRandomValues(c)}return"function"==typeof b?d.nextTick(function(){b(null,c)}):c}i&&i.getRandomValues?a.exports=j:a.exports=g},94281:function(a){"use strict";function b(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}var c={};function d(a,d,e){function f(a,b,c){return"string"==typeof d?d:d(a,b,c)}e||(e=Error);var g=function(a){function c(b,c,d){return a.call(this,f(b,c,d))||this}return b(c,a),c}(e);g.prototype.name=e.name,g.prototype.code=a,c[a]=g}function e(a,b){if(!Array.isArray(a))return"of ".concat(b," ").concat(String(a));var c=a.length;return(a=a.map(function(a){return String(a)}),c>2)?"one of ".concat(b," ").concat(a.slice(0,c-1).join(", "),", or ")+a[c-1]:2===c?"one of ".concat(b," ").concat(a[0]," or ").concat(a[1]):"of ".concat(b," ").concat(a[0])}function f(a,b,c){return a.substr(!c||c<0?0:+c,b.length)===b}function g(a,b,c){return(void 0===c||c>a.length)&&(c=a.length),a.substring(c-b.length,c)===b}function h(a,b,c){return"number"!=typeof c&&(c=0),!(c+b.length>a.length)&& -1!==a.indexOf(b,c)}d("ERR_INVALID_OPT_VALUE",function(a,b){return'The value "'+b+'" is invalid for option "'+a+'"'},TypeError),d("ERR_INVALID_ARG_TYPE",function(a,b,c){if("string"==typeof b&&f(b,"not ")?(d="must not be",b=b.replace(/^not /,"")):d="must be",g(a," argument"))i="The ".concat(a," ").concat(d," ").concat(e(b,"type"));else{var d,i,j=h(a,".")?"property":"argument";i='The "'.concat(a,'" ').concat(j," ").concat(d," ").concat(e(b,"type"))}return i+". Received type ".concat(typeof c)},TypeError),d("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),d("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),d("ERR_STREAM_PREMATURE_CLOSE","Premature close"),d("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),d("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),d("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),d("ERR_STREAM_WRITE_AFTER_END","write after end"),d("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),d("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),d("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.q=c},56753:function(a,b,c){"use strict";var d=c(83454),e=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};a.exports=k;var f=c(79481),g=c(64229);c(35717)(k,f);for(var h=e(g.prototype),i=0;i<h.length;i++){var j=h[i];k.prototype[j]||(k.prototype[j]=g.prototype[j])}function k(a){if(!(this instanceof k))return new k(a);f.call(this,a),g.call(this,a),this.allowHalfOpen=!0,a&&(!1===a.readable&&(this.readable=!1),!1===a.writable&&(this.writable=!1),!1===a.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||d.nextTick(m,this)}function m(a){a.end()}Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&& void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(a){void 0!==this._readableState&& void 0!==this._writableState&&(this._readableState.destroyed=a,this._writableState.destroyed=a)}})},82725:function(a,b,c){"use strict";a.exports=e;var d=c(74605);function e(a){if(!(this instanceof e))return new e(a);d.call(this,a)}c(35717)(e,d),e.prototype._transform=function(a,b,c){c(null,a)}},79481:function(a,b,c){"use strict";var d,e,f,g,h,i=c(83454);a.exports=C,C.ReadableState=B,c(17187).EventEmitter;var j=function(a,b){return a.listeners(b).length},k=c(22503),l=c(48764).Buffer,m=c.g.Uint8Array||function(){};function n(a){return l.from(a)}function o(a){return l.isBuffer(a)||a instanceof m}var p=c(94616);e=p&&p.debuglog?p.debuglog("stream"):function(){};var q=c(57327),r=c(61195),s=c(82457).getHighWaterMark,t=c(94281).q,u=t.ERR_INVALID_ARG_TYPE,v=t.ERR_STREAM_PUSH_AFTER_EOF,w=t.ERR_METHOD_NOT_IMPLEMENTED,x=t.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;c(35717)(C,k);var y=r.errorOrDestroy,z=["error","close","destroy","pause","resume"];function A(a,b,c){if("function"==typeof a.prependListener)return a.prependListener(b,c);a._events&&a._events[b]?Array.isArray(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c)}function B(a,b,e){d=d||c(56753),a=a||{},"boolean"!=typeof e&&(e=b instanceof d),this.objectMode=!!a.objectMode,e&&(this.objectMode=this.objectMode||!!a.readableObjectMode),this.highWaterMark=s(this,a,"readableHighWaterMark",e),this.buffer=new q,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==a.emitClose,this.autoDestroy=!!a.autoDestroy,this.destroyed=!1,this.defaultEncoding=a.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,a.encoding&&(f||(f=c(32553).s),this.decoder=new f(a.encoding),this.encoding=a.encoding)}function C(a){if(d=d||c(56753),!(this instanceof C))return new C(a);var b=this instanceof d;this._readableState=new B(a,this,b),this.readable=!0,a&&("function"==typeof a.read&&(this._read=a.read),"function"==typeof a.destroy&&(this._destroy=a.destroy)),k.call(this)}function D(a,b,c,d,f){e("readableAddChunk",b);var g,h=a._readableState;if(null===b)h.reading=!1,J(a,h);else if(f||(g=F(h,b)),g)y(a,g);else if(h.objectMode||b&&b.length>0){if("string"==typeof b||h.objectMode||Object.getPrototypeOf(b)===l.prototype||(b=n(b)),d)h.endEmitted?y(a,new x):E(a,h,b,!0);else if(h.ended)y(a,new v);else{if(h.destroyed)return!1;h.reading=!1,h.decoder&&!c?(b=h.decoder.write(b),h.objectMode||0!==b.length?E(a,h,b,!1):M(a,h)):E(a,h,b,!1)}}else d||(h.reading=!1,M(a,h));return!h.ended&&(h.length<h.highWaterMark||0===h.length)}function E(a,b,c,d){b.flowing&&0===b.length&&!b.sync?(b.awaitDrain=0,a.emit("data",c)):(b.length+=b.objectMode?1:c.length,d?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&K(a)),M(a,b)}function F(a,b){var c;return o(b)||"string"==typeof b|| void 0===b||a.objectMode||(c=new u("chunk",["string","Buffer","Uint8Array"],b)),c}Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(a){this._readableState&&(this._readableState.destroyed=a)}}),C.prototype.destroy=r.destroy,C.prototype._undestroy=r.undestroy,C.prototype._destroy=function(a,b){b(a)},C.prototype.push=function(a,b){var c,d=this._readableState;return d.objectMode?c=!0:"string"==typeof a&&((b=b||d.defaultEncoding)!==d.encoding&&(a=l.from(a,b),b=""),c=!0),D(this,a,b,!1,c)},C.prototype.unshift=function(a){return D(this,a,null,!0,!1)},C.prototype.isPaused=function(){return!1===this._readableState.flowing},C.prototype.setEncoding=function(a){f||(f=c(32553).s);var b=new f(a);this._readableState.decoder=b,this._readableState.encoding=this._readableState.decoder.encoding;for(var d=this._readableState.buffer.head,e="";null!==d;)e+=b.write(d.data),d=d.next;return this._readableState.buffer.clear(),""!==e&&this._readableState.buffer.push(e),this._readableState.length=e.length,this};var G=1073741824;function H(a){return a>=G?a=G:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function I(a,b){return a<=0||0===b.length&&b.ended?0:b.objectMode?1:a!=a?b.flowing&&b.length?b.buffer.head.data.length:b.length:(a>b.highWaterMark&&(b.highWaterMark=H(a)),a<=b.length)?a:b.ended?b.length:(b.needReadable=!0,0)}function J(a,b){if(e("onEofChunk"),!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.sync?K(a):(b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,L(a)))}}function K(a){var b=a._readableState;e("emitReadable",b.needReadable,b.emittedReadable),b.needReadable=!1,b.emittedReadable||(e("emitReadable",b.flowing),b.emittedReadable=!0,i.nextTick(L,a))}function L(a){var b=a._readableState;e("emitReadable_",b.destroyed,b.length,b.ended),!b.destroyed&&(b.length||b.ended)&&(a.emit("readable"),b.emittedReadable=!1),b.needReadable=!b.flowing&&!b.ended&&b.length<=b.highWaterMark,T(a)}function M(a,b){b.readingMore||(b.readingMore=!0,i.nextTick(N,a,b))}function N(a,b){for(;!b.reading&&!b.ended&&(b.length<b.highWaterMark||b.flowing&&0===b.length);){var c=b.length;if(e("maybeReadMore read 0"),a.read(0),c===b.length)break}b.readingMore=!1}function O(a){return function(){var b=a._readableState;e("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&j(a,"data")&&(b.flowing=!0,T(a))}}function P(a){var b=a._readableState;b.readableListening=a.listenerCount("readable")>0,b.resumeScheduled&&!b.paused?b.flowing=!0:a.listenerCount("data")>0&&a.resume()}function Q(a){e("readable nexttick read 0"),a.read(0)}function R(a,b){b.resumeScheduled||(b.resumeScheduled=!0,i.nextTick(S,a,b))}function S(a,b){e("resume",b.reading),b.reading||a.read(0),b.resumeScheduled=!1,a.emit("resume"),T(a),b.flowing&&!b.reading&&a.read(0)}function T(a){var b=a._readableState;for(e("flow",b.flowing);b.flowing&&null!==a.read(););}function U(a,b){var c;return 0===b.length?null:(b.objectMode?c=b.buffer.shift():!a||a>=b.length?(c=b.decoder?b.buffer.join(""):1===b.buffer.length?b.buffer.first():b.buffer.concat(b.length),b.buffer.clear()):c=b.buffer.consume(a,b.decoder),c)}function V(a){var b=a._readableState;e("endReadable",b.endEmitted),b.endEmitted||(b.ended=!0,i.nextTick(W,b,a))}function W(a,b){if(e("endReadableNT",a.endEmitted,a.length),!a.endEmitted&&0===a.length&&(a.endEmitted=!0,b.readable=!1,b.emit("end"),a.autoDestroy)){var c=b._writableState;(!c||c.autoDestroy&&c.finished)&&b.destroy()}}function X(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return -1}C.prototype.read=function(a){e("read",a),a=parseInt(a,10);var b,c=this._readableState,d=a;if(0!==a&&(c.emittedReadable=!1),0===a&&c.needReadable&&((0!==c.highWaterMark?c.length>=c.highWaterMark:c.length>0)||c.ended))return e("read: emitReadable",c.length,c.ended),0===c.length&&c.ended?V(this):K(this),null;if(0===(a=I(a,c))&&c.ended)return 0===c.length&&V(this),null;var f=c.needReadable;return e("need readable",f),(0===c.length||c.length-a<c.highWaterMark)&&e("length less than watermark",f=!0),c.ended||c.reading?e("reading or ended",f=!1):f&&(e("do read"),c.reading=!0,c.sync=!0,0===c.length&&(c.needReadable=!0),this._read(c.highWaterMark),c.sync=!1,c.reading||(a=I(d,c))),null===(b=a>0?U(a,c):null)?(c.needReadable=c.length<=c.highWaterMark,a=0):(c.length-=a,c.awaitDrain=0),0===c.length&&(c.ended||(c.needReadable=!0),d!==a&&c.ended&&V(this)),null!==b&&this.emit("data",b),b},C.prototype._read=function(a){y(this,new w("_read()"))},C.prototype.pipe=function(a,b){var c=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=a;break;case 1:d.pipes=[d.pipes,a];break;default:d.pipes.push(a)}d.pipesCount+=1,e("pipe count=%d opts=%j",d.pipesCount,b);var f=b&& !1===b.end||a===i.stdout||a===i.stderr?r:h;function g(a,b){e("onunpipe"),a===c&&b&& !1===b.hasUnpiped&&(b.hasUnpiped=!0,m())}function h(){e("onend"),a.end()}d.endEmitted?i.nextTick(f):c.once("end",f),a.on("unpipe",g);var k=O(c);a.on("drain",k);var l=!1;function m(){e("cleanup"),a.removeListener("close",p),a.removeListener("finish",q),a.removeListener("drain",k),a.removeListener("error",o),a.removeListener("unpipe",g),c.removeListener("end",h),c.removeListener("end",r),c.removeListener("data",n),l=!0,d.awaitDrain&&(!a._writableState||a._writableState.needDrain)&&k()}function n(b){e("ondata");var f=a.write(b);e("dest.write",f),!1===f&&((1===d.pipesCount&&d.pipes===a||d.pipesCount>1&& -1!==X(d.pipes,a))&&!l&&(e("false write response, pause",d.awaitDrain),d.awaitDrain++),c.pause())}function o(b){e("onerror",b),r(),a.removeListener("error",o),0===j(a,"error")&&y(a,b)}function p(){a.removeListener("finish",q),r()}function q(){e("onfinish"),a.removeListener("close",p),r()}function r(){e("unpipe"),c.unpipe(a)}return c.on("data",n),A(a,"error",o),a.once("close",p),a.once("finish",q),a.emit("pipe",c),d.flowing||(e("pipe resume"),c.resume()),a},C.prototype.unpipe=function(a){var b=this._readableState,c={hasUnpiped:!1};if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes||(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this,c)),this;if(!a){var d=b.pipes,e=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var f=0;f<e;f++)d[f].emit("unpipe",this,{hasUnpiped:!1});return this}var g=X(b.pipes,a);return -1===g||(b.pipes.splice(g,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this,c)),this},C.prototype.on=function(a,b){var c=k.prototype.on.call(this,a,b),d=this._readableState;return"data"===a?(d.readableListening=this.listenerCount("readable")>0,!1!==d.flowing&&this.resume()):"readable"!==a||d.endEmitted||d.readableListening||(d.readableListening=d.needReadable=!0,d.flowing=!1,d.emittedReadable=!1,e("on readable",d.length,d.reading),d.length?K(this):d.reading||i.nextTick(Q,this)),c},C.prototype.addListener=C.prototype.on,C.prototype.removeListener=function(a,b){var c=k.prototype.removeListener.call(this,a,b);return"readable"===a&&i.nextTick(P,this),c},C.prototype.removeAllListeners=function(a){var b=k.prototype.removeAllListeners.apply(this,arguments);return("readable"===a|| void 0===a)&&i.nextTick(P,this),b},C.prototype.resume=function(){var a=this._readableState;return a.flowing||(e("resume"),a.flowing=!a.readableListening,R(this,a)),a.paused=!1,this},C.prototype.pause=function(){return e("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(e("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},C.prototype.wrap=function(a){var b=this,c=this._readableState,d=!1;for(var f in a.on("end",function(){if(e("wrapped end"),c.decoder&&!c.ended){var a=c.decoder.end();a&&a.length&&b.push(a)}b.push(null)}),a.on("data",function(f){if(e("wrapped data"),c.decoder&&(f=c.decoder.write(f)),!c.objectMode||null!=f)(c.objectMode||f&&f.length)&&(b.push(f)||(d=!0,a.pause()))}),a)void 0===this[f]&&"function"==typeof a[f]&&(this[f]=function(b){return function(){return a[b].apply(a,arguments)}}(f));for(var g=0;g<z.length;g++)a.on(z[g],this.emit.bind(this,z[g]));return this._read=function(b){e("wrapped _read",b),d&&(d=!1,a.resume())},this},"function"==typeof Symbol&&(C.prototype[Symbol.asyncIterator]=function(){return void 0===g&&(g=c(45850)),g(this)}),Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(C.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(C.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(a){this._readableState&&(this._readableState.flowing=a)}}),C._fromList=U,Object.defineProperty(C.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(C.from=function(a,b){return void 0===h&&(h=c(15167)),h(C,a,b)})},74605:function(a,b,c){"use strict";a.exports=k;var d=c(94281).q,e=d.ERR_METHOD_NOT_IMPLEMENTED,f=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_TRANSFORM_ALREADY_TRANSFORMING,h=d.ERR_TRANSFORM_WITH_LENGTH_0,i=c(56753);function j(a,b){var c=this._transformState;c.transforming=!1;var d=c.writecb;if(null===d)return this.emit("error",new f);c.writechunk=null,c.writecb=null,null!=b&&this.push(b),d(a);var e=this._readableState;e.reading=!1,(e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}function k(a){if(!(this instanceof k))return new k(a);i.call(this,a),this._transformState={afterTransform:j.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.on("prefinish",l)}function l(){var a=this;"function"!=typeof this._flush||this._readableState.destroyed?m(this,null,null):this._flush(function(b,c){m(a,b,c)})}function m(a,b,c){if(b)return a.emit("error",b);if(null!=c&&a.push(c),a._writableState.length)throw new h;if(a._transformState.transforming)throw new g;return a.push(null)}c(35717)(k,i),k.prototype.push=function(a,b){return this._transformState.needTransform=!1,i.prototype.push.call(this,a,b)},k.prototype._transform=function(a,b,c){c(new e("_transform()"))},k.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},k.prototype._read=function(a){var b=this._transformState;null===b.writechunk||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))},k.prototype._destroy=function(a,b){i.prototype._destroy.call(this,a,function(a){b(a)})}},64229:function(a,b,c){"use strict";var d,e,f=c(83454);function g(a){var b=this;this.next=null,this.entry=null,this.finish=function(){S(b,a)}}a.exports=B,B.WritableState=A;var h={deprecate:c(94927)},i=c(22503),j=c(48764).Buffer,k=c.g.Uint8Array||function(){};function l(a){return j.from(a)}function m(a){return j.isBuffer(a)||a instanceof k}var n=c(61195),o=c(82457).getHighWaterMark,p=c(94281).q,q=p.ERR_INVALID_ARG_TYPE,r=p.ERR_METHOD_NOT_IMPLEMENTED,s=p.ERR_MULTIPLE_CALLBACK,t=p.ERR_STREAM_CANNOT_PIPE,u=p.ERR_STREAM_DESTROYED,v=p.ERR_STREAM_NULL_VALUES,w=p.ERR_STREAM_WRITE_AFTER_END,x=p.ERR_UNKNOWN_ENCODING,y=n.errorOrDestroy;function z(){}function A(a,b,e){d=d||c(56753),a=a||{},"boolean"!=typeof e&&(e=b instanceof d),this.objectMode=!!a.objectMode,e&&(this.objectMode=this.objectMode||!!a.writableObjectMode),this.highWaterMark=o(this,a,"writableHighWaterMark",e),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===a.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){J(b,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==a.emitClose,this.autoDestroy=!!a.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}function B(a){var b=this instanceof(d=d||c(56753));if(!b&&!e.call(B,this))return new B(a);this._writableState=new A(a,this,b),this.writable=!0,a&&("function"==typeof a.write&&(this._write=a.write),"function"==typeof a.writev&&(this._writev=a.writev),"function"==typeof a.destroy&&(this._destroy=a.destroy),"function"==typeof a.final&&(this._final=a.final)),i.call(this)}function C(a,b){var c=new w;y(a,c),f.nextTick(b,c)}function D(a,b,c,d){var e;return null===c?e=new v:"string"==typeof c||b.objectMode||(e=new q("chunk",["string","Buffer"],c)),!e||(y(a,e),f.nextTick(d,e),!1)}function E(a,b,c){return a.objectMode|| !1===a.decodeStrings||"string"!=typeof b||(b=j.from(b,c)),b}function F(a,b,c,d,e,f){if(!c){var g=E(b,d,e);d!==g&&(c=!0,e="buffer",d=g)}var h=b.objectMode?1:d.length;b.length+=h;var i=b.length<b.highWaterMark;if(i||(b.needDrain=!0),b.writing||b.corked){var j=b.lastBufferedRequest;b.lastBufferedRequest={chunk:d,encoding:e,isBuf:c,callback:f,next:null},j?j.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else G(a,b,!1,h,d,e,f);return i}function G(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,b.destroyed?b.onwrite(new u("write")):c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function H(a,b,c,d,e){--b.pendingcb,c?(f.nextTick(e,d),f.nextTick(Q,a,b),a._writableState.errorEmitted=!0,y(a,d)):(e(d),a._writableState.errorEmitted=!0,y(a,d),Q(a,b))}function I(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function J(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if("function"!=typeof e)throw new s;if(I(c),b)H(a,c,d,b,e);else{var g=N(c)||a.destroyed;g||c.corked||c.bufferProcessing||!c.bufferedRequest||M(a,c),d?f.nextTick(K,a,c,g,e):K(a,c,g,e)}}function K(a,b,c,d){c||L(a,b),b.pendingcb--,d(),Q(a,b)}function L(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function M(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=Array(b.bufferedRequestCount),e=b.corkedRequestsFree;e.entry=c;for(var f=0,h=!0;c;)d[f]=c,c.isBuf||(h=!1),c=c.next,f+=1;d.allBuffers=h,G(a,b,!0,b.length,d,"",e.finish),b.pendingcb++,b.lastBufferedRequest=null,e.next?(b.corkedRequestsFree=e.next,e.next=null):b.corkedRequestsFree=new g(b),b.bufferedRequestCount=0}else{for(;c;){var i=c.chunk,j=c.encoding,k=c.callback,l=b.objectMode?1:i.length;if(G(a,b,!1,l,i,j,k),c=c.next,b.bufferedRequestCount--,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequest=c,b.bufferProcessing=!1}function N(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function O(a,b){a._final(function(c){b.pendingcb--,c&&y(a,c),b.prefinished=!0,a.emit("prefinish"),Q(a,b)})}function P(a,b){b.prefinished||b.finalCalled||("function"!=typeof a._final||b.destroyed?(b.prefinished=!0,a.emit("prefinish")):(b.pendingcb++,b.finalCalled=!0,f.nextTick(O,a,b)))}function Q(a,b){var c=N(b);if(c&&(P(a,b),0===b.pendingcb&&(b.finished=!0,a.emit("finish"),b.autoDestroy))){var d=a._readableState;(!d||d.autoDestroy&&d.endEmitted)&&a.destroy()}return c}function R(a,b,c){b.ending=!0,Q(a,b),c&&(b.finished?f.nextTick(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function S(a,b,c){var d=a.entry;for(a.entry=null;d;){var e=d.callback;b.pendingcb--,e(c),d=d.next}b.corkedRequestsFree.next=a}c(35717)(B,i),A.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(A.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(a){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(e=Function.prototype[Symbol.hasInstance],Object.defineProperty(B,Symbol.hasInstance,{value:function(a){return!!e.call(this,a)||this===B&&a&&a._writableState instanceof A}})):e=function(a){return a instanceof this},B.prototype.pipe=function(){y(this,new t)},B.prototype.write=function(a,b,c){var d=this._writableState,e=!1,f=!d.objectMode&&m(a);return f&&!j.isBuffer(a)&&(a=l(a)),"function"==typeof b&&(c=b,b=null),f?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=z),d.ending?C(this,c):(f||D(this,d,a,c))&&(d.pendingcb++,e=F(this,d,f,a,b,c)),e},B.prototype.cork=function(){this._writableState.corked++},B.prototype.uncork=function(){var a=this._writableState;!a.corked||(a.corked--,a.writing||a.corked||a.bufferProcessing||!a.bufferedRequest||M(this,a))},B.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())> -1))throw new x(a);return this._writableState.defaultEncoding=a,this},Object.defineProperty(B.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(B.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),B.prototype._write=function(a,b,c){c(new r("_write()"))},B.prototype._writev=null,B.prototype.end=function(a,b,c){var d=this._writableState;return"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!=a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||R(this,d,c),this},Object.defineProperty(B.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(B.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(a){this._writableState&&(this._writableState.destroyed=a)}}),B.prototype.destroy=n.destroy,B.prototype._undestroy=n.undestroy,B.prototype._destroy=function(a,b){b(a)}},45850:function(a,b,c){"use strict";var d,e=c(83454);function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var g=c(8610),h=Symbol("lastResolve"),i=Symbol("lastReject"),j=Symbol("error"),k=Symbol("ended"),l=Symbol("lastPromise"),m=Symbol("handlePromise"),n=Symbol("stream");function o(a,b){return{value:a,done:b}}function p(a){var b=a[h];if(null!==b){var c=a[n].read();null!==c&&(a[l]=null,a[h]=null,a[i]=null,b(o(c,!1)))}}function q(a){e.nextTick(p,a)}function r(a,b){return function(c,d){a.then(function(){if(b[k]){c(o(void 0,!0));return}b[m](c,d)},d)}}var s=Object.getPrototypeOf(function(){}),t=Object.setPrototypeOf((d={get stream(){return this[n]},next:function(){var a,b=this,c=this[j];if(null!==c)return Promise.reject(c);if(this[k])return Promise.resolve(o(void 0,!0));if(this[n].destroyed)return new Promise(function(a,c){e.nextTick(function(){b[j]?c(b[j]):a(o(void 0,!0))})});var d=this[l];if(d)a=new Promise(r(d,this));else{var f=this[n].read();if(null!==f)return Promise.resolve(o(f,!1));a=new Promise(this[m])}return this[l]=a,a}},f(d,Symbol.asyncIterator,function(){return this}),f(d,"return",function(){var a=this;return new Promise(function(b,c){a[n].destroy(null,function(a){if(a){c(a);return}b(o(void 0,!0))})})}),d),s),u=function(a){var b,c=Object.create(t,(f(b={},n,{value:a,writable:!0}),f(b,h,{value:null,writable:!0}),f(b,i,{value:null,writable:!0}),f(b,j,{value:null,writable:!0}),f(b,k,{value:a._readableState.endEmitted,writable:!0}),f(b,m,{value:function(a,b){var d=c[n].read();d?(c[l]=null,c[h]=null,c[i]=null,a(o(d,!1))):(c[h]=a,c[i]=b)},writable:!0}),b));return c[l]=null,g(a,function(a){if(a&&"ERR_STREAM_PREMATURE_CLOSE"!==a.code){var b=c[i];null!==b&&(c[l]=null,c[h]=null,c[i]=null,b(a)),c[j]=a;return}var d=c[h];null!==d&&(c[l]=null,c[h]=null,c[i]=null,d(o(void 0,!0))),c[k]=!0}),a.on("readable",q.bind(null,c)),c};a.exports=u},57327:function(a,b,c){"use strict";function d(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function e(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?d(Object(c),!0).forEach(function(b){f(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):d(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function g(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")}function h(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function i(a,b,c){return b&&h(a.prototype,b),c&&h(a,c),a}var j=c(48764).Buffer,k=c(52361).inspect,l=k&&k.custom||"inspect";function m(a,b,c){j.prototype.copy.call(a,b,c)}a.exports=function(){function a(){g(this,a),this.head=null,this.tail=null,this.length=0}return i(a,[{key:"push",value:function(a){var b={data:a,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length}},{key:"unshift",value:function(a){var b={data:a,next:this.head};0===this.length&&(this.tail=b),this.head=b,++this.length}},{key:"shift",value:function(){if(0!==this.length){var a=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,a}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(a){if(0===this.length)return"";for(var b=this.head,c=""+b.data;b=b.next;)c+=a+b.data;return c}},{key:"concat",value:function(a){if(0===this.length)return j.alloc(0);for(var b=j.allocUnsafe(a>>>0),c=this.head,d=0;c;)m(c.data,b,d),d+=c.data.length,c=c.next;return b}},{key:"consume",value:function(a,b){var c;return a<this.head.data.length?(c=this.head.data.slice(0,a),this.head.data=this.head.data.slice(a)):c=a===this.head.data.length?this.shift():b?this._getString(a):this._getBuffer(a),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(a){var b=this.head,c=1,d=b.data;for(a-=d.length;b=b.next;){var e=b.data,f=a>e.length?e.length:a;if(f===e.length?d+=e:d+=e.slice(0,a),0==(a-=f)){f===e.length?(++c,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=e.slice(f));break}++c}return this.length-=c,d}},{key:"_getBuffer",value:function(a){var b=j.allocUnsafe(a),c=this.head,d=1;for(c.data.copy(b),a-=c.data.length;c=c.next;){var e=c.data,f=a>e.length?e.length:a;if(e.copy(b,b.length-a,0,f),0==(a-=f)){f===e.length?(++d,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=e.slice(f));break}++d}return this.length-=d,b}},{key:l,value:function(a,b){return k(this,e({},b,{depth:0,customInspect:!1}))}}]),a}()},61195:function(a,b,c){"use strict";var d=c(83454);function e(a,b){var c=this,e=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return e||h?(b?b(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,d.nextTick(i,this,a)):d.nextTick(i,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(a){!b&&a?c._writableState?c._writableState.errorEmitted?d.nextTick(g,c):(c._writableState.errorEmitted=!0,d.nextTick(f,c,a)):d.nextTick(f,c,a):b?(d.nextTick(g,c),b(a)):d.nextTick(g,c)}),this)}function f(a,b){i(a,b),g(a)}function g(a){(!a._writableState||a._writableState.emitClose)&&(!a._readableState||a._readableState.emitClose)&&a.emit("close")}function h(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(a,b){a.emit("error",b)}function j(a,b){var c=a._readableState,d=a._writableState;c&&c.autoDestroy||d&&d.autoDestroy?a.destroy(b):a.emit("error",b)}a.exports={destroy:e,undestroy:h,errorOrDestroy:j}},8610:function(a,b,c){"use strict";var d=c(94281).q.ERR_STREAM_PREMATURE_CLOSE;function e(a){var b=!1;return function(){if(!b){b=!0;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];a.apply(this,d)}}}function f(){}function g(a){return a.setHeader&&"function"==typeof a.abort}function h(a,b,c){if("function"==typeof b)return h(a,null,b);b||(b={}),c=e(c||f);var i=b.readable|| !1!==b.readable&&a.readable,j=b.writable|| !1!==b.writable&&a.writable,k=function(){a.writable||m()},l=a._writableState&&a._writableState.finished,m=function(){j=!1,l=!0,i||c.call(a)},n=a._readableState&&a._readableState.endEmitted,o=function(){i=!1,n=!0,j||c.call(a)},p=function(b){c.call(a,b)},q=function(){var b;return i&&!n?(a._readableState&&a._readableState.ended||(b=new d),c.call(a,b)):j&&!l?(a._writableState&&a._writableState.ended||(b=new d),c.call(a,b)):void 0},r=function(){a.req.on("finish",m)};return g(a)?(a.on("complete",m),a.on("abort",q),a.req?r():a.on("request",r)):j&&!a._writableState&&(a.on("end",k),a.on("close",k)),a.on("end",o),a.on("finish",m),!1!==b.error&&a.on("error",p),a.on("close",q),function(){a.removeListener("complete",m),a.removeListener("abort",q),a.removeListener("request",r),a.req&&a.req.removeListener("finish",m),a.removeListener("end",k),a.removeListener("close",k),a.removeListener("finish",m),a.removeListener("end",o),a.removeListener("error",p),a.removeListener("close",q)}}a.exports=h},15167:function(a){a.exports=function(){throw Error("Readable.from is not available in the browser")}},59946:function(a,b,c){"use strict";function d(a){var b=!1;return function(){b||(b=!0,a.apply(void 0,arguments))}}var e,f=c(94281).q,g=f.ERR_MISSING_ARGS,h=f.ERR_STREAM_DESTROYED;function i(a){if(a)throw a}function j(a){return a.setHeader&&"function"==typeof a.abort}function k(a,b,f,g){g=d(g);var i=!1;a.on("close",function(){i=!0}),void 0===e&&(e=c(8610)),e(a,{readable:b,writable:f},function(a){if(a)return g(a);i=!0,g()});var k=!1;return function(b){if(!i&&!k){if(k=!0,j(a))return a.abort();if("function"==typeof a.destroy)return a.destroy();g(b||new h("pipe"))}}}function l(a){a()}function m(a,b){return a.pipe(b)}function n(a){return a.length&&"function"==typeof a[a.length-1]?a.pop():i}function o(){for(var a,b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];var e=n(c);if(Array.isArray(c[0])&&(c=c[0]),c.length<2)throw new g("streams");var f=c.map(function(b,d){var g=d<c.length-1;return k(b,g,d>0,function(b){a||(a=b),b&&f.forEach(l),g||(f.forEach(l),e(a))})});return c.reduce(m)}a.exports=o},82457:function(a,b,c){"use strict";var d=c(94281).q.ERR_INVALID_OPT_VALUE;function e(a,b,c){return null!=a.highWaterMark?a.highWaterMark:b?a[c]:null}function f(a,b,c,f){var g=e(b,f,c);if(null!=g){if(!(isFinite(g)&&Math.floor(g)===g)||g<0){var h=f?c:"highWaterMark";throw new d(h,g)}return Math.floor(g)}return a.objectMode?16:16384}a.exports={getHighWaterMark:f}},22503:function(a,b,c){a.exports=c(17187).EventEmitter},88473:function(a,b,c){(b=a.exports=c(79481)).Stream=b,b.Readable=b,b.Writable=c(64229),b.Duplex=c(56753),b.Transform=c(74605),b.PassThrough=c(82725),b.finished=c(8610),b.pipeline=c(59946)},73692:function(a,b,c){"use strict";a.exports=h;var d=c(57824),e=h.prototype,f=new Date%1e9;function g(){return(1e9*Math.random()>>>0)+f++}function h(a){a=a||{},this.id=a.id||g(),this.max=a.max||1/0,this.items=a.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(a.lastModified||new Date);for(var b,c,d=this.items.length;d--;)b=this.items[d],c=new Date(b.expires)-new Date,this._lookup[b.key]=b,c>0?this.expire(b.key,c):c<=0&&this.delete(b.key)}e.has=function(a){return a in this._lookup},e.get=function(a){if(!this.has(a))return null;var b=this._lookup[a];return b.refresh&&this.expire(a,b.refresh),this.items.splice(this.items.indexOf(b),1),this.items.push(b),b.value},e.meta=function(a){if(!this.has(a))return null;var b=this._lookup[a];return"meta"in b?b.meta:null},e.set=function(a,b,c){var d=this._lookup[a],e=this._lookup[a]={key:a,value:b};return this.lastModified=new Date,d?(clearTimeout(d.timeout),this.items.splice(this.items.indexOf(d),1,e)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(e),this.size++),c&&("ttl"in c&&this.expire(a,c.ttl),"meta"in c&&(e.meta=c.meta),c.refresh&&(e.refresh=c.ttl)),this},e.delete=function(a){var b=this._lookup[a];return!!b&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(b),1),clearTimeout(b.timeout),delete this._lookup[a],this.size--,this)},e.expire=function(a,b){var c=b||0,e=this._lookup[a];if(!e)return this;if("string"==typeof c&&(c=d(b)),"number"!=typeof c)throw TypeError("Expiration time must be a string or number.");return clearTimeout(e.timeout),e.timeout=setTimeout(this.delete.bind(this,e.key),c),e.expires=Number(new Date)+c,this},e.clear=function(){for(var a=this.items.length;a--;)this.delete(this.items[a].key);return this},e.toJSON=function(){for(var a,b=Array(this.items.length),c=b.length;c--;)a=this.items[c],b[c]={key:a.key,meta:a.meta,value:a.value,expires:a.expires,refresh:a.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:b}}},82916:function(a,b,c){"use strict";let d=c(41807);class e{constructor(a,b,c){let e=this;this._started=d(),this._rescheduled=0,this._scheduled=b,this._args=c,this._triggered=!1,this._timerWrapper=()=>{e._rescheduled>0?(e._scheduled=e._rescheduled-(d()-e._started),e._schedule(e._scheduled)):(e._triggered=!0,a.apply(null,e._args))},this._timer=setTimeout(this._timerWrapper,b)}reschedule(a){a||(a=this._scheduled);let b=d();b+a-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(a)):this._triggered?this._schedule(a):(this._started=b,this._rescheduled=a)}_schedule(a){this._triggered=!1,this._started=d(),this._rescheduled=0,this._scheduled=a,this._timer=setTimeout(this._timerWrapper,a)}clear(){clearTimeout(this._timer)}}function f(){if("function"!=typeof arguments[0])throw Error("callback needed");if("number"!=typeof arguments[1])throw Error("timeout needed");let a;if(arguments.length>0){a=Array(arguments.length-2);for(var b=0;b<a.length;b++)a[b]=arguments[b+2]}return new e(arguments[0],arguments[1],a)}a.exports=f},41807:function(a){"use strict";a.exports=function(){return Date.now()}},29967:function(a,b,c){/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */ a.exports=e;let d=c(54375);function e(a,b,c){if("number"!=typeof b)throw Error("second argument must be a Number");let e,f,g,h,i,j=!0,k;function l(a){function b(){c&&c(a,e),c=null}j?d(b):b()}function m(b,c,d){if(e[b]=d,c&&(i=!0),0== --g||c)l(c);else if(!i&&k<f){let j;h?(j=h[k],k+=1,a[j](function(a,b){m(j,a,b)})):(j=k,k+=1,a[j](function(a,b){m(j,a,b)}))}}Array.isArray(a)?(e=[],g=f=a.length):(h=Object.keys(a),e={},g=f=h.length),k=b,g?h?h.some(function(c,d){return a[c](function(a,b){m(c,a,b)}),d===b-1}):a.some(function(a,c){return a(function(a,b){m(c,a,b)}),c===b-1}):l(null),j=!1}},89509:function(a,b,c){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */ var d=c(48764),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?a.exports=d:(f(d,b),b.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},50202:function(a,b,c){"use strict";var d=c(63700),e=/[\/\?<>\\:\*\|"]/g,f=/[\x00-\x1f\x80-\x9f]/g,g=/^\.+$/,h=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,i=/[\. ]+$/;function j(a,b){if("string"!=typeof a)throw Error("Input must be string");return d(a.replace(e,b).replace(f,b).replace(g,b).replace(h,b).replace(i,b),255)}a.exports=function(a,b){var c=b&&b.replacement||"",d=j(a,c);return""===c?d:j(d,"")}},27695:function(a){"use strict";let b=new Map,c=()=>`${Date.now()}:${Math.floor(1e6*Math.random())}`;async function d(a,c,d){for(;b.get(d);){try{await a()}catch(e){setTimeout(()=>{throw e},1);break}if(!b.get(d))break;await new Promise(a=>{let e=setTimeout(a,c);b.set(d,e)})}}function e(a,e,f){f=f||e;let g=c(),h=setTimeout(()=>{d(a,e,g)},f);return b.set(g,h),g}function f(a){let c=b.get(a);c&&(clearTimeout(c),b.delete(a))}a.exports={setDelayedInterval:e,clearDelayedInterval:f}},33694:function(a,b,c){"use strict";let d=c(33310);a.exports=(a,b={})=>{if(!d(a)&&!Array.isArray(a))throw TypeError("Expected a plain object or array");let{deep:c}=b,e=[],f=[],g=a=>{let b=e.indexOf(a);if(-1!==b)return f[b];let c=[];return e.push(a),f.push(c),c.push(...a.map(a=>Array.isArray(a)?g(a):d(a)?h(a):a)),c},h=a=>{let i=e.indexOf(a);if(-1!==i)return f[i];let j={},k=Object.keys(a).sort(b.compare);for(let l of(e.push(a),f.push(j),k)){let m=a[l],n;n=c&&Array.isArray(m)?g(m):c&&d(m)?h(m):m,Object.defineProperty(j,l,{...Object.getOwnPropertyDescriptor(a,l),value:n})}return j};return Array.isArray(a)?c?g(a):a.slice():h(a)}},20544:function(a){"use strict";let b=7;function c(a,b){return a+d(b)}function d(a){let b=a;return b-=b>>1&1431655765,((b=(858993459&b)+(b>>2&858993459))+(b>>4)&252645135)*16843009>>24}function e(a,b){return a[0]-b[0]}function f(a){return a[1]}a.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(a,b){let c=this._internalPositionFor(a,!1);if(void 0===b)-1!==c&&(this._unsetInternalPos(c),this._unsetBit(a),this._changedLength=!0,this._changedData=!0);else{let d=!1;-1===c?(c=this._data.length,this._setBit(a),this._changedData=!0):d=!0,this._setInternalPos(c,a,b,d),this._changedLength=!0}}unset(a){this.set(a,void 0)}get(a){this._sortData();let b=this._internalPositionFor(a,!0);if(-1!==b)return this._data[b][1]}push(a){return this.set(this.length,a),this.length}get length(){if(this._sortData(),this._changedLength){let a=this._data[this._data.length-1];this._length=a?a[0]+1:0,this._changedLength=!1}return this._length}forEach(a){let b=0;for(;b<this.length;)a(this.get(b),b,this),b++}map(a){let b=0,c=Array(this.length);for(;b<this.length;)c[b]=a(this.get(b),b,this),b++;return c}reduce(a,b){let c=0,d=b;for(;c<this.length;){let e=this.get(c);d=a(d,e,c),c++}return d}find(a){let b=0,c,d;for(;b<this.length&&!c;)c=a(d=this.get(b)),b++;return c?d:void 0}_internalPositionFor(a,e){let f=this._bytePosFor(a,e);if(f>=this._bitArrays.length)return -1;let g=this._bitArrays[f],h=a-f*b,i=(g&1<<h)>0;if(!i)return -1;let j=this._bitArrays.slice(0,f).reduce(c,0),k=~(4294967295<<h+1),l=d(g&k),m=j+l-1;return m}_bytePosFor(a,c){let d=Math.floor(a/b),e=d+1;for(;!c&&this._bitArrays.length<e;)this._bitArrays.push(0);return d}_setBit(a){let c=this._bytePosFor(a,!1);this._bitArrays[c]|=1<<a-c*b}_unsetBit(a){let c=this._bytePosFor(a,!1);this._bitArrays[c]&=~(1<<a-c*b)}_setInternalPos(a,b,c,d){let e=this._data,f=[b,c];if(d)this._sortData(),e[a]=f;else{if(e.length){if(e[e.length-1][0]>=b)e.push(f);else if(e[0][0]<=b)e.unshift(f);else{let g=Math.round(e.length/2);this._data=e.slice(0,g).concat(f).concat(e.slice(g))}}else this._data.push(f);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(a){this._data.splice(a,1)}_sortData(){this._changedData&&this._data.sort(e),this._changedData=!1}bitField(){let a=[],b=8,c=0,d=0,e,f=this._bitArrays.slice();for(;f.length||c;){0===c&&(e=f.shift(),c=7);let g=Math.min(c,b),h=~(255<<g),i=e&h;d|=i<<8-b,e>>>=g,c-=g,b-=g,b&&(c||f.length)||(a.push(d),d=0,b=8)}for(var j=a.length-1;j>0;j--){let k=a[j];if(0===k)a.pop();else break}return a}compactArray(){return this._sortData(),this._data.map(f)}}},50590:function(a){a.exports=a=>{if(a[Symbol.asyncIterator])return a;if(a.getReader)return async function*(){let b=a.getReader();try{for(;;){let{done:c,value:d}=await b.read();if(c)return;yield d}}finally{b.releaseLock()}}();throw Error("unknown stream")}},32553:function(a,b,c){"use strict";var d=c(89509).Buffer,e=d.isEncoding||function(a){switch((a=""+a)&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function f(a){var b;if(!a)return"utf8";for(;;)switch(a){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return a;default:if(b)return;a=(""+a).toLowerCase(),b=!0}}function g(a){var b=f(a);if("string"!=typeof b&&(d.isEncoding===e||!e(a)))throw Error("Unknown encoding: "+a);return b||a}function h(a){var b;switch(this.encoding=g(a),this.encoding){case"utf16le":this.text=o,this.end=p,b=4;break;case"utf8":this.fillLast=l,b=4;break;case"base64":this.text=q,this.end=r,b=3;break;default:this.write=s,this.end=t;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(b)}function i(a){return a<=127?0:a>>5==6?2:a>>4==14?3:a>>3==30?4:a>>6==2?-1:-2}function j(a,b,c){var d=b.length-1;if(d<c)return 0;var e=i(b[d]);return e>=0?(e>0&&(a.lastNeed=e-1),e):--d<c|| -2===e?0:(e=i(b[d]))>=0?(e>0&&(a.lastNeed=e-2),e):--d<c|| -2===e?0:(e=i(b[d]))>=0?(e>0&&(2===e?e=0:a.lastNeed=e-3),e):0}function k(a,b,c){if((192&b[0])!=128)return a.lastNeed=0,"";if(a.lastNeed>1&&b.length>1){if((192&b[1])!=128)return a.lastNeed=1,"";if(a.lastNeed>2&&b.length>2&&(192&b[2])!=128)return a.lastNeed=2,""}}function l(a){var b=this.lastTotal-this.lastNeed,c=k(this,a,b);return void 0!==c?c:this.lastNeed<=a.length?(a.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(a.copy(this.lastChar,b,0,a.length),this.lastNeed-=a.length)}function m(a,b){var c=j(this,a,b);if(!this.lastNeed)return a.toString("utf8",b);this.lastTotal=c;var d=a.length-(c-this.lastNeed);return a.copy(this.lastChar,0,d),a.toString("utf8",b,d)}function n(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+"":b}function o(a,b){if((a.length-b)%2==0){var c=a.toString("utf16le",b);if(c){var d=c.charCodeAt(c.length-1);if(d>=55296&&d<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1],c.slice(0,-1)}return c}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=a[a.length-1],a.toString("utf16le",b,a.length-1)}function p(a){var b=a&&a.length?this.write(a):"";if(this.lastNeed){var c=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,c)}return b}function q(a,b){var c=(a.length-b)%3;return 0===c?a.toString("base64",b):(this.lastNeed=3-c,this.lastTotal=3,1===c?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]),a.toString("base64",b,a.length-c))}function r(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function s(a){return a.toString(this.encoding)}function t(a){return a&&a.length?this.write(a):""}b.s=h,h.prototype.write=function(a){var b,c;if(0===a.length)return"";if(this.lastNeed){if(void 0===(b=this.fillLast(a)))return"";c=this.lastNeed,this.lastNeed=0}else c=0;return c<a.length?b?b+this.text(a,c):this.text(a,c):b||""},h.prototype.end=n,h.prototype.text=m,h.prototype.fillLast=function(a){if(this.lastNeed<=a.length)return a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length),this.lastNeed-=a.length}},10715:function(a,b,c){"use strict";let{AbortController:d}=globalThis,e=c(82916);class f extends d{constructor(a){super(),this._ms=a,this._timer=e(()=>this.abort(),a),Object.setPrototypeOf(this,f.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=e(()=>this.abort(),this._ms)}}a.exports={TimeoutController:f}},84957:function(a){!function(){a.exports=s;var b=86400,c=3200,d=146097*c/400,e=b*d,f=1e3*e,g=1e11*b,h=16777216,i=4294967296,j=1e6,k=1e9,l="000000000",m=Math.trunc||J,n=s.prototype;s.fromDate=A,s.fromInt64BE=H(0,1,2,3,0,4),s.fromInt64LE=H(3,2,1,0,4,0),s.fromString=z,s.fromTimeT=B,n.year=0,n.time=0,n.nano=0,n.addNano=x,n.getNano=y,n.getTimeT=D,n.getYear=t,n.toDate=v,n.toJSON=E,n.toString=F,n.writeInt64BE=G(0,1,2,3,0,4),n.writeInt64LE=G(3,2,1,0,4,0);var o="%Y-%m-%dT%H:%M:%S.%NZ",p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],q=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};function s(a,b,c){var d=this;if(!(d instanceof s))return new s(a,b,c);d.time=+a||0,d.nano=+b||0,d.year=+c||0,u(d)}function t(){return this.toDate().getUTCFullYear()+this.year}function u(a){var b,d,e=a.year,h=a.time,i=a.nano;if(i<0||j<=i){var k=Math.floor(i/j);i-=k*j,h+=k,b=1}var l=e%c;if(h< -g||g<h||l){(d=m(h/f))&&(e+=d*c,h-=d*f);var n=w(h);n.setUTCFullYear(l+n.getUTCFullYear()),e-=l,h=+n,d=m(e/c);var o=h+d*f;d&& -g<=o&&o<=g&&(e-=d*c,h=o),b=1}return b&&(a.year=e,a.time=h,a.nano=i),a}function v(){var a=u(this);return w(a.time)}function w(a){var b=new Date(0);return b.setTime(a),b}function x(a){return this.nano+=+a||0,this}function y(){var a=u(this);return(a.time%1e3*j+ +a.nano+k)%k}function z(a){var b,c=new s,d=(a+="").replace(/^\s*[+\-]?\d+/,function(a){var b=+a,d=1970+(b-1970)%400;return c.year=b-d,d}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(a,c,d){return c<0&&(d*=-1),b=(60*+c+ +d)*6e4,""}).replace(/\.\d+$/,function(a){return c.nano=+(a+l).substr(1,9),""}).split(/\D+/);if(d.length>1?d[1]--:d[1]=0,c.time=b=Date.UTC.apply(Date,d)-(b||0),isNaN(b))throw TypeError("Invalid Date");return u(c)}function A(a){return new s(+a)}function B(a){return C(a,0)}function C(a,b){b|=0,a=+a||0;var d=m((b*=i)/e)+m(a/e),f=b%e+a%e,g=m(f/e);return g&&(d+=g,f-=g*e),new s(1e3*f,0,d*c)}function D(){var a=u(this),e=Math.floor(a.time/1e3),f=a.year;return f&&(e+=f*d*b/c),e}function E(){return this.toString().replace(/0{1,6}Z$/,"Z")}function F(a){var b=this,c=b.toDate(),d={H:j,L:m,M:k,N:n,S:l,Y:f,a:s,b:t,d:h,e:i,m:g};return e(a||o);function e(a){return a.replace(/%./g,function(a){var b=a[1],c=r[b],f=d[b];return c?e(c):f?f():a})}function f(){var a=b.getYear();return a>999999?"+"+a:(0,a>9999)?"+"+M(a,6):(0,a>=0)?M(a,4):(0,a>= -999999)?"-"+M(-a,6):a}function g(){return L(c.getUTCMonth()+1)}function h(){return L(c.getUTCDate())}function i(){return K(c.getUTCDate())}function j(){return L(c.getUTCHours())}function k(){return L(c.getUTCMinutes())}function l(){return L(c.getUTCSeconds())}function m(){return M(c.getUTCMilliseconds(),3)}function n(){return M(b.getNano(),9)}function s(){return q[c.getUTCDay()]}function t(){return p[c.getUTCMonth()]}}function G(a,e,f,g,h,j){return k;function k(a,e){var f=u(this);a||(a=Array(8)),I(a,e|=0);var g=Math.floor(f.time/1e3),k=f.year*(d*b/c),n=m(k/i)+m(g/i),o=k%i+g%i,p=Math.floor(o/i);return p&&(n+=p,o-=p*i),l(a,e+h,n),l(a,e+j,o),a}function l(b,c,d){b[c+a]=d>>24&255,b[c+e]=d>>16&255,b[c+f]=d>>8&255,b[c+g]=255&d}}function H(a,b,c,d,e,f){return g;function g(a,b){I(a,b|=0);var c=i(a,b+e),d=i(a,b+f);return C(d,c)}function i(e,f){return e[f+a]*h+(e[f+b]<<16|e[f+c]<<8|e[f+d])}}function I(a,b){var c=a&&a.length;if(null==c)throw TypeError("Invalid Buffer");if(c<b+8)throw RangeError("Out of range")}function J(a){var b=a-a%1;return 0===b&&(a<0||0===a&&1/a!=1/0)?-0:b}function K(a){return(a>9?"":" ")+(0|a)}function L(a){return(a>9?"":"0")+(0|a)}function M(a,b){return(l+(0|a)).substr(-b)}}()},63700:function(a,b,c){"use strict";var d=c(71156),e=c(90793);a.exports=d.bind(null,e)},71156:function(a){"use strict";function b(a){return a>=55296&&a<=56319}function c(a){return a>=56320&&a<=57343}a.exports=function(a,d,e){if("string"!=typeof d)throw Error("Input must be string");for(var f,g,h=d.length,i=0,j=0;j<h;j+=1){if(f=d.charCodeAt(j),g=d[j],b(f)&&c(d.charCodeAt(j+1))&&(j+=1,g+=d[j]),i+=a(g),i===e)return d.slice(0,j+1);if(i>e)return d.slice(0,j-g.length+1)}return d}},90793:function(a){"use strict";function b(a){return a>=55296&&a<=56319}function c(a){return a>=56320&&a<=57343}a.exports=function(a){if("string"!=typeof a)throw Error("Input must be string");for(var d=a.length,e=0,f=null,g=null,h=0;h<d;h++)c(f=a.charCodeAt(h))?null!=g&&b(g)?e+=1:e+=3:f<=127?e+=1:f>=128&&f<=2047?e+=2:f>=2048&&f<=65535&&(e+=3),g=f;return e}},94927:function(a,b,c){function d(a,b){if(e("noDeprecation"))return a;var c=!1;function d(){if(!c){if(e("throwDeprecation"))throw Error(b);e("traceDeprecation")?console.trace(b):console.warn(b),c=!0}return a.apply(this,arguments)}return d}function e(a){try{if(!c.g.localStorage)return!1}catch(b){return!1}var d=c.g.localStorage[a];return null!=d&&"true"===String(d).toLowerCase()}a.exports=d},23209:function(a){a.exports=d;var b=128,c=127;function d(a,e){var f,g=0,e=e||0,h=0,i=e,j=a.length;do{if(i>=j)throw d.bytes=0,RangeError("Could not decode varint");f=a[i++],g+=h<28?(f&c)<<h:(f&c)*Math.pow(2,h),h+=7}while(f>=b);return d.bytes=i-e,g}},7089:function(a){a.exports=e;var b=128,c=-128,d=2147483648;function e(a,f,g){f=f||[];for(var h=g=g||0;a>=d;)f[g++]=255&a|b,a/=128;for(;a&c;)f[g++]=255&a|b,a>>>=7;return f[g]=0|a,e.bytes=g-h+1,f}},13924:function(a,b,c){a.exports={encode:c(7089),decode:c(23209),encodingLength:c(64146)}},64146:function(a){var b=128,c=16384,d=2097152,e=268435456,f=34359738368,g=4398046511104,h=562949953421312,i=72057594037927940,j=0x7fffffffffffffff;a.exports=function(a){return a<b?1:a<c?2:a<d?3:a<e?4:a<f?5:a<g?6:a<h?7:a<i?8:a<j?9:10}},82838:function(a,b,c){"use strict";let d=c(13924);a.exports=a=>{if(!(a instanceof Uint8Array))throw Error("arg needs to be a Uint8Array");let b=[];for(;a.length>0;){let c=d.decode(a);b.push(c),a=a.slice(d.decode.bytes)}return b}},26988:function(a){a.exports=d;var b=128,c=127;function d(a,e){var f,g=0,e=e||0,h=0,i=e,j=a.length;do{if(i>=j||h>49)throw d.bytes=0,RangeError("Could not decode varint");f=a[i++],g+=h<28?(f&c)<<h:(f&c)*Math.pow(2,h),h+=7}while(f>=b);return d.bytes=i-e,g}},1312:function(a){a.exports=e;var b=128,c=-128,d=2147483648;function e(a,f,g){if(Number.MAX_SAFE_INTEGER&&a>Number.MAX_SAFE_INTEGER)throw e.bytes=0,RangeError("Could not encode varint");f=f||[];for(var h=g=g||0;a>=d;)f[g++]=255&a|b,a/=128;for(;a&c;)f[g++]=255&a|b,a>>>=7;return f[g]=0|a,e.bytes=g-h+1,f}},94676:function(a,b,c){a.exports={encode:c(1312),decode:c(26988),encodingLength:c(10082)}},10082:function(a){var b=128,c=16384,d=2097152,e=268435456,f=34359738368,g=4398046511104,h=562949953421312,i=72057594037927940,j=0x7fffffffffffffff;a.exports=function(a){return a<b?1:a<c?2:a<d?3:a<e?4:a<f?5:a<g?6:a<h?7:a<i?8:a<j?9:10}},97916:function(a,b,c){"use strict";let d=c(59134),e="object"==typeof window&&"object"==typeof document&&9===document.nodeType,f=d(),g=e&&!f,h=f&&!e,i=f&&e,j=void 0!==globalThis.process&& void 0!==globalThis.process.release&&"node"===globalThis.process.release.name&&!f,k="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,l=void 0!==globalThis.process&& void 0!==globalThis.process.env&&"test"===globalThis.process.env.NODE_ENV,m="undefined"!=typeof navigator&&"ReactNative"===navigator.product;a.exports={isTest:l,isElectron:f,isElectronMain:h,isElectronRenderer:i,isNode:j,isBrowser:g,isWebWorker:k,isEnvWithDom:e,isReactNative:m}},47568:function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function e(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var g=a.apply(b,c);function h(a){d(g,e,f,h,i,"next",a)}function i(a){d(g,e,f,h,i,"throw",a)}h(void 0)})}}c.d(b,{Z:function(){return e}})},64936:function(a,b,c){"use strict";c.d(b,{Dy:function(){return f.D},Jx:function(){return e.Jx},WU:function(){return f.W},cv:function(){return d.cv}});var d=c(85989),e=c(61287),f=c(59787)},55580:function(a,b,c){"use strict";c.d(b,{Fh:function(){return o},Jl:function(){return i},Km:function(){return k},Tp:function(){return p},X0:function(){return h},YX:function(){return j},Zh:function(){return l},cs:function(){return m},kj:function(){return g},or:function(){return f},uN:function(){return n}});var d=c(59787),e=c(85590);let f=[24,256,65536,4294967296,BigInt("18446744073709551616")];function g(a,b,c){(0,e.DO)(a,b,1);let d=a[b];if(!0===c.strict&&d<f[0])throw Error(`${e.IR} integer encoded in more bytes than necessary (strict decode)`);return d}function h(a,b,c){(0,e.DO)(a,b,2);let d=a[b]<<8|a[b+1];if(!0===c.strict&&d<f[1])throw Error(`${e.IR} integer encoded in more bytes than necessary (strict decode)`);return d}function i(a,b,c){(0,e.DO)(a,b,4);let d=16777216*a[b]+(a[b+1]<<16)+(a[b+2]<<8)+a[b+3];if(!0===c.strict&&d<f[2])throw Error(`${e.IR} integer encoded in more bytes than necessary (strict decode)`);return d}function j(a,b,c){(0,e.DO)(a,b,8);let d=16777216*a[b]+(a[b+1]<<16)+(a[b+2]<<8)+a[b+3],g=16777216*a[b+4]+(a[b+5]<<16)+(a[b+6]<<8)+a[b+7],h=(BigInt(d)<<BigInt(32))+BigInt(g);if(!0===c.strict&&h<f[3])throw Error(`${e.IR} integer encoded in more bytes than necessary (strict decode)`);if(h<=Number.MAX_SAFE_INTEGER)return Number(h);if(!0===c.allowBigInt)return h;throw Error(`${e.IR} integers outside of the safe integer range are not supported`)}function k(a,b,c,e){return new d.W(d.D.uint,g(a,b+1,e),2)}function l(a,b,c,e){return new d.W(d.D.uint,h(a,b+1,e),3)}function m(a,b,c,e){return new d.W(d.D.uint,i(a,b+1,e),5)}function n(a,b,c,e){return new d.W(d.D.uint,j(a,b+1,e),9)}function o(a,b){return p(a,0,b.value)}function p(a,b,c){if(c<f[0]){let d=Number(c);a.push([b|d])}else if(c<f[1]){let g=Number(c);a.push([24|b,g])}else if(c<f[2]){let h=Number(c);a.push([25|b,h>>>8,255&h])}else if(c<f[3]){let i=Number(c);a.push([26|b,i>>>24&255,i>>>16&255,i>>>8&255,255&i])}else{let j=BigInt(c);if(j<f[4]){let k=[27|b,0,0,0,0,0,0,0],l=Number(j&BigInt(4294967295)),m=Number(j>>BigInt(32)&BigInt(4294967295));k[8]=255&l,l>>=8,k[7]=255&l,l>>=8,k[6]=255&l,l>>=8,k[5]=255&l,k[4]=255&m,m>>=8,k[3]=255&m,m>>=8,k[2]=255&m,m>>=8,k[1]=255&m,a.push(k)}else throw Error(`${e.IR} encountered BigInt larger than allowable range`)}}o.encodedSize=function(a){return p.encodedSize(a.value)},p.encodedSize=function(a){return a<f[0]?1:a<f[1]?2:a<f[2]?3:a<f[3]?5:9},o.compareTokens=function(a,b){return a.value<b.value?-1:a.value>b.value?1:0}},1618:function(a,b,c){"use strict";c.d(b,{UT:function(){return m},ec:function(){return l},r0:function(){return h},wy:function(){return i},yr:function(){return g}});var d=c(59787),e=c(55580),f=c(85590);function g(a,b,c,f){return new d.W(d.D.negint,-1-e.kj(a,b+1,f),2)}function h(a,b,c,f){return new d.W(d.D.negint,-1-e.X0(a,b+1,f),3)}function i(a,b,c,f){return new d.W(d.D.negint,-1-e.Jl(a,b+1,f),5)}let j=BigInt(-1),k=BigInt(1);function l(a,b,c,g){let h=e.YX(a,b+1,g);if("bigint"!=typeof h){let i=-1-h;if(i>=Number.MIN_SAFE_INTEGER)return new d.W(d.D.negint,i,9)}if(!0!==g.allowBigInt)throw Error(`${f.IR} integers outside of the safe integer range are not supported`);return new d.W(d.D.negint,j-BigInt(h),9)}function m(a,b){let c=b.value,d="bigint"==typeof c?c*j-k:-1*c-1;e.Tp(a,b.type.majorEncoded,d)}m.encodedSize=function(a){let b=a.value,c="bigint"==typeof b?b*j-k:-1*b-1;return c<e.or[0]?1:c<e.or[1]?2:c<e.or[2]?3:c<e.or[3]?5:9},m.compareTokens=function(a,b){return a.value<b.value?1:a.value>b.value?-1:0}},92887:function(a,b,c){"use strict";c.d(b,{BS:function(){return k},Ii:function(){return i},ME:function(){return m},UQ:function(){return j},hg:function(){return o},zU:function(){return l}});var d=c(59787),e=c(85590),f=c(55580),g=c(22042);function h(a,b,c,f){(0,e.DO)(a,b,c+f);let h=(0,g.tP)(a,b+c,b+c+f);return new d.W(d.D.bytes,h,c+f)}function i(a,b,c,d){return h(a,b,1,c)}function j(a,b,c,d){return h(a,b,2,f.kj(a,b+1,d))}function k(a,b,c,d){return h(a,b,3,f.X0(a,b+1,d))}function l(a,b,c,d){return h(a,b,5,f.Jl(a,b+1,d))}function m(a,b,c,d){let g=f.YX(a,b+1,d);if("bigint"==typeof g)throw Error(`${e.IR} 64-bit integer bytes lengths not supported`);return h(a,b,9,g)}function n(a){return void 0===a.encodedBytes&&(a.encodedBytes=a.type===d.D.string?(0,g.mL)(a.value):a.value),a.encodedBytes}function o(a,b){let c=n(b);f.Tp(a,b.type.majorEncoded,c.length),a.push(c)}function p(a,b){return a.length<b.length?-1:a.length>b.length?1:(0,g.qu)(a,b)}o.encodedSize=function(a){let b=n(a);return f.Tp.encodedSize(b.length)+b.length},o.compareTokens=function(a,b){return p(n(a),n(b))}},50768:function(a,b,c){"use strict";c.d(b,{Bq:function(){return k},YW:function(){return o},bc:function(){return n},h:function(){return l},nt:function(){return j},q0:function(){return m}});var d=c(59787),e=c(85590),f=c(55580),g=c(92887),h=c(22042);function i(a,b,c,f,g){let i=c+f;(0,e.DO)(a,b,i);let j=new d.W(d.D.string,(0,h.BB)(a,b+c,b+i),i);return!0===g.retainStringBytes&&(j.byteValue=(0,h.tP)(a,b+c,b+i)),j}function j(a,b,c,d){return i(a,b,1,c,d)}function k(a,b,c,d){return i(a,b,2,f.kj(a,b+1,d),d)}function l(a,b,c,d){return i(a,b,3,f.X0(a,b+1,d),d)}function m(a,b,c,d){return i(a,b,5,f.Jl(a,b+1,d),d)}function n(a,b,c,d){let g=f.YX(a,b+1,d);if("bigint"==typeof g)throw Error(`${e.IR} 64-bit integer string lengths not supported`);return i(a,b,9,g,d)}let o=g.hg},8278:function(a,b,c){"use strict";c.d(b,{HF:function(){return n},Ju:function(){return h},OC:function(){return j},a8:function(){return l},h7:function(){return i},lY:function(){return k},s5:function(){return m}});var d=c(59787),e=c(55580),f=c(85590);function g(a,b,c,e){return new d.W(d.D.array,e,c)}function h(a,b,c,d){return g(a,b,1,c)}function i(a,b,c,d){return g(a,b,2,e.kj(a,b+1,d))}function j(a,b,c,d){return g(a,b,3,e.X0(a,b+1,d))}function k(a,b,c,d){return g(a,b,5,e.Jl(a,b+1,d))}function l(a,b,c,d){let h=e.YX(a,b+1,d);if("bigint"==typeof h)throw Error(`${f.IR} 64-bit integer array lengths not supported`);return g(a,b,9,h)}function m(a,b,c,d){if(!1===d.allowIndefinite)throw Error(`${f.IR} indefinite length items not allowed`);return g(a,b,1,1/0)}function n(a,b){e.Tp(a,d.D.array.majorEncoded,b.value)}n.compareTokens=e.Fh.compareTokens,n.encodedSize=function(a){return e.Tp.encodedSize(a.value)}},59283:function(a,b,c){"use strict";c.d(b,{F2:function(){return l},G:function(){return i},IY:function(){return k},KI:function(){return n},"_K":function(){return h},ng:function(){return m},qe:function(){return j}});var d=c(59787),e=c(55580),f=c(85590);function g(a,b,c,e){return new d.W(d.D.map,e,c)}function h(a,b,c,d){return g(a,b,1,c)}function i(a,b,c,d){return g(a,b,2,e.kj(a,b+1,d))}function j(a,b,c,d){return g(a,b,3,e.X0(a,b+1,d))}function k(a,b,c,d){return g(a,b,5,e.Jl(a,b+1,d))}function l(a,b,c,d){let h=e.YX(a,b+1,d);if("bigint"==typeof h)throw Error(`${f.IR} 64-bit integer map lengths not supported`);return g(a,b,9,h)}function m(a,b,c,d){if(!1===d.allowIndefinite)throw Error(`${f.IR} indefinite length items not allowed`);return g(a,b,1,1/0)}function n(a,b){e.Tp(a,d.D.map.majorEncoded,b.value)}n.compareTokens=e.Fh.compareTokens,n.encodedSize=function(a){return e.Tp.encodedSize(a.value)}},82428:function(a,b,c){"use strict";c.d(b,{CF:function(){return h},MV:function(){return j},ZR:function(){return g},qJ:function(){return f},vP:function(){return i},xy:function(){return k}});var d=c(59787),e=c(55580);function f(a,b,c,e){return new d.W(d.D.tag,c,1)}function g(a,b,c,f){return new d.W(d.D.tag,e.kj(a,b+1,f),2)}function h(a,b,c,f){return new d.W(d.D.tag,e.X0(a,b+1,f),3)}function i(a,b,c,f){return new d.W(d.D.tag,e.Jl(a,b+1,f),5)}function j(a,b,c,f){return new d.W(d.D.tag,e.YX(a,b+1,f),9)}function k(a,b){e.Tp(a,d.D.tag.majorEncoded,b.value)}k.compareTokens=e.Fh.compareTokens,k.encodedSize=function(a){return e.Tp.encodedSize(a.value)}},73851:function(a,b,c){"use strict";c.d(b,{GI:function(){return o},h1:function(){return k},mW:function(){return n},tA:function(){return q},vV:function(){return p},y7:function(){return l}});var d=c(59787),e=c(85590),f=c(55580);let g=20,h=21,i=22,j=23;function k(a,b,c,f){if(!1===f.allowUndefined)throw Error(`${e.IR} undefined values are not supported`);return!0===f.coerceUndefinedToNull?new d.W(d.D.null,null,1):new d.W(d.D.undefined,void 0,1)}function l(a,b,c,f){if(!1===f.allowIndefinite)throw Error(`${e.IR} indefinite length items not allowed`);return new d.W(d.D.break,void 0,1)}function m(a,b,c){if(c){if(!1===c.allowNaN&&Number.isNaN(a))throw Error(`${e.IR} NaN values are not supported`);if(!1===c.allowInfinity&&(a===1/0||a=== -1/0))throw Error(`${e.IR} Infinity values are not supported`)}return new d.W(d.D.float,a,b)}function n(a,b,c,d){return m(v(a,b+1),3,d)}function o(a,b,c,d){return m(x(a,b+1),5,d)}function p(a,b,c,d){return m(z(a,b+1),9,d)}function q(a,b,c){let e=b.value;if(!1===e)a.push([d.D.float.majorEncoded|g]);else if(!0===e)a.push([d.D.float.majorEncoded|h]);else if(null===e)a.push([d.D.float.majorEncoded|i]);else if(void 0===e)a.push([d.D.float.majorEncoded|j]);else{let f,k=!1;c&& !0===c.float64||(u(e),f=v(t,1),e===f||Number.isNaN(e)?(t[0]=249,a.push(t.slice(0,3)),k=!0):(w(e),f=x(t,1),e!==f||(t[0]=250,a.push(t.slice(0,5)),k=!0))),k||(y(e),f=z(t,1),t[0]=251,a.push(t.slice(0,9)))}}q.encodedSize=function(a,b){let c=a.value;if(!1===c|| !0===c||null==c)return 1;if(!b|| !0!==b.float64){u(c);let d=v(t,1);if(c===d||Number.isNaN(c))return 3;if(w(c),d=x(t,1),c===d)return 5}return 9};let r=new ArrayBuffer(9),s=new DataView(r,1),t=new Uint8Array(r,0);function u(a){if(a===1/0)s.setUint16(0,31744,!1);else if(a=== -1/0)s.setUint16(0,64512,!1);else if(Number.isNaN(a))s.setUint16(0,32256,!1);else{s.setFloat32(0,a);let b=s.getUint32(0),c=(2139095040&b)>>23,d=8388607&b;if(255===c)s.setUint16(0,31744,!1);else if(0===c)s.setUint16(0,(2147483648&a)>>16|d>>13,!1);else{let e=c-127;e< -24?s.setUint16(0,0):e< -14?s.setUint16(0,(2147483648&b)>>16|1<<24+e,!1):s.setUint16(0,(2147483648&b)>>16|e+15<<10|d>>13,!1)}}}function v(a,b){if(a.length-b<2)throw Error(`${e.IR} not enough data for float16`);let c=(a[b]<<8)+a[b+1];if(31744===c)return 1/0;if(64512===c)return-1/0;if(32256===c)return NaN;let d=c>>10&31,f=1023&c,g;return g=0===d?5960464477539063e-23*f:31!==d?(f+1024)*2**(d-25):0===f?1/0:NaN,32768&c?-g:g}function w(a){s.setFloat32(0,a,!1)}function x(a,b){if(a.length-b<4)throw Error(`${e.IR} not enough data for float32`);let c=(a.byteOffset||0)+b;return new DataView(a.buffer,c,4).getFloat32(0,!1)}function y(a){s.setFloat64(0,a,!1)}function z(a,b){if(a.length-b<8)throw Error(`${e.IR} not enough data for float64`);let c=(a.byteOffset||0)+b;return new DataView(a.buffer,c,8).getFloat64(0,!1)}q.compareTokens=f.Fh.compareTokens},22042:function(a,b,c){"use strict";c.d(b,{BB:function(){return i},Dz:function(){return h},Pu:function(){return s},mL:function(){return j},nI:function(){return k},qu:function(){return o},tP:function(){return l},un:function(){return n},zo:function(){return m}});let d=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,e=new TextDecoder,f=new TextEncoder;function g(a){return d&&globalThis.Buffer.isBuffer(a)}function h(a){return a instanceof Uint8Array?g(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a:Uint8Array.from(a)}let i=d?(a,b,c)=>c-b>64?globalThis.Buffer.from(a.subarray(b,c)).toString("utf8"):q(a,b,c):(a,b,c)=>c-b>64?e.decode(a.subarray(b,c)):q(a,b,c),j=d?a=>a.length>64?globalThis.Buffer.from(a):p(a):a=>a.length>64?f.encode(a):p(a),k=a=>Uint8Array.from(a),l=d?(a,b,c)=>g(a)?new Uint8Array(a.subarray(b,c)):a.slice(b,c):(a,b,c)=>a.slice(b,c),m=d?(a,b)=>(a=a.map(a=>a instanceof Uint8Array?a:globalThis.Buffer.from(a)),h(globalThis.Buffer.concat(a,b))):(a,b)=>{let c=new Uint8Array(b),d=0;for(let e of a)d+e.length>c.length&&(e=e.subarray(0,c.length-d)),c.set(e,d),d+=e.length;return c},n=d?a=>globalThis.Buffer.allocUnsafe(a):a=>new Uint8Array(a);function o(a,b){if(g(a)&&g(b))return a.compare(b);for(let c=0;c<a.length;c++)if(a[c]!==b[c])return a[c]<b[c]?-1:1;return 0}function p(a,b=1/0){let c,d=a.length,e=null,f=[];for(let g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319||g+1===d){(b-=3)> -1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)> -1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)> -1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else if(c<1114112){if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}else throw Error("Invalid code point")}return f}function q(a,b,c){let d=[];for(;b<c;){let e=a[b],f=null,g=e>239?4:e>223?3:e>191?2:1;if(b+g<=c){let h,i,j,k;switch(g){case 1:e<128&&(f=e);break;case 2:(192&(h=a[b+1]))==128&&(k=(31&e)<<6|63&h)>127&&(f=k);break;case 3:h=a[b+1],i=a[b+2],(192&h)==128&&(192&i)==128&&(k=(15&e)<<12|(63&h)<<6|63&i)>2047&&(k<55296||k>57343)&&(f=k);break;case 4:h=a[b+1],i=a[b+2],j=a[b+3],(192&h)==128&&(192&i)==128&&(192&j)==128&&(k=(15&e)<<18|(63&h)<<12|(63&i)<<6|63&j)>65535&&k<1114112&&(f=k)}}null===f?(f=65533,g=1):f>65535&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|1023&f),d.push(f),b+=g}return s(d)}let r=4096;function s(a){let b=a.length;if(b<=r)return String.fromCharCode.apply(String,a);let c="",d=0;for(;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=r));return c}},85590:function(a,b,c){"use strict";c.d(b,{DO:function(){return g},IR:function(){return d},OO:function(){return e}});let d="CBOR decode error:",e="CBOR encode error:",f=[];function g(a,b,c){if(a.length-b<c)throw Error(`${d} not enough data for type`)}f[23]=1,f[24]=2,f[25]=3,f[26]=5,f[27]=9},61287:function(a,b,c){"use strict";c.d(b,{Jx:function(){return n}});var d=c(85590),e=c(59787),f=c(53741);let g={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class h{constructor(a,b={}){this.pos=0,this.data=a,this.options=b}done(){return this.pos>=this.data.length}next(){let a=this.data[this.pos],b=f.PS[a];if(void 0===b){let c=f.cW[a];if(!c)throw Error(`${d.IR} no decoder for major type ${a>>>5} (byte 0x${a.toString(16).padStart(2,"0")})`);let e=31&a;b=c(this.data,this.pos,e,this.options)}return this.pos+=b.encodedLength,b}}let i=Symbol.for("DONE"),j=Symbol.for("BREAK");function k(a,b,c){let e=[];for(let f=0;f<a.value;f++){let g=m(b,c);if(g===j){if(a.value===1/0)break;throw Error(`${d.IR} got unexpected break to lengthed array`)}if(g===i)throw Error(`${d.IR} found array but not enough entries (got ${f}, expected ${a.value})`);e[f]=g}return e}function l(a,b,c){let e=!0===c.useMaps,f=e?void 0:{},g=e?new Map:void 0;for(let h=0;h<a.value;h++){let k=m(b,c);if(k===j){if(a.value===1/0)break;throw Error(`${d.IR} got unexpected break to lengthed map`)}if(k===i)throw Error(`${d.IR} found map but not enough entries (got ${h} [no key], expected ${a.value})`);if(!0!==e&&"string"!=typeof k)throw Error(`${d.IR} non-string keys not supported (got ${typeof k})`);let l=m(b,c);if(l===i)throw Error(`${d.IR} found map but not enough entries (got ${h} [no value], expected ${a.value})`);e?g.set(k,l):f[k]=l}return e?g:f}function m(a,b){if(a.done())return i;let c=a.next();if(c.type===e.D.break)return j;if(c.type.terminal)return c.value;if(c.type===e.D.array)return k(c,a,b);if(c.type===e.D.map)return l(c,a,b);if(c.type===e.D.tag){if(b.tags&&"function"==typeof b.tags[c.value]){let f=m(a,b);return b.tags[c.value](f)}throw Error(`${d.IR} tag not supported (${c.value})`)}throw Error("unsupported")}function n(a,b){if(!(a instanceof Uint8Array))throw Error(`${d.IR} data to decode must be a Uint8Array`);b=Object.assign({},g,b);let c=b.tokenizer||new h(a,b),e=m(c,b);if(e===i)throw Error(`${d.IR} did not find any content to decode`);if(e===j)throw Error(`${d.IR} got unexpected break`);if(!c.done())throw Error(`${d.IR} too many terminals, data makes no sense`);return e}},85989:function(a,b,c){"use strict";c.d(b,{cv:function(){return J},"w$":function(){return I}});let d=["string","number","bigint","symbol"],e=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function f(a){if(null===a)return"null";if(void 0===a)return"undefined";if(!0===a|| !1===a)return"boolean";let b=typeof a;if(d.includes(b))return b;if("function"===b)return"Function";if(Array.isArray(a))return"Array";if(g(a))return"Buffer";let c=h(a);return c||"Object"}function g(a){return a&&a.constructor&&a.constructor.isBuffer&&a.constructor.isBuffer.call(null,a)}function h(a){let b=Object.prototype.toString.call(a).slice(8,-1);if(e.includes(b))return b}var i=c(59787),j=c(22042);let k=256;class l{constructor(a=k){this.chunkSize=a,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(a){let b=this.chunks[this.chunks.length-1],c=this.cursor+a.length;if(c<=this.maxCursor+1){let d=b.length-(this.maxCursor-this.cursor)-1;b.set(a,d)}else{if(b){let e=b.length-(this.maxCursor-this.cursor)-1;e<b.length&&(this.chunks[this.chunks.length-1]=b.subarray(0,e),this.maxCursor=this.cursor-1)}a.length<64&&a.length<this.chunkSize?(b=(0,j.un)(this.chunkSize),this.chunks.push(b),this.maxCursor+=b.length,null===this._initReuseChunk&&(this._initReuseChunk=b),b.set(a,0)):(this.chunks.push(a),this.maxCursor+=a.length)}this.cursor+=a.length}toBytes(a=!1){let b;if(1===this.chunks.length){let c=this.chunks[0];a&&this.cursor>c.length/2?(b=this.cursor===c.length?c:c.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):b=(0,j.tP)(c,0,this.cursor)}else b=(0,j.zo)(this.chunks,this.cursor);return a&&this.reset(),b}}var m=c(85590),n=c(53741),o=c(55580),p=c(1618),q=c(92887),r=c(50768),s=c(8278),t=c(59283),u=c(82428),v=c(73851);let w={float64:!1,mapSorter:G,quickEncodeToken:n.JN};function x(){let a=[];return a[i.D.uint.major]=o.Fh,a[i.D.negint.major]=p.UT,a[i.D.bytes.major]=q.hg,a[i.D.string.major]=r.YW,a[i.D.array.major]=s.HF,a[i.D.map.major]=t.KI,a[i.D.tag.major]=u.xy,a[i.D.float.major]=v.tA,a}let y=x(),z=new l;class A{constructor(a,b){this.obj=a,this.parent=b}includes(a){let b=this;do if(b.obj===a)return!0;while(b=b.parent);return!1}static createCheck(a,b){if(a&&a.includes(b))throw Error(`${m.OO} object contains circular references`);return new A(b,a)}}let B={null:new i.W(i.D.null,null),undefined:new i.W(i.D.undefined,void 0),true:new i.W(i.D.true,!0),false:new i.W(i.D.false,!1),emptyArray:new i.W(i.D.array,0),emptyMap:new i.W(i.D.map,0)},C={number(a,b,c,d){return Number.isInteger(a)&&Number.isSafeInteger(a)?a>=0?new i.W(i.D.uint,a):new i.W(i.D.negint,a):new i.W(i.D.float,a)},bigint(a,b,c,d){return a>=BigInt(0)?new i.W(i.D.uint,a):new i.W(i.D.negint,a)},Uint8Array(a,b,c,d){return new i.W(i.D.bytes,a)},string(a,b,c,d){return new i.W(i.D.string,a)},boolean(a,b,c,d){return a?B.true:B.false},null(a,b,c,d){return B.null},undefined(a,b,c,d){return B.undefined},ArrayBuffer(a,b,c,d){return new i.W(i.D.bytes,new Uint8Array(a))},DataView(a,b,c,d){return new i.W(i.D.bytes,new Uint8Array(a.buffer,a.byteOffset,a.byteLength))},Array(a,b,c,d){if(!a.length)return!0===c.addBreakTokens?[B.emptyArray,new i.W(i.D.break)]:B.emptyArray;d=A.createCheck(d,a);let e=[],f=0;for(let g of a)e[f++]=E(g,c,d);return c.addBreakTokens?[new i.W(i.D.array,a.length),e,new i.W(i.D.break)]:[new i.W(i.D.array,a.length),e]},Object(a,b,c,d){let e="Object"!==b,f=e?a.keys():Object.keys(a),g=e?a.size:f.length;if(!g)return!0===c.addBreakTokens?[B.emptyMap,new i.W(i.D.break)]:B.emptyMap;d=A.createCheck(d,a);let h=[],j=0;for(let k of f)h[j++]=[E(k,c,d),E(e?a.get(k):a[k],c,d)];return(F(h,c),c.addBreakTokens)?[new i.W(i.D.map,g),h,new i.W(i.D.break)]:[new i.W(i.D.map,g),h]}};for(let D of(C.Map=C.Object,C.Buffer=C.Uint8Array,"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" ")))C[`${D}Array`]=C.DataView;function E(a,b={},c){let d=f(a),e=b&&b.typeEncoders&&b.typeEncoders[d]||C[d];if("function"==typeof e){let g=e(a,d,b,c);if(null!=g)return g}let h=C[d];if(!h)throw Error(`${m.OO} unsupported type: ${d}`);return h(a,d,b,c)}function F(a,b){b.mapSorter&&a.sort(b.mapSorter)}function G(a,b){let c=Array.isArray(a[0])?a[0][0]:a[0],d=Array.isArray(b[0])?b[0][0]:b[0];if(c.type!==d.type)return c.type.compare(d.type);let e=c.type.major,f=y[e].compareTokens(c,d);return 0===f&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),f}function H(a,b,c,d){if(Array.isArray(b))for(let e of b)H(a,e,c,d);else c[b.type.major](a,b,d)}function I(a,b,c){let d=E(a,c);if(!Array.isArray(d)&&c.quickEncodeToken){let e=c.quickEncodeToken(d);if(e)return e;let f=b[d.type.major];if(f.encodedSize){let g=f.encodedSize(d,c),h=new l(g);if(f(h,d,c),1!==h.chunks.length)throw Error(`Unexpected error: pre-calculated length for ${d} was wrong`);return(0,j.Dz)(h.chunks[0])}}return z.reset(),H(z,d,b,c),z.toBytes(!0)}function J(a,b){return b=Object.assign({},w,b),I(a,y,b)}},53741:function(a,b,c){"use strict";c.d(b,{JN:function(){return C},PS:function(){return z},cW:function(){return q}});var d=c(59787),e=c(55580),f=c(1618),g=c(92887),h=c(50768),i=c(8278),j=c(59283),k=c(82428),l=c(73851),m=c(85590),n=c(22042);function o(a,b,c){throw Error(`${m.IR} encountered invalid minor (${c}) for major ${a[b]>>>5}`)}function p(a){return()=>{throw Error(`${m.IR} ${a}`)}}let q=[];for(let r=0;r<=23;r++)q[r]=o;q[24]=e.Km,q[25]=e.Zh,q[26]=e.cs,q[27]=e.uN,q[28]=o,q[29]=o,q[30]=o,q[31]=o;for(let s=32;s<=55;s++)q[s]=o;q[56]=f.yr,q[57]=f.r0,q[58]=f.wy,q[59]=f.ec,q[60]=o,q[61]=o,q[62]=o,q[63]=o;for(let t=64;t<=87;t++)q[t]=g.Ii;q[88]=g.UQ,q[89]=g.BS,q[90]=g.zU,q[91]=g.ME,q[92]=o,q[93]=o,q[94]=o,q[95]=p("indefinite length bytes/strings are not supported");for(let u=96;u<=119;u++)q[u]=h.nt;q[120]=h.Bq,q[121]=h.h,q[122]=h.q0,q[123]=h.bc,q[124]=o,q[125]=o,q[126]=o,q[127]=p("indefinite length bytes/strings are not supported");for(let v=128;v<=151;v++)q[v]=i.Ju;q[152]=i.h7,q[153]=i.OC,q[154]=i.lY,q[155]=i.a8,q[156]=o,q[157]=o,q[158]=o,q[159]=i.s5;for(let w=160;w<=183;w++)q[w]=j._K;q[184]=j.G,q[185]=j.qe,q[186]=j.IY,q[187]=j.F2,q[188]=o,q[189]=o,q[190]=o,q[191]=j.ng;for(let x=192;x<=215;x++)q[x]=k.qJ;q[216]=k.ZR,q[217]=k.CF,q[218]=k.vP,q[219]=k.MV,q[220]=o,q[221]=o,q[222]=o,q[223]=o;for(let y=224;y<=243;y++)q[y]=p("simple values are not supported");q[244]=o,q[245]=o,q[246]=o,q[247]=l.h1,q[248]=p("simple values are not supported"),q[249]=l.mW,q[250]=l.GI,q[251]=l.vV,q[252]=o,q[253]=o,q[254]=o,q[255]=l.y7;let z=[];for(let A=0;A<24;A++)z[A]=new d.W(d.D.uint,A,1);for(let B=-1;B>= -24;B--)z[31-B]=new d.W(d.D.negint,B,1);function C(a){switch(a.type){case d.D.false:return(0,n.nI)([244]);case d.D.true:return(0,n.nI)([245]);case d.D.null:return(0,n.nI)([246]);case d.D.bytes:if(!a.value.length)return(0,n.nI)([64]);return;case d.D.string:if(""===a.value)return(0,n.nI)([96]);return;case d.D.array:if(0===a.value)return(0,n.nI)([128]);return;case d.D.map:if(0===a.value)return(0,n.nI)([160]);return;case d.D.uint:if(a.value<24)return(0,n.nI)([Number(a.value)]);return;case d.D.negint:if(a.value>= -24)return(0,n.nI)([31-Number(a.value)])}}z[64]=new d.W(d.D.bytes,new Uint8Array(0),1),z[96]=new d.W(d.D.string,"",1),z[128]=new d.W(d.D.array,0,1),z[160]=new d.W(d.D.map,0,1),z[244]=new d.W(d.D.false,!1,1),z[245]=new d.W(d.D.true,!0,1),z[246]=new d.W(d.D.null,null,1)},59787:function(a,b,c){"use strict";c.d(b,{D:function(){return d},W:function(){return e}});class d{constructor(a,b,c){this.major=a,this.majorEncoded=a<<5,this.name=b,this.terminal=c}toString(){return`Type[${this.major}].${this.name}`}compare(a){return this.major<a.major?-1:this.major>a.major?1:0}}d.uint=new d(0,"uint",!0),d.negint=new d(1,"negint",!0),d.bytes=new d(2,"bytes",!0),d.string=new d(3,"string",!0),d.array=new d(4,"array",!1),d.map=new d(5,"map",!1),d.tag=new d(6,"tag",!1),d.float=new d(7,"float",!0),d.false=new d(7,"false",!0),d.true=new d(7,"true",!0),d.null=new d(7,"null",!0),d.undefined=new d(7,"undefined",!0),d.break=new d(7,"break",!0);class e{constructor(a,b,c){this.type=a,this.value=b,this.encodedLength=c,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}},37548:function(a,b,c){"use strict";c.r(b),c.d(b,{code:function(){return n},decode:function(){return p},encode:function(){return o},name:function(){return m}});var d=c(64936),e=c(81362);let f=42;function g(a){if(a.asCID!==a)return null;let b=e.CID.asCID(a);if(!b)return null;let c=new Uint8Array(b.bytes.byteLength+1);return c.set(b.bytes,1),[new d.WU(d.Dy.tag,f),new d.WU(d.Dy.bytes,c)]}function h(){throw Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function i(a){if(Number.isNaN(a))throw Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(a===1/0||a=== -1/0)throw Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}let j={float64:!0,typeEncoders:{Object:g,undefined:h,number:i}};function k(a){if(0!==a[0])throw Error("Invalid CID for CBOR tag 42; expected leading 0x00");return e.CID.decode(a.subarray(1))}let l={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};l.tags[f]=k;let m="dag-cbor",n=113,o=a=>d.cv(a,j),p=a=>d.Jx(a,l)},20362:function(a,b,c){"use strict";c.d(b,{Ue:function(){return Np}});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ={};c.r(aQ),c.d(aQ,{code:function(){return bP},createLink:function(){return bN},createNode:function(){return bM},decode:function(){return bR},encode:function(){return bQ},name:function(){return bO},prepare:function(){return bK},validate:function(){return bL}});var aR={};c.r(aR),c.d(aR,{code:function(){return b_},decode:function(){return b1},encode:function(){return b0},name:function(){return b$}});var aS={};c.r(aS),c.d(aS,{code:function(){return cm},decode:function(){return co},encode:function(){return cn},name:function(){return cl}});var aT={};c.r(aT),c.d(aT,{RsaPrivateKey:function(){return f0},RsaPublicKey:function(){return f_},fromJwk:function(){return f3},generateKeyPair:function(){return f4},unmarshalRsaPrivateKey:function(){return f1},unmarshalRsaPublicKey:function(){return f2}});var aU={};c.r(aU),c.d(aU,{Ed25519PrivateKey:function(){return hc},Ed25519PublicKey:function(){return hb},generateKeyPair:function(){return hf},generateKeyPairFromSeed:function(){return hg},unmarshalEd25519PrivateKey:function(){return hd},unmarshalEd25519PublicKey:function(){return he}});var aV={};c.r(aV),c.d(aV,{Secp256k1PrivateKey:function(){return iy},Secp256k1PublicKey:function(){return ix},generateKeyPair:function(){return iB},unmarshalSecp256k1PrivateKey:function(){return iz},unmarshalSecp256k1PublicKey:function(){return iA}});var aW={};c.r(aW),c.d(aW,{InvalidValueError:function(){return t7},MissingRepoOptionsError:function(){return t8},NonReversibleMigrationError:function(){return t4},NotInitializedRepoError:function(){return t5},RequiredParameterError:function(){return t6}});var aX={};c.r(aX),c.d(aX,{Decoder:function(){return CE},Encoder:function(){return CD},PacketType:function(){return av},protocol:function(){return CC}});var aY={};c.r(aY),c.d(aY,{RsaPrivateKey:function(){return HP},RsaPublicKey:function(){return HO},fromJwk:function(){return HS},generateKeyPair:function(){return HT},unmarshalRsaPrivateKey:function(){return HQ},unmarshalRsaPublicKey:function(){return HR}});var aZ={};c.r(aZ),c.d(aZ,{Ed25519PrivateKey:function(){return H1},Ed25519PublicKey:function(){return H0},generateKeyPair:function(){return H4},generateKeyPairFromSeed:function(){return H5},unmarshalEd25519PrivateKey:function(){return H2},unmarshalEd25519PublicKey:function(){return H3}});var a$={};c.r(a$),c.d(a$,{Secp256k1PrivateKey:function(){return If},Secp256k1PublicKey:function(){return Ie},generateKeyPair:function(){return Ii},unmarshalSecp256k1PrivateKey:function(){return Ig},unmarshalSecp256k1PublicKey:function(){return Ih}});var a_={};c.r(a_),c.d(a_,{abortedError:function(){return M0},notFoundError:function(){return M_}});var a0=c(70942),a1=c(106),a2=c(11227),a3=c(99086),a4=c(22817),a5=c(9885);function a6(a){return Object.assign(a2(a),{error:a2(`${a}:error`),trace:a2(`${a}:trace`)})}a2.formatters.b=a=>null==a?"undefined":a3.base58btc.baseEncode(a),a2.formatters.t=a=>null==a?"undefined":a4.base32.baseEncode(a),a2.formatters.m=a=>null==a?"undefined":a5.base64.baseEncode(a),a2.formatters.p=a=>null==a?"undefined":a.toString(),a2.formatters.c=a=>null==a?"undefined":a.toString(),a2.formatters.k=a=>null==a?"undefined":a.toString();var a7=c(32114),a8=c(62100);let a9=a8.Reader,ba=a8.Writer,bb=a8.util,bc=a8.roots["ipfs-unixfs"]||(a8.roots["ipfs-unixfs"]={}),bd=bc.Data=(()=>{function a(a){if(this.blocksizes=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.Type=0,a.prototype.Data=bb.newBuffer([]),a.prototype.filesize=bb.Long?bb.Long.fromBits(0,0,!0):0,a.prototype.blocksizes=bb.emptyArray,a.prototype.hashType=bb.Long?bb.Long.fromBits(0,0,!0):0,a.prototype.fanout=bb.Long?bb.Long.fromBits(0,0,!0):0,a.prototype.mode=0,a.prototype.mtime=null,a.encode=function(a,b){if(b||(b=ba.create()),b.uint32(8).int32(a.Type),null!=a.Data&&Object.hasOwnProperty.call(a,"Data")&&b.uint32(18).bytes(a.Data),null!=a.filesize&&Object.hasOwnProperty.call(a,"filesize")&&b.uint32(24).uint64(a.filesize),null!=a.blocksizes&&a.blocksizes.length)for(var c=0;c<a.blocksizes.length;++c)b.uint32(32).uint64(a.blocksizes[c]);return null!=a.hashType&&Object.hasOwnProperty.call(a,"hashType")&&b.uint32(40).uint64(a.hashType),null!=a.fanout&&Object.hasOwnProperty.call(a,"fanout")&&b.uint32(48).uint64(a.fanout),null!=a.mode&&Object.hasOwnProperty.call(a,"mode")&&b.uint32(56).uint32(a.mode),null!=a.mtime&&Object.hasOwnProperty.call(a,"mtime")&&bc.UnixTime.encode(a.mtime,b.uint32(66).fork()).ldelim(),b},a.decode=function(a,b){a instanceof a9||(a=a9.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new bc.Data;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.Type=a.int32();break;case 2:d.Data=a.bytes();break;case 3:d.filesize=a.uint64();break;case 4:if(d.blocksizes&&d.blocksizes.length||(d.blocksizes=[]),(7&e)==2)for(var f=a.uint32()+a.pos;a.pos<f;)d.blocksizes.push(a.uint64());else d.blocksizes.push(a.uint64());break;case 5:d.hashType=a.uint64();break;case 6:d.fanout=a.uint64();break;case 7:d.mode=a.uint32();break;case 8:d.mtime=bc.UnixTime.decode(a,a.uint32());break;default:a.skipType(7&e)}}if(!d.hasOwnProperty("Type"))throw bb.ProtocolError("missing required 'Type'",{instance:d});return d},a.fromObject=function(a){if(a instanceof bc.Data)return a;var b=new bc.Data;switch(a.Type){case"Raw":case 0:b.Type=0;break;case"Directory":case 1:b.Type=1;break;case"File":case 2:b.Type=2;break;case"Metadata":case 3:b.Type=3;break;case"Symlink":case 4:b.Type=4;break;case"HAMTShard":case 5:b.Type=5}if(null!=a.Data&&("string"==typeof a.Data?bb.base64.decode(a.Data,b.Data=bb.newBuffer(bb.base64.length(a.Data)),0):a.Data.length&&(b.Data=a.Data)),null!=a.filesize&&(bb.Long?(b.filesize=bb.Long.fromValue(a.filesize)).unsigned=!0:"string"==typeof a.filesize?b.filesize=parseInt(a.filesize,10):"number"==typeof a.filesize?b.filesize=a.filesize:"object"==typeof a.filesize&&(b.filesize=new bb.LongBits(a.filesize.low>>>0,a.filesize.high>>>0).toNumber(!0))),a.blocksizes){if(!Array.isArray(a.blocksizes))throw TypeError(".Data.blocksizes: array expected");b.blocksizes=[];for(var c=0;c<a.blocksizes.length;++c)bb.Long?(b.blocksizes[c]=bb.Long.fromValue(a.blocksizes[c])).unsigned=!0:"string"==typeof a.blocksizes[c]?b.blocksizes[c]=parseInt(a.blocksizes[c],10):"number"==typeof a.blocksizes[c]?b.blocksizes[c]=a.blocksizes[c]:"object"==typeof a.blocksizes[c]&&(b.blocksizes[c]=new bb.LongBits(a.blocksizes[c].low>>>0,a.blocksizes[c].high>>>0).toNumber(!0))}if(null!=a.hashType&&(bb.Long?(b.hashType=bb.Long.fromValue(a.hashType)).unsigned=!0:"string"==typeof a.hashType?b.hashType=parseInt(a.hashType,10):"number"==typeof a.hashType?b.hashType=a.hashType:"object"==typeof a.hashType&&(b.hashType=new bb.LongBits(a.hashType.low>>>0,a.hashType.high>>>0).toNumber(!0))),null!=a.fanout&&(bb.Long?(b.fanout=bb.Long.fromValue(a.fanout)).unsigned=!0:"string"==typeof a.fanout?b.fanout=parseInt(a.fanout,10):"number"==typeof a.fanout?b.fanout=a.fanout:"object"==typeof a.fanout&&(b.fanout=new bb.LongBits(a.fanout.low>>>0,a.fanout.high>>>0).toNumber(!0))),null!=a.mode&&(b.mode=a.mode>>>0),null!=a.mtime){if("object"!=typeof a.mtime)throw TypeError(".Data.mtime: object expected");b.mtime=bc.UnixTime.fromObject(a.mtime)}return b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.blocksizes=[]),b.defaults){if(c.Type=b.enums===String?"Raw":0,b.bytes===String?c.Data="":(c.Data=[],b.bytes!==Array&&(c.Data=bb.newBuffer(c.Data))),bb.Long){var d=new bb.Long(0,0,!0);c.filesize=b.longs===String?d.toString():b.longs===Number?d.toNumber():d}else c.filesize=b.longs===String?"0":0;if(bb.Long){var d=new bb.Long(0,0,!0);c.hashType=b.longs===String?d.toString():b.longs===Number?d.toNumber():d}else c.hashType=b.longs===String?"0":0;if(bb.Long){var d=new bb.Long(0,0,!0);c.fanout=b.longs===String?d.toString():b.longs===Number?d.toNumber():d}else c.fanout=b.longs===String?"0":0;c.mode=0,c.mtime=null}if(null!=a.Type&&a.hasOwnProperty("Type")&&(c.Type=b.enums===String?bc.Data.DataType[a.Type]:a.Type),null!=a.Data&&a.hasOwnProperty("Data")&&(c.Data=b.bytes===String?bb.base64.encode(a.Data,0,a.Data.length):b.bytes===Array?Array.prototype.slice.call(a.Data):a.Data),null!=a.filesize&&a.hasOwnProperty("filesize")&&("number"==typeof a.filesize?c.filesize=b.longs===String?String(a.filesize):a.filesize:c.filesize=b.longs===String?bb.Long.prototype.toString.call(a.filesize):b.longs===Number?new bb.LongBits(a.filesize.low>>>0,a.filesize.high>>>0).toNumber(!0):a.filesize),a.blocksizes&&a.blocksizes.length){c.blocksizes=[];for(var e=0;e<a.blocksizes.length;++e)"number"==typeof a.blocksizes[e]?c.blocksizes[e]=b.longs===String?String(a.blocksizes[e]):a.blocksizes[e]:c.blocksizes[e]=b.longs===String?bb.Long.prototype.toString.call(a.blocksizes[e]):b.longs===Number?new bb.LongBits(a.blocksizes[e].low>>>0,a.blocksizes[e].high>>>0).toNumber(!0):a.blocksizes[e]}return null!=a.hashType&&a.hasOwnProperty("hashType")&&("number"==typeof a.hashType?c.hashType=b.longs===String?String(a.hashType):a.hashType:c.hashType=b.longs===String?bb.Long.prototype.toString.call(a.hashType):b.longs===Number?new bb.LongBits(a.hashType.low>>>0,a.hashType.high>>>0).toNumber(!0):a.hashType),null!=a.fanout&&a.hasOwnProperty("fanout")&&("number"==typeof a.fanout?c.fanout=b.longs===String?String(a.fanout):a.fanout:c.fanout=b.longs===String?bb.Long.prototype.toString.call(a.fanout):b.longs===Number?new bb.LongBits(a.fanout.low>>>0,a.fanout.high>>>0).toNumber(!0):a.fanout),null!=a.mode&&a.hasOwnProperty("mode")&&(c.mode=a.mode),null!=a.mtime&&a.hasOwnProperty("mtime")&&(c.mtime=bc.UnixTime.toObject(a.mtime,b)),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a.DataType=function(){let a={},b=Object.create(a);return b[a[0]="Raw"]=0,b[a[1]="Directory"]=1,b[a[2]="File"]=2,b[a[3]="Metadata"]=3,b[a[4]="Symlink"]=4,b[a[5]="HAMTShard"]=5,b}(),a})();bc.UnixTime=(()=>{function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.Seconds=bb.Long?bb.Long.fromBits(0,0,!1):0,a.prototype.FractionalNanoseconds=0,a.encode=function(a,b){return b||(b=ba.create()),b.uint32(8).int64(a.Seconds),null!=a.FractionalNanoseconds&&Object.hasOwnProperty.call(a,"FractionalNanoseconds")&&b.uint32(21).fixed32(a.FractionalNanoseconds),b},a.decode=function(a,b){a instanceof a9||(a=a9.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new bc.UnixTime;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.Seconds=a.int64();break;case 2:d.FractionalNanoseconds=a.fixed32();break;default:a.skipType(7&e)}}if(!d.hasOwnProperty("Seconds"))throw bb.ProtocolError("missing required 'Seconds'",{instance:d});return d},a.fromObject=function(a){if(a instanceof bc.UnixTime)return a;var b=new bc.UnixTime;return null!=a.Seconds&&(bb.Long?(b.Seconds=bb.Long.fromValue(a.Seconds)).unsigned=!1:"string"==typeof a.Seconds?b.Seconds=parseInt(a.Seconds,10):"number"==typeof a.Seconds?b.Seconds=a.Seconds:"object"==typeof a.Seconds&&(b.Seconds=new bb.LongBits(a.Seconds.low>>>0,a.Seconds.high>>>0).toNumber())),null!=a.FractionalNanoseconds&&(b.FractionalNanoseconds=a.FractionalNanoseconds>>>0),b},a.toObject=function(a,b){b||(b={});var c={};if(b.defaults){if(bb.Long){var d=new bb.Long(0,0,!1);c.Seconds=b.longs===String?d.toString():b.longs===Number?d.toNumber():d}else c.Seconds=b.longs===String?"0":0;c.FractionalNanoseconds=0}return null!=a.Seconds&&a.hasOwnProperty("Seconds")&&("number"==typeof a.Seconds?c.Seconds=b.longs===String?String(a.Seconds):a.Seconds:c.Seconds=b.longs===String?bb.Long.prototype.toString.call(a.Seconds):b.longs===Number?new bb.LongBits(a.Seconds.low>>>0,a.Seconds.high>>>0).toNumber():a.Seconds),null!=a.FractionalNanoseconds&&a.hasOwnProperty("FractionalNanoseconds")&&(c.FractionalNanoseconds=a.FractionalNanoseconds),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})(),bc.Metadata=(()=>{function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.MimeType="",a.encode=function(a,b){return b||(b=ba.create()),null!=a.MimeType&&Object.hasOwnProperty.call(a,"MimeType")&&b.uint32(10).string(a.MimeType),b},a.decode=function(a,b){a instanceof a9||(a=a9.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new bc.Metadata;a.pos<c;){var e=a.uint32();e>>>3==1?d.MimeType=a.string():a.skipType(7&e)}return d},a.fromObject=function(a){if(a instanceof bc.Metadata)return a;var b=new bc.Metadata;return null!=a.MimeType&&(b.MimeType=String(a.MimeType)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(c.MimeType=""),null!=a.MimeType&&a.hasOwnProperty("MimeType")&&(c.MimeType=a.MimeType),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})();let be=bd,bf=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],bg=["directory","hamt-sharded-directory"],bh=parseInt("0644",8),bi=parseInt("0755",8);function bj(a){return null==a?void 0:"number"==typeof a?4095&a:"0"===(a=a.toString()).substring(0,1)?4095&parseInt(a,8):4095&parseInt(a,10)}function bk(a){if(null==a)return;let b;if(null!=a.secs&&(b={secs:a.secs,nsecs:a.nsecs}),null!=a.Seconds&&(b={secs:a.Seconds,nsecs:a.FractionalNanoseconds}),Array.isArray(a)&&(b={secs:a[0],nsecs:a[1]}),a instanceof Date){let c=a.getTime(),d=Math.floor(c/1e3);b={secs:d,nsecs:(c-1e3*d)*1e3}}if(Object.prototype.hasOwnProperty.call(b,"secs")){if(null!=b&&null!=b.nsecs&&(b.nsecs<0||b.nsecs>999999999))throw a7(Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return b}}class bl{static unmarshal(a){let b=be.decode(a),c=be.toObject(b,{defaults:!1,arrays:!0,longs:Number,objects:!1}),d=new bl({type:bf[c.Type],data:c.Data,blockSizes:c.blocksizes,mode:c.mode,mtime:c.mtime?{secs:c.mtime.Seconds,nsecs:c.mtime.FractionalNanoseconds}:void 0});return d._originalMode=c.mode||0,d}constructor(a={type:"file"}){let{type:b,data:c,blockSizes:d,hashType:e,fanout:f,mtime:g,mode:h}=a;if(b&&!bf.includes(b))throw a7(Error("Type: "+b+" is not valid"),"ERR_INVALID_TYPE");this.type=b||"file",this.data=c,this.hashType=e,this.fanout=f,this.blockSizes=d||[],this._originalMode=0,this.mode=bj(h),g&&(this.mtime=bk(g),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(a){this._mode=this.isDirectory()?bi:bh;let b=bj(a);void 0!==b&&(this._mode=b)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&bg.includes(this.type))}addBlockSize(a){this.blockSizes.push(a)}removeBlockSize(a){this.blockSizes.splice(a,1)}fileSize(){if(this.isDirectory())return 0;let a=0;return this.blockSizes.forEach(b=>{a+=b}),this.data&&(a+=this.data.length),a}marshal(){let a;switch(this.type){case"raw":a=be.DataType.Raw;break;case"directory":a=be.DataType.Directory;break;case"file":a=be.DataType.File;break;case"metadata":a=be.DataType.Metadata;break;case"symlink":a=be.DataType.Symlink;break;case"hamt-sharded-directory":a=be.DataType.HAMTShard;break;default:throw a7(Error("Type: "+a+" is not valid"),"ERR_INVALID_TYPE")}let b=this.data;this.data&&this.data.length||(b=void 0);let c;null!=this.mode&&((c=4294963200&this._originalMode|(bj(this.mode)||0))!==bh||this.isDirectory()||(c=void 0),c===bi&&this.isDirectory()&&(c=void 0));let d;if(null!=this.mtime){let e=bk(this.mtime);e&&0===(d={Seconds:e.secs,FractionalNanoseconds:e.nsecs}).FractionalNanoseconds&&delete d.FractionalNanoseconds}let f={Type:a,Data:b,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:c,mtime:d};return be.encode(f).finish()}}var bm=c(81362);let bn=new TextDecoder;function bo(a,b){let c=0;for(let d=0;;d+=7){if(d>=64)throw Error("protobuf: varint overflow");if(b>=a.length)throw Error("protobuf: unexpected end of data");let e=a[b++];if(c+=d<28?(127&e)<<d:(127&e)*2**d,e<128)break}return[c,b]}function bp(a,b){let c;[c,b]=bo(a,b);let d=b+c;if(c<0||d<0)throw Error("protobuf: invalid length");if(d>a.length)throw Error("protobuf: unexpected end of data");return[a.subarray(b,d),d]}function bq(a,b){let c;return[c,b]=bo(a,b),[7&c,c>>3,b]}function br(a){let b={},c=a.length,d=0;for(;d<c;){let e,f;if([e,f,d]=bq(a,d),1===f){if(b.Hash)throw Error("protobuf: (PBLink) duplicate Hash section");if(2!==e)throw Error(`protobuf: (PBLink) wrong wireType (${e}) for Hash`);if(void 0!==b.Name)throw Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==b.Tsize)throw Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[b.Hash,d]=bp(a,d)}else if(2===f){if(void 0!==b.Name)throw Error("protobuf: (PBLink) duplicate Name section");if(2!==e)throw Error(`protobuf: (PBLink) wrong wireType (${e}) for Name`);if(void 0!==b.Tsize)throw Error("protobuf: (PBLink) invalid order, found Tsize before Name");let g;[g,d]=bp(a,d),b.Name=bn.decode(g)}else if(3===f){if(void 0!==b.Tsize)throw Error("protobuf: (PBLink) duplicate Tsize section");if(0!==e)throw Error(`protobuf: (PBLink) wrong wireType (${e}) for Tsize`);[b.Tsize,d]=bo(a,d)}else throw Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${f}`)}if(d>c)throw Error("protobuf: (PBLink) unexpected end of data");return b}function bs(a){let b=a.length,c=0,d,e=!1,f;for(;c<b;){let g,h;if([g,h,c]=bq(a,c),2!==g)throw Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${g}`);if(1===h){if(f)throw Error("protobuf: (PBNode) duplicate Data section");[f,c]=bp(a,c),d&&(e=!0)}else if(2===h){if(e)throw Error("protobuf: (PBNode) duplicate Links section");d||(d=[]);let i;[i,c]=bp(a,c),d.push(br(i))}else throw Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${h}`)}if(c>b)throw Error("protobuf: (PBNode) unexpected end of data");let j={};return f&&(j.Data=f),j.Links=d||[],j}let bt=new TextEncoder,bu=4294967296,bv=2147483648;function bw(a,b){let c=b.length;if("number"==typeof a.Tsize){if(a.Tsize<0)throw Error("Tsize cannot be negative");if(!Number.isSafeInteger(a.Tsize))throw Error("Tsize too large for encoding");c=bA(b,c,a.Tsize)-1,b[c]=24}if("string"==typeof a.Name){let d=bt.encode(a.Name);c-=d.length,b.set(d,c),c=bA(b,c,d.length)-1,b[c]=18}return a.Hash&&(c-=a.Hash.length,b.set(a.Hash,c),c=bA(b,c,a.Hash.length)-1,b[c]=10),b.length-c}function bx(a){let b=bz(a),c=new Uint8Array(b),d=b;if(a.Data&&(d-=a.Data.length,c.set(a.Data,d),d=bA(c,d,a.Data.length)-1,c[d]=10),a.Links)for(let e=a.Links.length-1;e>=0;e--){let f=bw(a.Links[e],c.subarray(0,d));d-=f,d=bA(c,d,f)-1,c[d]=18}return c}function by(a){let b=0;if(a.Hash){let c=a.Hash.length;b+=1+c+bB(c)}if("string"==typeof a.Name){let d=bt.encode(a.Name).length;b+=1+d+bB(d)}return"number"==typeof a.Tsize&&(b+=1+bB(a.Tsize)),b}function bz(a){let b=0;if(a.Data){let c=a.Data.length;b+=1+c+bB(c)}if(a.Links)for(let d of a.Links){let e=by(d);b+=1+e+bB(e)}return b}function bA(a,b,c){b-=bB(c);let d=b;for(;c>=bv;)a[b++]=127&c|128,c/=128;for(;c>=128;)a[b++]=127&c|128,c>>>=7;return a[b]=c,d}function bB(a){return a%2==0&&a++,Math.floor((bC(a)+6)/7)}function bC(a){let b=0;return a>=bu&&(a=Math.floor(a/bu),b=32),a>=65536&&(a>>>=16,b+=16),a>=256&&(a>>>=8,b+=8),b+bD[a]}let bD=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],bE=["Data","Links"],bF=["Hash","Name","Tsize"],bG=new TextEncoder;function bH(a,b){if(a===b)return 0;let c=a.Name?bG.encode(a.Name):[],d=b.Name?bG.encode(b.Name):[],e=c.length,f=d.length;for(let g=0,h=Math.min(e,f);g<h;++g)if(c[g]!==d[g]){e=c[g],f=d[g];break}return e<f?-1:f<e?1:0}function bI(a,b){return!Object.keys(a).some(a=>!b.includes(a))}function bJ(a){if("object"==typeof a.asCID){let b=bm.CID.asCID(a);if(!b)throw TypeError("Invalid DAG-PB form");return{Hash:b}}if("object"!=typeof a||Array.isArray(a))throw TypeError("Invalid DAG-PB form");let c={};if(a.Hash){let d=bm.CID.asCID(a.Hash);try{!d&&("string"==typeof a.Hash?d=bm.CID.parse(a.Hash):a.Hash instanceof Uint8Array&&(d=bm.CID.decode(a.Hash)))}catch(e){throw TypeError(`Invalid DAG-PB form: ${e.message}`)}d&&(c.Hash=d)}if(!c.Hash)throw TypeError("Invalid DAG-PB form");return"string"==typeof a.Name&&(c.Name=a.Name),"number"==typeof a.Tsize&&(c.Tsize=a.Tsize),c}function bK(a){if((a instanceof Uint8Array||"string"==typeof a)&&(a={Data:a}),"object"!=typeof a||Array.isArray(a))throw TypeError("Invalid DAG-PB form");let b={};if(void 0!==a.Data){if("string"==typeof a.Data)b.Data=bG.encode(a.Data);else if(a.Data instanceof Uint8Array)b.Data=a.Data;else throw TypeError("Invalid DAG-PB form")}if(void 0!==a.Links){if(Array.isArray(a.Links))b.Links=a.Links.map(bJ),b.Links.sort(bH);else throw TypeError("Invalid DAG-PB form")}else b.Links=[];return b}function bL(a){if(!a||"object"!=typeof a||Array.isArray(a))throw TypeError("Invalid DAG-PB form");if(!bI(a,bE))throw TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==a.Data&&!(a.Data instanceof Uint8Array))throw TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(a.Links))throw TypeError("Invalid DAG-PB form (Links must be an array)");for(let b=0;b<a.Links.length;b++){let c=a.Links[b];if(!c||"object"!=typeof c||Array.isArray(c))throw TypeError("Invalid DAG-PB form (bad link object)");if(!bI(c,bF))throw TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!c.Hash)throw TypeError("Invalid DAG-PB form (link must have a Hash)");if(c.Hash.asCID!==c.Hash)throw TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==c.Name&&"string"!=typeof c.Name)throw TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==c.Tsize&&("number"!=typeof c.Tsize||c.Tsize%1!=0))throw TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(b>0&& -1===bH(c,a.Links[b-1]))throw TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function bM(a,b=[]){return bK({Data:a,Links:b})}function bN(a,b,c){return bJ({Hash:c,Name:a,Tsize:b})}let bO="dag-pb",bP=112;function bQ(a){bL(a);let b={};return a.Links&&(b.Links=a.Links.map(a=>{let b={};return a.Hash&&(b.Hash=a.Hash.bytes),void 0!==a.Name&&(b.Name=a.Name),void 0!==a.Tsize&&(b.Tsize=a.Tsize),b})),a.Data&&(b.Data=a.Data),bx(b)}function bR(a){let b=bs(a),c={};return b.Data&&(c.Data=b.Data),b.Links&&(c.Links=b.Links.map(a=>{let b={};try{b.Hash=bm.CID.decode(a.Hash)}catch(c){}if(!b.Hash)throw Error("Invalid Hash field found in link, expected CID");return void 0!==a.Name&&(b.Name=a.Name),void 0!==a.Tsize&&(b.Tsize=a.Tsize),b})),c}var bS=c(64936);let bT=42;function bU(a){if(a.asCID!==a)return null;let b=bm.CID.asCID(a);if(!b)return null;let c=new Uint8Array(b.bytes.byteLength+1);return c.set(b.bytes,1),[new bS.WU(bS.Dy.tag,bT),new bS.WU(bS.Dy.bytes,c)]}function bV(){throw Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function bW(a){if(Number.isNaN(a))throw Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(a===1/0||a=== -1/0)throw Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}let bX={float64:!0,typeEncoders:{Object:bU,undefined:bV,number:bW}};function bY(a){if(0!==a[0])throw Error("Invalid CID for CBOR tag 42; expected leading 0x00");return bm.CID.decode(a.subarray(1))}let bZ={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};bZ.tags[bT]=bY;let b$="dag-cbor",b_=113,b0=a=>bS.cv(a,bX),b1=a=>bS.Jx(a,bZ);var b2=c(16441),b3=c(59787),b4=c(85989),b5=c(85590),b6=c(22042);class b7 extends Array{constructor(){super(),this.inRecursive=[]}prefix(a){let b=this.inRecursive[this.inRecursive.length-1];b&&(b.type===b3.D.array&&(b.elements++,1!==b.elements&&a.push([44])),b.type===b3.D.map&&(b.elements++,1!==b.elements&&(b.elements%2==1?a.push([44]):a.push([58]))))}[b3.D.uint.major](a,b){this.prefix(a);let c=String(b.value),d=[];for(let e=0;e<c.length;e++)d[e]=c.charCodeAt(e);a.push(d)}[b3.D.negint.major](a,b){this[b3.D.uint.major](a,b)}[b3.D.bytes.major](a,b){throw Error(`${b5.OO} unsupported type: Uint8Array`)}[b3.D.string.major](a,b){this.prefix(a);let c=(0,b6.mL)(JSON.stringify(b.value));a.push(c.length>32?(0,b6.Dz)(c):c)}[b3.D.array.major](a,b){this.prefix(a),this.inRecursive.push({type:b3.D.array,elements:0}),a.push([91])}[b3.D.map.major](a,b){this.prefix(a),this.inRecursive.push({type:b3.D.map,elements:0}),a.push([123])}[b3.D.tag.major](a,b){}[b3.D.float.major](a,b){if("break"===b.type.name){let c=this.inRecursive.pop();if(c){if(c.type===b3.D.array)a.push([93]);else if(c.type===b3.D.map)a.push([125]);else throw Error("Unexpected recursive type; this should not happen!");return}throw Error("Unexpected break; this should not happen!")}if(void 0===b.value)throw Error(`${b5.OO} unsupported type: undefined`);if(this.prefix(a),"true"===b.type.name){a.push([116,114,117,101]);return}if("false"===b.type.name){a.push([102,97,108,115,101]);return}if("null"===b.type.name){a.push([110,117,108,108]);return}let d=String(b.value),e=[],f=!1;for(let g=0;g<d.length;g++)e[g]=d.charCodeAt(g),f||46!==e[g]&&101!==e[g]&&69!==e[g]||(f=!0);f||(e.push(46),e.push(48)),a.push(e)}}function b8(a,b){if(Array.isArray(a[0])||Array.isArray(b[0]))throw Error(`${b5.OO} complex map keys are not supported`);let c=a[0],d=b[0];if(c.type!==b3.D.string||d.type!==b3.D.string)throw Error(`${b5.OO} non-string map keys are not supported`);if(c<d)return -1;if(c>d)return 1;throw Error(`${b5.OO} unexpected duplicate map keys, this is not supported`)}let b9={addBreakTokens:!0,mapSorter:b8};function ca(a,b){return b=Object.assign({},b9,b),(0,b4.w$)(a,new b7,b)}var cb=c(61287);class cc{constructor(a,b={}){this.pos=0,this.data=a,this.options=b,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let a=this.ch();for(;32===a||9===a||13===a||10===a;)a=this.data[++this.pos]}expect(a){if(this.data.length-this.pos<a.length)throw Error(`${b5.IR} unexpected end of input at position ${this.pos}`);for(let b=0;b<a.length;b++)if(this.data[this.pos++]!==a[b])throw Error(`${b5.IR} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...a)}'`)}parseNumber(){let a=this.pos,b=!1,c=!1,d=a=>{for(;!this.done();){let b=this.ch();if(a.includes(b))this.pos++;else break}};if(45===this.ch()&&(b=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new b3.W(b3.D.uint,0,this.pos-a);this.pos++,c=!0}if(d([48,49,50,51,52,53,54,55,56,57]),b&&this.pos===a+1)throw Error(`${b5.IR} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(c)throw Error(`${b5.IR} unexpected token at position ${this.pos}`);c=!0,this.pos++,d([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(c=!0,this.pos++,!this.done()&&(43===this.ch()||45===this.ch())&&this.pos++,d([48,49,50,51,52,53,54,55,56,57]));let e=String.fromCharCode.apply(null,this.data.subarray(a,this.pos)),f=parseFloat(e);return c?new b3.W(b3.D.float,f,this.pos-a):!0!==this.options.allowBigInt||Number.isSafeInteger(f)?new b3.W(f>=0?b3.D.uint:b3.D.negint,f,this.pos-a):new b3.W(f>=0?b3.D.uint:b3.D.negint,BigInt(e),this.pos-a)}parseString(){if(34!==this.ch())throw Error(`${b5.IR} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let a=this.pos,b=0;a<this.data.length&&b<65536;a++,b++){let c=this.data[a];if(92===c||c<32||c>=128)break;if(34===c){let d=String.fromCharCode.apply(null,this.data.subarray(this.pos,a));return this.pos=a+1,new b3.W(b3.D.string,d,b)}}let e=this.pos,f=[],g=()=>{if(this.pos+4>=this.data.length)throw Error(`${b5.IR} unexpected end of unicode escape sequence at position ${this.pos}`);let a=0;for(let b=0;b<4;b++){let c=this.ch();if(c>=48&&c<=57)c-=48;else if(c>=97&&c<=102)c=c-97+10;else if(c>=65&&c<=70)c=c-65+10;else throw Error(`${b5.IR} unexpected unicode escape character at position ${this.pos}`);a=16*a+c,this.pos++}return a},h=()=>{let a=this.ch(),b=null,c=a>239?4:a>223?3:a>191?2:1;if(this.pos+c>this.data.length)throw Error(`${b5.IR} unexpected unicode sequence at position ${this.pos}`);let d,e,g,h;switch(c){case 1:a<128&&(b=a);break;case 2:(192&(d=this.data[this.pos+1]))==128&&(h=(31&a)<<6|63&d)>127&&(b=h);break;case 3:d=this.data[this.pos+1],e=this.data[this.pos+2],(192&d)==128&&(192&e)==128&&(h=(15&a)<<12|(63&d)<<6|63&e)>2047&&(h<55296||h>57343)&&(b=h);break;case 4:d=this.data[this.pos+1],e=this.data[this.pos+2],g=this.data[this.pos+3],(192&d)==128&&(192&e)==128&&(192&g)==128&&(h=(15&a)<<18|(63&d)<<12|(63&e)<<6|63&g)>65535&&h<1114112&&(b=h)}null===b?(b=65533,c=1):b>65535&&(b-=65536,f.push(b>>>10&1023|55296),b=56320|1023&b),f.push(b),this.pos+=c};for(;!this.done();){let i=this.ch(),j;switch(i){case 92:if(this.pos++,this.done())throw Error(`${b5.IR} unexpected string termination at position ${this.pos}`);switch(j=this.ch(),this.pos++,j){case 34:case 39:case 92:case 47:f.push(j);break;case 98:f.push(8);break;case 116:f.push(9);break;case 110:f.push(10);break;case 102:f.push(12);break;case 114:f.push(13);break;case 117:f.push(g());break;default:throw Error(`${b5.IR} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new b3.W(b3.D.string,(0,b6.Pu)(f),this.pos-e);default:if(i<32)throw Error(`${b5.IR} invalid control character at position ${this.pos}`);i<128?(f.push(i),this.pos++):h()}}throw Error(`${b5.IR} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new b3.W(b3.D.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new b3.W(b3.D.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new b3.W(b3.D.null,null,4);case 102:return this.expect([102,97,108,115,101]),new b3.W(b3.D.false,!1,5);case 116:return this.expect([116,114,117,101]),new b3.W(b3.D.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw Error(`${b5.IR} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new b3.W(b3.D.break,void 0,1);if(44!==this.ch())throw Error(`${b5.IR} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new b3.W(b3.D.break,void 0,1);return this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new b3.W(b3.D.break,void 0,1);if(44!==this.ch())throw Error(`${b5.IR} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new b3.W(b3.D.break,void 0,1);let a=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw Error(`${b5.IR} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),a}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw Error(`${b5.IR} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function cd(a,b){return b=Object.assign({tokenizer:new cc(a,b)},b),(0,cb.Jx)(a,b)}function ce(a){if(a.asCID!==a)return null;let b=b2.k0.asCID(a);if(!b)return null;let c=b.toString();return[new bS.WU(bS.Dy.map,1/0,1),new bS.WU(bS.Dy.string,"/",1),new bS.WU(bS.Dy.string,c,c.length),new bS.WU(bS.Dy.break,void 0,1)]}function cf(a){let b=a5.base64.encode(a).slice(1);return[new bS.WU(bS.Dy.map,1/0,1),new bS.WU(bS.Dy.string,"/",1),new bS.WU(bS.Dy.map,1/0,1),new bS.WU(bS.Dy.string,"bytes",5),new bS.WU(bS.Dy.string,b,b.length),new bS.WU(bS.Dy.break,void 0,1),new bS.WU(bS.Dy.break,void 0,1)]}function cg(){throw Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function ch(a){if(Number.isNaN(a))throw Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(a===1/0||a=== -1/0)throw Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}let ci={typeEncoders:{Object:ce,Uint8Array:cf,Buffer:cf,undefined:cg,number:ch}};class cj extends cc{constructor(a,b){super(a,b),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let a=this._next();if(a.type===bS.Dy.map){let b=this._next();if(b.type===bS.Dy.string&&"/"===b.value){let c=this._next();if(c.type===bS.Dy.string){let d=this._next();if(d.type!==bS.Dy.break)throw Error("Invalid encoded CID form");return this.tokenBuffer.push(c),new bS.WU(bS.Dy.tag,42,0)}if(c.type===bS.Dy.map){let e=this._next();if(e.type===bS.Dy.string&&"bytes"===e.value){let f=this._next();if(f.type===bS.Dy.string){for(let g=0;g<2;g++){let h=this._next();if(h.type!==bS.Dy.break)throw Error("Invalid encoded Bytes form")}let i=a5.base64.decode(`m${f.value}`);return new bS.WU(bS.Dy.bytes,i,f.value.length)}this.tokenBuffer.push(f)}this.tokenBuffer.push(e)}this.tokenBuffer.push(c)}this.tokenBuffer.push(b)}return a}}let ck={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};ck.tags[42]=b2.k0.parse;let cl="dag-json",cm=297,cn=a=>ca(a,ci),co=a=>{let b=Object.assign(ck,{tokenizer:new cj(a,ck)});return cd(a,b)};var cp=c(28630),cq=c.t(cp,2),cr=c(78103),cs=c(37211);function ct(){}class cu extends Error{constructor(a="not initialized"){super(a),this.name="NotInitializedError",this.code=cu.code}}cu.code="ERR_NOT_INITIALIZED";class cv extends Error{constructor(a="cannot initialize an initializing node"){super(a),this.name="AlreadyInitializingError",this.code=cw.code}}cv.code="ERR_ALREADY_INITIALIZING";class cw extends Error{constructor(a="cannot re-initialize an initialized node"){super(a),this.name="AlreadyInitializedError",this.code=cw.code}}cw.code="ERR_ALREADY_INITIALIZED";class cx extends Error{constructor(a="not started"){super(a),this.name="NotStartedError",this.code=cx.code}}cx.code="ERR_NOT_STARTED";class cy extends Error{constructor(a="cannot start, already startin"){super(a),this.name="AlreadyStartingError",this.code=cy.code}}cy.code="ERR_ALREADY_STARTING";class cz extends Error{constructor(a="cannot start, already started"){super(a),this.name="AlreadyStartedError",this.code=cz.code}}cz.code="ERR_ALREADY_STARTED";class cA extends Error{constructor(a="not enabled"){super(a),this.name="NotEnabledError",this.code=cA.code}}cA.code="ERR_NOT_ENABLED";var cB=c(52217),cC=c(24981),cD=c(78647),cE=c(92263);let cF="/",cG=new TextEncoder().encode(cF),cH=cG[0];class cI{constructor(a,b){if("string"==typeof a)this._buf=(0,cB.fromString)(a);else if(a instanceof Uint8Array)this._buf=a;else throw Error("Invalid key, should be String of Uint8Array");if(null==b&&(b=!0),b&&this.clean(),0===this._buf.byteLength||this._buf[0]!==cH)throw Error("Invalid key")}toString(a="utf8"){return(0,cE.toString)(this._buf,a)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(a){return new cI(a.join(cF))}static random(){return new cI((0,cD.nanoid)().replace(/-/g,""))}static asKey(a){return a instanceof Uint8Array||"string"==typeof a?new cI(a):a.uint8Array?new cI(a.uint8Array()):null}clean(){if(this._buf&&0!==this._buf.byteLength||(this._buf=cG),this._buf[0]!==cH){let a=new Uint8Array(this._buf.byteLength+1);a.fill(cH,0,1),a.set(this._buf,1),this._buf=a}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===cH;)this._buf=this._buf.subarray(0,-1)}less(a){let b=this.list(),c=a.list();for(let d=0;d<b.length;d++){if(c.length<d+1)return!1;let e=b[d],f=c[d];if(e<f)return!0;if(e>f)return!1}return b.length<c.length}reverse(){return cI.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let a=this.namespaces();return a[a.length-1]}list(){return this.toString().split(cF).slice(1)}type(){return cJ(this.baseNamespace())}name(){return cK(this.baseNamespace())}instance(a){return new cI(this.toString()+":"+a)}path(){let a=this.parent().toString();return a.endsWith(cF)||(a+=cF),a+=this.type(),new cI(a)}parent(){let a=this.list();return new cI(1===a.length?cF:a.slice(0,-1).join(cF))}child(a){return this.toString()===cF?a:a.toString()===cF?this:new cI(this.toString()+a.toString(),!1)}isAncestorOf(a){return a.toString()!==this.toString()&&a.toString().startsWith(this.toString())}isDecendantOf(a){return a.toString()!==this.toString()&&this.toString().startsWith(a.toString())}isTopLevel(){return 1===this.list().length}concat(...a){return cI.withNamespaces([...this.namespaces(),...cL(a.map(a=>a.namespaces()))])}}function cJ(a){let b=a.split(":");return b.length<2?"":b.slice(0,-1).join(":")}function cK(a){let b=a.split(":");return b[b.length-1]}function cL(a){return[].concat(...a)}var cM=c(10715),cN=c(32044);let cO=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;function cP(a="",b="ms"){var c=null;return(a=(a+"").replace(/(\d)[,_](\d)/g,"$1$2")).replace(cO,function(a,b,d){(d=cQ(d))&&(c=(c||0)+parseFloat(b,10)*d)}),c&&c/(cQ(b)||1)}function cQ(a){return cP[a]||cP[a.toLowerCase().replace(/s$/,"")]}cP.nanosecond=cP.ns=1/1e6,cP["\xb5s"]=cP["s"]=cP.us=cP.microsecond=.001,cP.millisecond=cP.ms=cP[""]=1,cP.second=cP.sec=cP.s=1e3*cP.ms,cP.minute=cP.min=cP.m=60*cP.s,cP.hour=cP.hr=cP.h=60*cP.m,cP.day=cP.d=24*cP.h,cP.week=cP.wk=cP.w=7*cP.d,cP.month=cP.b=30.4375*cP.d,cP.year=cP.yr=cP.y=365.25*cP.d;var cR=cP;class cS extends Error{constructor(a="request timed out"){super(a),this.name="TimeoutError",this.code=cS.code}}function cT(a,b){return(...c)=>{let d=c[null==b?c.length-1:b];if(!d||!d.timeout)return a(...c);let e="string"==typeof d.timeout?cR(d.timeout):d.timeout,f=new cM.TimeoutController(e);d.signal=(0,cN.anySignal)([d.signal,f.signal]);let g=a(...c),h=new Promise((a,b)=>{f.signal.addEventListener("abort",()=>{b(new cS)})}),i=Date.now(),j=()=>{if(f.signal.aborted)throw new cS;let a=Date.now()-i;if(a>e)throw f.abort(),new cS};return g[Symbol.asyncIterator]?async function*(){let a=g[Symbol.asyncIterator]();try{for(;;){let{value:b,done:c}=await Promise.race([a.next(),h]);if(c)break;j(),yield b}}catch(d){throw j(),d}finally{f.clear(),a.return&&a.return()}}():(async()=>{try{let a=await Promise.race([g,h]);return j(),a}catch(b){throw j(),b}finally{f.clear()}})()}}cS.code="ERR_TIMEOUT";let cU="/ipfs/";function cV(a){if(a instanceof Uint8Array)try{a=bm.CID.decode(a)}catch(b){throw a7(b,"ERR_INVALID_CID")}let c=bm.CID.asCID(a);if(c)return{cid:c,path:void 0};(a=a.toString()).startsWith(cU)&&(a=a.substring(cU.length));let d=a.split("/"),e;try{c=bm.CID.parse(d.shift()||"")}catch(f){throw a7(f,"ERR_INVALID_CID")}return d.length&&(e=`/${d.join("/")}`),{cid:c,path:e}}let cW="ERR_BAD_PATH",cX="This command must be run in online mode. Try running 'ipfs daemon' first.",cY=new cI("/local/filesroot"),cZ=262144,c$=a=>{let b=bm.CID.asCID(a);if(b)return`/ipfs/${a}`;let c=a.toString();try{return`/ipfs/${bm.CID.parse(c)}`}catch{}if(cC.path(c))return c;throw a7(Error(`invalid path: ${a}`),cW)},c_=a=>a instanceof Uint8Array?bm.CID.decode(a).toString():(0===(a=a.toString()).indexOf("/ipfs/")&&(a=a.substring(6)),"/"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1)),a),c0=async function(a,b,c,d={}){let{cid:e,path:f}=cV(c);f&&(d.path=f);let g=e,h=d.path||"";if(h.startsWith("/")&&(h=h.substring(1)),d.path)try{for await(let{value:i,remainderPath:j}of c3(e,d.path,b,a,{signal:d.signal})){if(!bm.CID.asCID(i))break;h=j,g=i}}catch(k){throw k.message.startsWith("Object has no property")&&(k.message=`no link named "${h.split("/")[0]}" under ${g}`,k.code="ERR_NO_LINK"),k}return{cid:g,remainderPath:h||""}},c1=a=>{if("file"!==a.type&&"directory"!==a.type&&"raw"!==a.type)throw Error(`Unknown node type '${a.type}'`);let b={cid:a.cid,path:a.path,name:a.name,size:a.size,type:"file"};return"directory"===a.type&&(b.type="dir"),"file"===a.type&&(b.size=a.unixfs.fileSize()),("file"===a.type||"directory"===a.type)&&(b.mode=a.unixfs.mode,void 0!==a.unixfs.mtime&&(b.mtime=a.unixfs.mtime)),b},c2=cT(async(a,b)=>await a),c3=async function*(a,b,c,d,e){let f=async a=>{let b=await c.getCodec(a.code),f=await d.blocks.get(a,e);return b.decode(f)},g=b.split("/").filter(Boolean),h=await f(a),i=a;for(;g.length;){let j=g.shift();if(!j)throw a7(Error(`Could not resolve path "${b}"`),"ERR_INVALID_PATH");if(a.code===bP&&Array.isArray(h.Links)){let k=h.Links.find(a=>a.Name===j);if(k){yield{value:k.Hash,remainderPath:g.join("/")},h=await f(k.Hash),i=k.Hash;continue}}if(Object.prototype.hasOwnProperty.call(h,j))yield{value:h=h[j],remainderPath:g.join("/")};else throw a7(Error(`no link named "${j}" under ${i}`),"ERR_NO_LINK");bm.CID.asCID(h)&&(i=h,h=await f(h))}yield{value:h,remainderPath:""}};class c4{static create({start:a,stop:b}){return new c4(a,b)}static async start(a,b){let{state:c,activate:d}=a;switch(c.status){case"stopped":try{let e=d(b);a.state={status:"starting",ready:e};let f=await e;return a.state={status:"started",value:f},f}catch(g){throw a.state={status:"stopped"},g}case"starting":throw new cy;case"started":throw new cz;case"stopping":return await c.ready,await c4.start(a,b);default:return c4.panic(a)}}static async stop(a){let{state:b,deactivate:c}=a;switch(b.status){case"stopped":break;case"starting":try{await b.ready}catch(d){}return await c4.stop(a);case"stopping":return await b.ready;case"started":c&&await c(b.value),a.state={status:"stopped"};break;default:c4.panic(b)}}static try({state:a}){return"started"===a.status?a.value:null}static async use({state:a},b){switch(a.status){case"started":return a.value;case"starting":return await c2(a.ready,b);default:throw new cx}}static panic({state:a}){let b=JSON.stringify({status:a.status});throw RangeError(`Service in invalid state ${b}, should never happen if you see this please report a bug`)}constructor(a,b){this.activate=a,this.deactivate=b,this.state={status:"stopped"}}async use(a){return await c4.use(this,a)}try(){return c4.try(this)}}function c5({network:a,preload:b,peerId:c,keychain:d,repo:e,ipns:f,mfsPreload:g,print:h,hashers:i,options:j}){let k=async()=>{let{libp2p:k}=await c4.start(a,{peerId:c,repo:e,print:h,hashers:i,options:j});await Promise.all([f.startOnline({keychain:d,libp2p:k,peerId:c,repo:e}),b.start(),g.start()])};return k}function c6({network:a,preload:b,ipns:c,repo:d,mfsPreload:e}){let f=async()=>{await Promise.all([b.stop(),c.stop(),e.stop()]),await c4.stop(a),await d.close()};return f}var c7=c(70248);class c8{constructor(a){this.lru=c7(a)}get(a){let b=this.lru.get(a);if(b){if(b.expire&&b.expire<Date.now()){this.lru.remove(a);return}return b.value}}set(a,b,c){this.lru.set(a,{value:b,expire:Date.now()+c})}has(a){let b=this.get(a);return!!b}remove(a){this.lru.remove(a)}clear(){this.lru.clear()}}var c9=c(26729);class da extends Error{constructor(a){super(a),this.name="TimeoutError"}}class db extends Error{constructor(a){super(),this.name="AbortError",this.message=a}}let dc=a=>void 0===globalThis.DOMException?new db(a):new DOMException(a),dd=a=>{let b=void 0===a.reason?dc("This operation was aborted."):a.reason;return b instanceof Error?b:dc(b)};function de(a,b,c,d){let e,f=new Promise((f,g)=>{if("number"!=typeof b||1!==Math.sign(b))throw TypeError(`Expected \`milliseconds\` to be a positive number, got \`${b}\``);if(b===Number.POSITIVE_INFINITY){f(a);return}if((d={customTimers:{setTimeout,clearTimeout},...d}).signal){let{signal:h}=d;h.aborted&&g(dd(h)),h.addEventListener("abort",()=>{g(dd(h))})}e=d.customTimers.setTimeout.call(void 0,()=>{if("function"==typeof c){try{f(c())}catch(d){g(d)}return}let e="string"==typeof c?c:`Promise timed out after ${b} milliseconds`,h=c instanceof Error?c:new da(e);"function"==typeof a.cancel&&a.cancel(),g(h)},b),(async()=>{try{f(await a)}catch(b){g(b)}finally{d.customTimers.clearTimeout.call(void 0,e)}})()});return f.clear=()=>{clearTimeout(e),e=void 0},f}function df(a,b,c){let d=0,e=a.length;for(;e>0;){let f=Math.trunc(e/2),g=d+f;0>=c(a[g],b)?(d=++g,e-=f+1):e=f}return d}var dg=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};class dh{constructor(){w.set(this,[])}enqueue(a,b){b={priority:0,...b};let c={priority:b.priority,run:a};if(this.size&&dg(this,w,"f")[this.size-1].priority>=b.priority){dg(this,w,"f").push(c);return}let d=df(dg(this,w,"f"),c,(a,b)=>b.priority-a.priority);dg(this,w,"f").splice(d,0,c)}dequeue(){let a=dg(this,w,"f").shift();return null==a?void 0:a.run}filter(a){return dg(this,w,"f").filter(b=>b.priority===a.priority).map(a=>a.run)}get size(){return dg(this,w,"f").length}}w=new WeakMap;var di=function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c},dj=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};let dk=new da;class dl extends Error{}class dm extends c9{constructor(a){var b,c,d,e;if(super(),x.add(this),y.set(this,void 0),z.set(this,void 0),A.set(this,0),B.set(this,void 0),C.set(this,void 0),D.set(this,0),E.set(this,void 0),F.set(this,void 0),G.set(this,void 0),H.set(this,void 0),I.set(this,0),J.set(this,void 0),K.set(this,void 0),L.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(a={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:dh,...a}).intervalCap&&a.intervalCap>=1))throw TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(c=null===(b=a.intervalCap)|| void 0===b?void 0:b.toString())&& void 0!==c?c:""}\` (${typeof a.intervalCap})`);if(void 0===a.interval||!(Number.isFinite(a.interval)&&a.interval>=0))throw TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(e=null===(d=a.interval)|| void 0===d?void 0:d.toString())&& void 0!==e?e:""}\` (${typeof a.interval})`);di(this,y,a.carryoverConcurrencyCount,"f"),di(this,z,a.intervalCap===Number.POSITIVE_INFINITY||0===a.interval,"f"),di(this,B,a.intervalCap,"f"),di(this,C,a.interval,"f"),di(this,G,new a.queueClass,"f"),di(this,H,a.queueClass,"f"),this.concurrency=a.concurrency,this.timeout=a.timeout,di(this,L,!0===a.throwOnTimeout,"f"),di(this,K,!1===a.autoStart,"f")}get concurrency(){return dj(this,J,"f")}set concurrency(a){if(!("number"==typeof a&&a>=1))throw TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${a}\` (${typeof a})`);di(this,J,a,"f"),dj(this,x,"m",V).call(this)}async add(a,b={}){return new Promise((c,d)=>{let e=async()=>{var e,f,g;di(this,I,(f=dj(this,I,"f"),++f),"f"),di(this,A,(g=dj(this,A,"f"),++g),"f");try{if(null===(e=b.signal)|| void 0===e?void 0:e.aborted){d(new dl("The task was aborted."));return}let h=void 0===this.timeout&& void 0===b.timeout?a({signal:b.signal}):de(Promise.resolve(a({signal:b.signal})),void 0===b.timeout?this.timeout:b.timeout,()=>{(void 0===b.throwOnTimeout?dj(this,L,"f"):b.throwOnTimeout)&&d(dk)}),i=await h;c(i),this.emit("completed",i)}catch(j){d(j),this.emit("error",j)}dj(this,x,"m",O).call(this)};dj(this,G,"f").enqueue(e,b),dj(this,x,"m",S).call(this),this.emit("add")})}async addAll(a,b){return Promise.all(a.map(async a=>this.add(a,b)))}start(){return dj(this,K,"f")&&(di(this,K,!1,"f"),dj(this,x,"m",V).call(this)),this}pause(){di(this,K,!0,"f")}clear(){di(this,G,new(dj(this,H,"f")),"f")}async onEmpty(){0!==dj(this,G,"f").size&&await dj(this,x,"m",W).call(this,"empty")}async onSizeLessThan(a){!(dj(this,G,"f").size<a)&&await dj(this,x,"m",W).call(this,"next",()=>dj(this,G,"f").size<a)}async onIdle(){(0!==dj(this,I,"f")||0!==dj(this,G,"f").size)&&await dj(this,x,"m",W).call(this,"idle")}get size(){return dj(this,G,"f").size}sizeBy(a){return dj(this,G,"f").filter(a).length}get pending(){return dj(this,I,"f")}get isPaused(){return dj(this,K,"f")}}y=new WeakMap,z=new WeakMap,A=new WeakMap,B=new WeakMap,C=new WeakMap,D=new WeakMap,E=new WeakMap,F=new WeakMap,G=new WeakMap,H=new WeakMap,I=new WeakMap,J=new WeakMap,K=new WeakMap,L=new WeakMap,x=new WeakSet,M=function(){return dj(this,z,"f")||dj(this,A,"f")<dj(this,B,"f")},N=function(){return dj(this,I,"f")<dj(this,J,"f")},O=function(){var a;di(this,I,(a=dj(this,I,"f"),--a),"f"),dj(this,x,"m",S).call(this),this.emit("next")},P=function(){this.emit("empty"),0===dj(this,I,"f")&&this.emit("idle")},Q=function(){dj(this,x,"m",U).call(this),dj(this,x,"m",T).call(this),di(this,F,void 0,"f")},R=function(){let a=Date.now();if(void 0===dj(this,E,"f")){let b=dj(this,D,"f")-a;if(!(b<0))return void 0===dj(this,F,"f")&&di(this,F,setTimeout(()=>{dj(this,x,"m",Q).call(this)},b),"f"),!0;di(this,A,dj(this,y,"f")?dj(this,I,"f"):0,"f")}return!1},S=function(){if(0===dj(this,G,"f").size)return dj(this,E,"f")&&clearInterval(dj(this,E,"f")),di(this,E,void 0,"f"),dj(this,x,"m",P).call(this),!1;if(!dj(this,K,"f")){let a=!dj(this,x,"a",R);if(dj(this,x,"a",M)&&dj(this,x,"a",N)){let b=dj(this,G,"f").dequeue();return!!b&&(this.emit("active"),b(),a&&dj(this,x,"m",T).call(this),!0)}}return!1},T=function(){!dj(this,z,"f")&& void 0===dj(this,E,"f")&&(di(this,E,setInterval(()=>{dj(this,x,"m",U).call(this)},dj(this,C,"f")),"f"),di(this,D,Date.now()+dj(this,C,"f"),"f"))},U=function(){0===dj(this,A,"f")&&0===dj(this,I,"f")&&dj(this,E,"f")&&(clearInterval(dj(this,E,"f")),di(this,E,void 0,"f")),di(this,A,dj(this,y,"f")?dj(this,I,"f"):0,"f"),dj(this,x,"m",V).call(this)},V=function(){for(;dj(this,x,"m",S).call(this););},W=async function(a,b){return new Promise(c=>{let d=()=>{(!b||b())&&(this.off(a,d),c())};this.on(a,d)})};var dn=c(67137);let dp=new c8(1e3),dq=6e4,dr=dm.default?dm.default:dm,ds=new dr({concurrency:4}),dt=a=>{if(a.Path)return a.Path;throw Error(a.Message)};async function du(a,b){let c=async(a,b={})=>{let c=new URLSearchParams(b);c.set("arg",a);let d=c.toString();if(!b.nocache&&dp.has(d)){let e=dp.get(d);return dt(e)}let f=await ds.add(async()=>{let a=await dn.get("https://ipfs.io/api/v0/dns",{searchParams:c}),b=new URL(a.url).search.slice(1),d=await a.json();return dp.set(b,d,dq),d});return dt(f)};return c(a,b)}function dv(a){return a.endsWith(".eth")&&(a=a.replace(/.eth$/,".eth.link")),a}function dw(){let a=async(a,b={recursive:!0})=>{if("string"!=typeof a)throw Error("Invalid arguments, domain must be a string");return a=dv(a),du(a,b)};return cT(a)}function dx({network:a}){return()=>{let b=a.try();return null!=b&&Boolean(b.libp2p.isStarted())}}var dy=c(28924),dz=c(19588),dA=c(56155);let dB=Symbol.for("@libp2p/peer-id"),dC=Object.values(cs.gh).map(a=>a.decoder).reduce((a,b)=>a.or(b),cs.gh.identity.decoder),dD=114,dE=36,dF=37;class dG{constructor(a){this.type=a.type,this.multihash=a.multihash,this.privateKey=a.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[dB](){return!0}toString(){return null==this.string&&(this.string=a3.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return bm.CID.createV1(dD,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(a){if(a instanceof Uint8Array)return(0,dz.equals)(this.multihash.bytes,a);if("string"==typeof a)return dL(a).equals(this);if(a?.multihash?.bytes!=null)return(0,dz.equals)(this.multihash.bytes,a.multihash.bytes);throw Error("not valid Id")}}class dH extends dG{constructor(a){super({...a,type:"RSA"}),this.type="RSA",this.publicKey=a.publicKey}}class dI extends dG{constructor(a){super({...a,type:"Ed25519"}),this.type="Ed25519",this.publicKey=a.multihash.digest}}class dJ extends dG{constructor(a){super({...a,type:"secp256k1"}),this.type="secp256k1",this.publicKey=a.multihash.digest}}function dK(a){if("RSA"===a.type)return new dH(a);if("Ed25519"===a.type)return new dI(a);if("secp256k1"===a.type)return new dJ(a);throw a7(Error("Not a PeerId"),"ERR_INVALID_PARAMETERS")}function dL(a,b){if(b=b??dC,"1"===a.charAt(0)||"Q"===a.charAt(0)){let c=dy.decode(a3.base58btc.decode(`z${a}`));return a.startsWith("12D")?new dI({multihash:c}):a.startsWith("16U")?new dJ({multihash:c}):new dH({multihash:c})}return dM(dC.decode(a))}function dM(a){try{let b=dy.decode(a);if(b.code===cr.identity.code){if(b.digest.length===dE)return new dI({multihash:b});if(b.digest.length===dF)return new dJ({multihash:b})}if(b.code===dA.sha256.code)return new dH({multihash:b})}catch{return dN(bm.CID.decode(a))}throw Error("Supplied PeerID CID is invalid")}function dN(a){if(null==a||null==a.multihash||null==a.version||1===a.version&&a.code!==dD)throw Error("Supplied PeerID CID is invalid");let b=a.multihash;if(b.code===dA.sha256.code)return new dH({multihash:a.multihash});if(b.code===cr.identity.code){if(b.digest.length===dE)return new dI({multihash:a.multihash});if(b.digest.length===dF)return new dJ({multihash:a.multihash})}throw Error("Supplied PeerID CID is invalid")}async function dO(a,b){return a.length===dE?new dI({multihash:dy.create(cr.identity.code,a),privateKey:b}):a.length===dF?new dJ({multihash:dy.create(cr.identity.code,a),privateKey:b}):new dH({multihash:await dA.sha256.digest(a),publicKey:a,privateKey:b})}function dP({repo:a,codecs:b,bases:c,name:d}){async function e(e,f={}){if(!cC.path(e))throw Error("invalid argument "+e);if(cC.ipnsPath(e))for await(let g of d.resolve(e,f))e=g;let[,h,i,...j]=e.split("/"),k=f.cidBase?await c.getBase(f.cidBase):void 0,l=dQ(i);if(0===j.length){let m=k?k.encoder.encode(l):i;return`/${h}/${m}`}let n=bm.CID.decode(l);e=j.join("/");let o=c3(n,e,b,a,f),p=n,q=e;for await(let r of o)bm.CID.asCID(r.value)&&(p=r.value,q=r.remainderPath);return`/ipfs/${p.toString(k&&k.encoder)}${q?"/"+q:""}`}return cT(e)}function dQ(a){try{return dL(a).toBytes()}catch{return bm.CID.parse(a).bytes}}var dR=c(93093);function dS({addAll:a}){return(b,c={})=>{let d,e=bm.CID.asCID(b);return dR(d=e?a([{cid:e,...c}],c):a([{path:b.toString(),...c}],c))}}async function*dT(a){if(null==a)throw a7(Error(`Unexpected input: ${a}`),"ERR_UNEXPECTED_INPUT");let b=bm.CID.asCID(a);if(b){yield dU({cid:b});return}if(a instanceof String||"string"==typeof a){yield dU({path:a});return}if(null!=a.cid||null!=a.path)return yield dU(a);if(Symbol.iterator in a){let c=a[Symbol.iterator](),d=c.next();if(d.done)return c;if(bm.CID.asCID(d.value)||d.value instanceof String||"string"==typeof d.value){for(let e of(yield dU({cid:d.value}),c))yield dU({cid:e});return}if(null!=d.value.cid||null!=d.value.path){for(let f of(yield dU(d.value),c))yield dU(f);return}throw a7(Error("Unexpected input: "+typeof a),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in a){let g=a[Symbol.asyncIterator](),h=await g.next();if(h.done)return g;if(bm.CID.asCID(h.value)||h.value instanceof String||"string"==typeof h.value){for await(let i of(yield dU({cid:h.value}),g))yield dU({cid:i});return}if(null!=h.value.cid||null!=h.value.path){for await(let j of(yield dU(h.value),g))yield dU(j);return}}throw a7(Error("Unexpected input: "+typeof a),"ERR_UNEXPECTED_INPUT")}function dU(a){let b=a.cid||`${a.path}`;if(!b)throw a7(Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let c={path:b,recursive:!1!==a.recursive};return null!=a.metadata&&(c.metadata=a.metadata),c}let dV={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function dW({repo:a,codecs:b}){async function*c(c,d={}){let e=async function*(){for await(let{path:d,recursive:e,metadata:f}of dT(c)){let{cid:g}=await c0(a,b,d),{reason:h}=await a.pins.isPinnedWithType(g,[dV.recursive,dV.direct]);if("recursive"===h&&!e)throw Error(`${g} already pinned recursively`);e?await a.pins.pinRecursively(g,{metadata:f}):await a.pins.pinDirectly(g,{metadata:f}),yield g}},f=Boolean(d.lock);if(!f){yield*e();return}let g=await a.gcLock.readLock();try{yield*e()}finally{g()}}return cT(c)}function dX(a,b,c){let d={type:a,cid:b};return c&&(d.metadata=c),d}function dY({repo:a,codecs:b}){async function*c(c={}){let d=dV.all;if(c.type&&(d=c.type,!Object.keys(dV).includes(d)))throw a7(Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(c.paths){let e=!1;for await(let{path:f}of dT(c.paths)){let{cid:g}=await c0(a,b,f),{reason:h,pinned:i,parent:j,metadata:k}=await a.pins.isPinnedWithType(g,d);if(!i)throw a7(Error(`path '${f}' is not pinned`),"ERR_NOT_PINNED");switch(h){case dV.direct:case dV.recursive:e=!0,yield dX(h,g,k);break;default:e=!0,yield dX(`${dV.indirect} through ${j}`,g,k)}}if(!e)throw Error("No match found");return}if(d===dV.recursive||d===dV.all)for await(let{cid:l,metadata:m}of a.pins.recursiveKeys())yield dX(dV.recursive,l,m);if(d===dV.indirect||d===dV.all)for await(let n of a.pins.indirectKeys(c))yield dX(dV.indirect,n);if(d===dV.direct||d===dV.all)for await(let{cid:o,metadata:p}of a.pins.directKeys())yield dX(dV.direct,o,p)}return cT(c)}function dZ({rmAll:a}){async function b(b,c={}){let d=await dR(a([{path:b,...c}],c));if(!d)throw Error("CID expected");return d}return b}function d$({repo:a,codecs:b}){async function*c(c,d={}){let e=await a.gcLock.readLock();try{for await(let{path:f,recursive:g}of dT(c)){let{cid:h}=await c0(a,b,f),{pinned:i,reason:j}=await a.pins.isPinnedWithType(h,dV.all);if(!i)throw Error(`${h} is not pinned`);switch(j){case dV.recursive:if(!g)throw Error(`${h} is pinned recursively`);await a.pins.unpin(h),yield h;break;case dV.direct:await a.pins.unpin(h),yield h;break;default:throw Error(`${h} is pinned indirectly under ${j}`)}}}finally{e()}}return cT(c)}class d_{constructor({codecs:a,repo:b}){let c=dW({codecs:a,repo:b});this.addAll=c,this.add=dS({addAll:c});let d=d$({codecs:a,repo:b});this.rmAll=d,this.rm=dZ({rmAll:d}),this.ls=dY({codecs:a,repo:b}),this.remote={add:(a,b={})=>Promise.reject(Error("Not implemented")),ls:async function*(a,b={}){return Promise.reject(Error("Not implemented"))},rm:(a,b={})=>Promise.reject(Error("Not implemented")),rmAll:(a,b={})=>Promise.reject(Error("Not implemented")),service:{add:(a,b)=>Promise.reject(Error("Not implemented")),rm:(a,b={})=>Promise.reject(Error("Not implemented")),ls:(a={})=>Promise.reject(Error("Not implemented"))}}}}let d0=Symbol.for("@libp2p/peer-id");function d1(a){return null!=a&&Boolean(a[d0])}function d2(a){return a7(a=a||Error("Cannot open database"),"ERR_DB_OPEN_FAILED")}function d3(a){return a7(a=a||Error("Delete failed"),"ERR_DB_DELETE_FAILED")}function d4(a){return a7(a=a||Error("Write failed"),"ERR_DB_WRITE_FAILED")}function d5(a){return a7(a=a||Error("Not Found"),"ERR_NOT_FOUND")}var d6=c(84957),d7=c(20605);let d8=Symbol.for("@achingbrain/uint8arraylist");function d9(a,b,c){if(null==b||b<0||b>=c)throw RangeError("index is out of bounds");let d=0;for(let e of a){let f=d+e.byteLength;if(b<f)return{buf:e,index:b-d};d=f}throw RangeError("index is out of bounds")}function ea(a){return Boolean(a?.[d8])}class eb{constructor(...a){Object.defineProperty(this,d8,{value:!0}),this.bufs=[],this.length=0,this.appendAll(a)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...a){this.appendAll(a)}appendAll(a){let b=0;for(let c of a)if(c instanceof Uint8Array)b+=c.byteLength,this.bufs.push(c);else if(ea(c))b+=c.length,this.bufs=this.bufs.concat(c.bufs);else throw Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=b}get(a){let b=d9(this.bufs,a,this.length);return b.buf[b.index]}set(a,b){let c=d9(this.bufs,a,this.length);c.buf[c.index]=b}write(a,b=0){if(a instanceof Uint8Array)for(let c=0;c<a.length;c++)this.set(b+c,a[c]);else if(ea(a))for(let d=0;d<a.length;d++)this.set(b+d,a.get(d));else throw Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(a){if(!Number.isNaN(a=Math.trunc(a))&&!(a<=0))for(;this.bufs.length>0;)if(a>=this.bufs[0].byteLength)a-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(a),this.length-=a;break}}slice(a,b){let{bufs:c,length:d}=this._subList(a,b);return(0,d7.concat)(c,d)}subarray(a,b){let{bufs:c}=this._subList(a,b),d=new eb;return d.appendAll(c),d}_subList(a,b){if(null==a&&null==b)return{bufs:this.bufs,length:this.length};if(a=a??0,b=b??(this.length>0?this.length:0),a<0&&(a=this.length+a),b<0&&(b=this.length+b),a<0||b>this.length)throw RangeError("index out of bounds");if(a===b)return{bufs:[],length:0};let c=[],d=0;for(let e of this.bufs){let f=d,g=f+e.byteLength,h=a>=f&&a<g,i=b>f&&b<=g,j=a<f&&b>=g;d=g;let k,l;if(h&&(k=a-f,l=e.byteLength),i&&(l=b-f,null==k&&(k=0)),j&&(k=0,l=e.byteLength),null!=k&&null!=l&&c.push(e.subarray(k,l)),i)break}return{bufs:c,length:b-a}}getInt8(a){let b=this.slice(a,a+1),c=new DataView(b.buffer,b.byteOffset,b.byteLength);return c.getInt8(0)}setInt8(a,b){let c=new Uint8Array(1),d=new DataView(c.buffer,c.byteOffset,c.byteLength);d.setInt8(0,b),this.write(c,a)}getInt16(a,b){let c=this.slice(a,a+2),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getInt16(0,b)}setInt16(a,b,c){let d=new Uint8Array(2),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setInt16(0,b,c),this.write(d,a)}getInt32(a,b){let c=this.slice(a,a+4),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getInt32(0,b)}setInt32(a,b,c){let d=new Uint8Array(4),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setInt32(0,b,c),this.write(d,a)}getBigInt64(a,b){let c=this.slice(a,a+8),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getBigInt64(0,b)}setBigInt64(a,b,c){let d=new Uint8Array(8),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setBigInt64(0,b,c),this.write(d,a)}getUint8(a){let b=this.slice(a,a+1),c=new DataView(b.buffer,b.byteOffset,b.byteLength);return c.getUint8(0)}setUint8(a,b){let c=new Uint8Array(1),d=new DataView(c.buffer,c.byteOffset,c.byteLength);d.setUint8(0,b),this.write(c,a)}getUint16(a,b){let c=this.slice(a,a+2),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getUint16(0,b)}setUint16(a,b,c){let d=new Uint8Array(2),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setUint16(0,b,c),this.write(d,a)}getUint32(a,b){let c=this.slice(a,a+4),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getUint32(0,b)}setUint32(a,b,c){let d=new Uint8Array(4),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setUint32(0,b,c),this.write(d,a)}getBigUint64(a,b){let c=this.slice(a,a+8),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getBigUint64(0,b)}setBigUint64(a,b,c){let d=new Uint8Array(8),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setBigUint64(0,b,c),this.write(d,a)}getFloat32(a,b){let c=this.slice(a,a+4),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getFloat32(0,b)}setFloat32(a,b,c){let d=new Uint8Array(4),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setFloat32(0,b,c),this.write(d,a)}getFloat64(a,b){let c=this.slice(a,a+8),d=new DataView(c.buffer,c.byteOffset,c.byteLength);return d.getFloat64(0,b)}setFloat64(a,b,c){let d=new Uint8Array(8),e=new DataView(d.buffer,d.byteOffset,d.byteLength);e.setFloat64(0,b,c),this.write(d,a)}}function ec(a){return a instanceof Uint8Array?{get(b){return a[b]},set(b,c){a[b]=c}}:{get(b){return a.get(b)},set(b,c){a.set(b,c)}}}let ed=4294967296;class ee{constructor(a=0,b=0){this.hi=a,this.lo=b}toBigInt(a){if(a)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){let b=~this.lo+1>>>0,c=~this.hi>>>0;return 0===b&&(c=c+1>>>0),-(BigInt(b)+(BigInt(c)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}zzDecode(){let a=-(1&this.lo),b=((this.lo>>>1|this.hi<<31)^a)>>>0,c=(this.hi>>>1^a)>>>0;return new ee(c,b)}zzEncode(){let a=this.hi>>31,b=((this.hi<<1|this.lo>>>31)^a)>>>0,c=(this.lo<<1^a)>>>0;return new ee(b,c)}toBytes(a,b=0){let c=ec(a);for(;this.hi>0;)c.set(b++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)c.set(b++,127&this.lo|128),this.lo=this.lo>>>7;c.set(b++,this.lo)}static fromBigInt(a){if(0n===a)return new ee;let b=a<0;b&&(a=-a);let c=0|Number(a>>32n),d=0|Number(a-(BigInt(c)<<32n));return b&&(c=~c>>>0,d=~d>>>0,++d>ed&&(d=0,++c>ed&&(c=0))),new ee(c,d)}static fromNumber(a){if(0===a)return new ee;let b=a<0;b&&(a=-a);let c=a>>>0,d=(a-c)/4294967296>>>0;return b&&(d=~d>>>0,c=~c>>>0,++c>4294967295&&(c=0,++d>4294967295&&(d=0))),new ee(d,c)}static fromBytes(a,b){let c=ec(a),d=new ee,e=0;if(a.length-b>4){for(;e<4;++e)if(d.lo=(d.lo|(127&c.get(b))<<7*e)>>>0,128>c.get(b++))return d;if(d.lo=(d.lo|(127&c.get(b))<<28)>>>0,d.hi=(d.hi|(127&c.get(b))>>4)>>>0,128>c.get(b++))return d;e=0}else{for(;e<3;++e){if(b>=a.length)throw RangeError(`index out of range: ${b} > ${a.length}`);if(d.lo=(d.lo|(127&c.get(b))<<7*e)>>>0,128>c.get(b++))return d}return d.lo=(d.lo|(127&c.get(b++))<<7*e)>>>0,d}if(a.length-b>4){for(;e<5;++e)if(d.hi=(d.hi|(127&c.get(b))<<7*e+3)>>>0,128>c.get(b++))return d}else for(;e<5;++e){if(b>=a.length)throw RangeError(`index out of range: ${b} > ${a.length}`);if(d.hi=(d.hi|(127&c.get(b))<<7*e+3)>>>0,128>c.get(b++))return d}throw Error("invalid varint encoding")}}let ef=128,eg=127,eh=~eg,ei=2147483648,ej=128,ek=16384,el=2097152,em=268435456,en=34359738368,eo=4398046511104,ep=562949953421312,eq=72057594037927940,er=0x7fffffffffffffff,es={encodingLength(a){return a<ej?1:a<ek?2:a<el?3:a<em?4:a<en?5:a<eo?6:a<ep?7:a<eq?8:a<er?9:10},encode(a,b){let c=0,d=ec(b);for(;a>=ei;)d.set(c++,255&a|ef),a/=128;for(;(a&eh)>0;)d.set(c++,255&a|ef),a>>>=7;d.set(c,0|a)},decode(a,b=0){let c=ec(a),d=4294967295;if(d=(127&c.get(b))>>>0,128>c.get(b++)||(d=(d|(127&c.get(b))<<7)>>>0,128>c.get(b++))||(d=(d|(127&c.get(b))<<14)>>>0,128>c.get(b++))||(d=(d|(127&c.get(b))<<21)>>>0,128>c.get(b++))||(d=(d|(15&c.get(b))<<28)>>>0,128>c.get(b++)))return d;if((b+=5)>a.length)throw RangeError(`index out of range: ${b} > ${a.length}`);return d}},et={encodingLength(a){return a<0?10:es.encodingLength(a)},encode(a,b){if(a<0){let c=0,d=ec(b),e=ee.fromNumber(a);for(;e.hi>0;)d.set(c++,127&e.lo|128),e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)d.set(c++,127&e.lo|128),e.lo=e.lo>>>7;d.set(c++,e.lo);return}es.encode(a,b)},decode(a,b=0){return 0|es.decode(a,b)}},eu={encodingLength(a){return a=(a<<1^a>>31)>>>0,es.encodingLength(a)},encode(a,b,c=0){return a=(a<<1^a>>31)>>>0,es.encode(a,b)},decode(a,b=0){let c=es.decode(a,b);return c>>>1^ -(1&c)|0}};function ev(a,b){let c=new Uint8Array(es.encodingLength(a.length));return es.encode(a.length,c),b.decode(new eb(c,a),0)}function ew(a,b){let c=b.encode(a),d=es.encodingLength(es.decode(c));return c.slice(d)}function ex(a,b,c,d,e){return{name:a,type:b,encode:c,decode:d,encodingLength:e}}(w6=X||(X={}))[w6.VARINT=0]="VARINT",w6[w6.BIT64=1]="BIT64",w6[w6.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",w6[w6.START_GROUP=3]="START_GROUP",w6[w6.END_GROUP=4]="END_GROUP",w6[w6.BIT32=5]="BIT32";let ey=function(){return 1},ez=function(a){return Uint8Array.from([a?1:0])},eA=function(a,b){return a.get(b)>0},eB=ex("bool",X.VARINT,ez,eA,ey),eC=function(a){let b=a.byteLength;return es.encodingLength(b)+b},eD=function(a){let b=new Uint8Array(es.encodingLength(a.byteLength));return es.encode(a.byteLength,b),new eb(b,a)},eE=function(a,b){let c=es.decode(a,b);return b+=es.encodingLength(c),a.slice(b,b+c)},eF=ex("bytes",X.LENGTH_DELIMITED,eD,eE,eC),eG=function(){return 8},eH=function(a){let b=new eb(new Uint8Array(eG(a)));return b.setFloat64(0,a,!0),b},eI=function(a,b){return a.getFloat64(b,!0)};function eJ(a){function b(b){if(null==a[b.toString()])throw Error("Invalid enum value");return"number"==typeof b?b:a[b]}let c=function(a){return es.encodingLength(b(a))},d=function(a){let c=b(a),d=new Uint8Array(es.encodingLength(c));return es.encode(c,d),d},e=function(b,c){let d=es.decode(b,c),e=d.toString();if(null==a[e])throw Error("Invalid enum value");return a[e]};return ex("enum",X.VARINT,d,e,c)}ex("double",X.BIT64,eH,eI,eG);let eK=function(){return 4},eL=function(a){let b=new eb(new Uint8Array(eK(a)));return b.setInt32(0,a,!0),b},eM=function(a,b){return a.getInt32(b,!0)};ex("fixed32",X.BIT32,eL,eM,eK);let eN=function(a){return 8},eO=function(a){let b=new eb(new Uint8Array(eN(a)));return b.setBigInt64(0,a,!0),b},eP=function(a,b){return a.getBigInt64(b,!0)};ex("fixed64",X.BIT64,eO,eP,eN);let eQ=function(){return 4},eR=function(a){let b=new eb(new Uint8Array(eQ(1)));return b.setFloat32(0,a,!0),b},eS=function(a,b){return a.getFloat32(b,!0)};ex("float",X.BIT32,eR,eS,eQ);let eT=function(a){return et.encodingLength(a)},eU=function(a){let b=new Uint8Array(eT(a));return et.encode(a,b),b},eV=function(a,b){return et.decode(a,b)},eW=ex("int32",X.VARINT,eU,eV,eT),eX=127n,eY={encodingLength(a){let b=0;for(;a>=128n;b++)a>>=7n;return b+1},encode(a,b){let c=ec(b),d=0;for(;eX<a;)c.set(d++,128|Number(a&eX)),a>>=7n;c.set(d,Number(a))},decode(a,b=0){return ee.fromBytes(a,b).toBigInt(!0)}},eZ={encodingLength(a){return a<0n?10:eY.encodingLength(a)},encode(a,b,c=0){if(a<0n){ee.fromBigInt(a).toBytes(b,c);return}return eY.encode(a,b)},decode(a,b=0){return ee.fromBytes(a,b).toBigInt(!1)}},e$={encodingLength(a){return eY.encodingLength(a>=0?2n*a:-(2n*a)-1n)},encode(a,b,c=0){ee.fromBigInt(a).zzEncode().toBytes(b,c)},decode(a,b=0){return ee.fromBytes(a,b).zzDecode().toBigInt(!1)}},e_=function(a){return eZ.encodingLength(a)},e0=function(a){let b=new Uint8Array(e_(a));return eZ.encode(a,b),b},e1=function(a,b){return 0n|eZ.decode(a,b)};function e2(a){let b=function(b){let c=0;for(let d of Object.values(a))c+=d.codec.encodingLength(b[d.name]);return es.encodingLength(c)+c},c=function(b){let c=new eb;function d(a,b,d){if(null==a){if(!0===d.optional)return;throw Error(`Non optional field "${d.name}" was ${null===a?"null":"undefined"}`)}let e=b<<3|d.codec.type,f=new Uint8Array(es.encodingLength(e));es.encode(e,f);let g=d.codec.encode(a);c.append(f),c.append(g)}for(let[e,f]of Object.entries(a)){let g=parseInt(e);if(!0===f.repeats){if(!Array.isArray(b[f.name]))throw Error(`Repeating field "${f.name}" was not an array`);for(let h of b[f.name])d(h,g,f)}else d(b[f.name],g,f)}let i=new Uint8Array(es.encodingLength(c.length));return es.encode(c.length,i),new eb(i,c)},d=function(b,c){let d=es.decode(b,c);c+=es.encodingLength(d);let e=c+d,f={};for(;c<e;){let g=es.decode(b,c);c+=es.encodingLength(g);let h=7&g,i=g>>3,j=a[i],k=0;if(h===X.VARINT){if(null!=j){let l=j.codec.decode(b,c);k=j.codec.encodingLength(l)}else{let m=es.decode(b,c);k=es.encodingLength(m)}}else if(h===X.BIT64)k=8;else if(h===X.LENGTH_DELIMITED){let n=es.decode(b,c);k=n+es.encodingLength(n)}else if(h===X.BIT32)k=4;else if(h===X.START_GROUP)throw Error("Unsupported wire type START_GROUP");else if(h===X.END_GROUP)throw Error("Unsupported wire type END_GROUP");if(null!=j){let o=j.codec.decode(b,c);!0===j.repeats?(null==f[j.name]&&(f[j.name]=[]),f[j.name].push(o)):f[j.name]=o}c+=k}for(let p of Object.values(a))!0===p.repeats&&null==f[p.name]&&(f[p.name]=[]);return f};return ex("message",X.LENGTH_DELIMITED,c,d,b)}ex("int64",X.VARINT,e0,e1,e_);let e3=function(){return 4},e4=function(a){let b=new eb(new Uint8Array(e3(a)));return b.setInt32(0,a,!0),b},e5=function(a,b){return a.getInt32(b,!0)};ex("sfixed32",X.BIT32,e4,e5,e3);let e6=function(){return 8},e7=function(a){let b=new eb(new Uint8Array(e6(a)));return b.setBigInt64(0,a,!0),b},e8=function(a,b){return a.getBigInt64(b,!0)};ex("sfixed64",X.BIT64,e7,e8,e6);let e9=function(a){return eu.encodingLength(a)},fa=function(a){let b=new Uint8Array(e9(a));return eu.encode(a,b),b},fb=function(a,b){return eu.decode(a,b)};ex("sint32",X.VARINT,fa,fb,e9);let fc=function(a){return e$.encodingLength(a)},fd=function(a){let b=new Uint8Array(fc(a));return e$.encode(a,b),b},fe=function(a,b){return e$.decode(a,b)};ex("sint64",X.VARINT,fd,fe,fc);let ff=function(a){let b=(0,cB.fromString)(a).byteLength;return es.encodingLength(b)+b},fg=function(a){let b=(0,cB.fromString)(a),c=new Uint8Array(es.encodingLength(b.byteLength));return es.encode(b.length,c),new eb(c,b)},fh=function(a,b){let c=es.decode(a,b);return b+=es.encodingLength(c),(0,cE.toString)(a.slice(b,b+c))},fi=ex("string",X.LENGTH_DELIMITED,fg,fh,ff),fj=function(a){return es.encodingLength(a)},fk=function(a){let b=new Uint8Array(fj(a));return es.encode(a,b),b},fl=function(a,b){return es.decode(a,b)};ex("uint32",X.VARINT,fk,fl,fj);let fm=function(a){return eY.encodingLength(a)},fn=function(a){let b=new Uint8Array(eY.encodingLength(a));return eY.encode(a,b),b},fo=function(a,b){return eY.decode(a,b)},fp=ex("uint64",X.VARINT,fn,fo,fm);(w7=Y||(Y={})).RSA="RSA",w7.Ed25519="Ed25519",w7.Secp256k1="Secp256k1",(w8=Z||(Z={}))[w8.RSA=0]="RSA",w8[w8.Ed25519=1]="Ed25519",w8[w8.Secp256k1=2]="Secp256k1",(w9=Y||(Y={})).codec=()=>eJ(Z),(xa=$||($={})).codec=()=>e2({1:{name:"Type",codec:Y.codec()},2:{name:"Data",codec:eF}}),xa.encode=a=>ew(a,xa.codec()),xa.decode=a=>ev(a,xa.codec()),(xb=_||(_={})).codec=()=>e2({1:{name:"Type",codec:Y.codec()},2:{name:"Data",codec:eF}}),xb.encode=a=>ew(a,xb.codec()),xb.decode=a=>ev(a,xb.codec()),c(3068),c(97450);var fq=c(3832),fr={get(a=globalThis){let b=a.crypto;if(null==b||null==b.subtle)throw Object.assign(Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return b}},fs={SHA1:20,SHA256:32,SHA512:64};let ft={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},fu=async(a,b)=>{let c=await fr.get().subtle.sign({name:"HMAC"},a,b);return new Uint8Array(c,0,c.byteLength)};var fv=c(97116);function fw(a,b){let c=Uint8Array.from(a.abs().toByteArray());if(c=0===c[0]?c.slice(1):c,null!=b){if(c.length>b)throw Error("byte array longer than desired length");c=(0,d7.concat)([new Uint8Array(b-c.length),c])}return(0,cE.toString)(c,"base64url")}function fx(a){let b=fy(a);return new fq.jsbn.BigInteger((0,cE.toString)(b,"base16"),16)}function fy(a,b){let c=(0,cB.fromString)(a,"base64urlpad");if(null!=b){if(c.length>b)throw Error("byte array longer than desired length");c=(0,d7.concat)([new Uint8Array(b-c.length),c])}return c}c(15764);let fz={"P-256":256,"P-384":384,"P-521":521},fA=Object.keys(fz),fB=fA.join(" / "),fC={"P-256":32,"P-384":48,"P-521":66};function fD(a){if(null==a.crv||null==a.x||null==a.y)throw a7(Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");if("P-256"!==a.crv&&"P-384"!==a.crv&&"P-521"!==a.crv)throw a7(Error(`Unknown curve: ${a.crv}. Must be ${fB}`),"ERR_INVALID_CURVE");let b=fC[a.crv];return(0,d7.concat)([Uint8Array.from([4]),fy(a.x,b),fy(a.y,b)],1+2*b)}function fE(a,b){if("P-256"!==a&&"P-384"!==a&&"P-521"!==a)throw a7(Error(`Unknown curve: ${a}. Must be ${fB}`),"ERR_INVALID_CURVE");let c=fC[a];if(!(0,dz.equals)(b.slice(0,1),Uint8Array.from([4])))throw a7(Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:a,x:(0,cE.toString)(b.slice(1,c+1),"base64url"),y:(0,cE.toString)(b.slice(1+c),"base64url"),ext:!0}}let fF=(a,b)=>({...fE(a,b.public),d:(0,cE.toString)(b.private,"base64url")});function fG(a){let b=a?.algorithm??"AES-GCM",c=a?.keyLength??16,d=a?.nonceLength??12,e=a?.digest??"SHA-256",f=a?.saltLength??16,g=a?.iterations??32767,h=fr.get();async function i(a,i){let j=h.getRandomValues(new Uint8Array(f)),k=h.getRandomValues(new Uint8Array(d)),l={name:b,iv:k};"string"==typeof i&&(i=(0,cB.fromString)(i));let m={name:"PBKDF2",salt:j,iterations:g,hash:{name:e}},n=await h.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),o=await h.subtle.deriveKey(m,n,{name:b,length:c},!0,["encrypt"]),p=await h.subtle.encrypt(l,o,a);return(0,d7.concat)([j,l.iv,new Uint8Array(p)])}async function j(a,i){let j=a.slice(0,f),k=a.slice(f,f+d),l=a.slice(f+d),m={name:b,iv:k};"string"==typeof i&&(i=(0,cB.fromString)(i));let n={name:"PBKDF2",salt:j,iterations:g,hash:{name:e}},o=await h.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),p=await h.subtle.deriveKey(n,o,{name:b,length:c},!0,["decrypt"]),q=await h.subtle.decrypt(m,p,l);return new Uint8Array(q)}c*=8;let k={encrypt:i,decrypt:j};return k}async function fH(a,b){let c=a5.base64.decode(a),d=fG();return await d.decrypt(c,b)}c(63219);var fI=c(1914);function fJ(a){if(isNaN(a)||a<=0)throw a7(Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return fI(a)}function fK(a){let b=fq.asn1.fromDer((0,cE.toString)(a,"ascii")),c=fq.pki.privateKeyFromAsn1(b);return{kty:"RSA",n:fw(c.n),e:fw(c.e),d:fw(c.d),p:fw(c.p),q:fw(c.q),dp:fw(c.dP),dq:fw(c.dQ),qi:fw(c.qInv),alg:"RS256"}}function fL(a){if(null==a.n||null==a.e||null==a.d||null==a.p||null==a.q||null==a.dp||null==a.dq||null==a.qi)throw a7(Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let b=fq.pki.privateKeyToAsn1({n:fx(a.n),e:fx(a.e),d:fx(a.d),p:fx(a.p),q:fx(a.q),dP:fx(a.dp),dQ:fx(a.dq),qInv:fx(a.qi)});return(0,cB.fromString)(fq.asn1.toDer(b).getBytes(),"ascii")}function fM(a){let b=fq.asn1.fromDer((0,cE.toString)(a,"ascii")),c=fq.pki.publicKeyFromAsn1(b);return{kty:"RSA",n:fw(c.n),e:fw(c.e)}}function fN(a){if(null==a.n||null==a.e)throw a7(Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let b=fq.pki.publicKeyToAsn1({n:fx(a.n),e:fx(a.e)});return(0,cB.fromString)(fq.asn1.toDer(b).getBytes(),"ascii")}function fO(a,b){return b.map(b=>fx(a[b]))}function fP(a){return fq.pki.setRsaPrivateKey(...fO(a,["n","e","d","p","q","dp","dq","qi"]))}function fQ(a){return fq.pki.setRsaPublicKey(...fO(a,["n","e"]))}async function fR(a){let b=await fr.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),c=await fV(b);return{privateKey:c[0],publicKey:c[1]}}async function fS(a){let b=await fr.get().subtle.importKey("jwk",a,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),c=[b,await fW(a)],d=await fV({privateKey:c[0],publicKey:c[1]});return{privateKey:d[0],publicKey:d[1]}}async function fT(a,b){let c=await fr.get().subtle.importKey("jwk",a,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),d=await fr.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},c,Uint8Array.from(b));return new Uint8Array(d,0,d.byteLength)}async function fU(a,b,c){let d=await fr.get().subtle.importKey("jwk",a,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await fr.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},d,b,c)}async function fV(a){if(null==a.privateKey||null==a.publicKey)throw a7(Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([fr.get().subtle.exportKey("jwk",a.privateKey),fr.get().subtle.exportKey("jwk",a.publicKey)])}async function fW(a){return await fr.get().subtle.importKey("jwk",{kty:a.kty,n:a.n,e:a.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function fX(a,b,c,d){let e=b?fQ(a):fP(a),f=(0,cE.toString)(Uint8Array.from(c),"ascii"),g=d(f,e);return(0,cB.fromString)(g,"ascii")}function fY(a,b){return fX(a,!0,b,(a,b)=>b.encrypt(a))}function fZ(a,b){return fX(a,!1,b,(a,b)=>b.decrypt(a))}async function f$(a,b){let c=fG(),d=await c.encrypt(a,b);return a5.base64.encode(d)}c(28095);class f_{constructor(a){this._key=a}async verify(a,b){return await fU(this._key,b,a)}marshal(){return fN(this._key)}get bytes(){return $.encode({Type:Y.RSA,Data:this.marshal()})}encrypt(a){return fY(this._key,a)}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}}class f0{constructor(a,b){this._key=a,this._publicKey=b}genSecret(){return fJ(16)}async sign(a){return await fT(this._key,a)}get public(){if(null==this._publicKey)throw a7(Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new f_(this._publicKey)}decrypt(a){return fZ(this._key,a)}marshal(){return fL(this._key)}get bytes(){return _.encode({Type:Y.RSA,Data:this.marshal()})}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}async id(){let a=await this.public.hash();return(0,cE.toString)(a,"base58btc")}async export(a,b="pkcs-8"){if("pkcs-8"===b){let c=new fq.util.ByteBuffer(this.marshal()),d=fq.asn1.fromDer(c),e=fq.pki.privateKeyFromAsn1(d),f={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return fq.pki.encryptRsaPrivateKey(e,a,f)}if("libp2p-key"===b)return await f$(this.bytes,a);throw a7(Error(`export format '${b}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}async function f1(a){let b=fK(a),c=await fS(b);return new f0(c.privateKey,c.publicKey)}function f2(a){let b=fM(a);return new f_(b)}async function f3(a){let b=await fS(a);return new f0(b.privateKey,b.publicKey)}async function f4(a){let b=await fR(a);return new f0(b.privateKey,b.publicKey)}var f5=c(7420),f6=c.t(f5,2);/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */ let f7=BigInt(0),f8=BigInt(1),f9=BigInt(2),ga=BigInt(255),gb=f9**BigInt(252)+BigInt("27742317777372353535851937790883648493"),gc=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:f9**ga-BigInt(19),l:gb,n:gb,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),gd=f9**BigInt(256),ge=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");let gf=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),gg=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),gh=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),gi=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class gj{constructor(a,b,c,d){this.x=a,this.y=b,this.z=c,this.t=d}static fromAffine(a){if(!(a instanceof gp))throw TypeError("ExtendedPoint#fromAffine: expected Point");return a.equals(gp.ZERO)?gj.ZERO:new gj(a.x,a.y,f8,gA(a.x*a.y))}static toAffineBatch(a){let b=gC(a.map(a=>a.z));return a.map((a,c)=>a.toAffine(b[c]))}static normalizeZ(a){return this.toAffineBatch(a).map(this.fromAffine)}equals(a){gk(a);let{x:b,y:c,z:d}=this,{x:e,y:f,z:g}=a,h=gA(b*g),i=gA(e*d),j=gA(c*g),k=gA(f*d);return h===i&&j===k}negate(){return new gj(gA(-this.x),this.y,this.z,gA(-this.t))}double(){let{x:a,y:b,z:c}=this,{a:d}=gc,e=gA(a**f9),f=gA(b**f9),g=gA(f9*gA(c**f9)),h=gA(d*e),i=gA(gA((a+b)**f9)-e-f),j=h+f,k=j-g,l=h-f,m=gA(i*k),n=gA(j*l),o=gA(i*l),p=gA(k*j);return new gj(m,n,p,o)}add(a){gk(a);let{x:b,y:c,z:d,t:e}=this,{x:f,y:g,z:h,t:i}=a,j=gA((c-b)*(g+f)),k=gA((c+b)*(g-f)),l=gA(k-j);if(l===f7)return this.double();let m=gA(d*f9*i),n=gA(e*f9*h),o=n+m,p=k+j,q=n-m,r=gA(o*l),s=gA(p*q),t=gA(o*q),u=gA(l*p);return new gj(r,s,u,t)}subtract(a){return this.add(a.negate())}precomputeWindow(a){let b=1+256/a,c=[],d=this,e=d;for(let f=0;f<b;f++){e=d,c.push(e);for(let g=1;g<2**(a-1);g++)e=e.add(d),c.push(e);d=e.double()}return c}wNAF(a,b){!b&&this.equals(gj.BASE)&&(b=gp.BASE);let c=b&&b._WINDOW_SIZE||1;if(256%c)throw Error("Point#wNAF: Invalid precomputation window, must be power of 2");let d=b&&go.get(b);!d&&(d=this.precomputeWindow(c),b&&1!==c&&(d=gj.normalizeZ(d),go.set(b,d)));let e=gj.ZERO,f=gj.ZERO,g=1+256/c,h=2**(c-1),i=BigInt(2**c-1),j=2**c,k=BigInt(c);for(let l=0;l<g;l++){let m=l*h,n=Number(a&i);if(a>>=k,n>h&&(n-=j,a+=f8),0===n){let o=d[m];l%2&&(o=o.negate()),f=f.add(o)}else{let p=d[m+Math.abs(n)-1];n<0&&(p=p.negate()),e=e.add(p)}}return gj.normalizeZ([e,f])[0]}multiply(a,b){return this.wNAF(gK(a,gc.l),b)}multiplyUnsafe(a){let b=gK(a,gc.l,!1),c=gj.BASE,d=gj.ZERO;if(b===f7)return d;if(this.equals(d)||b===f8)return this;if(this.equals(c))return this.wNAF(b);let e=d,f=this;for(;b>f7;)b&f8&&(e=e.add(f)),f=f.double(),b>>=f8;return e}isSmallOrder(){return this.multiplyUnsafe(gc.h).equals(gj.ZERO)}isTorsionFree(){return this.multiplyUnsafe(gc.l).equals(gj.ZERO)}toAffine(a=gB(this.z)){let{x:b,y:c,z:d}=this,e=gA(b*a),f=gA(c*a),g=gA(d*a);if(g!==f8)throw Error("invZ was invalid");return new gp(e,f)}fromRistrettoBytes(){gm()}toRistrettoBytes(){gm()}fromRistrettoHash(){gm()}}function gk(a){if(!(a instanceof gj))throw TypeError("ExtendedPoint expected")}function gl(a){if(!(a instanceof gn))throw TypeError("RistrettoPoint expected")}function gm(){throw Error("Legacy method: switch to RistrettoPoint")}gj.BASE=new gj(gc.Gx,gc.Gy,f8,gA(gc.Gx*gc.Gy)),gj.ZERO=new gj(f7,f8,f8,f7);class gn{constructor(a){this.ep=a}static calcElligatorRistrettoMap(a){let{d:b}=gc,c=gA(ge*a*a),d=gA((c+f8)*gh),e=BigInt(-1),f=gA((e-b*c)*gA(c+b)),{isValid:g,value:h}=gF(d,f),i=gA(h*a);gx(i)||(i=gA(-i)),g||(h=i),g||(e=c);let j=gA(e*(c-f8)*gi-f),k=h*h,l=gA((h+h)*f),m=gA(j*gf),n=gA(f8-k),o=gA(f8+k);return new gj(gA(l*o),gA(n*m),gA(m*o),gA(l*n))}static hashToCurve(a){a=gJ(a,64);let b=gz(a.slice(0,32)),c=this.calcElligatorRistrettoMap(b),d=gz(a.slice(32,64)),e=this.calcElligatorRistrettoMap(d);return new gn(c.add(e))}static fromHex(a){a=gJ(a,32);let{a:b,d:c}=gc,d="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",e=gz(a);if(!gI(gw(e),a)||gx(e))throw Error(d);let f=gA(e*e),g=gA(f8+b*f),h=gA(f8-b*f),i=gA(g*g),j=gA(h*h),k=gA(b*c*i-j),{isValid:l,value:m}=gG(gA(k*j)),n=gA(m*h),o=gA(m*n*k),p=gA((e+e)*n);gx(p)&&(p=gA(-p));let q=gA(g*o),r=gA(p*q);if(!l||gx(r)||q===f7)throw Error(d);return new gn(new gj(p,q,f8,r))}toRawBytes(){let{x:a,y:b,z:c,t:d}=this.ep,e=gA(gA(c+b)*gA(c-b)),f=gA(a*b),{value:g}=gG(gA(e*f**f9)),h=gA(g*e),i=gA(g*f),j=gA(h*i*d),k;if(gx(d*j)){let l=gA(b*ge),m=gA(a*ge);a=l,b=m,k=gA(h*gg)}else k=i;gx(a*j)&&(b=gA(-b));let n=gA((c-b)*k);return gx(n)&&(n=gA(-n)),gw(n)}toHex(){return gt(this.toRawBytes())}toString(){return this.toHex()}equals(a){gl(a);let b=this.ep,c=a.ep,d=gA(b.x*c.y)===gA(b.y*c.x),e=gA(b.y*c.y)===gA(b.x*c.x);return d||e}add(a){return gl(a),new gn(this.ep.add(a.ep))}subtract(a){return gl(a),new gn(this.ep.subtract(a.ep))}multiply(a){return new gn(this.ep.multiply(a))}multiplyUnsafe(a){return new gn(this.ep.multiplyUnsafe(a))}}gn.BASE=new gn(gj.BASE),gn.ZERO=new gn(gj.ZERO);let go=new WeakMap;class gp{constructor(a,b){this.x=a,this.y=b}_setWindowSize(a){this._WINDOW_SIZE=a,go.delete(this)}static fromHex(a,b=!0){let{d:c,P:d}=gc;a=gJ(a,32);let e=a.slice();e[31]=-129&a[31];let f=gy(e);if(b&&f>=d)throw Error("Expected 0 < hex < P");if(!b&&f>=gd)throw Error("Expected 0 < hex < 2**256");let g=gA(f*f),h=gA(g-f8),i=gA(c*g+f8),{isValid:j,value:k}=gF(h,i);if(!j)throw Error("Point.fromHex: invalid y coordinate");let l=(k&f8)===f8,m=(128&a[31])!=0;return m!==l&&(k=gA(-k)),new gp(k,f)}static async fromPrivateKey(a){return(await gR(a)).point}toRawBytes(){let a=gw(this.y);return a[31]|=this.x&f8?128:0,a}toHex(){return gt(this.toRawBytes())}toX25519(){let{y:a}=this,b=gA((f8+a)*gB(f8-a));return gw(b)}isTorsionFree(){return gj.fromAffine(this).isTorsionFree()}equals(a){return this.x===a.x&&this.y===a.y}negate(){return new gp(gA(-this.x),this.y)}add(a){return gj.fromAffine(this).add(gj.fromAffine(a)).toAffine()}subtract(a){return this.add(a.negate())}multiply(a){return gj.fromAffine(this).multiply(a,this).toAffine()}}gp.BASE=new gp(gc.Gx,gc.Gy),gp.ZERO=new gp(f7,f8);class gq{constructor(a,b){this.r=a,this.s=b,this.assertValidity()}static fromHex(a){let b=gJ(a,64),c=gp.fromHex(b.slice(0,32),!1),d=gy(b.slice(32,64));return new gq(c,d)}assertValidity(){let{r:a,s:b}=this;if(!(a instanceof gp))throw Error("Expected Point instance");return gK(b,gc.l,!1),this}toRawBytes(){let a=new Uint8Array(64);return a.set(this.r.toRawBytes()),a.set(gw(this.s),32),a}toHex(){return gt(this.toRawBytes())}}function gr(...a){if(!a.every(a=>a instanceof Uint8Array))throw Error("Expected Uint8Array list");if(1===a.length)return a[0];let b=a.reduce((a,b)=>a+b.length,0),c=new Uint8Array(b);for(let d=0,e=0;d<a.length;d++){let f=a[d];c.set(f,e),e+=f.length}return c}let gs=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function gt(a){if(!(a instanceof Uint8Array))throw Error("Uint8Array expected");let b="";for(let c=0;c<a.length;c++)b+=gs[a[c]];return b}function gu(a){if("string"!=typeof a)throw TypeError("hexToBytes: expected string, got "+typeof a);if(a.length%2)throw Error("hexToBytes: received invalid unpadded hex");let b=new Uint8Array(a.length/2);for(let c=0;c<b.length;c++){let d=2*c,e=a.slice(d,d+2),f=Number.parseInt(e,16);if(Number.isNaN(f)||f<0)throw Error("Invalid byte sequence");b[c]=f}return b}function gv(a){let b=32,c=a.toString(16).padStart(2*b,"0");return gu(c)}function gw(a){return gv(a).reverse()}function gx(a){return(gA(a)&f8)===f8}function gy(a){if(!(a instanceof Uint8Array))throw Error("Expected Uint8Array");return BigInt("0x"+gt(Uint8Array.from(a).reverse()))}function gz(a){return gA(gy(a)&f9**ga-f8)}function gA(a,b=gc.P){let c=a%b;return c>=f7?c:b+c}function gB(a,b=gc.P){if(a===f7||b<=f7)throw Error(`invert: expected positive integers, got n=${a} mod=${b}`);let c=gA(a,b),d=b,e=f7,f=f8,g=f8,h=f7;for(;c!==f7;){let i=d/c,j=d%c,k=e-g*i,l=f-h*i;d=c,c=j,e=g,f=h,g=k,h=l}let m=d;if(m!==f8)throw Error("invert: does not exist");return gA(e,b)}function gC(a,b=gc.P){let c=Array(a.length),d=a.reduce((a,d,e)=>d===f7?a:(c[e]=a,gA(a*d,b)),f8),e=gB(d,b);return a.reduceRight((a,d,e)=>d===f7?a:(c[e]=gA(a*c[e],b),gA(a*d,b)),e),c}function gD(a,b){let{P:c}=gc,d=a;for(;(b--)>f7;)d*=d,d%=c;return d}function gE(a){let{P:b}=gc,c=BigInt(5),d=BigInt(10),e=BigInt(20),f=BigInt(40),g=BigInt(80),h=a*a%b,i=h*a%b,j=gD(i,f9)*i%b,k=gD(j,f8)*a%b,l=gD(k,c)*k%b,m=gD(l,d)*l%b,n=gD(m,e)*m%b,o=gD(n,f)*n%b,p=gD(o,g)*o%b,q=gD(p,g)*o%b,r=gD(q,d)*l%b,s=gD(r,f9)*a%b;return{pow_p_5_8:s,b2:i}}function gF(a,b){let c=gA(b*b*b),d=gA(c*c*b),e=gE(a*d).pow_p_5_8,f=gA(a*c*e),g=gA(b*f*f),h=f,i=gA(f*ge),j=g===a,k=g===gA(-a),l=g===gA(-a*ge);return j&&(f=h),(k||l)&&(f=i),gx(f)&&(f=gA(-f)),{isValid:j||k,value:f}}function gG(a){return gF(f8,a)}function gH(a){return gA(gy(a),gc.l)}function gI(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function gJ(a,b){let c=a instanceof Uint8Array?Uint8Array.from(a):gu(a);if("number"==typeof b&&c.length!==b)throw Error(`Expected ${b} bytes`);return c}function gK(a,b,c=!0){if(!b)throw TypeError("Specify max value");if("number"==typeof a&&Number.isSafeInteger(a)&&(a=BigInt(a)),"bigint"==typeof a&&a<b){if(c){if(f7<a)return a}else if(f7<=a)return a}throw TypeError("Expected valid scalar: 0 < scalar < max")}function gL(a){return a[0]&=248,a[31]&=127,a[31]|=64,a}function gM(a){return gy(gL(gJ(a,32)))}function gN(a){if(32!==(a="bigint"==typeof a||"number"==typeof a?gv(gK(a,gd)):gJ(a)).length)throw Error("Expected 32 bytes");return a}function gO(a){let b=gL(a.slice(0,32)),c=a.slice(32,64),d=gH(b),e=gp.BASE.multiply(d),f=e.toRawBytes();return{head:b,prefix:c,scalar:d,point:e,pointBytes:f}}let gP;function gQ(...a){if("function"!=typeof gP)throw Error("utils.sha512Sync must be set to use sync methods");return gP(...a)}async function gR(a){return gO(await g2.sha512(gN(a)))}function gS(a){return gO(gQ(gN(a)))}async function gT(a){return(await gR(a)).pointBytes}async function gU(a,b){a=gJ(a);let{prefix:c,scalar:d,pointBytes:e}=await gR(b),f=gH(await g2.sha512(c,a)),g=gp.BASE.multiply(f),h=gH(await g2.sha512(g.toRawBytes(),e,a)),i=gA(f+h*d,gc.l);return new gq(g,i).toRawBytes()}function gV(a,b,c){b=gJ(b),c instanceof gp||(c=gp.fromHex(c,!1));let{r:d,s:e}=a instanceof gq?a.assertValidity():gq.fromHex(a),f=gj.BASE.multiplyUnsafe(e);return{r:d,s:e,SB:f,pub:c,msg:b}}function gW(a,b,c,d){let e=gH(d),f=gj.fromAffine(a).multiplyUnsafe(e),g=gj.fromAffine(b).add(f);return g.subtract(c).multiplyUnsafe(gc.h).equals(gj.ZERO)}async function gX(a,b,c){let{r:d,SB:e,msg:f,pub:g}=gV(a,b,c),h=await g2.sha512(d.toRawBytes(),g.toRawBytes(),f);return gW(g,d,e,h)}function gY(a,b,c){let d=gA(a*(b-c));return b=gA(b-d),c=gA(c+d),[b,c]}function gZ(a,b){let{P:c}=gc,d=gK(a,c),e=gK(b,c),f=BigInt(121665),g=d,h=f8,i=f7,j=d,k=f8,l=f7,m;for(let n=BigInt(254);n>=f7;n--){let o=e>>n&f8;l^=o,h=(m=gY(l,h,j))[0],j=m[1],m=gY(l,i,k),i=m[0],k=m[1],l=o;let p=h+i,q=gA(p*p),r=h-i,s=gA(r*r),t=q-s,u=j+k,v=j-k,w=gA(v*p),x=gA(u*r);j=gA((w+x)**f9),k=gA(g*(w-x)**f9),h=gA(q*s),i=gA(t*(q+gA(f*t)))}h=(m=gY(l,h,j))[0],j=m[1],m=gY(l,i,k),i=m[0],k=m[1];let{pow_p_5_8:y,b2:z}=gE(i),A=gA(gD(y,BigInt(3))*z);return gA(h*A)}function g$(a){return gw(gA(a,gc.P))}function g_(a){let b=gJ(a,32);return b[31]&=127,gy(b)}gp.BASE._setWindowSize(8);let g0={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(a,b){let c=g_(b),d=gM(a),e=gZ(c,d);if(e===f7)throw Error("Invalid private or public key received");return g$(e)},scalarMultBase(a){return g0.scalarMult(a,g0.BASE_POINT_U)}},g1={node:f6,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},g2={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa",],bytesToHex:gt,hexToBytes:gu,concatBytes:gr,getExtendedPublicKey:gR,mod:gA,invert:gB,hashToPrivateScalar:a=>{if((a=gJ(a)).length<40||a.length>1024)throw Error("Expected 40-1024 bytes of private key as per FIPS 186");return gA(gy(a),gc.l-f8)+f8},randomBytes:(a=32)=>{if(g1.web)return g1.web.getRandomValues(new Uint8Array(a));if(g1.node){let{randomBytes:b}=g1.node;return new Uint8Array(b(a).buffer)}throw Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>g2.randomBytes(32),sha512:async(...a)=>{let b=gr(...a);if(g1.web){let c=await g1.web.subtle.digest("SHA-512",b.buffer);return new Uint8Array(c)}if(g1.node)return Uint8Array.from(g1.node.createHash("sha512").update(b).digest());throw Error("The environment doesn't have sha512 function")},precompute(a=8,b=gp.BASE){let c=b.equals(gp.BASE)?b:new gp(b.x,b.y);return c._setWindowSize(a),c.multiply(f9),c},sha512Sync:void 0};Object.defineProperties(g2,{sha512Sync:{configurable:!1,get(){return gP},set(a){gP||(gP=a)}}});let g3=32,g4=64,g5=32;async function g6(){let a=g2.randomPrivateKey(),b=await gT(a),c=ha(a,b);return{privateKey:c,publicKey:b}}async function g7(a){if(a.length!==g5)throw TypeError('"seed" must be 32 bytes in length.');if(!(a instanceof Uint8Array))throw TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let b=a,c=await gT(b),d=ha(b,c);return{privateKey:d,publicKey:c}}async function g8(a,b){let c=a.slice(0,g5);return await gU(b,c)}async function g9(a,b,c){return await gX(b,c,a)}function ha(a,b){let c=new Uint8Array(g4);for(let d=0;d<g5;d++)c[d]=a[d],c[g5+d]=b[d];return c}class hb{constructor(a){this._key=hh(a,g3)}async verify(a,b){return await g9(this._key,b,a)}marshal(){return this._key}get bytes(){return $.encode({Type:Y.Ed25519,Data:this.marshal()})}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}}class hc{constructor(a,b){this._key=hh(a,g4),this._publicKey=hh(b,g3)}async sign(a){return await g8(this._key,a)}get public(){return new hb(this._publicKey)}marshal(){return this._key}get bytes(){return _.encode({Type:Y.Ed25519,Data:this.marshal()})}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}async id(){let a=await cr.identity.digest(this.public.bytes);return a3.base58btc.encode(a.bytes).substring(1)}async export(a,b="libp2p-key"){if("libp2p-key"===b)return await f$(this.bytes,a);throw a7(Error(`export format '${b}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function hd(a){if(a.length>g4){a=hh(a,g4+g3);let b=a.slice(0,g4),c=a.slice(g4,a.length);return new hc(b,c)}a=hh(a,g4);let d=a.slice(0,g4),e=a.slice(g3);return new hc(d,e)}function he(a){return a=hh(a,g3),new hb(a)}async function hf(){let{privateKey:a,publicKey:b}=await g6();return new hc(a,b)}async function hg(a){let{privateKey:b,publicKey:c}=await g7(a);return new hc(b,c)}function hh(a,b){if((a=Uint8Array.from(a??[])).length!==b)throw a7(Error(`Key must be a Uint8Array of length ${b}, got ${a.length}`),"ERR_INVALID_KEY_TYPE");return a}var hi=c(95856),hj=c.t(hi,2);/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */ let hk=BigInt(0),hl=BigInt(1),hm=BigInt(2),hn=BigInt(3),ho=BigInt(8),hp=hm**BigInt(256),hq={a:hk,b:BigInt(7),P:hp-hm**BigInt(32)-BigInt(977),n:hp-BigInt("432420386565659656852420866394968145599"),h:hl,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function hr(a){let{a:b,b:c}=hq,d=hM(a*a),e=hM(d*a);return hM(e+b*a+c)}let hs=hq.a===hk;class ht{constructor(a,b,c){this.x=a,this.y=b,this.z=c}static fromAffine(a){if(!(a instanceof hv))throw TypeError("JacobianPoint#fromAffine: expected Point");return new ht(a.x,a.y,hl)}static toAffineBatch(a){let b=hQ(a.map(a=>a.z));return a.map((a,c)=>a.toAffine(b[c]))}static normalizeZ(a){return ht.toAffineBatch(a).map(ht.fromAffine)}equals(a){if(!(a instanceof ht))throw TypeError("JacobianPoint expected");let{x:b,y:c,z:d}=this,{x:e,y:f,z:g}=a,h=hM(d**hm),i=hM(g**hm),j=hM(b*i),k=hM(e*h),l=hM(hM(c*g)*i),m=hM(hM(f*d)*h);return j===k&&l===m}negate(){return new ht(this.x,hM(-this.y),this.z)}double(){let{x:a,y:b,z:c}=this,d=hM(a**hm),e=hM(b**hm),f=hM(e**hm),g=hM(hm*(hM((a+e)**hm)-d-f)),h=hM(hn*d),i=hM(h**hm),j=hM(i-hm*g),k=hM(h*(g-j)-ho*f),l=hM(hm*b*c);return new ht(j,k,l)}add(a){if(!(a instanceof ht))throw TypeError("JacobianPoint expected");let{x:b,y:c,z:d}=this,{x:e,y:f,z:g}=a;if(e===hk||f===hk)return this;if(b===hk||c===hk)return a;let h=hM(d**hm),i=hM(g**hm),j=hM(b*i),k=hM(e*h),l=hM(hM(c*g)*i),m=hM(hM(f*d)*h),n=hM(k-j),o=hM(m-l);if(n===hk)return o===hk?this.double():ht.ZERO;let p=hM(n**hm),q=hM(n*p),r=hM(j*p),s=hM(o**hm-q-hm*r),t=hM(o*(r-s)-l*q),u=hM(d*g*n);return new ht(s,t,u)}subtract(a){return this.add(a.negate())}multiplyUnsafe(a){let b=ht.ZERO;if("bigint"==typeof a&&a===hk)return b;let c=hL(a);if(c===hl)return this;if(!hs){let d=b,e=this;for(;c>hk;)c&hl&&(d=d.add(e)),e=e.double(),c>>=hl;return d}let{k1neg:f,k1:g,k2neg:h,k2:i}=hT(c),j=b,k=b,l=this;for(;g>hk||i>hk;)g&hl&&(j=j.add(l)),i&hl&&(k=k.add(l)),l=l.double(),g>>=hl,i>>=hl;return f&&(j=j.negate()),h&&(k=k.negate()),k=new ht(hM(k.x*hq.beta),k.y,k.z),j.add(k)}precomputeWindow(a){let b=hs?128/a+1:256/a+1,c=[],d=this,e=d;for(let f=0;f<b;f++){e=d,c.push(e);for(let g=1;g<2**(a-1);g++)e=e.add(d),c.push(e);d=e.double()}return c}wNAF(a,b){!b&&this.equals(ht.BASE)&&(b=hv.BASE);let c=b&&b._WINDOW_SIZE||1;if(256%c)throw Error("Point#wNAF: Invalid precomputation window, must be power of 2");let d=b&&hu.get(b);!d&&(d=this.precomputeWindow(c),b&&1!==c&&(d=ht.normalizeZ(d),hu.set(b,d)));let e=ht.ZERO,f=ht.ZERO,g=1+(hs?128/c:256/c),h=2**(c-1),i=BigInt(2**c-1),j=2**c,k=BigInt(c);for(let l=0;l<g;l++){let m=l*h,n=Number(a&i);if(a>>=k,n>h&&(n-=j,a+=hl),0===n){let o=d[m];l%2&&(o=o.negate()),f=f.add(o)}else{let p=d[m+Math.abs(n)-1];n<0&&(p=p.negate()),e=e.add(p)}}return{p:e,f}}multiply(a,b){let c=hL(a),d,e;if(hs){let{k1neg:f,k1:g,k2neg:h,k2:i}=hT(c),{p:j,f:k}=this.wNAF(g,b),{p:l,f:m}=this.wNAF(i,b);f&&(j=j.negate()),h&&(l=l.negate()),l=new ht(hM(l.x*hq.beta),l.y,l.z),d=j.add(l),e=k.add(m)}else{let{p:n,f:o}=this.wNAF(c,b);d=n,e=o}return ht.normalizeZ([d,e])[0]}toAffine(a=hP(this.z)){let{x:b,y:c,z:d}=this,e=a,f=hM(e*e),g=hM(f*e),h=hM(b*f),i=hM(c*g),j=hM(d*e);if(j!==hl)throw Error("invZ was invalid");return new hv(h,i)}}ht.BASE=new ht(hq.Gx,hq.Gy,hl),ht.ZERO=new ht(hk,hl,hk);let hu=new WeakMap;class hv{constructor(a,b){this.x=a,this.y=b}_setWindowSize(a){this._WINDOW_SIZE=a,hu.delete(this)}static fromCompressedHex(a){let b=32===a.length,c=hJ(b?a:a.subarray(1));if(!hX(c))throw Error("Point is not on curve");let d=hr(c),e=hO(d),f=(e&hl)===hl;if(b)f&&(e=hM(-e));else{let g=(1&a[0])==1;g!==f&&(e=hM(-e))}let h=new hv(c,e);return h.assertValidity(),h}static fromUncompressedHex(a){let b=hJ(a.subarray(1,33)),c=hJ(a.subarray(33,65)),d=new hv(b,c);return d.assertValidity(),d}static fromHex(a){let b=hK(a),c=b.length,d=b[0];if(32===c||33===c&&(2===d||3===d))return this.fromCompressedHex(b);if(65===c&&4===d)return this.fromUncompressedHex(b);throw Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${c}`)}static fromPrivateKey(a){return hv.BASE.multiply(hZ(a))}static fromSignature(a,b,c){a=hK(a);let d=hU(a),{r:e,s:f}=h_(b);if(0!==c&&1!==c)throw Error("Cannot recover signature: invalid recovery bit");let g=1&c?"03":"02",h=hv.fromHex(g+hE(e)),{n:i}=hq,j=hP(e,i),k=hM(-d*j,i),l=hM(f*j,i),m=hv.BASE.multiplyAndAddUnsafe(h,k,l);if(!m)throw Error("Cannot recover signature: point at infinify");return m.assertValidity(),m}toRawBytes(a=!1){return hI(this.toHex(a))}toHex(a=!1){let b=hE(this.x);if(!a)return`04${b}${hE(this.y)}`;{let c=this.y&hl?"03":"02";return`${c}${b}`}}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let a="Point is not on elliptic curve",{x:b,y:c}=this;if(!hX(b)||!hX(c))throw Error(a);let d=hM(c*c),e=hr(b);if(hM(d-e)!==hk)throw Error(a)}equals(a){return this.x===a.x&&this.y===a.y}negate(){return new hv(this.x,hM(-this.y))}double(){return ht.fromAffine(this).double().toAffine()}add(a){return ht.fromAffine(this).add(ht.fromAffine(a)).toAffine()}subtract(a){return this.add(a.negate())}multiply(a){return ht.fromAffine(this).multiply(a,this).toAffine()}multiplyAndAddUnsafe(a,b,c){let d=ht.fromAffine(this),e=b===hk||b===hl||this!==hv.BASE?d.multiplyUnsafe(b):d.multiply(b),f=ht.fromAffine(a).multiplyUnsafe(c),g=e.add(f);return g.equals(ht.ZERO)?void 0:g.toAffine()}}function hw(a){return Number.parseInt(a[0],16)>=8?"00"+a:a}function hx(a){if(a.length<2||2!==a[0])throw Error(`Invalid signature integer tag: ${hD(a)}`);let b=a[1],c=a.subarray(2,b+2);if(!b||c.length!==b)throw Error("Invalid signature integer: wrong length");if(0===c[0]&&c[1]<=127)throw Error("Invalid signature integer: trailing length");return{data:hJ(c),left:a.subarray(b+2)}}function hy(a){if(a.length<2||48!=a[0])throw Error(`Invalid signature tag: ${hD(a)}`);if(a[1]!==a.length-2)throw Error("Invalid signature: incorrect length");let{data:b,left:c}=hx(a.subarray(2)),{data:d,left:e}=hx(c);if(e.length)throw Error(`Invalid signature: left bytes after parsing: ${hD(e)}`);return{r:b,s:d}}hv.BASE=new hv(hq.Gx,hq.Gy),hv.ZERO=new hv(hk,hk);class hz{constructor(a,b){this.r=a,this.s=b,this.assertValidity()}static fromCompact(a){let b=hB(a),c="Signature.fromCompact";if("string"!=typeof a&&!b)throw TypeError(`${c}: Expected string or Uint8Array`);let d=b?hD(a):a;if(128!==d.length)throw Error(`${c}: Expected 64-byte hex`);return new hz(hH(d.slice(0,64)),hH(d.slice(64,128)))}static fromDER(a){let b=hB(a);if("string"!=typeof a&&!b)throw TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:c,s:d}=hy(b?a:hI(a));return new hz(c,d)}static fromHex(a){return this.fromDER(a)}assertValidity(){let{r:a,s:b}=this;if(!hW(a))throw Error("Invalid Signature: r must be 0 < r < n");if(!hW(b))throw Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let a=hq.n>>hl;return this.s>a}normalizeS(){return this.hasHighS()?new hz(this.r,hq.n-this.s):this}toDERRawBytes(a=!1){return hI(this.toDERHex(a))}toDERHex(a=!1){let b=hw(hG(this.s));if(a)return b;let c=hw(hG(this.r)),d=hG(c.length/2),e=hG(b.length/2),f=hG(c.length/2+b.length/2+4);return`30${f}02${d}${c}02${e}${b}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return hI(this.toCompactHex())}toCompactHex(){return hE(this.r)+hE(this.s)}}function hA(...a){if(!a.every(hB))throw Error("Uint8Array list expected");if(1===a.length)return a[0];let b=a.reduce((a,b)=>a+b.length,0),c=new Uint8Array(b);for(let d=0,e=0;d<a.length;d++){let f=a[d];c.set(f,e),e+=f.length}return c}function hB(a){return a instanceof Uint8Array}let hC=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function hD(a){if(!(a instanceof Uint8Array))throw Error("Expected Uint8Array");let b="";for(let c=0;c<a.length;c++)b+=hC[a[c]];return b}function hE(a){if(a>hp)throw Error("Expected number < 2^256");return a.toString(16).padStart(64,"0")}function hF(a){return hI(hE(a))}function hG(a){let b=a.toString(16);return 1&b.length?`0${b}`:b}function hH(a){if("string"!=typeof a)throw TypeError("hexToNumber: expected string, got "+typeof a);return BigInt(`0x${a}`)}function hI(a){if("string"!=typeof a)throw TypeError("hexToBytes: expected string, got "+typeof a);if(a.length%2)throw Error("hexToBytes: received invalid unpadded hex"+a.length);let b=new Uint8Array(a.length/2);for(let c=0;c<b.length;c++){let d=2*c,e=a.slice(d,d+2),f=Number.parseInt(e,16);if(Number.isNaN(f)||f<0)throw Error("Invalid byte sequence");b[c]=f}return b}function hJ(a){return hH(hD(a))}function hK(a){return a instanceof Uint8Array?Uint8Array.from(a):hI(a)}function hL(a){if("number"==typeof a&&Number.isSafeInteger(a)&&a>0)return BigInt(a);if("bigint"==typeof a&&hW(a))return a;throw TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function hM(a,b=hq.P){let c=a%b;return c>=hk?c:b+c}function hN(a,b){let{P:c}=hq,d=a;for(;(b--)>hk;)d*=d,d%=c;return d}function hO(a){let{P:b}=hq,c=BigInt(6),d=BigInt(11),e=BigInt(22),f=BigInt(23),g=BigInt(44),h=BigInt(88),i=a*a*a%b,j=i*i*a%b,k=hN(j,hn)*j%b,l=hN(k,hn)*j%b,m=hN(l,hm)*i%b,n=hN(m,d)*m%b,o=hN(n,e)*n%b,p=hN(o,g)*o%b,q=hN(p,h)*p%b,r=hN(q,g)*o%b,s=hN(r,hn)*j%b,t=hN(s,f)*n%b,u=hN(t,c)*i%b;return hN(u,hm)}function hP(a,b=hq.P){if(a===hk||b<=hk)throw Error(`invert: expected positive integers, got n=${a} mod=${b}`);let c=hM(a,b),d=b,e=hk,f=hl,g=hl,h=hk;for(;c!==hk;){let i=d/c,j=d%c,k=e-g*i,l=f-h*i;d=c,c=j,e=g,f=h,g=k,h=l}let m=d;if(m!==hl)throw Error("invert: does not exist");return hM(e,b)}function hQ(a,b=hq.P){let c=Array(a.length),d=a.reduce((a,d,e)=>d===hk?a:(c[e]=a,hM(a*d,b)),hl),e=hP(d,b);return a.reduceRight((a,d,e)=>d===hk?a:(c[e]=hM(a*c[e],b),hM(a*d,b)),e),c}let hR=(a,b)=>(a+b/hm)/b,hS=hm**BigInt(128);function hT(a){let{n:b}=hq,c=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),d=-hl*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),e=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),f=c,g=hR(f*a,b),h=hR(-d*a,b),i=hM(a-g*c-h*e,b),j=hM(-g*d-h*f,b),k=i>hS,l=j>hS;if(k&&(i=b-i),l&&(j=b-j),i>hS||j>hS)throw Error("splitScalarEndo: Endomorphism failed, k="+a);return{k1neg:k,k1:i,k2neg:l,k2:j}}function hU(a){let{n:b}=hq,c=a.length,d=8*c-256,e=hJ(a);return d>0&&(e>>=BigInt(d)),e>=b&&(e-=b),e}class hV{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...a){return ip.hmacSha256(this.k,...a)}hmacSync(...a){if("function"!=typeof ip.hmacSha256Sync)throw Error("utils.hmacSha256Sync is undefined, you need to set it");let b=ip.hmacSha256Sync(this.k,...a);if(b instanceof Promise)throw Error("To use sync sign(), ensure utils.hmacSha256 is sync");return b}incr(){if(this.counter>=1e3)throw Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(a=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),a),this.v=await this.hmac(this.v),0!==a.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),a),this.v=await this.hmac(this.v))}reseedSync(a=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),a),this.v=this.hmacSync(this.v),0!==a.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),a),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}}function hW(a){return hk<a&&a<hq.n}function hX(a){return hk<a&&a<hq.P}function hY(a,b,c){let d=hJ(a);if(!hW(d))return;let{n:e}=hq,f=hv.BASE.multiply(d),g=hM(f.x,e);if(g===hk)return;let h=hM(hP(d,e)*hM(b+c*g,e),e);if(h===hk)return;let i=new hz(g,h),j=(f.x===i.r?0:2)|Number(f.y&hl);return{sig:i,recovery:j}}function hZ(a){let b;if("bigint"==typeof a)b=a;else if("number"==typeof a&&Number.isSafeInteger(a)&&a>0)b=BigInt(a);else if("string"==typeof a){if(64!==a.length)throw Error("Expected 32 bytes of private key");b=hH(a)}else if(hB(a)){if(32!==a.length)throw Error("Expected 32 bytes of private key");b=hJ(a)}else throw TypeError("Expected valid private key");if(!hW(b))throw Error("Expected private key: 0 < key < n");return b}function h$(a){return a instanceof hv?(a.assertValidity(),a):hv.fromHex(a)}function h_(a){if(a instanceof hz)return a.assertValidity(),a;try{return hz.fromDER(a)}catch(b){return hz.fromCompact(a)}}function h0(a,b=!1){return hv.fromPrivateKey(a).toRawBytes(b)}function h1(a){let b=a.length>32?a.slice(0,32):a;return hJ(b)}function h2(a){let b=h1(a),c=hM(b,hq.n);return h3(c<hk?b:c)}function h3(a){if("bigint"!=typeof a)throw Error("Expected bigint");let b=hE(a);return hI(b)}function h4(a,b,c){if(null==a)throw Error(`sign: expected valid message hash, not "${a}"`);let d=hK(a),e=hZ(b),f=[h3(e),h2(d)];if(null!=c){!0===c&&(c=ip.randomBytes(32));let g=hK(c);if(32!==g.length)throw Error("sign: Expected 32 bytes of extra data");f.push(g)}let h=hA(...f),i=h1(d);return{seed:h,m:i,d:e}}function h5(a,b){let{sig:c,recovery:d}=a,{canonical:e,der:f,recovered:g}=Object.assign({canonical:!0,der:!0},b);e&&c.hasHighS()&&(c=c.normalizeS(),d^=1);let h=f?c.toDERRawBytes():c.toCompactRawBytes();return g?[h,d]:h}async function h6(a,b,c={}){let{seed:d,m:e,d:f}=h4(a,b,c.extraEntropy),g,h=new hV;for(await h.reseed(d);!(g=hY(await h.generate(),e,f));)await h.reseed();return h5(g,c)}let h7={strict:!0};function h8(a,b,c,d=h7){let e;try{e=h_(a),b=hK(b)}catch(f){return!1}let{r:g,s:h}=e;if(d.strict&&e.hasHighS())return!1;let i=hU(b),j;try{j=h$(c)}catch(k){return!1}let{n:l}=hq,m=hP(h,l),n=hM(i*m,l),o=hM(g*m,l),p=hv.BASE.multiplyAndAddUnsafe(j,n,o);if(!p)return!1;let q=hM(p.x,l);return q===g}function h9(a){return hM(hJ(a),hq.n)}function ia(a){return(a.y&hl)===hk}class ib{constructor(a,b){this.r=a,this.s=b,this.assertValidity()}static fromHex(a){let b=hK(a);if(64!==b.length)throw TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${b.length}`);let c=hJ(b.subarray(0,32)),d=hJ(b.subarray(32,64));return new ib(c,d)}assertValidity(){let{r:a,s:b}=this;if(!hX(a)||!hW(b))throw Error("Invalid signature")}toHex(){return hE(this.r)+hE(this.s)}toRawBytes(){return hI(this.toHex())}}function ic(a,b,c){if(null==a)throw TypeError(`sign: Expected valid message, not "${a}"`);let d=hK(a),e=hZ(b),f=hK(c);if(32!==f.length)throw TypeError("sign: Expected 32 bytes of aux randomness");let g=hv.fromPrivateKey(e),h=g.toRawX(),i=ia(g)?e:hq.n-e;return{m:d,P:g,px:h,d:i,rand:f}}function id(a,b){return hF(a^hJ(b))}function ie(a){let b=hM(hJ(a),hq.n);if(b===hk)throw Error("sign: Creation of signature failed. k is zero");let c=hv.fromPrivateKey(b),d=c.toRawX(),e=ia(c)?b:hq.n-b;return{R:c,rx:d,k:e}}function ig(a,b,c,d){return new ib(a.x,hM(b+c*d,hq.n)).toRawBytes()}function ih(a,b,c){let d=a instanceof ib,e=d?a:ib.fromHex(a);return d&&e.assertValidity(),{...e,m:hK(b),P:h$(c)}}function ii(a,b,c,d){let e=hv.BASE.multiplyAndAddUnsafe(b,hZ(c),hM(-d,hq.n));return!!(e&&ia(e))&&e.x===a}async function ij(a,b,c){try{let{r:d,s:e,m:f,P:g}=ih(a,b,c),h=h9(await ip.taggedHash(im.challenge,hF(d),g.toRawX(),f));return ii(d,g,e,h)}catch(i){return!1}}function ik(a,b,c){try{let{r:d,s:e,m:f,P:g}=ih(a,b,c),h=h9(ip.taggedHashSync(im.challenge,hF(d),g.toRawX(),f));return ii(d,g,e,h)}catch(i){return!1}}hv.BASE._setWindowSize(8);let il={node:hj,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},im={challenge:"BIP0340/challenge",aux:"BIP0340/aux",nonce:"BIP0340/nonce"},io={},ip={isValidPrivateKey(a){try{return hZ(a),!0}catch(b){return!1}},privateAdd:(a,b)=>{let c=hZ(a),d=hZ(b);return hF(hM(c+d,hq.n))},privateNegate:a=>{let b=hZ(a);return hF(hq.n-b)},pointAddScalar:(a,b,c)=>{let d=hv.fromHex(a),e=hZ(b),f=hv.BASE.multiplyAndAddUnsafe(d,e,hl);if(!f)throw Error("Tweaked point at infinity");return f.toRawBytes(c)},pointMultiply:(a,b,c)=>{let d=hv.fromHex(a),e=hJ(hK(b));return d.multiply(e).toRawBytes(c)},hashToPrivateKey:a=>{if((a=hK(a)).length<40||a.length>1024)throw Error("Expected 40-1024 bytes of private key as per FIPS 186");let b=hM(hJ(a),hq.n-hl)+hl;return hF(b)},randomBytes:(a=32)=>{if(il.web)return il.web.getRandomValues(new Uint8Array(a));if(il.node){let{randomBytes:b}=il.node;return Uint8Array.from(b(a))}throw Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ip.hashToPrivateKey(ip.randomBytes(40)),bytesToHex:hD,hexToBytes:hI,concatBytes:hA,mod:hM,invert:hP,sha256:async(...a)=>{if(il.web){let b=await il.web.subtle.digest("SHA-256",hA(...a));return new Uint8Array(b)}if(il.node){let{createHash:c}=il.node,d=c("sha256");return a.forEach(a=>d.update(a)),Uint8Array.from(d.digest())}throw Error("The environment doesn't have sha256 function")},hmacSha256:async(a,...b)=>{if(il.web){let c=await il.web.subtle.importKey("raw",a,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),d=hA(...b),e=await il.web.subtle.sign("HMAC",c,d);return new Uint8Array(e)}if(il.node){let{createHmac:f}=il.node,g=f("sha256",a);return b.forEach(a=>g.update(a)),Uint8Array.from(g.digest())}throw Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(a,...b)=>{let c=io[a];if(void 0===c){let d=await ip.sha256(Uint8Array.from(a,a=>a.charCodeAt(0)));c=hA(d,d),io[a]=c}return ip.sha256(c,...b)},taggedHashSync:(a,...b)=>{if("function"!=typeof ip.sha256Sync)throw Error("utils.sha256Sync is undefined, you need to set it");let c=io[a];if(void 0===c){let d=ip.sha256Sync(Uint8Array.from(a,a=>a.charCodeAt(0)));c=hA(d,d),io[a]=c}return ip.sha256Sync(c,...b)},precompute(a=8,b=hv.BASE){let c=b===hv.BASE?b:new hv(b.x,b.y);return c._setWindowSize(a),c.multiply(hn),c}};function iq(){return ip.randomPrivateKey()}async function ir(a,b){let{digest:c}=await dA.sha256.digest(b);try{return await h6(c,a)}catch(d){throw a7(d,"ERR_INVALID_INPUT")}}async function is(a,b,c){try{let{digest:d}=await dA.sha256.digest(c);return h8(b,d,a)}catch(e){throw a7(e,"ERR_INVALID_INPUT")}}function it(a){let b=hv.fromHex(a).toRawBytes(!0);return b}function iu(a){try{h0(a,!0)}catch(b){throw a7(b,"ERR_INVALID_PRIVATE_KEY")}}function iv(a){try{hv.fromHex(a)}catch(b){throw a7(b,"ERR_INVALID_PUBLIC_KEY")}}function iw(a){try{return h0(a,!0)}catch(b){throw a7(b,"ERR_INVALID_PRIVATE_KEY")}}class ix{constructor(a){iv(a),this._key=a}async verify(a,b){return await is(this._key,b,a)}marshal(){return it(this._key)}get bytes(){return $.encode({Type:Y.Secp256k1,Data:this.marshal()})}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}}class iy{constructor(a,b){this._key=a,this._publicKey=b??iw(a),iu(this._key),iv(this._publicKey)}async sign(a){return await ir(this._key,a)}get public(){return new ix(this._publicKey)}marshal(){return this._key}get bytes(){return _.encode({Type:Y.Secp256k1,Data:this.marshal()})}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}async id(){let a=await this.public.hash();return(0,cE.toString)(a,"base58btc")}async export(a,b="libp2p-key"){if("libp2p-key"===b)return await f$(this.bytes,a);throw a7(Error(`export format '${b}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function iz(a){return new iy(a)}function iA(a){return new ix(a)}async function iB(){let a=await iq();return new iy(a)}let iC={rsa:aT,ed25519:aU,secp256k1:aV};function iD(a){let b=Object.keys(iC).join(" / ");return a7(Error(`invalid or unsupported key type ${a}. Must be ${b}`),"ERR_UNSUPPORTED_KEY_TYPE")}function iE(a){if("rsa"===(a=a.toLowerCase())||"ed25519"===a||"secp256k1"===a)return iC[a];throw iD(a)}async function iF(a,b){return await iE(a).generateKeyPair(b??2048)}function iG(a){let b=$.decode(a),c=b.Data;switch(b.Type){case Y.RSA:return iC.rsa.unmarshalRsaPublicKey(c);case Y.Ed25519:return iC.ed25519.unmarshalEd25519PublicKey(c);case Y.Secp256k1:return iC.secp256k1.unmarshalSecp256k1PublicKey(c);default:throw iD(b.Type)}}function iH(a,b){return iE(b=(b??"rsa").toLowerCase()),a.bytes}async function iI(a){let b=_.decode(a),c=b.Data;switch(b.Type){case Y.RSA:return await iC.rsa.unmarshalRsaPrivateKey(c);case Y.Ed25519:return iC.ed25519.unmarshalEd25519PrivateKey(c);case Y.Secp256k1:return iC.secp256k1.unmarshalSecp256k1PrivateKey(c);default:throw iD(b.Type)}}async function iJ(a,b){try{let c=await fH(a,b);return await iI(c)}catch(d){}let e=fq.pki.decryptRsaPrivateKey(a,b);if(null===e)throw a7(Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let f=fq.asn1.toDer(fq.pki.privateKeyToAsn1(e));return await iC.rsa.unmarshalRsaPrivateKey(f=(0,cB.fromString)(f.getBytes(),"ascii"))}let iK="ERR_IPNS_EXPIRED_RECORD",iL="ERR_UNRECOGNIZED_VALIDITY",iM="ERR_SIGNATURE_CREATION",iN="ERR_SIGNATURE_VERIFICATION",iO="ERR_UNRECOGNIZED_FORMAT",iP="ERR_UNDEFINED_PARAMETER",iQ="ERR_INVALID_RECORD_DATA",iR="ERR_INVALID_EMBEDDED_KEY",iS="ERR_MISSING_PRIVATE_KEY",iT,iU;(xd=iT=(xc=aa||(aa={})).ValidityType||(xc.ValidityType={})).EOL="EOL",(xe=iU||(iU={}))[xe.EOL=0]="EOL",(xf=iT=xc.ValidityType||(xc.ValidityType={})).codec=()=>eJ(iU),xc.codec=()=>e2({1:{name:"value",codec:eF,optional:!0},2:{name:"signature",codec:eF,optional:!0},3:{name:"validityType",codec:xc.ValidityType.codec(),optional:!0},4:{name:"validity",codec:eF,optional:!0},5:{name:"sequence",codec:fp,optional:!0},6:{name:"ttl",codec:fp,optional:!0},7:{name:"pubKey",codec:eF,optional:!0},8:{name:"signatureV2",codec:eF,optional:!0},9:{name:"data",codec:eF,optional:!0}}),xc.encode=a=>ew(a,xc.codec()),xc.decode=a=>ev(a,xc.codec());let iV=a6("ipns:utils"),iW=(0,cB.fromString)("/ipns/");function iX(a){let b=RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),c=String(a).trim().match(b);if(null==c)throw Error("Invalid format");let d=parseInt(c[1],10),e=parseInt(c[2],10)-1,f=parseInt(c[3],10),g=parseInt(c[4],10),h=parseInt(c[5],10),i=parseInt(c[6],10),j=parseInt(c[7].slice(0,-6),10);return new Date(Date.UTC(d,e,f,g,h,i,j))}let iY=async(a,b)=>{if(null==b||null==a){let c=Error("one or more of the provided parameters are not defined");throw iV.error(c),a7(c,iP)}let d;if(null!=b.pubKey){try{d=iG(b.pubKey)}catch(e){throw iV.error(e),e}let f=await dO(b.pubKey);if(!f.equals(a))throw a7(Error("Embedded public key did not match PeerID"),iR)}else null!=a.publicKey&&(d=iG(a.publicKey));if(null!=d)return d;throw a7(Error("no public key is available"),iP)},iZ=(a,b,c)=>{let d=(0,cB.fromString)(b);return(0,d7.concat)([a,c,d])},i$=a=>{let b=(0,cB.fromString)("ipns-signature:");return(0,d7.concat)([b,a])},i_=a=>aa.encode(a),i0=a=>{let b=aa.decode(a);return{value:b.value??new Uint8Array(0),signature:b.signature??new Uint8Array(0),validityType:b.validityType??aa.ValidityType.EOL,validity:b.validity??new Uint8Array(0),sequence:b.sequence??0n,pubKey:b.pubKey,ttl:b.ttl??void 0,signatureV2:b.signatureV2,data:b.data}},i1=a=>(0,d7.concat)([iW,a.toBytes()]),i2=a=>dM(a.slice(iW.length)),i3=(a,b,c,d,e)=>{let f;if(c===aa.ValidityType.EOL)f=0;else throw a7(Error("Unknown validity type"),iL);let g={Value:a,Validity:b,ValidityType:f,Sequence:d,TTL:e};return bS.cv(g)},i4=a=>{let b=bS.Jx(a);if(0===b.ValidityType)b.ValidityType=aa.ValidityType.EOL;else throw a7(Error("Unknown validity type"),iL);return Number.isInteger(b.Sequence)&&(b.Sequence=BigInt(b.Sequence)),Number.isInteger(b.TTL)&&(b.TTL=BigInt(b.TTL)),b},i5=a6("ipns"),i6=cr.identity.code,i7="/ipns/",i8=i7.length,i9=async(a,b,c,d)=>{let e=new d6(Date.now()+Number(d)),f=aa.ValidityType.EOL,[g,h]=d.toString().split("."),i=BigInt(g)*BigInt(1e5)+BigInt(h??"0");return await ja(a,b,c,f,e,i)},ja=async(a,b,c,d,e,f)=>{c=BigInt(c);let g=(0,cB.fromString)(e.toString());if(null==a.privateKey)throw a7(Error("Missing private key"),iS);let h=await iI(a.privateKey),i=await jd(h,b,d,g),j=i3(b,g,d,c,f),k=i$(j),l=await h.sign(k),m={value:b,signature:i,validityType:d,validity:g,sequence:c,ttl:f,signatureV2:l,data:j};if(null!=a.publicKey){let n=dy.decode(a.toBytes());n.code===i6&&(0,dz.equals)(a.publicKey,n.digest)||(m.pubKey=a.publicKey)}return i5("ipns entry for %b created",b),m},jb=a=>a4.base32upper.encode(a).slice(1),jc=a=>new cI(`/ipns/${jb(a)}`),jd=async(a,b,c,d)=>{try{let e=iZ(b,c,d);return await a.sign(e)}catch(f){throw i5.error("record signature creation failed",f),a7(Error("record signature creation failed"),iM)}},je=a6("ipfs:ipns:publisher"),jf=d5().code,jg=36e5;class jh{constructor(a,b){this._routing=a,this._datastore=b}async publishWithEOL(a,b,c){let d=await this._updateOrCreateRecord(a,b,c);return this._putRecordToRouting(d,a)}publish(a,b){return this.publishWithEOL(a,b,jg)}async _putRecordToRouting(a,b){if(!d1(b)){let c="peerId received is not valid";throw je.error(c),a7(Error(c),"ERR_INVALID_PEER_ID")}if(null==b.publicKey)throw a7(Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");let d=i1(b);return await this._publishEntry(d,a),a}async _publishEntry(a,b){try{let c=await this._routing.put(a,b);return je(`ipns record for ${(0,cE.toString)(a,"base32")} was stored in the routing`),c}catch(d){let e=`ipns record for ${(0,cE.toString)(a,"base32")} could not be stored in the routing - ${d.stack}`;throw je.error(e),je.error(d),a7(Error(e),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(a,b={}){if(!d1(a)){let c="peerId received is not valid";throw je.error(c),a7(Error(c),"ERR_INVALID_PEER_ID")}let d=!1!==b.checkRouting;try{let e=await this._datastore.get(jc(a.toBytes()));return this._unmarshalData(e)}catch(f){if(f.code!==jf){let g=`unexpected error getting the ipns record ${a.toString()} from datastore`;throw je.error(g),a7(Error(g),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!d)throw a7(f,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let h=i1(a),i=await this._routing.get(h);return this._unmarshalData(i)}catch(j){throw je.error(j),j}}}_unmarshalData(a){try{return i0(a)}catch(b){throw a7(b,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(a,b,c){if(!d1(a)){let d="peerId received is not valid";throw je.error(d),a7(Error(d),"ERR_INVALID_PEER_ID")}let e={checkRouting:!0},f;try{f=await this._getPublished(a,e)}catch(g){if(g.code!==jf){let h=`unexpected error when determining the last published IPNS record for ${a.toString()} ${g.stack}`;throw je.error(h),a7(Error(h),"ERR_DETERMINING_PUBLISHED_RECORD")}}let i=0n;f&& void 0!==f.sequence&&(i=(0,dz.equals)(f.value,b)?f.sequence:f.sequence+BigInt(1));let j;try{j=await i9(a,b,i,c)}catch(k){let l=`ipns record for ${b} could not be created`;throw je.error(k),a7(Error(l),"ERR_CREATING_IPNS_RECORD")}try{let m=i_(j);return await this._datastore.put(jc(a.toBytes()),m),je(`ipns record for ${(0,cE.toString)(b,"base32")} was stored in the datastore`),m}catch(n){let o=`ipns record for ${b} could not be stored in the datastore`;throw je.error(o),a7(Error(o),"ERR_STORING_IN_DATASTORE")}}}jh.defaultRecordLifetime=jg;let ji=a6("ipfs:ipns:republisher"),jj=6e4,jk=60*jj,jl=4*jk,jm=24*jk;class jn{constructor(a,b,c,d,e={pass:""}){this._publisher=a,this._datastore=b,this._peerId=c,this._keychain=d,this._options=e,this._republishHandle=null}async start(){if(this._republishHandle)throw a7(Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let a={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:b=>{a._timeoutId=setTimeout(async()=>{a._timeoutId=null;try{a._inflightTask=a._task(),await a._inflightTask,a._task&&a.runPeriodically(b)}catch(c){ji.error(c)}},b())},cancel:async()=>{null!=a._timeoutId&&clearTimeout(a._timeoutId),a._task=null,await a._inflightTask}},{pass:b}=this._options,c=!0;a._task=()=>this._republishEntries(this._peerId,b),a.runPeriodically(()=>c?(c=!1,this._options.initialBroadcastInterval||jj):this._options.broadcastInterval||jl),this._republishHandle=a}async stop(){let a=this._republishHandle;if(!a)throw a7(Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await a.cancel()}async _republishEntries(a,b){try{await this._republishEntry(a)}catch(c){let d="cannot republish entry for the node's private key";ji.error(d);return}if(b)try{let e=await this._keychain.listKeys();for(let f of e){if("self"===f.name)continue;let g=await this._keychain.exportKey(f.name,b),h=await iJ(g,b),i=await dO(h.public.bytes,h.bytes);await this._republishEntry(i)}}catch(j){ji.error(j)}}async _republishEntry(a){try{let b=await this._getPreviousValue(a);await this._publisher.publishWithEOL(a,b,jm)}catch(c){if("ERR_NO_ENTRY_FOUND"===c.code)return;throw c}}async _getPreviousValue(a){if(!d1(a))throw a7(Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let b=await this._datastore.get(jc(a.toBytes()));if(!(b instanceof Uint8Array))throw a7(Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{let c=i0(b);return c.value}catch(d){throw ji.error(d),a7(Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(e){if(e&&e.notFound)throw a7(Error(`no previous entry for record with id: ${a.toString()}`),"ERR_NO_ENTRY_FOUND");throw e}}}let jo=a6("ipns:validator"),jp=async(a,b)=>{let{value:c,validityType:d,validity:e}=b,f,g;null!=b.signatureV2&&null!=b.data?(g=b.signatureV2,f=i$(b.data),jq(b)):(g=b.signature??new Uint8Array(0),f=iZ(c,d,e));let h;try{h=await a.verify(f,g)}catch(i){h=!1}if(!h)throw jo.error("record signature verification failed"),a7(Error("record signature verification failed"),iN);if(null!=e&&d===aa.ValidityType.EOL){let j;try{j=iX((0,cE.toString)(e))}catch(k){throw jo.error("unrecognized validity format (not an rfc3339 format)"),a7(Error("unrecognized validity format (not an rfc3339 format)"),iO)}if(j.getTime()<Date.now())throw jo.error("record has expired"),a7(Error("record has expired"),iK)}else if(null!=d)throw jo.error("unrecognized validity type"),a7(Error("unrecognized validity type"),iL);jo("ipns entry for %b is valid",c)},jq=a=>{if(null==a.data)throw a7(Error("Record data is missing"),iQ);let b=i4(a.data);if(!(0,dz.equals)(b.Value,a.value))throw a7(Error('Field "value" did not match between protobuf and CBOR'),iN);if(!(0,dz.equals)(b.Validity,a.validity))throw a7(Error('Field "validity" did not match between protobuf and CBOR'),iN);if(b.ValidityType!==a.validityType)throw a7(Error('Field "validityType" did not match between protobuf and CBOR'),iN);if(b.Sequence!==a.sequence)throw a7(Error('Field "sequence" did not match between protobuf and CBOR'),iN);if(b.TTL!==a.ttl)throw a7(Error('Field "ttl" did not match between protobuf and CBOR'),iN)},jr=async(a,b)=>{let c=i2(a),d=i0(b),e=await iY(c,d);await jp(e,d)},js=a6("ipfs:ipns:resolver"),jt=d5().code,ju=32;class jv{constructor(a){this._routing=a}async resolve(a,b={}){if("string"!=typeof a)throw a7(Error("invalid name"),"ERR_INVALID_NAME");let c=b.recursive&&"true"===b.recursive.toString(),d=a.split("/");if(3!==d.length||""!==d[0])throw a7(Error("invalid name"),"ERR_INVALID_NAME");let e=d[2],f=1/0;c&&(f=ju);let g=await this.resolver(e,f);return js(`${a} was locally resolved correctly`),g}async resolver(a,b){if(0===b){let c=`could not resolve name (recursion limit of ${ju} exceeded)`;throw js.error(c),a7(Error(c),"ERR_RESOLVE_RECURSION_LIMIT")}let d=await this._resolveName(a),e=d.split("/");return"ipfs"!==e[1]&&b?this.resolver(e[2],b-1):d}async _resolveName(a){let b=dL(a),c=i1(b),d;try{d=await this._routing.get(c)}catch(e){if(js.error("could not get record from routing",e),e.code===jt)throw a7(Error(`record requested for ${a} was not found in the network`),"ERR_NO_RECORD_FOUND");throw a7(Error(`unexpected error getting the ipns record ${b.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(b,d)}async _validateRecord(a,b){await jr((0,d7.concat)([(0,cB.fromString)("/ipns/"),a.toBytes()]),b);let c=i0(b);return(0,cE.toString)(c.value)}}class jw{constructor(a){this.lru=c7(a)}get(a){let b=this.lru.get(a);if(b){if(b.expire&&b.expire<Date.now()){this.lru.remove(a);return}return b.value}}set(a,b,c){this.lru.set(a,{value:b,expire:Date.now()+c})}has(a){let b=this.get(a);return!!b}remove(a){this.lru.remove(a)}clear(){this.lru.clear()}}let jx=a6("ipfs:ipns"),jy=6e4;class jz{constructor(a,b,c,d,e){this.publisher=new jh(a,b),this.republisher=new jn(this.publisher,b,c,d,e),this.resolver=new jv(a),this.cache=new jw(1e3),this.routing=a}async publish(a,b,c=jh.defaultRecordLifetime){try{await this.publisher.publishWithEOL(a,b,c),jx(`IPNS value ${(0,cE.toString)(b,"base32")} was published correctly`);let d=a.toString(),e=parseFloat(c),f=e<jy?e:jy;return this.cache.set(d,b,f),jx(`IPNS value ${(0,cE.toString)(b,"base32")} was cached correctly`),{name:d,value:b}}catch(g){throw jx.error(g),g}}async resolve(a,b={}){if("string"!=typeof a)throw a7(Error("name received is not valid"),"ERR_INVALID_NAME");if(!b.nocache&&!b.recursive){let c=a.split("/")[2],d=this.cache.get(c);if(d)return d}try{let e=await this.resolver.resolve(a,b);return jx(`IPNS record from ${a} was resolved correctly`),e}catch(f){throw jx.error(f),f}}async initializeKeyspace(a,b){return this.publish(a,b,jh.defaultRecordLifetime)}}var jA=c(31303);let jB=(a,b)=>(async function*(){let c=await jA(a);yield*c.sort(b)})();var jC=c(64593),jD=c(55565),jE=c(37939);class jF{open(){return Promise.reject(Error(".open is not implemented"))}close(){return Promise.reject(Error(".close is not implemented"))}put(a,b,c){return Promise.reject(Error(".put is not implemented"))}get(a,b){return Promise.reject(Error(".get is not implemented"))}has(a,b){return Promise.reject(Error(".has is not implemented"))}delete(a,b){return Promise.reject(Error(".delete is not implemented"))}async *putMany(a,b={}){for await(let{key:c,value:d}of a)await this.put(c,d,b),yield{key:c,value:d}}async *getMany(a,b={}){for await(let c of a)yield this.get(c,b)}async *deleteMany(a,b={}){for await(let c of a)await this.delete(c,b),yield c}batch(){let a=[],b=[];return{put(b,c){a.push({key:b,value:c})},delete(a){b.push(a)},commit:async c=>{await jC(this.putMany(a,c)),a=[],await jC(this.deleteMany(b,c)),b=[]}}}async *_all(a,b){throw Error("._all is not implemented")}async *_allKeys(a,b){throw Error("._allKeys is not implemented")}query(a,b){let c=this._all(a,b);if(null!=a.prefix&&(c=jD(c,b=>b.key.toString().startsWith(a.prefix))),Array.isArray(a.filters)&&(c=a.filters.reduce((a,b)=>jD(a,b),c)),Array.isArray(a.orders)&&(c=a.orders.reduce((a,b)=>jB(a,b),c)),null!=a.offset){let d=0;c=jD(c,()=>(d++)>=a.offset)}return null!=a.limit&&(c=jE(c,a.limit)),c}queryKeys(a,b){let c=this._allKeys(a,b);if(null!=a.prefix&&(c=jD(c,b=>b.toString().startsWith(a.prefix))),Array.isArray(a.filters)&&(c=a.filters.reduce((a,b)=>jD(a,b),c)),Array.isArray(a.orders)&&(c=a.orders.reduce((a,b)=>jB(a,b),c)),null!=a.offset){let d=0;c=jD(c,()=>(d++)>=a.offset)}return null!=a.limit&&(c=jE(c,a.limit)),c}}var jG=c(77416);let jH=a2("datastore:core:tiered");class jI extends jF{constructor(a){super(),this.stores=a.slice()}async open(){try{await Promise.all(this.stores.map(a=>a.open()))}catch(a){throw d2()}}async put(a,b,c){try{await Promise.all(this.stores.map(d=>d.put(a,b,c)))}catch(d){throw d4()}}async get(a,b){for(let c of this.stores)try{let d=await c.get(a,b);if(d)return d}catch(e){jH(e)}throw d5()}async has(a,b){for(let c of this.stores)if(await c.has(a,b))return!0;return!1}async delete(a,b){try{await Promise.all(this.stores.map(c=>c.delete(a,b)))}catch(c){throw d3()}}async *putMany(a,b={}){let c,d=this.stores.map(a=>{let d=jG();return jC(a.putMany(d,b)).catch(a=>{c=a}),d});try{for await(let e of a){if(c)throw c;d.forEach(a=>a.push(e)),yield e}}finally{d.forEach(a=>a.end())}}async *deleteMany(a,b={}){let c,d=this.stores.map(a=>{let d=jG();return jC(a.deleteMany(d,b)).catch(a=>{c=a}),d});try{for await(let e of a){if(c)throw c;d.forEach(a=>a.push(e)),yield e}}finally{d.forEach(a=>a.end())}}async close(){await Promise.all(this.stores.map(a=>a.close()))}batch(){let a=this.stores.map(a=>a.batch());return{put:(b,c)=>{a.forEach(a=>a.put(b,c))},delete:b=>{a.forEach(a=>a.delete(b))},commit:async b=>{for(let c of a)await c.commit(b)}}}query(a,b){return this.stores[this.stores.length-1].query(a,b)}queryKeys(a,b){return this.stores[this.stores.length-1].queryKeys(a,b)}}var jJ=c(26905);let jK=(a,b)=>{let c=b.map((a,b)=>({entry:aa.decode(a),index:b}));return c.sort((a,b)=>{if(null!=a.entry.signatureV2&&null==b.entry.signatureV2)return -1;if(null==a.entry.signatureV2&&null!=b.entry.signatureV2)return 1;let c=a.entry.sequence??0n,d=b.entry.sequence??0n;if(c>d)return -1;if(c<d)return 1;let e=a.entry.validity??new Uint8Array(0),f=b.entry.validity??new Uint8Array(0),g=iX((0,cE.toString)(e)),h=iX((0,cE.toString)(f));return g.getTime()>h.getTime()?-1:g.getTime()<h.getTime()?1:0}),c[0].index},jL="/repo/flatfs/shard/",jM="SHARDING",jN="_README";class jO extends null{constructor(a){super(a),this._padding="".padStart(a,"_"),this.name="prefix"}fun(a){return(a+this._padding).slice(0,this.param)}}class jP extends null{constructor(a){super(a),this._padding="".padStart(a,"_"),this.name="suffix"}fun(a){let b=this._padding+a;return b.slice(b.length-this.param)}}class jQ extends null{constructor(a){super(a),this._padding="".padStart(a+1,"_"),this.name="next-to-last"}fun(a){let b=this._padding+a,c=b.length-this.param-1;return b.slice(c,c+this.param)}}class jR extends jF{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(a,b){this.data[a.toString()]=b}async get(a){let b=await this.has(a);if(!b)throw d5();return this.data[a.toString()]}async has(a){return void 0!==this.data[a.toString()]}async delete(a){delete this.data[a.toString()]}async *_all(){yield*Object.entries(this.data).map(([a,b])=>({key:new cI(a),value:b}))}async *_allKeys(){yield*Object.entries(this.data).map(([a])=>new cI(a))}}var jS=c(32121);c(74664);let jT=new cI(jM),jU=new cI(jN);class jV extends null{constructor(a,b){super(),this.child=new KeyTransformDatastore(a,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=b}async open(){await this.child.open(),this.shard=await jV.create(this.child,this.shard)}_convertKey(a){let b=a.toString();if(b===jT.toString()||b===jU.toString())return a;let c=new Key(this.shard.fun(b));return c.child(a)}_invertKey(a){let b=a.toString();return b===jT.toString()||b===jU.toString()?a:Key.withNamespaces(a.list().slice(1))}static async createOrOpen(a,b){try{await jV.create(a,b)}catch(c){if(c&&"datastore exists"!==c.message)throw c}return jV.open(a)}static async open(a){let b=await readShardFun("/",a);return new jV(a,b)}static async create(a,b){let c=await a.has(jT);if(!c&&!b)throw Errors.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!c){let d="function"==typeof a.putRaw?a.putRaw.bind(a):a.put.bind(a);return await Promise.all([d(jT,new TextEncoder().encode(b.toString()+"\n")),d(jU,new TextEncoder().encode(readme))]),b}let e=await readShardFun("/",a),f=(e||"").toString(),g=b.toString();if(f!==g)throw Error(`specified fun ${g} does not match repo shard fun ${f}`);return e}put(a,b,c){return this.child.put(a,b,c)}get(a,b){return this.child.get(a,b)}has(a,b){return this.child.has(a,b)}delete(a,b){return this.child.delete(a,b)}async *putMany(a,b={}){yield*this.child.putMany(a,b)}async *getMany(a,b={}){yield*this.child.getMany(a,b)}async *deleteMany(a,b={}){yield*this.child.deleteMany(a,b)}batch(){return this.child.batch()}query(a,b){let c={...a,filters:[({key:a})=>a.toString()!==jT.toString(),({key:a})=>a.toString()!==jU.toString()].concat(a.filters||[])};return this.child.query(c,b)}queryKeys(a,b){let c={...a,filters:[a=>a.toString()!==jT.toString(),a=>a.toString()!==jU.toString()].concat(a.filters||[])};return this.child.queryKeys(c,b)}close(){return this.child.close()}}var jW=c(74014);let jX="/record/";function jY(a){return(0,cE.toString)(a,"base32")}function jZ(a){("string"==typeof a||a instanceof String)&&(a=(0,cB.fromString)(a.toString()));let b=(0,cE.toString)(a,"base64url");return`${jX}${b}`}function j$(a){if(a.substring(0,jX.length)!==jX)throw a7(Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let b=a.substring(jX.length);return(0,cB.fromString)(b,"base64url")}let j_=a6("datastore-pubsub:publisher");class j0 extends jF{constructor(a,b,c,d,e,f){if(super(),!d)throw a7(TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if("function"!=typeof d)throw a7(TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if("function"!=typeof e)throw a7(TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(f&&"function"!=typeof f)throw a7(TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=a,this._datastore=b,this._peerId=c,this._validator=d,this._selector=e,this._handleSubscriptionKeyFn=f,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(a,b){if(!(a instanceof Uint8Array)){let c="datastore key does not have a valid format";throw j_.error(c),a7(Error(c),"ERR_INVALID_DATASTORE_KEY")}if(!(b instanceof Uint8Array)){let d="received value is not a Uint8Array";throw j_.error(d),a7(Error(d),"ERR_INVALID_VALUE_RECEIVED")}let e=jZ(a);j_(`publish value for topic ${e}`),await this._pubsub.publish(e,b)}async get(a){if(!(a instanceof Uint8Array)){let b="datastore key does not have a valid format";throw j_.error(b),a7(Error(b),"ERR_INVALID_DATASTORE_KEY")}let c=jZ(a),d=await this._pubsub.getTopics();if(d&&Array.isArray(d)&&d.indexOf(c)> -1)return this._getLocal(a);try{await this._pubsub.subscribe(c)}catch(e){let f=`cannot subscribe topic ${c}`;throw j_.error(f),a7(Error(f),"ERR_SUBSCRIBING_TOPIC")}return j_(`subscribed values for key ${c}`),this._getLocal(a)}unsubscribe(a){let b=jZ(a);return this._pubsub.unsubscribe(b)}async _getLocal(a){let b=new cI("/"+jY(a),!1),c;try{c=await this._datastore.get(b)}catch(d){if("ERR_NOT_FOUND"!==d.code){let e=`unexpected error getting the ipns record for ${b.toString()}`;throw j_.error(e),a7(Error(e),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let f=`local record requested was not found for ${b.toString()}`;throw j_.error(f),a7(Error(f),"ERR_NOT_FOUND")}if(!(c instanceof Uint8Array)){let g="found record that we couldn't convert to a value";throw j_.error(g),a7(Error(g),"ERR_INVALID_RECORD_RECEIVED")}return c}async _onMessage(a){let b=a.detail,{data:c,from:d,topic:e}=b,f;try{f=j$(e)}catch(g){j_.error(g);return}if(j_(`message received for topic ${e}`),this._peerId.equals(d)){j_("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let h;try{h=await this._handleSubscriptionKeyFn(f)}catch(i){j_.error("message discarded by the subscriptionKeyFn");return}f=h}try{await this._storeIfSubscriptionIsBetter(f,c)}catch(j){j_.error(j)}}async _storeIfSubscriptionIsBetter(a,b){let c=!1;try{c=await this._isBetter(a,b)}catch(d){if("ERR_NOT_VALID_RECORD"!==d.code)throw d}c&&await this._storeRecord(a,b)}async _validateRecord(a,b){return this._validator(a,b)}async _selectRecord(a,b){let c=await this._selector(a,b);return 0===c}async _isBetter(a,b){try{await this._validateRecord(a,b)}catch(c){let d="record received through pubsub is not valid";throw j_.error(d),a7(Error(d),"ERR_NOT_VALID_RECORD")}let e=new cI(a),f;try{f=await this._getLocal(e.uint8Array())}catch(g){return!0}return!(0,dz.equals)(f,b)&&this._selectRecord(a,[f,b])}async _storeRecord(a,b){let c=new cI("/"+jY(a),!1);await this._datastore.put(c,b),j_(`record for ${jZ(a)} was stored in the datastore`)}}let j1=a6("ipfs:ipns:pubsub");class j2{constructor(a,b,c){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new j0(a,b,c,jr,jK,this._handleSubscriptionKey)}async put(a,b){try{await this._pubsubDs.put(a,b)}catch(c){throw j1.error(c),c}}async get(a){let b,c;try{b=await this._pubsubDs.get(a)}catch(d){c=d}let e=a.slice(0,i8);if((0,cE.toString)(e)===i7){let f=a3.base58btc.encode(a).substring(1),g=a3.base58btc.encode(a.slice(i8)).substring(1);this._subscriptions[f]=g,j1(`subscribed to pubsub topic ${f}, id ${g}`)}if(c)throw c;return b}_handleSubscriptionKey(a){a instanceof Uint8Array&&(a=(0,cE.toString)(a,"base58btc"));let b=this._subscriptions[a];if(!b)throw a7(Error(`key ${a} does not correspond to a subscription`),"ERR_INVALID_KEY");try{let c=i1(dL(b));return c}catch(d){throw j1.error(d),d}}getSubscriptions(){let a=Object.values(this._subscriptions).filter(Boolean);return a.map(a=>`${i7}${a}`)}async cancel(a){if("string"!=typeof a)throw a7(Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");a.startsWith(i7)&&(a=a.substring(i8));let b=Object.keys(this._subscriptions).find(b=>this._subscriptions[b]===a);if(!b)return{canceled:!1};let c=(0,cB.fromString)(b);return this._pubsubDs.unsubscribe(c),delete this._subscriptions[b],j1(`unsubscribed pubsub ${b}: ${a}`),{canceled:!0}}}function j3(a){let b=a.getUTCFullYear(),c=String(a.getUTCMonth()+1).padStart(2,"0"),d=String(a.getUTCDate()).padStart(2,"0"),e=String(a.getUTCHours()).padStart(2,"0"),f=String(a.getUTCMinutes()).padStart(2,"0"),g=String(a.getUTCSeconds()).padStart(2,"0"),h=a.getUTCMilliseconds(),i=String(1e6*h).padStart(9,"0");return`${b}-${c}-${d}T${e}:${f}:${g}.${i}Z`}function j4(a){let b=RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),c=String(a).trim().match(b);if(null==c)throw Error("Invalid format");let d=parseInt(c[1],10),e=parseInt(c[2],10)-1,f=parseInt(c[3],10),g=parseInt(c[4],10),h=parseInt(c[5],10),i=parseInt(c[6],10),j=parseInt(c[7].slice(0,-6),10);return new Date(Date.UTC(d,e,f,g,h,i,j))}(xg=ab||(ab={})).codec=()=>e2({1:{name:"key",codec:eF},2:{name:"value",codec:eF},5:{name:"timeReceived",codec:fi}}),xg.encode=a=>ew(a,xg.codec()),xg.decode=a=>ev(a,xg.codec());class j5{constructor(a,b,c){if(!(a instanceof Uint8Array))throw Error("key must be a Uint8Array");if(!(b instanceof Uint8Array))throw Error("value must be a Uint8Array");this.key=a,this.value=b,this.timeReceived=c}serialize(){return ab.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:j3(this.timeReceived)}}static deserialize(a){let b=ab.decode(a);return new j5(b.key,b.value,new Date(b.timeReceived))}static fromDeserialized(a){let b=j4(a.timeReceived);if(null==a.key)throw Error("key missing from deserialized object");if(null==a.value)throw Error("value missing from deserialized object");let c=new j5(a.key,a.value,b);return c}}let j6=a6("ipfs:ipns:offline-datastore");class j7{constructor(a){this._datastore=a,this.stores=[]}async put(a,b){if(!(a instanceof Uint8Array))throw a7(Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(b instanceof Uint8Array))throw a7(Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let c;try{c=this._routingKey(a)}catch(d){throw j6.error(d),a7(Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let e=new j5(a,b,new Date);await this._datastore.put(c,e.serialize())}async get(a){if(!(a instanceof Uint8Array))throw a7(Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let b;try{b=this._routingKey(a)}catch(c){throw j6.error(c),a7(Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let d=await this._datastore.get(b),e;try{e=j5.deserialize(d)}catch(f){throw j6.error(f),f}return e.value}_routingKey(a){return new cI("/dht/record/"+(0,cE.toString)(a,"base32"),!1)}}let j8=a6("ipfs:ipns:dht-datastore");class j9{constructor(a){this._dht=a}async put(a,b){try{await jC(this._dht.put(a,b))}catch(c){throw j8.error(c),c}}async get(a){for await(let b of this._dht.get(a))if("VALUE"===b.name)return b.value;throw d5()}}function ka({libp2p:a,repo:b,peerId:c,options:d}){let e=[],f;if(jJ(d,"EXPERIMENTAL.ipnsPubsub",!1)&&(f=new j2(a.pubsub,b.datastore,c),e.push(f)),!0!==jJ(d,"offline",!1)&&["dht","dhtclient","dhtserver"].includes(jJ(d,"config.Routing.Type","none"))&&e.push(new j9(a.dht)),jJ(d,"offline",!1)||0===e.length){let g=new j7(b.datastore);e.push(g)}return new jI(e)}let kb=a6("ipfs:components:ipns");class kc{constructor(a={pass:""}){this.options=a,this.offline=null,this.online=null}getIPNS(){let a=this.online||this.offline;if(a)return a;throw new cu}get routing(){return this.getIPNS().routing}startOffline({repo:a,peerId:b,keychain:c}){if(null!=this.offline)throw new cw;kb("initializing IPNS keyspace (offline)");let d=new j7(a.datastore),e=new jz(d,a.datastore,b,c,this.options);this.offline=e}async startOnline({libp2p:a,repo:b,peerId:c,keychain:d}){if(null!=this.online)throw new cw;let e=ka({libp2p:a,repo:b,peerId:c,options:this.options}),f=new jz(e,b.datastore,c,d,this.options);await f.republisher.start(),this.online=f}async stop(){let a=this.online;a&&(await a.republisher.stop(),this.online=null)}publish(a,b,c){return this.getIPNS().publish(a,b,c)}resolve(a,b){return this.getIPNS().resolve(a,b)}initializeKeyspace(a,b){return this.getIPNS().initializeKeyspace(a,b)}}async function kd({ipns:a,repo:b,codecs:c},d,e){if(cC.ipnsPath(d))return a.resolve(d);let{cid:f,path:g}=cV(d);await jC(c3(f,g||"",c,b,e))}let ke=a6("ipfs:name:publish");function kf({ipns:a,repo:b,codecs:c,peerId:d,isOnline:e,keychain:f}){let g=async a=>{let b;if("self"===a&&null!=d.privateKey)b=await iI(d.privateKey);else try{let c=await f.exportKey(a,"temp");b=await iJ(c,"temp")}catch(e){throw ke.error(e),a7(e,"ERR_CANNOT_GET_KEY")}return dO(b.public.bytes,b.bytes)};async function h(d,f={}){let h=!1!==f.resolve,i=f.lifetime||"24h",j=f.key||"self";if(!e())throw a7(Error(cX),"OFFLINE_ERROR");try{d=c$(d)}catch(k){throw ke.error(k),k}let l=0;try{l=cR(i)||0,l=parseFloat(l.toFixed(6))}catch(m){throw ke.error(m),m}let n=await Promise.all([g(j),h?kd({ipns:a,repo:b,codecs:c},d):Promise.resolve()]),o=(0,cB.fromString)(d),p=await a.publish(n[0],o,l);return{name:p.name,value:(0,cE.toString)(p.value)}}return cT(h)}var kg=c(98441),kh=c(82734);let ki=a0.bind({ignoreUndefined:!0}),kj=a6("ipfs:name:resolve"),kk=(a,b)=>b.length>0?a+"/"+b.join("/"):a;function kl({dns:a,ipns:b,isOnline:c,options:{offline:d}}){async function*e(e,f={}){if(f=ki({nocache:!1,recursive:!0},f),d&&f&&f.nocache)throw a7(Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!c()&&!d)throw a7(Error(cX),"OFFLINE_ERROR");let g=e.toString();g.startsWith("/ipns/")||(g=`/ipns/${g}`);let[h,i,...j]=g.slice(1).split("/");try{if("1"===i.substring(0,1)){let k=dL(i),l=dy.decode(k.toBytes()),m=bm.CID.createV1(114,l);i=m.toString(kg.base36)}else{let n=bm.CID.parse(i);1===n.version&&(i=n.toString(kg.base36))}}catch(o){if(kh(i)){yield kk(await a(i,f),j);return}throw kj.error(o),a7(Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}let p=await b.resolve(`/${h}/${i}`,f);yield kk(p instanceof Uint8Array?(0,cE.toString)(p):p,j)}return cT(e)}function km(a,b){if(!a||!(b&&b.ipnsPubsub))throw a7(Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(a.routing instanceof j2)return a.routing;let c=(a.routing.stores||[]).find(a=>a instanceof j2);if(!c)throw a7(Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return c}function kn({ipns:a,options:b}){let c=b.EXPERIMENTAL;async function d(b,d={}){let e=km(a,c);return e.cancel(b,d)}return cT(d)}function ko({ipns:a,options:b}){let c=b.EXPERIMENTAL;async function d(b={}){try{return{enabled:Boolean(km(a,c))}}catch(d){return{enabled:!1}}}return cT(d)}function kp({ipns:a,options:b}){let c=b.EXPERIMENTAL;async function d(b={}){let d=km(a,c);return d.getSubscriptions(b)}return cT(d)}class kq{constructor({ipns:a,options:b}){this.cancel=kn({ipns:a,options:b}),this.state=ko({ipns:a,options:b}),this.subs=kp({ipns:a,options:b})}}class kr{constructor({dns:a,ipns:b,repo:c,codecs:d,peerId:e,isOnline:f,keychain:g,options:h}){this.publish=kf({ipns:b,repo:c,codecs:d,peerId:e,isOnline:f,keychain:g}),this.resolve=kl({dns:a,ipns:b,isOnline:f,options:h}),this.pubsub=new kq({ipns:b,options:h})}}let ks=d5().code,kt={default:"<dst>",edges:"<src> -> <dst>"};function ku({repo:a,codecs:b,resolve:c,preload:d}){async function*e(e,f={}){if(0===f.maxDepth)return;if(f.edges&&f.format&&f.format!==kt.default)throw Error("Cannot set edges to true and also specify format");if(f.format=f.edges?kt.edges:f.format,"number"!=typeof f.maxDepth&&(f.maxDepth=f.recursive?1/0:1),f.timeout){let g=new cM.TimeoutController(f.timeout),h=[g.signal];f.signal&&h.push(f.signal),f.signal=(0,cN.anySignal)(h)}let i=Array.isArray(e)?e:[e],j=i.map(a=>kv(d,a,f));for(let k of j)try{yield*kw(c,a,b,k,f)}catch(l){yield{ref:"",err:l.message}}}return e}function kv(a,b,c){let{cid:d,path:e}=cV(b);return!1!==c.preload&&a(d),`/ipfs/${d}${e||""}`}async function*kw(a,b,c,d,e){let f=await a(d,e),{cid:g}=cV(f),h=null!=e.maxDepth?e.maxDepth:1/0,i=e.unique||!1;for await(let j of ky(b,c,g,h,i,e))j.parent&&!j.isDuplicate&&(yield{ref:kx(j.parent.cid,j.node.cid,j.node.name,e.format)})}function kx(a,b,c="",d=kt.default){let e=d.replace(/<src>/g,a.toString());return(e=e.replace(/<dst>/g,b.toString())).replace(/<linkname>/g,c)}async function*ky(a,b,c,d,e,f){let g=new Set;async function*h(c,i){let j=i+1;if(!(j>d))try{for await(let k of kz(a,b,c.cid,f))yield{parent:c,node:k,isDuplicate:e&&g.has(k.cid.toString())},e&&g.add(k.cid.toString()),yield*h(k,j)}catch(l){throw l.code===ks&&(l.message=`Could not find object with CID: ${c.cid}`),l}}yield*h({cid:c},0)}async function*kz(a,b,c,d){let e=await a.blocks.get(c,d),f=await b.getCodec(c.code),g=f.decode(e),h=c.code===bP,i=[];for(let[j,k]of kA(g,i)){if(h){let l=j.match(/^Links\/(\d+)\/Hash$/);if(l){let m=Number(l[1]);if(m<g.Links.length){yield{name:g.Links[m].Name,cid:k};continue}}}yield{name:j,cid:k}}}let kA=function*(a,b){if(!(null==a||a instanceof Uint8Array)){for(let[c,d]of Object.entries(a)){let e=[...b,c];if(null!=d&&"object"==typeof d){if(Array.isArray(d))for(let[f,g]of d.entries()){let h=[...e,f],i=bm.CID.asCID(g);i?yield[h.join("/"),i]:"object"==typeof g&&(yield*kA(g,h))}else{let j=bm.CID.asCID(d);j?yield[e.join("/"),j]:yield*kA(d,e)}}}return[]}};function kB({repo:a}){async function*b(b={}){for await(let c of a.blocks.queryKeys({},{signal:b.signal}))yield{ref:c.toString()}}return cT(b)}function kC({network:a}){async function b(b={}){let{bitswap:c}=await a.use(b),d=c.getWantlist();return Array.from(d).map(a=>a[1].cid)}return cT(b)}function kD({network:a}){async function b(b,c={}){let{bitswap:d}=await a.use(c),e=d.wantlistForPeer(b);return Array.from(e).map(a=>a[1].cid)}return cT(b)}function kE({network:a}){async function b(b,c={}){let{bitswap:d}=await a.use(c);return Array.isArray(b)||(b=[b]),d.unwant(b)}return cT(b)}function kF({network:a}){async function b(b={}){let c=(await a.use(b)).bitswap,d=c.stat().snapshot;return{provideBufLen:parseInt(d.providesBufferLength.toString()),blocksReceived:BigInt(d.blocksReceived.toString()),wantlist:Array.from(c.getWantlist()).map(a=>a[1].cid),peers:c.peers(),dupBlksReceived:BigInt(d.dupBlksReceived.toString()),dupDataReceived:BigInt(d.dupDataReceived.toString()),dataReceived:BigInt(d.dataReceived.toString()),blocksSent:BigInt(d.blocksSent.toString()),dataSent:BigInt(d.dataSent.toString())}}return cT(b)}class kG{constructor({network:a}){this.wantlist=kC({network:a}),this.wantlistForPeer=kD({network:a}),this.unwant=kE({network:a}),this.stat=kF({network:a})}}let kH="[a-fA-F\\d:]",kI=a=>a&&a.includeBoundaries?`(?:(?<=\\s|^)(?=${kH})|(?<=${kH})(?=\\s|$))`:"",kJ="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",kK="[a-fA-F\\d]{1,4}",kL=`
(?:
(?:${kK}:){7}(?:${kK}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${kK}:){6}(?:${kJ}|:${kK}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${kK}:){5}(?::${kJ}|(?::${kK}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${kK}:){4}(?:(?::${kK}){0,1}:${kJ}|(?::${kK}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${kK}:){3}(?:(?::${kK}){0,2}:${kJ}|(?::${kK}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${kK}:){2}(?:(?::${kK}){0,3}:${kJ}|(?::${kK}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${kK}:){1}(?:(?::${kK}){0,4}:${kJ}|(?::${kK}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${kK}){0,5}:${kJ}|(?::${kK}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),kM=RegExp(`(?:^${kJ}$)|(?:^${kL}$)`),kN=RegExp(`^${kJ}$`),kO=RegExp(`^${kL}$`),kP=a=>a&&a.exact?kM:RegExp(`(?:${kI(a)}${kJ}${kI(a)})|(?:${kI(a)}${kL}${kI(a)})`,"g");kP.v4=a=>a&&a.exact?kN:RegExp(`${kI(a)}${kJ}${kI(a)}`,"g"),kP.v6=a=>a&&a.exact?kO:RegExp(`${kI(a)}${kL}${kI(a)}`,"g");var kQ=kP;function kR(a){return kQ({exact:!0}).test(a)}function kS(a){return kQ.v6({exact:!0}).test(a)}function kT(a){return kQ.v4({exact:!0}).test(a)}let kU=kT,kV=kS,kW=function(a){let b=0,c;if(kU(a))c=new Uint8Array(b+4),a.split(/\./g).forEach(a=>{c[b++]=255&parseInt(a,10)});else if(kV(a)){let d=a.split(":",8),e;for(e=0;e<d.length;e++){let f=kU(d[e]),g;f&&(g=kW(d[e]),d[e]=(0,cE.toString)(g.slice(0,2),"base16")),null!=g&& ++e<8&&d.splice(e,0,(0,cE.toString)(g.slice(2,4),"base16"))}if(""===d[0])for(;d.length<8;)d.unshift("0");else if(""===d[d.length-1])for(;d.length<8;)d.push("0");else if(d.length<8){for(e=0;e<d.length&&""!==d[e];e++);let h=[e,1];for(e=9-d.length;e>0;e--)h.push("0");d.splice.apply(d,h)}for(e=0,c=new Uint8Array(b+16);e<d.length;e++){let i=parseInt(d[e],16);c[b++]=i>>8&255,c[b++]=255&i}}if(null==c)throw Error("Invalid ip address: "+a);return c},kX=function(a,b,c){b=~~b,c=c??a.length-b;let d=[],e="",f=new DataView(a.buffer);if(4===c){for(let g=0;g<c;g++)d.push(a[b+g]);e=d.join(".")}else if(16===c){for(let h=0;h<c;h+=2)d.push(f.getUint16(b+h).toString(16));e=(e=(e=d.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return e},kY=-1,kZ={},k$={},k_=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,kY,"ip6zone"],[53,kY,"dns",!0],[54,kY,"dns4",!0],[55,kY,"dns6",!0],[56,kY,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,kY,"unix",!1,!0],[421,kY,"ipfs"],[421,kY,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,kY,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,kY,"memory"]];function k0(a,b,c,d,e){return{code:a,size:b,name:c,resolvable:Boolean(d),path:Boolean(e)}}function k1(a){if("number"==typeof a){if(null!=k$[a])return k$[a];throw Error(`no protocol with code: ${a}`)}if("string"==typeof a){if(null!=kZ[a])return kZ[a];throw Error(`no protocol with name: ${a}`)}throw Error(`invalid protocol id type: ${typeof a}`)}k_.forEach(a=>{let b=k0(...a);k$[b.code]=b,kZ[b.name]=b});var k2=c(94676);function k3(a,b){let c=k1(a);switch(c.code){case 4:case 41:return k6(b);case 6:case 273:case 33:case 132:return k8(b).toString();case 53:case 54:case 55:case 56:case 400:case 777:return la(b);case 421:return lc(b);case 444:case 445:return lf(b);default:return(0,cE.toString)(b,"base16")}}function k4(a,b){let c=k1(a);switch(c.code){case 4:case 41:return k5(b);case 6:case 273:case 33:case 132:return k7(parseInt(b,10));case 53:case 54:case 55:case 56:case 400:case 777:return k9(b);case 421:return lb(b);case 444:return ld(b);case 445:return le(b);default:return(0,cB.fromString)(b,"base16")}}function k5(a){if(!kR(a))throw Error("invalid ip address");return kW(a)}function k6(a){let b=kX(a,0,a.length);if(null==b||!kR(b))throw Error("invalid ip address");return b}function k7(a){let b=new ArrayBuffer(2),c=new DataView(b);return c.setUint16(0,a),new Uint8Array(b)}function k8(a){let b=new DataView(a.buffer);return b.getUint16(a.byteOffset)}function k9(a){let b=(0,cB.fromString)(a),c=Uint8Array.from(k2.encode(b.length));return(0,d7.concat)([c,b],c.length+b.length)}function la(a){let b=k2.decode(a);if((a=a.slice(k2.decode.bytes)).length!==b)throw Error("inconsistent lengths");return(0,cE.toString)(a)}function lb(a){let b;b="Q"===a[0]||"1"===a[0]?dy.decode(a3.base58btc.decode(`z${a}`)).bytes:bm.CID.parse(a).multihash.bytes;let c=Uint8Array.from(k2.encode(b.length));return(0,d7.concat)([c,b],c.length+b.length)}function lc(a){let b=k2.decode(a),c=a.slice(k2.decode.bytes);if(c.length!==b)throw Error("inconsistent lengths");return(0,cE.toString)(c,"base58btc")}function ld(a){let b=a.split(":");if(2!==b.length)throw Error(`failed to parse onion addr: ["'${b.join('", "')}'"]' does not contain a port number`);if(16!==b[0].length)throw Error(`failed to parse onion addr: ${b[0]} not a Tor onion address.`);let c=a4.base32.decode("b"+b[0]),d=parseInt(b[1],10);if(d<1||d>65536)throw Error("Port number is not in range(1, 65536)");let e=k7(d);return(0,d7.concat)([c,e],c.length+e.length)}function le(a){let b=a.split(":");if(2!==b.length)throw Error(`failed to parse onion addr: ["'${b.join('", "')}'"]' does not contain a port number`);if(56!==b[0].length)throw Error(`failed to parse onion addr: ${b[0]} not a Tor onion3 address.`);let c=a4.base32.decode(`b${b[0]}`),d=parseInt(b[1],10);if(d<1||d>65536)throw Error("Port number is not in range(1, 65536)");let e=k7(d);return(0,d7.concat)([c,e],c.length+e.length)}function lf(a){let b=a.slice(0,a.length-2),c=a.slice(a.length-2),d=(0,cE.toString)(b,"base32"),e=k8(c);return`${d}:${e}`}function lg(a){let b=[],c=a.split("/").slice(1);if(1===c.length&&""===c[0])return[];for(let d=0;d<c.length;d++){let e=c[d],f=k1(e);if(0===f.size){b.push([e]);continue}if(++d>=c.length)throw lt("invalid address: "+a);if(!0===f.path){b.push([e,ls(c.slice(d).join("/"))]);break}b.push([e,c[d]])}return b}function lh(a){let b=[];return a.map(a=>{let c=lu(a);return b.push(c.name),a.length>1&&null!=a[1]&&b.push(a[1]),null}),ls(b.join("/"))}function li(a){return a.map(a=>{Array.isArray(a)||(a=[a]);let b=lu(a);return a.length>1?[b.code,k4(b.code,a[1])]:[b.code]})}function lj(a){return a.map(a=>{let b=lu(a);return null!=a[1]?[b.code,k3(b.code,a[1])]:[b.code]})}function lk(a){return lq((0,d7.concat)(a.map(a=>{let b=lu(a),c=Uint8Array.from(k2.encode(b.code));return a.length>1&&null!=a[1]&&(c=(0,d7.concat)([c,a[1]])),c})))}function ll(a,b){if(a.size>0)return a.size/8;if(0===a.size)return 0;{let c=k2.decode(b);return c+k2.decode.bytes}}function lm(a){let b=[],c=0;for(;c<a.length;){let d=k2.decode(a,c),e=k2.decode.bytes,f=k1(d),g=ll(f,a.slice(c+e));if(0===g){b.push([d]),c+=e;continue}let h=a.slice(c+e,c+e+g);if((c+=g+e)>a.length)throw lt("Invalid address Uint8Array: "+(0,cE.toString)(a,"base16"));b.push([d,h])}return b}function ln(a){let b=lm(a),c=lj(b);return lh(c)}function lo(a){a=ls(a);let b=lg(a),c=li(b);return lk(c)}function lp(a){return lo(a)}function lq(a){let b=lr(a);if(null!=b)throw b;return Uint8Array.from(a)}function lr(a){try{lm(a)}catch(b){return b}}function ls(a){return"/"+a.trim().split("/").filter(a=>a).join("/")}function lt(a){return Error("Error parsing address: "+a)}function lu(a){let b=k1(a[0]);return b}let lv=Symbol.for("nodejs.util.inspect.custom"),lw=[k1("ip4").code,k1("ip6").code],lx=[k1("dns").code,k1("dns4").code,k1("dns6").code,k1("dnsaddr").code],ly=[k1("p2p").code,k1("ipfs").code],lz=[k1("tcp").code,k1("udp").code],lA=new Map,lB=Symbol.for("@multiformats/js-multiaddr/multiaddr");class lC{constructor(a){if(null==a&&(a=""),Object.defineProperty(this,lB,{value:!0}),a instanceof Uint8Array)this.bytes=lq(a);else if("string"==typeof a){if(a.length>0&&"/"!==a.charAt(0))throw Error(`multiaddr "${a}" must start with a "/"`);this.bytes=lp(a)}else if(lC.isMultiaddr(a))this.bytes=lq(a.bytes);else throw Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return ln(this.bytes)}toJSON(){return this.toString()}toOptions(){let a=this.protoCodes(),b=this.toString().split("/").slice(1),c,d;if(b.length>2)lx.includes(a[0])&&ly.includes(a[1])?(c=k1("tcp").name,d=443):(c=k1(b[2]).name,d=parseInt(b[3]));else if(lx.includes(a[0]))c=k1("tcp").name,d=443;else throw Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');let e={family:41===a[0]||55===a[0]?6:4,host:b[1],transport:c,port:d};return e}protos(){return this.protoCodes().map(a=>Object.assign({},k1(a)))}protoCodes(){let a=[],b=this.bytes,c=0;for(;c<b.length;){let d=k2.decode(b,c),e=k2.decode.bytes,f=k1(d),g=ll(f,b.slice(c+e));c+=g+e,a.push(d)}return a}protoNames(){return this.protos().map(a=>a.name)}tuples(){return lm(this.bytes)}stringTuples(){let a=lm(this.bytes);return lj(a)}encapsulate(a){return a=new lC(a),new lC(this.toString()+a.toString())}decapsulate(a){let b=a.toString(),c=this.toString(),d=c.lastIndexOf(b);if(d<0)throw Error(`Address ${this.toString()} does not contain subaddress: ${a.toString()}`);return new lC(c.slice(0,d))}decapsulateCode(a){let b=this.tuples();for(let c=b.length-1;c>=0;c--)if(b[c][0]===a)return new lC(lk(b.slice(0,c)));return this}getPeerId(){try{let a=this.stringTuples().filter(a=>a[0]===kZ.ipfs.code),b=a.pop();if(b?.[1]!=null){let c=b[1];if("Q"===c[0]||"1"===c[0])return(0,cE.toString)(a3.base58btc.decode(`z${c}`),"base58btc");return(0,cE.toString)(bm.CID.parse(c).multihash.bytes,"base58btc")}return null}catch(d){return null}}getPath(){let a=null;try{a=this.stringTuples().filter(a=>{let b=k1(a[0]);return!0===b.path})[0][1],null==a&&(a=null)}catch{a=null}return a}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async resolve(a){let b=this.protos().find(a=>a.resolvable);if(null==b)return[this];let c=lA.get(b.name);if(null==c)throw a7(Error(`no available resolver for ${b.name}`),"ERR_NO_AVAILABLE_RESOLVER");let d=await c(this,a);return d.map(a=>new lC(a))}nodeAddress(){let a=this.protoCodes(),b=this.protoNames(),c=this.toString().split("/").slice(1),d=k1(c[2]).code,e=parseInt(c[3]);if(lx.includes(a[0])&&ly.includes(a[1])&&(d=k1("tcp").code,e=443),c.length<4)throw Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');if(lw.includes(a[0])||lx.includes(a[0])){if(!lz.includes(d))throw Error(`no protocol with name: "'${b[1]}'". Must have a valid transport protocol: "{tcp, udp}".`)}else throw Error(`no protocol with name: "'${b[0]}'". Must have a valid family name: "{ip4, ip6, dns, dns4, dns6, dnsaddr}".`);return{family:41===a[0]||55===a[0]?6:4,address:c[1],port:e}}isThinWaistAddress(a){let b=(a??this).protos();return 2===b.length&&(4===b[0].code||41===b[0].code)&&(6===b[1].code||273===b[1].code)}static fromNodeAddress(a,b){if(null==a)throw Error("requires node address object");if(null==b)throw Error("requires transport protocol");let c;switch(a.family){case 4:c="ip4";break;case 6:c="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new lC("/"+[c,a.address,b,a.port].join("/"))}static isName(a){return!!lC.isMultiaddr(a)&&a.protos().some(a=>a.resolvable)}static isMultiaddr(a){return Boolean(a?.[lB])}[lv](){return"<Multiaddr "+(0,cE.toString)(this.bytes,"base16")+" - "+ln(this.bytes)+">"}inspect(){return"<Multiaddr "+(0,cE.toString)(this.bytes,"base16")+" - "+ln(this.bytes)+">"}}lC.resolvers=lA;let lD=l0("dns4"),lE=l0("dns6"),lF=l0("dnsaddr"),lG=l_(l0("dns"),lF,lD,lE),lH=l_(l0("ip4"),l0("ip6")),lI=l_(l$(lH,l0("tcp")),l$(lG,l0("tcp"))),lJ=l$(lH,l0("udp")),lK=l$(lJ,l0("utp")),lL=l$(lJ,l0("quic")),lM=l_(l$(lI,l0("ws")),l$(lG,l0("ws"))),lN=l_(l$(lI,l0("wss")),l$(lG,l0("wss"))),lO=l_(l$(lI,l0("http")),l$(lH,l0("http")),l$(lG,l0("http"))),lP=l_(l$(lI,l0("https")),l$(lH,l0("https")),l$(lG,l0("https"))),lQ=l_(l$(lM,l0("p2p-webrtc-star"),l0("p2p")),l$(lN,l0("p2p-webrtc-star"),l0("p2p")),l$(lM,l0("p2p-webrtc-star")),l$(lN,l0("p2p-webrtc-star")));l_(l$(lM,l0("p2p-websocket-star"),l0("p2p")),l$(lN,l0("p2p-websocket-star"),l0("p2p")),l$(lM,l0("p2p-websocket-star")),l$(lN,l0("p2p-websocket-star")));let lR=l_(l$(lO,l0("p2p-webrtc-direct"),l0("p2p")),l$(lP,l0("p2p-webrtc-direct"),l0("p2p")),l$(lO,l0("p2p-webrtc-direct")),l$(lP,l0("p2p-webrtc-direct"))),lS=l_(lM,lN,lO,lP,lQ,lR,lI,lK,lL,lG);l_(l$(lS,l0("p2p-stardust"),l0("p2p")),l$(lS,l0("p2p-stardust")));let lT=l_(l$(lS,l0("p2p")),lQ,lR,l0("p2p")),lU=l_(l$(lT,l0("p2p-circuit"),lT),l$(lT,l0("p2p-circuit")),l$(l0("p2p-circuit"),lT),l$(lS,l0("p2p-circuit")),l$(l0("p2p-circuit"),lS),l0("p2p-circuit")),lV=()=>l_(l$(lU,lV),lU),lW=lV(),lX=l_(l$(lW,lT,lW),l$(lT,lW),l$(lW,lT),lW,lT),lY=lX;function lZ(a){function b(b){let c;try{c=new lC(b)}catch(d){return!1}let e=a(c.protoNames());return null!==e&&(!0===e|| !1===e?e:0===e.length)}return b}function l$(...a){function b(b){if(b.length<a.length)return null;let c=b;return a.some(a=>(Array.isArray(c="function"==typeof a?a().partialMatch(b):a.partialMatch(b))&&(b=c),null===c)),c}return{toString:function(){return"{ "+a.join(" ")+" }"},input:a,matches:lZ(b),partialMatch:b}}function l_(...a){function b(b){let c=null;return a.some(a=>{let d="function"==typeof a?a().partialMatch(b):a.partialMatch(b);return null!=d&&(c=d,!0)}),c}let c={toString:function(){return"{ "+a.join(" ")+" }"},input:a,matches:lZ(b),partialMatch:b};return c}function l0(a){let b=a;function c(a){let c;try{c=new lC(a)}catch(d){return!1}let e=c.protoNames();return 1===e.length&&e[0]===b}function d(a){return 0===a.length?null:a[0]===b?a.slice(1):null}return{toString:function(){return b},matches:c,partialMatch:d}}function l1(a){try{return lY.matches(a)}catch(b){return!1}}function l2({repo:a}){async function b(b,c={}){if(!l1(b))throw Error(`${b} is not a valid Multiaddr`);let d=await a.config.getAll(c),e=d.Bootstrap||[];return e.push(b.toString()),d.Bootstrap=Array.from(new Set(e)).sort((a,b)=>a.localeCompare(b)),await a.config.replace(d),{Peers:[b]}}return cT(b)}function l3({repo:a}){async function b(b={}){let c=await a.config.getAll(b),d=c.Bootstrap||[];return c.Bootstrap=[],await a.config.replace(c),{Peers:d.map(a=>new lC(a))}}return cT(b)}function l4({repo:a}){async function b(b={}){let c=await a.config.get("Bootstrap",b);return{Peers:(c||[]).map(a=>new lC(a))}}return cT(b)}var l5=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function l6({repo:a}){async function b(b={}){let c=await a.config.getAll(b);return c.Bootstrap=l5().Bootstrap,await a.config.replace(c),{Peers:l5().Bootstrap.map(a=>new lC(a))}}return cT(b)}function l7({repo:a}){async function b(b,c={}){if(!l1(b))throw Error(`${b} is not a valid Multiaddr`);let d=await a.config.getAll(c);return d.Bootstrap=(d.Bootstrap||[]).filter(a=>a.toString()!==b.toString()),await a.config.replace(d),{Peers:[b]}}return cT(b)}class l8{constructor({repo:a}){this.add=l2({repo:a}),this.list=l4({repo:a}),this.rm=l7({repo:a}),this.clear=l3({repo:a}),this.reset=l6({repo:a})}}function l9({preload:a,repo:b}){async function c(c,d={}){return!1!==d.preload&&a(c),b.blocks.get(c,d)}return cT(c)}function ma({codecs:a,hashers:b,repo:c,preload:d}){async function e(e,f={}){let g=f.pin?await c.gcLock.readLock():null;try{let h=null!=f.version?f.version:0,i=f.format||(0===h?"dag-pb":"raw"),j=await b.getHasher(f.mhtype||"sha2-256"),k=await j.digest(e),l=await a.getCodec(i),m=bm.CID.create(h,l.code,k);return await c.blocks.put(m,e,{signal:f.signal}),!1!==f.preload&&d(m),!0===f.pin&&await c.pins.pinRecursively(m,{signal:f.signal}),m}finally{g&&g()}}return cT(e)}var mb=c(58869);class mc{constructor(a){if(!(a>0)||(a-1&a)!=0)throw Error("Max size for a FixedFIFO should be a power of two");this.buffer=Array(a),this.mask=a-1,this.top=0,this.btm=0,this.next=null}push(a){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=a,this.top=this.top+1&this.mask,!0)}shift(){let a=this.buffer[this.btm];if(void 0!==a)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,a}isEmpty(){return void 0===this.buffer[this.btm]}}class md{constructor(a={}){this.hwm=a.splitLimit??16,this.head=new mc(this.hwm),this.tail=this.head,this.size=0}calculateSize(a){return a?.byteLength!=null?a.byteLength:1}push(a){if(a?.value!=null&&(this.size+=this.calculateSize(a.value)),!this.head.push(a)){let b=this.head;this.head=b.next=new mc(2*this.head.buffer.length),this.head.push(a)}}shift(){let a=this.tail.shift();if(void 0===a&&null!=this.tail.next){let b=this.tail.next;this.tail.next=null,this.tail=b,a=this.tail.shift()}return a?.value!=null&&(this.size-=this.calculateSize(a.value)),a}isEmpty(){return this.head.isEmpty()}}function me(a={}){let b=a=>{let b=a.shift();if(null==b)return{done:!0};if(null!=b.error)throw b.error;return{done:!0===b.done,value:b.value}};return mf(b,a)}function mf(a,b){let c=(b=b??{}).onEnd,d=new md,e,f,g,h=async()=>d.isEmpty()?g?{done:!0}:await new Promise((b,c)=>{f=g=>{f=null,d.push(g);try{b(a(d))}catch(h){c(h)}return e}}):a(d),i=a=>null!=f?f(a):(d.push(a),e),j=a=>(d=new md,null!=f)?f({error:a}):(d.push({error:a}),e),k=a=>{if(g)return e;if(b?.objectMode!== !0&&a?.byteLength==null)throw Error("objectMode was not true but tried to push non-Uint8Array value");return i({done:!1,value:a})},l=a=>g?e:(g=!0,null!=a?j(a):i({done:!0})),m=()=>(d=new md,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l,get readableLength(){return d.size}},null==c)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),null!=c&&(c(a),c=void 0),{done:!0}},return(){return o.return(),null!=c&&(c(),c=void 0),{done:!0}},push:k,end(a){return o.end(a),null!=c&&(c(a),c=void 0),e},get readableLength(){return o.readableLength}}}let mg=(...a)=>{let b;for(;a.length>0;)b=a.shift()(b);return b},mh=a=>null!=a&&("function"==typeof a[Symbol.asyncIterator]||"function"==typeof a[Symbol.iterator]||"function"==typeof a.next),mi=a=>null!=a&&"function"==typeof a.sink&&mh(a.source),mj=a=>b=>{let c=a.sink(b);if(null!=c.then){let d=me({objectMode:!0});c.then(()=>{d.end()},a=>{d.end(a)});let e=async function*(){yield*a.source,d.end()};return jW(d,e())}return a.source};function mk(a,...b){if(mi(a)){let c=a;a=()=>c.source}else if(mh(a)){let d=a;a=()=>d}let e=[a,...b];if(e.length>1&&mi(e[e.length-1])&&(e[e.length-1]=e[e.length-1].sink),e.length>2)for(let f=1;f<e.length-1;f++)mi(e[f])&&(e[f]=mj(e[f]));return mg(...e)}function ml(a){return a instanceof Uint8Array?bm.CID.decode(a):bm.CID.parse(a.toString())}let mm=8;function mn({repo:a}){async function*b(b,c={}){Array.isArray(b)||(b=[b]);let d=await a.gcLock.writeLock();try{yield*mk(b,b=>jS(b,b=>async()=>{b=ml(b);let d={cid:b};try{let e=await a.blocks.has(b);if(!e)throw a7(Error("block not found"),"ERR_BLOCK_NOT_FOUND");await a.blocks.delete(b)}catch(f){c.force||(f.message=`cannot remove ${b}: ${f.message}`,d.error=f)}return d}),a=>mb(a,{concurrency:mm}),a=>jD(a,()=>!c.quiet))}finally{d()}}return cT(b)}function mo({repo:a,preload:b}){async function c(c,d={}){c=ml(c),!1!==d.preload&&b(c);let e=await a.blocks.get(c);return{cid:c,size:e.length}}return cT(c)}class mp{constructor({codecs:a,hashers:b,preload:c,repo:d}){this.get=l9({preload:c,repo:d}),this.put=ma({codecs:a,hashers:b,preload:c,repo:d}),this.rm=mn({repo:d}),this.stat=mo({preload:c,repo:d})}}var mq=c(86154),mr=c(23294),ms=c(28132);function mt(a){return ArrayBuffer.isView(a)||a instanceof ArrayBuffer}function mu(a){return a.constructor&&("Blob"===a.constructor.name||"File"===a.constructor.name)&&"function"==typeof a.stream}function mv(a){return"object"==typeof a&&(a.path||a.content)}let mw=a=>a&&"function"==typeof a.getReader;async function*mx(a){yield a}async function my(a){if(mt(a))return mx(mz(a));if("string"==typeof a||a instanceof String)return mx(mz(a.toString()));if(mu(a))return mr(a);if(mw(a)&&(a=mq(a)),Symbol.iterator in a||Symbol.asyncIterator in a){let b=ms(a),{value:c,done:d}=await b.peek();if(d)return mx(new Uint8Array(0));if(b.push(c),Number.isInteger(c))return mx(Uint8Array.from(await jA(b)));if(mt(c)||"string"==typeof c||c instanceof String)return jS(b,mz)}throw a7(Error(`Unexpected input: ${a}`),"ERR_UNEXPECTED_INPUT")}function mz(a){return a instanceof Uint8Array?a:ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a instanceof ArrayBuffer?new Uint8Array(a):Array.isArray(a)?Uint8Array.from(a):(0,cB.fromString)(a.toString())}async function*mA(a,b){if(null==a)throw a7(Error(`Unexpected input: ${a}`),"ERR_UNEXPECTED_INPUT");if("string"==typeof a||a instanceof String){yield mB(a.toString(),b);return}if(mt(a)||mu(a)){yield mB(a,b);return}if(mw(a)&&(a=mq(a)),Symbol.iterator in a||Symbol.asyncIterator in a){let c=ms(a),{value:d,done:e}=await c.peek();if(e){yield{content:[]};return}if(c.push(d),Number.isInteger(d)||mt(d)||"string"==typeof d||d instanceof String){yield mB(c,b);return}throw a7(Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(mv(a)){yield mB(a,b);return}throw a7(Error('Unexpected input: cannot convert "'+typeof a+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function mB(a,b){let{path:c,mode:d,mtime:e,content:f}=a,g={path:c||"",mode:bj(d),mtime:bk(e)};return f?g.content=await b(f):c||(g.content=await b(a)),g}function mC(a){return mA(a,my)}function mD({addAll:a}){async function b(b,c={}){let d=await dR(a(mC(b),c));if(null==d)throw Error("Failed to add a file, if you see this please report a bug");return d}return b}var mE=c(84810),mF=c(7225),mG=c(40469);function mH(a){let b=[,,,,];for(let c=0;c<4;c++)b[c]=255&a,a>>=8;return new Uint8Array(b)}(0,mF.D)({name:"murmur3-32",code:35,encode:a=>mH(mG.x86.hash32(a))});let mI=(0,mF.D)({name:"murmur3-128",code:34,encode:a=>b2.aI.fromHex(mG.x64.hash128(a))});async function mJ(a){return(await mI.encode(a)).slice(0,8).reverse()}let mK={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:dA.sha256,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:mJ,hamtHashCode:34,hamtBucketBits:8};var mL=(a={})=>{let b=a0.bind({ignoreUndefined:!0});return b(mK,a)};let mM=async(a,b,c)=>{c.codec||(c.codec=aQ),c.hasher||(c.hasher=dA.sha256),void 0===c.cidVersion&&(c.cidVersion=1),c.codec===aQ&&c.hasher!==dA.sha256&&(c.cidVersion=1);let d=await c.hasher.digest(a),e=bm.CID.create(c.cidVersion,c.codec.code,d);return c.onlyHash||await b.put(e,a,{signal:c.signal}),e};var mN=mM;let mO=async(a,b,c)=>{let d=new bl({type:"directory",mtime:a.mtime,mode:a.mode}),e=bQ(bK({Data:d.marshal()})),f=await mN(e,b,c),g=a.path;return{cid:f,path:g,unixfs:d,size:e.length}};var mP=mO,mQ=c(96945);async function mR(a,b){return b(await jA(a))}var mS=mR,mT=c(78165);function mU(a,b,c){return mV(a,b,c)}async function mV(a,b,c){let d=[];for await(let e of mT(a,c.maxChildrenPerNode))d.push(await b(e));return d.length>1?mV(d,b,c):d[0]}var mW=mU;async function mX(a,b,c){let d=new m$(c.layerRepeat),e=0,f=1,g=d;for await(let h of mT(a,c.maxChildrenPerNode))g.isFull()&&(g!==d&&d.addChild(await g.reduce(b)),e&&e%c.layerRepeat==0&&f++,g=new mZ(f,c.layerRepeat,e),e++),g.append(h);return g&&g!==d&&d.addChild(await g.reduce(b)),d.reduce(b)}var mY=mX;class mZ{constructor(a,b,c=0){this.maxDepth=a,this.layerRepeat=b,this.currentDepth=1,this.iteration=c,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:a,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let a=this._findParent(this.node,this.currentDepth);return!a||(this._addNextNodeToParent(a),!1)}_addNextNodeToParent(a){this.parent=a;let b={children:[],depth:a.depth+1,parent:a,maxDepth:this.maxDepth,maxChildren:Math.floor(a.children.length/this.layerRepeat)*this.layerRepeat};a.children.push(b),this.currentDepth=b.depth,this.node=b}append(a){this.node.data=a}reduce(a){return this._reduce(this.root,a)}async _reduce(a,b){let c=[];return a.children.length&&(c=await Promise.all(a.children.filter(a=>a.data).map(a=>this._reduce(a,b)))),b((a.data||[]).concat(c))}_findParent(a,b){let c=a.parent;return c&&0!==c.depth?c.children.length!==c.maxChildren&&c.maxChildren?c:this._findParent(c,b):void 0}}class m$ extends mZ{constructor(a){super(0,a),this.root.depth=0,this.currentDepth=1}addChild(a){this.root.children.push(a)}reduce(a){return a((this.root.data||[]).concat(this.root.children))}}async function*m_(a,b,c){for await(let d of a.content)yield async()=>{c.progress(d.length,a.path);let e,f={codec:aQ,cidVersion:c.cidVersion,hasher:c.hasher,onlyHash:c.onlyHash};return c.rawLeaves?(f.codec=mQ,f.cidVersion=1):(e=new bl({type:c.leafType,data:d}),d=bQ({Data:e.marshal(),Links:[]})),{cid:await mN(d,b,f),unixfs:e,size:d.length}}}var m0=m_;let m1={flat:mS,balanced:mW,trickle:mY};async function*m2(a,b,c){let d=-1,e,f;for await(let g of(f="function"==typeof c.bufferImporter?c.bufferImporter:m0,mE(f(a,b,c),c.blockWriteConcurrency))){if(0== ++d){e=g;continue}1===d&&e&&(yield e,e=null),yield g}e&&(e.single=!0,yield e)}let m3=(a,b,c)=>{async function d(d){if(1===d.length&&d[0].single&&c.reduceSingleLeafToSelf){let e=d[0];if(void 0!==a.mtime|| void 0!==a.mode){let f=await b.get(e.cid);e.unixfs=new bl({type:"file",mtime:a.mtime,mode:a.mode,data:f}),f=bQ(bK({Data:e.unixfs.marshal()})),e.cid=await mN(f,b,{...c,codec:aQ,hasher:c.hasher,cidVersion:c.cidVersion}),e.size=f.length}return{cid:e.cid,path:a.path,unixfs:e.unixfs,size:e.size}}let g=new bl({type:"file",mtime:a.mtime,mode:a.mode}),h=d.filter(a=>!!(a.cid.code===mQ.code&&a.size||a.unixfs&&!a.unixfs.data&&a.unixfs.fileSize())||Boolean(a.unixfs&&a.unixfs.data&&a.unixfs.data.length)).map(a=>a.cid.code===mQ.code?(g.addBlockSize(a.size),{Name:"",Tsize:a.size,Hash:a.cid}):(a.unixfs&&a.unixfs.data?g.addBlockSize(a.unixfs.data.length):g.addBlockSize(a.unixfs&&a.unixfs.fileSize()||0),{Name:"",Tsize:a.size,Hash:a.cid})),i={Data:g.marshal(),Links:h},j=bQ(bK(i)),k=await mN(j,b,c);return{cid:k,path:a.path,unixfs:g,size:j.length+i.Links.reduce((a,b)=>a+b.Tsize,0)}}return d};function m4(a,b,c){let d=m1[c.strategy];if(!d)throw a7(Error(`Unknown importer build strategy name: ${c.strategy}`),"ERR_BAD_STRATEGY");return d(m2(a,b,c),m3(a,b,c),c)}var m5=m4,m6=c(9668),m7=c(63060);async function*m8(a,b){let c,d,e;if(b.minChunkSize&&b.maxChunkSize&&b.avgChunkSize)e=b.avgChunkSize,c=b.minChunkSize,d=b.maxChunkSize;else if(b.avgChunkSize)c=(e=b.avgChunkSize)/3,d=e+e/2;else throw a7(Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(c<16)throw a7(Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");d<c&&(d=c),e<c&&(e=c);let f=Math.floor(Math.log2(e));for await(let g of na(a,{min:c,max:d,bits:f,window:b.window,polynomial:b.polynomial}))yield g}var m9=m8;async function*na(a,b){let c=await (0,m7.create)(b.bits,b.min,b.max,b.window),d=new m6;for await(let e of a){d.append(e);let f=c.fingerprint(e);for(let g=0;g<f.length;g++){let h=f[g],i=d.slice(0,h);d.consume(h),yield i}}d.length&&(yield d.slice(0))}async function*nb(a,b){let c=new m6,d=0,e=!1,f=b.maxChunkSize;for await(let g of a)for(c.append(g),d+=g.length;d>=f;)if(yield c.slice(0,f),e=!0,f===c.length)c=new m6,d=0;else{let h=new m6;h.append(c.shallowSlice(f)),c=h,d-=f}(!e||d)&&(yield c.slice(0,d))}var nc=nb;async function*nd(a){for await(let b of a){if(void 0===b.length)throw a7(Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"==typeof b||b instanceof String)yield(0,cB.fromString)(b.toString());else if(Array.isArray(b))yield Uint8Array.from(b);else if(b instanceof Uint8Array)yield b;else throw a7(Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var ne=nd;function nf(a){return Symbol.iterator in a}function ng(a){return Symbol.asyncIterator in a}function nh(a){try{if(a instanceof Uint8Array)return async function*(){yield a}();if(nf(a))return async function*(){yield*a}();if(ng(a))return a}catch{throw a7(Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw a7(Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*ni(a,b,c){for await(let d of a)if(d.path&&("./"===d.path.substring(0,2)&&(c.wrapWithDirectory=!0),d.path=d.path.split("/").filter(a=>a&&"."!==a).join("/")),d.content){let e;e="function"==typeof c.chunker?c.chunker:"rabin"===c.chunker?m9:nc;let f;f="function"==typeof c.chunkValidator?c.chunkValidator:ne;let g={path:d.path,mtime:d.mtime,mode:d.mode,content:e(f(nh(d.content),c),c)};yield()=>m5(g,b,c)}else if(d.path){let h={path:d.path,mtime:d.mtime,mode:d.mode};yield()=>mP(h,b,c)}else throw Error("Import candidate must have content or path or both")}var nj=ni;class nk{constructor(a,b){this.options=b||{},this.root=a.root,this.dir=a.dir,this.path=a.path,this.dirty=a.dirty,this.flat=a.flat,this.parent=a.parent,this.parentKey=a.parentKey,this.unixfs=a.unixfs,this.mode=a.mode,this.mtime=a.mtime,this.cid=void 0,this.size=void 0}async put(a,b){}get(a){return Promise.resolve(this)}async *eachChildSeries(){}async *flush(a){}}var nl=nk;class nm extends nl{constructor(a,b){super(a,b),this._children={}}async put(a,b){this.cid=void 0,this.size=void 0,this._children[a]=b}get(a){return Promise.resolve(this._children[a])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async *eachChildSeries(){let a=Object.keys(this._children);for(let b=0;b<a.length;b++){let c=a[b];yield{key:c,child:this._children[c]}}}async *flush(a){let b=Object.keys(this._children),c=[];for(let d=0;d<b.length;d++){let e=this._children[b[d]];if(e instanceof nl)for await(let f of e.flush(a))yield e=f;null!=e.size&&e.cid&&c.push({Name:b[d],Tsize:e.size,Hash:e.cid})}let g=new bl({type:"directory",mtime:this.mtime,mode:this.mode}),h={Data:g.marshal(),Links:c},i=bQ(bK(h)),j=await mN(i,a,this.options),k=i.length+h.Links.reduce((a,b)=>a+(null==b.Tsize?0:b.Tsize),0);this.cid=j,this.size=k,yield{cid:j,unixfs:g,path:this.path,size:k}}}var nn=nm,no=c(54563);class np extends nl{constructor(a,b){super(a,b),this._bucket=(0,no.createHAMT)({hashFn:b.hamtHashFn,bits:b.hamtBucketBits})}async put(a,b){await this._bucket.put(a,b)}get(a){return this._bucket.get(a)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async *eachChildSeries(){for await(let{key:a,value:b}of this._bucket.eachLeafSeries())yield{key:a,child:b}}async *flush(a){for await(let b of nr(this._bucket,a,this,this.options))yield{...b,path:this.path}}}var nq=np;async function*nr(a,b,c,d){let e=a._children,f=[],g=0;for(let h=0;h<e.length;h++){let i=e.get(h);if(!i)continue;let j=h.toString(16).toUpperCase().padStart(2,"0");if(i instanceof no.Bucket){let k;for await(let l of(await nr(i,b,null,d)))k=l;if(!k)throw Error("Could not flush sharded directory, no subshard found");f.push({Name:j,Tsize:k.size,Hash:k.cid}),g+=k.size}else if("function"==typeof i.value.flush){let m=i.value,n;for await(let o of m.flush(b))yield n=o;let p=j+i.key;f.push({Name:p,Tsize:n.size,Hash:n.cid}),g+=n.size}else{let q=i.value;if(!q.cid)continue;let r=j+i.key,s=q.size;f.push({Name:r,Tsize:s,Hash:q.cid}),g+=s}}let t=Uint8Array.from(e.bitField().reverse()),u=new bl({type:"hamt-sharded-directory",data:t,fanout:a.tableSize(),hashType:d.hamtHashCode,mtime:c&&c.mtime,mode:c&&c.mode}),v={Data:u.marshal(),Links:f},w=bQ(bK(v)),x=await mN(w,b,d),y=w.length+g;yield{cid:x,unixfs:u,size:y}}async function ns(a,b,c,d){let e=b;b instanceof nn&&b.directChildrenCount()>=c&&(e=await nt(b,d));let f=e.parent;if(f){if(e!==b){if(a&&(a.parent=e),!e.parentKey)throw Error("No parent key found");await f.put(e.parentKey,e)}return ns(e,f,c,d)}return e}async function nt(a,b){let c=new nq({root:a.root,dir:!0,parent:a.parent,parentKey:a.parentKey,path:a.path,dirty:a.dirty,flat:!1,mtime:a.mtime,mode:a.mode},b);for await(let{key:d,child:e}of a.eachChildSeries())await c.put(d,e);return c}var nu=ns;let nv=(a="")=>(a.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);var nw=nv;async function nx(a,b,c){let d=nw(a.path||""),e=d.length-1,f=b,g="";for(let h=0;h<d.length;h++){let i=d[h];g+=`${g?"/":""}${i}`;let j=h===e;if(f.dirty=!0,f.cid=void 0,f.size=void 0,j)await f.put(i,a),b=await nu(null,f,c.shardSplitThreshold,c);else{let k=await f.get(i);k&&k instanceof nl||(k=new nn({root:!1,dir:!0,parent:f,parentKey:i,path:g,dirty:!0,flat:!0,mtime:k&&k.unixfs&&k.unixfs.mtime,mode:k&&k.unixfs&&k.unixfs.mode},c)),await f.put(i,k),f=k}}return b}async function*ny(a,b){if(!(a instanceof nl)){a&&a.unixfs&&a.unixfs.isDirectory()&&(yield a);return}yield*a.flush(b)}async function*nz(a,b,c){let d=new nn({root:!0,dir:!0,path:"",dirty:!0,flat:!0},c);for await(let e of a)e&&(d=await nx(e,d,c),e.unixfs&&e.unixfs.isDirectory()||(yield e));if(c.wrapWithDirectory)yield*ny(d,b);else for await(let f of d.eachChildSeries())f&&(yield*ny(f.child,b))}var nA=nz;async function*nB(a,b,c={}){let d=mL(c),e;e="function"==typeof c.dagBuilder?c.dagBuilder:nj;let f;f="function"==typeof c.treeBuilder?c.treeBuilder:nA;let g;for await(let h of f(mE(e(g=Symbol.asyncIterator in a||Symbol.iterator in a?a:[a],b,d),d.fileImportConcurrency),b,d))yield{cid:h.cid,path:h.path,unixfs:h.unixfs,size:h.size}}async function*nC(a,b){if("string"==typeof a||a instanceof String||mt(a)||mu(a)||a._readableState)throw a7(Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(mw(a)&&(a=mq(a)),Symbol.iterator in a||Symbol.asyncIterator in a){let c=ms(a),{value:d,done:e}=await c.peek();if(e){yield*[];return}if(c.push(d),Number.isInteger(d))throw a7(Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(d._readableState){yield*jS(c,a=>nD({content:a},b));return}if(mt(d)){yield nD({content:c},b);return}if(mv(d)||d[Symbol.iterator]||d[Symbol.asyncIterator]||mw(d)||mu(d)){yield*jS(c,a=>nD(a,b));return}}if(mv(a))throw a7(Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw a7(Error("Unexpected input: "+typeof a),"ERR_UNEXPECTED_INPUT")}async function nD(a,b){let{path:c,mode:d,mtime:e,content:f}=a,g={path:c||"",mode:bj(d),mtime:bk(e)};return f?g.content=await b(f):c||(g.content=await b(a)),g}function nE(a){return nC(a,my)}let nF=a=>{if(!a)return{chunker:"fixed"};if(a.startsWith("size-")){let b=a.split("-")[1],c=parseInt(b);if(isNaN(c))throw Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:c}}if(a.startsWith("rabin"))return{chunker:"rabin",...nG(a)};throw Error(`Unrecognized chunker option: ${a}`)},nG=a=>{let b={},c=a.split("-");switch(c.length){case 1:b.avgChunkSize=262144;break;case 2:b.avgChunkSize=nH(c[1],"avg");break;case 4:b.minChunkSize=nH(c[1],"min"),b.avgChunkSize=nH(c[2],"avg"),b.maxChunkSize=nH(c[3],"max");break;default:throw Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return b},nH=(a,b)=>{let c=parseInt(a);if(isNaN(c))throw Error(`Chunker parameter ${b} must be an integer`);return c},nI=a0.bind({ignoreUndefined:!0});function nJ({repo:a,preload:b,hashers:c,options:d}){let e=d&&d.sharding;async function*f(d,f={}){let g=nI({shardSplitThreshold:e?1e3:1/0,strategy:"balanced"},f,{...nF(f.chunker)});g.hashAlg&&"sha2-256"!==g.hashAlg&&1!==g.cidVersion&&(g.cidVersion=1),g.trickle&&(g.strategy="trickle"),"trickle"===g.strategy&&(g.leafType="raw",g.reduceSingleLeafToSelf=!1),g.cidVersion>0&& void 0===g.rawLeaves&&(g.rawLeaves=!0),void 0!==g.hashAlg&& void 0===g.rawLeaves&&(g.rawLeaves=!0),delete g.trickle;let h={};if(g.progress){let i=g.progress;g.progress=(a,b)=>{h[b]||(h[b]=0),h[b]+=a,i(h[b],b)}}let j;null!=g.hashAlg&&(j=await c.getHasher(g.hashAlg));let k=mk(nE(d),b=>nB(b,a.blocks,{...g,hasher:j,pin:!1}),nK(g),nL(b,g),nM(a,g)),l=await a.gcLock.readLock();try{for await(let m of k){let n=m.path??m.cid.toString();delete h[n],yield{...m,path:n}}}finally{l()}}return cT(f)}function nK(a){async function*b(b){for await(let c of b){let d=c.cid;1===a.cidVersion&&(d=d.toV1());let e=c.path?c.path:d.toString();a.wrapWithDirectory&&!c.path&&(e=""),yield{path:e,cid:d,size:c.size,mode:c.unixfs&&c.unixfs.mode,mtime:c.unixfs&&c.unixfs.mtime}}}return b}function nL(a,b){async function*c(c){for await(let d of c){let e=!d.path||b.wrapWithDirectory?""===d.path:!d.path.includes("/"),f=e&&!b.onlyHash&& !1!==b.preload;f&&a(d.cid),yield d}}return c}function nM(a,b){async function*c(c){for await(let d of c){let e=!(d.path&&d.path.includes("/")),f=(null==b.pin||b.pin)&&e&&!b.onlyHash;f&&await a.pins.pinRecursively(d.cid),yield d}}return c}let nN=async function(a){return(await mI.encode(a)).slice(0,8).reverse()},nO=(a,b,c)=>Promise.all(a.map(a=>{if(null==a.Name)throw Error("Unexpected Link without a Name");if(2===a.Name.length){let d=parseInt(a.Name,16);return b._putObjectAt(d,new no.Bucket({hash:c._options.hash,bits:c._options.bits},b,d))}return c.put(a.Name.substring(2),!0)})),nP=a=>a.toString(16).toUpperCase().padStart(2,"0").substring(0,2),nQ=a=>{let b=a.bucket,c=[];for(;b._parent;)c.push(b),b=b._parent;return c.push(b),c.reverse()},nR=async(a,b,c,d,e)=>{if(!d){let f=(0,no.createHAMT)({hashFn:nN});d={rootBucket:f,hamtDepth:1,lastBucket:f}}await nO(a.Links,d.lastBucket,d.rootBucket);let g=await d.rootBucket._findNewBucketAndPos(b),h=nP(g.pos),i=nQ(g);i.length>d.hamtDepth&&(d.lastBucket=i[d.hamtDepth],h=nP(d.lastBucket._posAtParent));let j=a.Links.find(a=>{if(null==a.Name)return!1;let c=a.Name.substring(0,2),d=a.Name.substring(2);return c===h&&(!d||d===b)});if(!j)return null;if(null!=j.Name&&j.Name.substring(2)===b)return j.Hash;d.hamtDepth++;let k=await c.get(j.Hash,e);return a=bR(k),nR(a,b,c,d,e)};var nS=nR;function nT(a,b,c,d){let e=a.length,f=b+e;return c>=f||d<b?new Uint8Array(0):(d>=b&&d<f&&(a=a.slice(0,d-b)),c>=b&&c<f&&(a=a.slice(c-b)),a)}var nU=nT;let nV=(a,b,c)=>{if(b||(b=0),b<0)throw a7(Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(b>a)throw a7(Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(c||0===c||(c=a-b),c<0)throw a7(Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return b+c>a&&(c=a-b),{offset:b,length:c}};var nW=nV;async function*nX(a,b,c,d,e=0,f){if(b instanceof Uint8Array){let g=nU(b,e,c,d);return g.length&&(yield g),e+=g.length}if(null==b.Data)throw a7(Error("no data in PBNode"),"ERR_NOT_UNIXFS");let h;try{h=bl.unmarshal(b.Data)}catch(i){throw a7(i,"ERR_NOT_UNIXFS")}if(h.data&&h.data.length){let j=nU(h.data,e,c,d);j.length&&(yield j),e+=h.data.length}let k=e;for(let l=0;l<b.Links.length;l++){let m=b.Links[l],n=e+h.blockSizes[l];if(c>=k&&c<n||d>k&&d<=n||c<k&&d>n){let o=await a.get(m.Hash,{signal:f.signal}),p;switch(m.Hash.code){case bP:p=await bR(o);break;case mQ.code:p=o;break;case b_:p=await b1(o);break;default:throw Error(`Unsupported codec: ${m.Hash.code}`)}for await(let q of nX(a,p,c,d,e,f))e+=q.length,yield q}e=n,k=n+1}}let nY=(a,b,c,d,e,f,g)=>{function h(a={}){let d=c.fileSize();if(void 0===d)throw Error("File was a directory");let{offset:e,length:f}=nW(d,a.offset,a.length),h=e,i=e+f;return nX(g,b,h,i,0,a)}return h};var nZ=nY;let n$=(a,b,c,d,e,f,g)=>{async function*h(a={}){let c=a.offset||0,h=a.length||b.Links.length,i=b.Links.slice(c,h);for(let j of i){let k=await e(j.Hash,j.Name||"",`${d}/${j.Name||""}`,[],f+1,g,a);k.entry&&(yield k.entry)}}return h};var n_=n$;let n0=(a,b,c,d,e,f,g)=>{function h(a={}){return n1(b,d,e,f,g,a)}return h};async function*n1(a,b,c,d,e,f){let g=a.Links;for(let h of g){let i=null!=h.Name?h.Name.substring(2):null;if(i){let j=await c(h.Hash,i,`${b}/${i}`,[],d+1,e,f);yield j.entry}else{let k=await e.get(h.Hash);for await(let l of(a=bR(k),n1(a,b,c,d,e,f)))yield l}}}var n2=n0;let n3=(a,b)=>{let c=a.Links.find(a=>a.Name===b);return c&&c.Hash},n4={raw:nZ,file:nZ,directory:n_,"hamt-sharded-directory":n2,metadata:(a,b,c,d,e,f,g)=>()=>[],symlink:(a,b,c,d,e,f,g)=>()=>[]},n5=async(a,b,c,d,e,f,g,h)=>{let i=await g.get(a,h),j=bR(i),k,l;if(b||(b=a.toString()),null==j.Data)throw a7(Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{k=bl.unmarshal(j.Data)}catch(m){throw a7(m,"ERR_NOT_UNIXFS")}if(c||(c=b),d.length){let n;if(!(n=k&&"hamt-sharded-directory"===k.type?await nS(j,d[0],g):n3(j,d[0])))throw a7(Error("file does not exist"),"ERR_NOT_FOUND");let o=d.shift(),p=`${c}/${o}`;l={cid:n,toResolve:d,name:o||"",path:p}}return{entry:{type:k.isDirectory()?"directory":"file",name:b,path:c,cid:a,content:n4[k.type](a,j,k,c,e,f,g),unixfs:k,depth:f,node:j,size:k.fileSize()},next:l}};var n6=n5;let n7=a=>{async function*b(b={}){let{offset:c,length:d}=nW(a.length,b.offset,b.length);yield nU(a,0,c,c+d)}return b},n8=async(a,b,c,d,e,f,g,h)=>{if(d.length)throw a7(Error(`No link named ${c} found in raw node ${a}`),"ERR_NOT_FOUND");let i=await g.get(a,h);return{entry:{type:"raw",name:b,path:c,cid:a,content:n7(i),depth:f,size:i.length,node:i}}};var n9=n8;let oa=async(a,b,c,d,e,f,g,h)=>{let i=await g.get(a),j=b1(i),k=j,l=c;for(;d.length;){let m=d[0];if(m in k){d.shift(),l=`${l}/${m}`;let n=bm.CID.asCID(k[m]);if(n)return{entry:{type:"object",name:b,path:c,cid:a,node:i,depth:f,size:i.length,content:async function*(){yield j}},next:{cid:n,name:m,path:l,toResolve:d}};k=k[m]}else throw a7(Error(`No property named ${m} found in cbor node ${a}`),"ERR_NO_PROP")}return{entry:{type:"object",name:b,path:c,cid:a,node:i,depth:f,size:i.length,content:async function*(){yield j}}}};var ob=oa;let oc=a=>{async function*b(b={}){let{offset:c,length:d}=nW(a.length,b.offset,b.length);yield nU(a,0,c,c+d)}return b},od=async(a,b,c,d,e,f,g,h)=>{if(d.length)throw a7(Error(`No link named ${c} found in raw node ${a}`),"ERR_NOT_FOUND");let i=await dy.decode(a.multihash.bytes);return{entry:{type:"identity",name:b,path:c,cid:a,content:oc(i.digest),depth:f,size:i.digest.length,node:i.digest}}};var oe=od;let of={[bP]:n6,[mQ.code]:n9,[b_]:ob,[cr.identity.code]:oe};function og(a,b,c,d,e,f,g){let h=of[a.code];if(!h)throw a7(Error(`No resolver for code ${a.code}`),"ERR_NO_RESOLVER");return h(a,b,c,d,og,e,f,g)}var oh=og;let oi=(a="")=>(a.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),oj=a=>{if(a instanceof Uint8Array)return{cid:bm.CID.decode(a),toResolve:[]};let b=bm.CID.asCID(a);if(b)return{cid:b,toResolve:[]};if("string"==typeof a){0===a.indexOf("/ipfs/")&&(a=a.substring(6));let c=oi(a);return{cid:bm.CID.parse(c[0]),toResolve:c.slice(1)}}throw a7(Error(`Unknown path type ${a}`),"ERR_BAD_PATH")};async function*ok(a,b,c={}){let{cid:d,toResolve:e}=oj(a),f=d.toString(),g=f,h=e.length;for(;;){let i=await oh(d,f,g,e,h,b,c);if(!i.entry&&!i.next)throw a7(Error(`Could not resolve ${a}`),"ERR_NOT_FOUND");if(i.entry&&(yield i.entry),!i.next)return;e=i.next.toResolve,d=i.next.cid,f=i.next.name,g=i.next.path}}async function ol(a,b,c={}){let d=await dR(ok(a,b,c));if(!d)throw a7(Error(`Could not resolve ${a}`),"ERR_NOT_FOUND");return d}async function*om(a,b,c={}){let d=await ol(a,b,c);if(d&&(yield d,"directory"===d.type))for await(let e of f(d,c))yield e;async function*f(a,b){for await(let c of a.content(b))yield c,!(c instanceof Uint8Array)&&"directory"===c.type&&(yield*f(c,b))}}function on({repo:a,preload:b}){async function*c(c,d={}){if(c=c_(c),!1!==d.preload){let e=c.split("/");b(bm.CID.parse(e[0]))}let f=await ol(c,a.blocks,d);if("directory"===f.type)throw Error("this dag node is a directory");if(!f.content)throw Error("this dag node has no content");yield*f.content(d)}return cT(c)}(0,cB.fromString)("ustar\0","binary"),(0,cB.fromString)("ustar ","binary"),(0,cB.fromString)(" \0","binary");let oo=function(a,b,c){return"number"!=typeof a?c:(a=~~a)>=b?b:a>=0||(a+=b)>=0?a:0},op=function(a,b,c,d){for(;c<d;c++)if(a.get(c)===b)return c;return d};function oq(a){let b;if(128===a.get(0))b=!0;else{if(255!==a.get(0))return 0;b=!1}let c=!1,d=[];for(let e=a.length-1;e>0;e--){let f=a.get(e);b?d.push(f):c&&0===f?d.push(0):c?(c=!1,d.push(256-f)):d.push(255-f)}let g=0,h=d.length;for(let i=0;i<h;i++)g+=d[i]*Math.pow(256,i);return b?g:-1*g}function or(a){let b=async function*(){let b=yield,c=new eb;for await(let d of a){if(null==b){c.append(d),b=yield c,c=new eb;continue}for(c.append(d);c.length>=b;){let e=c.subarray(0,b);if(c.consume(b),null==(b=yield e)){c.length>0&&(b=yield c,c=new eb);break}}}if(null!=b)throw Object.assign(Error(`stream ended before ${b} bytes became available`),{code:"ERR_UNDER_READ",buffer:c})}();return b.next(),b}function os(a){return 0!=(a&=511)?512-a:0}var ot=c(71993),ou=c(33053);let ov="0000000000000000000",ow="7777777777777777777",ox=48,oy=(0,cB.fromString)("ustar\0","binary"),oz=(0,cB.fromString)("00","binary"),oA=parseInt("7777",8),oB=257,oC=263,oD=function(a){switch(a){case"file":default:return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}},oE=function(a){let b=256;for(let c=0;c<148;c++)b+=a[c];for(let d=156;d<512;d++)b+=a[d];return b},oF=function(a,b){let c=a.toString(8);return c.length>b?(0,cB.fromString)(ow.slice(0,b)+" "):(0,cB.fromString)(ov.slice(0,b-c.length)+c+" ")},oG=function(a){let b=(0,cB.fromString)(a).byteLength,c=Math.floor(Math.log(b)/Math.log(10))+1;return b+c>=Math.pow(10,c)&&c++,`${b+c}${a}`};function oH(a){let b="";null!=a.name&&(b+=oG(" path="+a.name+"\n")),null!=a.linkname&&(b+=oG(" linkpath="+a.linkname+"\n"));let c=a.pax;if(null!=c)for(let d in c)Object.prototype.hasOwnProperty.call(c,d)&&(b+=oG(" "+d+"="+c[d]+"\n"));return(0,cB.fromString)(b)}function oI(a){let b=new Uint8Array(512),c=a.name,d="";if(5===a.typeflag&&"/"!==c[c.length-1]&&(c+="/"),(0,cB.fromString)(c).byteLength!==c.length)return null;for(;(0,cB.fromString)(c).byteLength>100;){let e=c.indexOf("/");if(-1===e)return null;d+=""!==d?"/"+c.slice(0,e):c.slice(0,e),c=c.slice(e+1)}return(0,cB.fromString)(c).byteLength>100||(0,cB.fromString)(d).byteLength>155||null!=a.linkname&&(0,cB.fromString)(a.linkname).byteLength>100?null:(b.set((0,cB.fromString)(c),0),b.set(oF(a.mode&oA,6),100),b.set(oF(a.uid,6),108),b.set(oF(a.gid,6),116),b.set(oF(a.size,11),124),b.set(oF(a.mtime.getTime()/1e3|0,11),136),b[156]=ox+oD(a.type),null!=a.linkname&&b.set((0,cB.fromString)(a.linkname),157),b.set(oy,oB),b.set(oz,oC),null!=a.uname&&b.set((0,cB.fromString)(a.uname),265),null!=a.gname&&b.set((0,cB.fromString)(a.gname),297),b.set(oF(a.devmajor??0,6),329),b.set(oF(a.devminor??0,6),337),null!=d&&b.set((0,cB.fromString)(d),345),b.set(oF(oE(b),6),148),b)}let{S_IFMT:oJ,S_IFBLK:oK,S_IFCHR:oL,S_IFDIR:oM,S_IFIFO:oN,S_IFLNK:oO}=ot,oP=parseInt("755",8),oQ=parseInt("644",8),oR=new Uint8Array(1024);function oS(a=0){switch(a&oJ){case oK:return"block-device";case oL:return"character-device";case oM:return"directory";case oN:return"fifo";case oO:return"symlink";default:return"file"}}function oT(a){return 0!=(a&=511)?oR.slice(0,512-a):new Uint8Array(0)}function oU(a){if(null==a.pax){let b=oI(a);if(null!=b)return b}return oV(a)}function oV(a){let b=oH(a),c={name:"PaxHeader",mode:a.mode,uid:a.uid,gid:a.gid,size:b.length,mtime:a.mtime,type:"pax-header",linkname:a.linkname,uname:a.uname,gname:a.gname,devmajor:a.devmajor,devminor:a.devminor};return new eb(oI(c)??new Uint8Array(0),b,oT(b.length),oI({...c,size:a.size,type:a.type})??new Uint8Array(0)).slice()}function oW(){return async function*(a){for await(let{header:b,body:c}of a){let d={...b,size:"symlink"===b.type?0:b.size??0,type:b.type??oS(b.mode),mode:b.mode??("directory"===b.type?oP:oQ),uid:b.uid??0,gid:b.gid??0,mtime:b.mtime??new Date};if("string"==typeof c&&(c=(0,cB.fromString)(c)),c instanceof Uint8Array||ea(c)){d.size=c.length,yield oU(d),yield ea(c)?c.slice():c,yield oT(d.size);continue}if("symlink"===d.type&&null==d.linkname){if(null==c)throw Error("type was symlink but no linkname or body specified");d.linkname=(0,cE.toString)(await ou(c)),yield oU(d);continue}if(yield oU(d),"file"!==d.type&&"contiguous-file"!==d.type)continue;let e=0;for await(let f of c??[])e+=f.length,yield ea(f)?f.slice():f;if(e!==d.size)throw Error(`size mismatch, wrote ${e} of ${d.size} bytes`);yield oT(d.size)}yield oR}}var oX=c(27885);let oY=6;function oZ({repo:a,preload:b}){async function*c(c,d={}){if(null!=d.compressionLevel&&(d.compressionLevel< -1||d.compressionLevel>9))throw a7(Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(!1!==d.preload){let e;try{e=c_(c).split("/")}catch(f){throw a7(f,"ERR_INVALID_PATH")}b(bm.CID.parse(e[0]))}let g=bm.CID.asCID(c)||c,h=await ol(g,a.blocks,d);if("file"===h.type||"raw"===h.type){let i=[];d.compress&& !0!==d.archive?i.push(h.content):i.push([{header:{name:h.path,mode:"file"===h.type&&h.unixfs.mode,mtime:"file"===h.type&&h.unixfs.mtime?new Date(1e3*h.unixfs.mtime.secs):void 0,size:h.size,type:"file"},body:h.content()}],oW(),a=>jS(a,a=>a.slice())),d.compress&&i.push(async function*(a){let b=await ou(a);yield oX.ZP.gzip(b,{level:d.compressionLevel||oY})}),yield*mk(...i);return}if("directory"===h.type){let j=[om(g,a.blocks,d),async function*(a){for await(let b of a){let c={header:{name:b.path,size:b.size}};if("file"===b.type)c.header.type="file",c.header.mode=null!=b.unixfs.mode?b.unixfs.mode:void 0,c.header.mtime=b.unixfs.mtime?new Date(1e3*b.unixfs.mtime.secs):void 0,c.body=b.content();else if("raw"===b.type)c.header.type="file",c.body=b.content();else if("directory"===b.type)c.header.type="directory",c.header.mode=null!=b.unixfs.mode?b.unixfs.mode:void 0,c.header.mtime=b.unixfs.mtime?new Date(1e3*b.unixfs.mtime.secs):void 0;else throw a7(Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield c}},oW(),a=>jS(a,a=>a.slice())];if(d.compress){if(!d.archive)throw a7(Error("file is not regular"),"ERR_INVALID_PATH");d.compress&&j.push(async function*(a){let b=await ou(a);yield oX.ZP.gzip(b,{level:d.compressionLevel||oY})})}yield*mk(...j);return}throw a7(Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return cT(c)}function o$({repo:a,preload:b}){async function*c(c,d={}){let e=c_(c),f=e.split("/");!1!==d.preload&&b(bm.CID.parse(f[0]));let g=bm.CID.asCID(e)||e,h=await ol(g,a.blocks,d);if("file"===h.type){yield c1(h);return}if("directory"===h.type){for await(let i of h.content())yield c1(i);return}throw a7(Error(`Unknown UnixFS type ${h.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return cT(c)}class o_{constructor({preload:a,repo:b,hashers:c,options:d}){let e=nJ({preload:a,repo:b,options:d,hashers:c});this.addAll=e,this.add=mD({addAll:e}),this.cat=on({repo:b,preload:a}),this.get=oZ({repo:b,preload:a}),this.ls=o$({repo:b,preload:a})}}let o0="0.15.4",o1="965f5a4e00254cee48fca2127d95209deaee09cf",o2="^0.155.2";function o3({repo:a}){async function b(b={}){let c=await a.version.get();return{version:o0,commit:o1,repo:`${c}`,"ipfs-core":o0,"interface-ipfs-core":o2}}return cT(b)}let o4=a6("ipfs:components:id");function o5({peerId:a,network:b}){async function c(c={}){let d=b.try();if(!d){if(c.peerId)throw new cx;if(null==a.publicKey)throw a7(Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:a,publicKey:(0,cE.toString)(a.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${o0}`,protocolVersion:"9000",protocols:[]}}let{libp2p:e}=d,f=c.peerId?c.peerId:a,g=await o6(f,e,c),h=(0,cE.toString)(g.metadata.get("AgentVersion")||new Uint8Array),i=(0,cE.toString)(g.metadata.get("ProtocolVersion")||new Uint8Array),j=g.id.toString(),k=g.publicKey?(0,cE.toString)(g.publicKey,"base64pad"):"";return{id:f,publicKey:k,addresses:(g.addresses||[]).map(a=>{let b=a.toString();return b.endsWith(`/p2p/${j}`)?b:`${b}/p2p/${j}`}).sort().map(a=>new lC(a)),agentVersion:h,protocolVersion:i,protocols:(g.protocols||[]).sort()}}return cT(c)}async function o6(a,b,c){let d=await b.peerStore.get(a);d||(d=await o7(a,b,c));let e=a.publicKey?a.publicKey:await b.peerStore.keyBook.get(a);if(null==e)try{e=await b.getPublicKey(a,c)}catch(f){o4.error("Could not load public key for",a.toString(),f)}return{...d,publicKey:e,metadata:d.metadata||new Map,addresses:d.addresses.map(a=>a.multiaddr)}}async function o7(a,b,c){if(null==b.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(let d of b.dht.findPeer(a,c))if("FINAL_PEER"===d.name)break;let e=await b.peerStore.get(a);if(!e)throw a7(Error("Could not find peer"),"ERR_NOT_FOUND");return e}var o8=o9;function o9(a,b,c){var d,e,f;if(Array.isArray(b)&&(d=b.slice(0)),"string"==typeof b&&(d=b.split(".")),"symbol"==typeof b&&(d=[b]),!Array.isArray(d))throw Error("props arg must be an array, a string or a symbol");if(!(e=d.pop()))return!1;for(pa(e);f=d.shift();)if(pa(f),void 0===a[f]&&(a[f]={}),!(a=a[f])||"object"!=typeof a)return!1;return a[e]=c,!0}function pa(a){if("__proto__"==a||"constructor"==a||"prototype"==a)throw Error("setting of prototype values not supported")}let pb={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:a=>(o8(a,"Discovery.MDNS.Enabled",!1),o8(a,"Discovery.webRTCStar.Enabled",!1),a.Swarm={...a.Swarm||{},DisableNatPortMap:!0},a)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:a=>(o8(a,"Discovery.MDNS.Enabled",!0),o8(a,"Discovery.webRTCStar.Enabled",!0),o8(a,"Swarm",{...a.Swarm||{},DisableNatPortMap:!1}),a)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:a=>{let b=l5();return o8(a,"Addresses.API",b.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),o8(a,"Addresses.Gateway",b.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),o8(a,"Addresses.Swarm",b.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),o8(a,"Addresses.Delegates",[]),o8(a,"Bootstrap",[]),o8(a,"Discovery.MDNS.Enabled",!1),o8(a,"Discovery.webRTCStar.Enabled",!1),o8(a,"Swarm",{...a.Swarm||{},DisableNatPortMap:!0}),a}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:a=>{let b=l5();return o8(a,"Addresses.API",b.Addresses.API),o8(a,"Addresses.Gateway",b.Addresses.Gateway),o8(a,"Addresses.Swarm",b.Addresses.Swarm),o8(a,"Addresses.Delegates",b.Addresses.Delegates),o8(a,"Bootstrap",b.Bootstrap),o8(a,"Discovery.MDNS.Enabled",b.Discovery.MDNS.Enabled),o8(a,"Discovery.webRTCStar.Enabled",b.Discovery.webRTCStar.Enabled),o8(a,"Swarm",{...a.Swarm||{},DisableNatPortMap:!1}),a}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:a=>{let b=a.Swarm||{},c=b.ConnMgr||{};return c.LowWater=20,c.HighWater=40,b.ConnMgr=c,a.Swarm=b,a}},"default-power":{description:'Inverse of "lowpower" profile.',transform:a=>{let b=l5();return a.Swarm=b.Swarm,a}}},pc=a6("ipfs:core:config");function pd({repo:a}){return{getAll:cT(b),get:cT(c),set:cT(d),replace:cT(e),profiles:{apply:cT(f),list:cT(pe)}};async function b(b={}){return a.config.getAll(b)}async function c(b,c){return b?a.config.get(b,c):Promise.reject(Error("key argument is required"))}async function d(b,c,d){return a.config.set(b,c,d)}async function e(b,c){return a.config.replace(b,c)}async function f(b,c={dryRun:!1}){let{dryRun:d}=c,e=pb[b];if(!e)throw Error(`No profile with name '${b}' exists`);try{let f=await a.config.getAll(c),g=JSON.parse(JSON.stringify(f));return g=e.transform(g),d||await a.config.replace(g,c),delete f.Identity.PrivKey,delete g.Identity.PrivKey,{original:f,updated:g}}catch(h){throw pc(h),Error(`Could not apply profile '${b}' to config: ${h.message}`)}}}async function pe(a){return Object.keys(pb).map(a=>({name:a,description:pb[a].description}))}let pf=({enumerable:a=!0,configurable:b=!1}={})=>({enumerable:a,configurable:b,writable:!1}),pg=function*(a,b){if(null!=a&&!(a instanceof Uint8Array))for(let[c,d]of Object.entries(a)){let e=[...b,c];if(null!=d&&"object"==typeof d){if(Array.isArray(d))for(let[f,g]of d.entries()){let h=[...e,f],i=b2.k0.asCID(g);i?yield[h.join("/"),i]:"object"==typeof g&&(yield*pg(g,h))}else{let j=b2.k0.asCID(d);j?yield[e.join("/"),j]:yield*pg(d,e)}}}},ph=function*(a,b){if(null!=a)for(let[c,d]of Object.entries(a)){let e=[...b,c];if(yield e.join("/"),null!=d&&!(d instanceof Uint8Array)&&"object"==typeof d&&!b2.k0.asCID(d)){if(Array.isArray(d))for(let[f,g]of d.entries()){let h=[...e,f];yield h.join("/"),"object"!=typeof g||b2.k0.asCID(g)||(yield*ph(g,h))}else yield*ph(d,e)}}},pi=(a,b)=>{let c=a;for(let[d,e]of b.entries()){if(null==(c=c[e]))throw Error(`Object has no property at ${b.slice(0,d+1).map(a=>`[${JSON.stringify(a)}]`).join("")}`);let f=b2.k0.asCID(c);if(f)return{value:f,remaining:b.slice(d+1).join("/")}}return{value:c}};class pj{constructor({cid:a,bytes:b,value:c}){if(!a||!b|| void 0===c)throw Error("Missing required argument");this.cid=a,this.bytes=b,this.value=c,this.asBlock=this,Object.defineProperties(this,{cid:pf(),bytes:pf(),value:pf(),asBlock:pf()})}links(){return pg(this.value,[])}tree(){return ph(this.value,[])}get(a="/"){return pi(this.value,a.split("/").filter(Boolean))}}let pk=({bytes:a,cid:b,value:c,codec:d})=>{let e=void 0!==c?c:d&&d.decode(a);if(void 0===e)throw Error('Missing required argument, must either provide "value" or "codec"');return new pj({cid:b,bytes:a,value:e})};function pl(a){let b=b0({version:1,roots:a}),c=k2.encode(b.length),d=new Uint8Array(c.length+b.length);return d.set(c,0),d.set(b,c.length),d}function pm(a){return{async setRoots(b){let c=pl(b);await a.write(c)},async writeBlock(b){let{cid:c,bytes:d}=b;await a.write(new Uint8Array(k2.encode(c.bytes.length+d.length))),await a.write(c.bytes),d.length&&await a.write(d)},async close(){await a.end()}}}function pn(){}function po(){let a=[],b=null,c=pn,d=!1,e=null,f=pn,g=()=>(b||(b=new Promise(a=>{c=()=>{b=null,c=pn,a()}})),b),h={write(b){a.push(b);let c=g();return f(),c},async end(){d=!0;let a=g();f(),await a}},i={async next(){let b=a.shift();return b?(0===a.length&&c(),{done:!1,value:b}):d?(c(),{done:!0,value:void 0}):(e||(e=new Promise(a=>{f=()=>(e=null,f=pn,a(i.next()))})),e)}};return{writer:h,iterator:i}}let pp={Null:a=>null===a,Int:a=>Number.isInteger(a),Float:a=>"number"==typeof a&&Number.isFinite(a),String:a=>"string"==typeof a,Bool:a=>"boolean"==typeof a,Bytes:a=>a instanceof Uint8Array,Link:a=>!pp.Null(a)&&"object"==typeof a&&a.asCID===a,List:a=>Array.isArray(a),Map:a=>!pp.Null(a)&&"object"==typeof a&&a.asCID!==a&&!pp.List(a)&&!pp.Bytes(a)},pq={Int:pp.Int,"CarHeader > version":a=>pq.Int(a),"CarHeader > roots (anon) > valueType (anon)":pp.Link,"CarHeader > roots (anon)":a=>pp.List(a)&&Array.prototype.every.call(a,pq["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":a=>pq["CarHeader > roots (anon)"](a),CarHeader:a=>{let b=a&&Object.keys(a);return pp.Map(a)&&["version"].every(a=>b.includes(a))&&Object.entries(a).every(([a,b])=>pq["CarHeader > "+a]&&pq["CarHeader > "+a](b))}},pr=pq.CarHeader,ps={SHA2_256:18,LENGTH:32,DAG_PB:112},pt=40;async function pu(a){let b=await a.upTo(8);if(!b.length)throw Error("Unexpected end of data");let c=k2.decode(b);return a.seek(k2.decode.bytes),c}async function pv(a){let b=await a.exactly(pt),c=new DataView(b.buffer,b.byteOffset,b.byteLength),d=0,e={version:2,characteristics:[c.getBigUint64(d,!0),c.getBigUint64(d+=8,!0)],dataOffset:Number(c.getBigUint64(d+=8,!0)),dataSize:Number(c.getBigUint64(d+=8,!0)),indexOffset:Number(c.getBigUint64(d+=8,!0))};return a.seek(pt),e}async function pw(a,b){let c=await pu(a);if(0===c)throw Error("Invalid CAR header (zero length)");let d=await a.exactly(c);a.seek(c);let e=b1(d);if(!pr(e))throw Error("Invalid CAR header format");if(1!==e.version&&2!==e.version|| void 0!==b&&e.version!==b)throw Error(`Invalid CAR version: ${e.version}${void 0!==b?` (expected ${b})`:""}`);let f=Array.isArray(e.roots);if(1===e.version&&!f||2===e.version&&f)throw Error("Invalid CAR header format");if(1===e.version)return e;let g=await pv(a);a.seek(g.dataOffset-a.pos);let h=await pw(a,1);return Object.assign(h,g)}async function px(a){let b=await a.upTo(8);k2.decode(b);let c=k2.decode.bytes,d=k2.decode(b.subarray(k2.decode.bytes)),e=k2.decode.bytes,f=c+e+d,g=await a.exactly(f);return a.seek(f),g}async function py(a){let b=await a.exactly(2);if(b[0]===ps.SHA2_256&&b[1]===ps.LENGTH){let c=await a.exactly(34);a.seek(34);let d=dy.decode(c);return bm.CID.create(0,ps.DAG_PB,d)}let e=await pu(a);if(1!==e)throw Error(`Unexpected CID version (${e})`);let f=await pu(a),g=await px(a),h=dy.decode(g);return bm.CID.create(e,f,h)}async function pz(a){let b=a.pos,c=await pu(a);if(0===c)throw Error("Invalid CAR section (zero length)");c+=a.pos-b;let d=await py(a),e=c-Number(a.pos-b);return{cid:d,length:c,blockLength:e}}async function pA(a){let{cid:b,blockLength:c}=await pz(a),d=await a.exactly(c);return a.seek(c),{bytes:d,cid:b}}async function pB(a){let b=a.pos,{cid:c,length:d,blockLength:e}=await pz(a),f={cid:c,length:d,blockLength:e,offset:b,blockOffset:a.pos};return a.seek(f.blockLength),f}function pC(a){let b=(async()=>{let b=await pw(a);if(2===b.version){let c=a.pos-b.dataOffset;a=pG(a,b.dataSize-c)}return b})();return{header:()=>b,async *blocks(){for(await b;(await a.upTo(8)).length>0;)yield await pA(a)},async *blocksIndex(){for(await b;(await a.upTo(8)).length>0;)yield await pB(a)}}}function pD(a){let b=0;return{async upTo(c){return a.subarray(b,b+Math.min(c,a.length-b))},async exactly(c){if(c>a.length-b)throw Error("Unexpected end of data");return a.subarray(b,b+c)},seek(a){b+=a},get pos(){return b}}}function pE(a){let b=0,c=0,d=0,e=new Uint8Array(0),f=async b=>{c=e.length-d;let f=[e.subarray(d)];for(;c<b;){let g=await a();if(null==g)break;c<0?g.length>c&&f.push(g.subarray(-c)):f.push(g),c+=g.length}e=new Uint8Array(f.reduce((a,b)=>a+b.length,0));let h=0;for(let i of f)e.set(i,h),h+=i.length;d=0};return{async upTo(a){return e.length-d<a&&await f(a),e.subarray(d,d+Math.min(e.length-d,a))},async exactly(a){if(e.length-d<a&&await f(a),e.length-d<a)throw Error("Unexpected end of data");return e.subarray(d,d+a)},seek(a){b+=a,d+=a},get pos(){return b}}}function pF(a){let b=a[Symbol.asyncIterator]();async function c(){let a=await b.next();return a.done?null:a.value}return pE(c)}function pG(a,b){let c=0;return{async upTo(d){let e=await a.upTo(d);return e.length+c>b&&(e=e.subarray(0,b-c)),e},async exactly(d){let e=await a.exactly(d);if(e.length+c>b)throw Error("Unexpected end of data");return e},seek(b){c+=b,a.seek(b)},get pos(){return a.pos}}}class pH{constructor(a,b){this._encoder=b,this._mutex=b.setRoots(a),this._ended=!1}async put(a){if(!(a.bytes instanceof Uint8Array)||!a.cid)throw TypeError("Can only write {cid, bytes} objects");if(this._ended)throw Error("Already closed");let b=bm.CID.asCID(a.cid);if(!b)throw TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:b,bytes:a.bytes})),this._mutex}async close(){if(this._ended)throw Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(a){a=pK(a);let{encoder:b,iterator:c}=pJ(),d=new pH(a,b),e=new pI(c);return{writer:d,out:e}}static createAppender(){let{encoder:a,iterator:b}=pJ();a.setRoots=()=>Promise.resolve();let c=new pH([],a),d=new pI(b);return{writer:c,out:d}}static async updateRootsInBytes(a,b){let c=pD(a);await pw(c);let d=pl(b);if(Number(c.pos)!==d.length)throw Error(`updateRoots() can only overwrite a header of the same length (old header is ${c.pos} bytes, new header is ${d.length} bytes)`);return a.set(d,0),a}}class pI{constructor(a){this._iterator=a}[Symbol.asyncIterator](){if(this._iterating)throw Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function pJ(){let a=po(),{writer:b,iterator:c}=a,d=pm(b);return{encoder:d,iterator:c}}function pK(a){if(void 0===a)return[];if(!Array.isArray(a)){let b=bm.CID.asCID(a);if(!b)throw TypeError("roots must be a single CID or an array of CIDs");return[b]}let c=[];for(let d of a){let e=bm.CID.asCID(d);if(!e)throw TypeError("roots must be a single CID or an array of CIDs");c.push(e)}return c}var pL=c(40950);let pM=async({cid:a,load:b,seen:c})=>{c=c||new Set;let d=a.toString(a3.base58btc);if(c.has(d))return;let e=await b(a);if(c.add(d),null!==e)for(let[,f]of e.links())await pM({cid:f,load:b,seen:c})},pN=a6("ipfs:components:dag:import"),pO=[mQ.code,pL.code];function pP({repo:a,preload:b,codecs:c}){async function*d(d,e={}){!1!==e.preload&&b(d);let f=bm.CID.asCID(d);if(!f)throw Error(`Unexpected error converting CID type: ${d}`);pN(`Exporting ${f} as car`);let{writer:g,out:h}=await pH.create([f]),i=null;for await(let j of((async()=>{try{let b=pQ(a,g,{signal:e.signal,timeout:e.timeout},c);await pM({cid:f,load:b})}catch(d){i=d}finally{g.close()}})(),h)){if(i)break;yield j}if(i)throw i}return cT(d)}function pQ(a,b,c,d){return async e=>{let f=await d.getCodec(e.code);if(!f)throw Error(`Can't decode links in block with codec 0x${e.code.toString(16)} to form complete DAG`);let g=await a.blocks.get(e,c);return(pN(`Adding block ${e} to car`),await b.put({cid:e,bytes:g}),pO.includes(e.code))?null:pk({bytes:g,cid:e,codec:f})}}var pR=c(72262);function pS({codecs:a,repo:b,preload:c}){let d=async function(d,e={}){if(!1!==e.preload&&c(d),e.path){let f=e.localResolve?await pR(c3(d,e.path,a,b,e)):await dR(c3(d,e.path,a,b,e)),g=f;if(!g)throw a7(Error("Not found"),"ERR_NOT_FOUND");return g}let h=await a.getCodec(d.code),i=await b.blocks.get(d,e),j=h.decode(i);return{value:j,remainderPath:""}};return cT(d)}class pT{constructor(a,b,c){this._version=a,this._roots=b,this._iterable=c,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class pU extends pT{[Symbol.asyncIterator](){if(this._decoded)throw Error("Cannot decode more than once");if(!this._iterable)throw Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(a){let{version:b,roots:c,iterator:d}=await pW(a);return new pU(b,c,d)}static async fromIterable(a){let{version:b,roots:c,iterator:d}=await pX(a);return new pU(b,c,d)}}class pV extends null{[Symbol.asyncIterator](){if(this._decoded)throw Error("Cannot decode more than once");if(!this._iterable)throw Error("Block iterable not found");this._decoded=!0;let a=this._iterable[Symbol.asyncIterator]();return{async next(){let b=await a.next();return b.done?b:{done:!1,value:b.value.cid}}}}static async fromBytes(a){let{version:b,roots:c,iterator:d}=await pW(a);return new pV(b,c,d)}static async fromIterable(a){let{version:b,roots:c,iterator:d}=await pX(a);return new pV(b,c,d)}}async function pW(a){if(!(a instanceof Uint8Array))throw TypeError("fromBytes() requires a Uint8Array");return pY(pD(a))}async function pX(a){if(!a||"function"!=typeof a[Symbol.asyncIterator])throw TypeError("fromIterable() requires an async iterable");return pY(pF(a))}async function pY(a){let b=pC(a),{version:c,roots:d}=await b.header();return{version:c,roots:d,iterator:b.blocks()}}let pZ=a6("ipfs:components:dag:import");function p$({repo:a}){async function*b(b,c={}){let d=await a.gcLock.readLock();try{let e={signal:c.signal,timeout:c.timeout},f=ms(b),{value:g,done:h}=await f.peek();if(h)return;g&&f.push(g);let i;for await(let j of i=g instanceof Uint8Array?[f]:f){let k=await p_(a,e,j);if(!1!==c.pinRoots)for(let l of k){let m="";try{await a.blocks.has(l)?(pZ(`Pinning root ${l}`),await a.pins.pinRecursively(l)):m="blockstore: block not found"}catch(n){m=n.message}yield{root:{cid:l,pinErrorMsg:m}}}}}finally{d()}}return cT(b)}async function p_(a,b,c){let d=await pU.fromIterable(c),e=await d.getRoots();return await jC(a.blocks.putMany(jS(d,({cid:a,bytes:b})=>(pZ(`Import block ${a}`),{key:a,value:b})),{signal:b.signal})),e}function p0({repo:a,codecs:b,hashers:c,preload:d}){async function e(e,f={}){let g=f.pin?await a.gcLock.readLock():null;try{let h=await b.getCodec(f.storeCodec||"dag-cbor");if(!h)throw Error(`Unknown storeCodec ${f.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(f.inputCodec){if(!(e instanceof Uint8Array))throw Error("Can only inputCodec on raw bytes that can be decoded");let i=await b.getCodec(f.inputCodec);if(!i)throw Error(`Unknown inputCodec ${f.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);e=i.decode(e)}let j=null!=f.version?f.version:1,k=await c.getHasher(f.hashAlg||"sha2-256");if(!k)throw Error(`Unknown hash algorithm ${f.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let l=h.encode(e),m=await k.digest(l),n=bm.CID.create(j,h.code,m);return await a.blocks.put(n,l,{signal:f.signal}),f.pin&&await a.pins.pinRecursively(n),!1!==f.preload&&d(n),n}finally{g&&g()}}return cT(e)}function p1({repo:a,codecs:b,preload:c}){async function d(d,e={}){let{cid:f}=cV(d);return!1!==e.preload&&c(f),c0(a,b,d,e)}return cT(d)}class p2{constructor({repo:a,codecs:b,hashers:c,preload:d}){this.export=pP({repo:a,preload:d,codecs:b}),this.get=pS({codecs:b,repo:a,preload:d}),this.import=p$({repo:a}),this.resolve=p1({repo:a,codecs:b,preload:d}),this.put=p0({repo:a,codecs:b,hashers:c,preload:d})}}let p3=(a,b)=>b,p4=(a,b,c,d)=>{if(null!=d&& !1===d.assumeHttp)return`tcp://${a}:${b}`;let e="tcp",f=`:${b}`,g=c[c.length-1];return"tcp"===g.protocol&&(e="443"===b?"https":"http",f="443"===b||"80"===b?"":f),`${e}://${a}${f}`},p5={ip4:p3,ip6:(a,b,c,d)=>1===d.length&&"ip6"===d[0].protocol?b:`[${b}]`,tcp:(a,b,c,d,e)=>d.some(a=>["http","https","ws","wss"].includes(a.protocol))?`${a}:${b}`:p4(a,b,d,e),udp:(a,b)=>`udp://${a}:${b}`,dnsaddr:p3,dns4:p3,dns6:p3,ipfs:(a,b)=>`${a}/ipfs/${b}`,p2p:(a,b)=>`${a}/p2p/${b}`,http:a=>`http://${a}`,https:a=>`https://${a}`,ws:a=>`ws://${a}`,wss:a=>`wss://${a}`,"p2p-websocket-star":a=>`${a}/p2p-websocket-star`,"p2p-webrtc-star":a=>`${a}/p2p-webrtc-star`,"p2p-webrtc-direct":a=>`${a}/p2p-webrtc-direct`};function p6(a,b){let c=new lC(a),d=a.toString().split("/").slice(1);return c.tuples().map(a=>({protocol:d.shift()??"",content:null!=a[1]?d.shift()??"":""})).reduce((a,c,d,e)=>{let f=p5[c.protocol];if(null==f)throw Error(`Unsupported protocol ${c.protocol}`);return f(a,c.content,d,e,b)},"")}function p7(a){if(!Array.isArray(a))throw TypeError(`Expected an array, got ${typeof a}`);a=[...a];for(let b=a.length-1;b>0;b--){let c=Math.floor(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}return a}let p8=a6("ipfs:preload"),p9=dm.default?dm.default:dm,qa=new p9({concurrency:4});function qb(a,b={}){return p8(a),qa.add(async()=>{let c=await dn.post(a,{signal:b.signal}),d=c.body.getReader();try{for(;;){let{done:e}=await d.read();if(e)return}}finally{d.releaseLock()}})}let qc=a6("ipfs:preload");function qd(a={}){if(a.enabled=Boolean(a.enabled),a.addresses=a.addresses||[],a.cache=a.cache||1e3,!a.enabled||!a.addresses.length){qc("preload disabled");let b=()=>{};return Object.assign(b,{start:()=>{},stop:()=>{}})}let c=!0,d=[],e=a.addresses.map(a=>p6(a)),f=c7(a.cache),g=async a=>{try{if(c)throw Error(`preload ${a} but preloader is not started`);let b=a.toString();if(f.has(b))return;f.set(b,!0);let g=p7(e),h=!1,i=Date.now();for(let j of g){if(c)throw Error(`preload aborted for ${b}`);let k;try{k=new AbortController,d=d.concat(k),await qb(`${j}/api/v0/refs?r=true&arg=${encodeURIComponent(b)}`,{signal:k.signal}),h=!0}catch(l){"aborted"!==l.type&&qc.error(l)}finally{d=d.filter(a=>a!==k)}if(h)break}qc(`${h?"":"un"}successfully preloaded ${b} in ${Date.now()-i}ms`)}catch(m){qc.error(m)}};return g.start=()=>{c=!1},g.stop=()=>{c=!0,qc(`aborting ${d.length} pending preload request(s)`),d.forEach(a=>a.abort()),d=[]},g}let qe=a6("ipfs:mfs-preload");function qf({preload:a,files:b,options:c={}}){if(c.interval=c.interval||3e4,!c.enabled){qe("MFS preload disabled");let d=async()=>{};return{start:d,stop:d}}let e="",f,g=async()=>{try{let d=await b.stat("/"),h=d.cid.toString();e!==h&&(qe(`preloading updated MFS root ${e} -> ${d.cid}`),await a(d.cid),e=h)}catch(i){qe.error("failed to preload MFS root",i)}finally{f=setTimeout(g,c.interval)}};return{async start(){let a=await b.stat("/");e=a.cid.toString(),qe(`monitoring MFS root ${a.cid}`),f=setTimeout(g,c.interval)},stop(){clearTimeout(f)}}}class qg extends Error{constructor(a){super(a),this.name="TimeoutError"}}class qh extends Error{constructor(a){super(),this.name="AbortError",this.message=a}}let qi=a=>void 0===globalThis.DOMException?new qh(a):new DOMException(a),qj=a=>{let b=void 0===a.reason?qi("This operation was aborted."):a.reason;return b instanceof Error?b:qi(b)};function qk(a,b){let{milliseconds:c,fallback:d,message:e,customTimers:f={setTimeout,clearTimeout}}=b,g,h=new Promise((h,i)=>{if("number"!=typeof c||1!==Math.sign(c))throw TypeError(`Expected \`milliseconds\` to be a positive number, got \`${c}\``);if(c===Number.POSITIVE_INFINITY){h(a);return}if(b.signal){let{signal:j}=b;j.aborted&&i(qj(j)),j.addEventListener("abort",()=>{i(qj(j))})}g=f.setTimeout.call(void 0,()=>{if(d){try{h(d())}catch(b){i(b)}return}let f="string"==typeof e?e:`Promise timed out after ${c} milliseconds`,g=e instanceof Error?e:new qg(f);"function"==typeof a.cancel&&a.cancel(),i(g)},c),(async()=>{try{h(await a)}catch(b){i(b)}finally{f.clearTimeout.call(void 0,g)}})()});return h.clear=()=>{f.clearTimeout.call(void 0,g),g=void 0},h}let ql=(a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((a,b)=>((b&=63)<36?a+=b.toString(36):b<62?a+=(b-26).toString(36).toUpperCase():b>62?a+="-":a+="_",a),""),qm="lock:worker:request-read",qn="lock:worker:release-read",qo="lock:master:grant-read",qp="lock:worker:request-write",qq="lock:worker:release-write",qr="lock:master:grant-write",qs={},qt=a=>{a.addEventListener("message",b=>{qt.dispatchEvent("message",a,b)}),null!=a.port&&a.port.addEventListener("message",b=>{qt.dispatchEvent("message",a,b)})};qt.addEventListener=(a,b)=>{null==qs[a]&&(qs[a]=[]),qs[a].push(b)},qt.removeEventListener=(a,b)=>{null!=qs[a]&&(qs[a]=qs[a].filter(a=>a===b))},qt.dispatchEvent=function(a,b,c){null!=qs[a]&&qs[a].forEach(a=>a(b,c))};var qu=qt;let qv=(a,b,c,d,e)=>(f,g)=>{if(g.data.type!==c)return;let h={type:g.data.type,name:g.data.name,identifier:g.data.identifier};a.dispatchEvent(new MessageEvent(b,{data:{name:h.name,handler:async()=>(f.postMessage({type:e,name:h.name,identifier:h.identifier}),await new Promise(a=>{let b=c=>{if(null==c||null==c.data)return;let e={type:c.data.type,name:c.data.name,identifier:c.data.identifier};e.type===d&&e.identifier===h.identifier&&(f.removeEventListener("message",b),a())};f.addEventListener("message",b)}))}}))},qw=(a,b,c,d)=>async()=>{let e=ql();return globalThis.postMessage({type:b,identifier:e,name:a}),await new Promise(b=>{let f=g=>{if(null==g||null==g.data)return;let h={type:g.data.type,identifier:g.data.identifier};h.type===c&&h.identifier===e&&(globalThis.removeEventListener("message",f),b(()=>{globalThis.postMessage({type:d,identifier:e,name:a})}))};globalThis.addEventListener("message",f)})},qx={singleProcess:!1};var qy=a=>{a=Object.assign({},qx,a);let b=Boolean(globalThis.document)||a.singleProcess;if(b){let c=new EventTarget;return qu.addEventListener("message",qv(c,"requestReadLock",qm,qn,qo)),qu.addEventListener("message",qv(c,"requestWriteLock",qp,qq,qr)),c}return{isWorker:!0,readLock:a=>qw(a,qm,qo,qn),writeLock:a=>qw(a,qp,qr,qq)}};let qz={},qA;async function qB(a,b){let c,d=new Promise(a=>{c=a});return a.add(async()=>await qk((async()=>await new Promise(a=>{c(()=>{a()})}))(),{milliseconds:b.timeout})),await d}let qC=(a,b)=>{if(!0===qA.isWorker)return{readLock:qA.readLock(a,b),writeLock:qA.writeLock(a,b)};let c=new dm({concurrency:1}),d;return{async readLock(){if(null!=d)return await qB(d,b);d=new dm({concurrency:b.concurrency,autoStart:!1});let a=d,e=qB(d,b);return c.add(async()=>(a.start(),await a.onIdle().then(()=>{d===a&&(d=null)}))),await e},async writeLock(){return d=null,await qB(c,b)}}},qD={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function qE(a){let b=Object.assign({},qD,a);return null==qA&& !0!==(qA=qy(b)).isWorker&&(qA.addEventListener("requestReadLock",a=>{null!=qz[a.data.name]&&qz[a.data.name].readLock().then(async b=>await a.data.handler().finally(()=>b()))}),qA.addEventListener("requestWriteLock",async a=>{null!=qz[a.data.name]&&qz[a.data.name].writeLock().then(async b=>await a.data.handler().finally(()=>b()))})),null==qz[b.name]&&(qz[b.name]=qC(b.name,b)),qz[b.name]}let qF;function qG(a=!1){if(qF)return qF;let b=qE({singleProcess:a});return qF={readLock:a=>async(...c)=>{let d=await b.readLock();try{return await a.apply(null,c)}finally{d()}},writeLock:a=>async(...c)=>{let d=await b.writeLock();try{return await a.apply(null,c)}finally{d()}}}}let qH=a6("ipfs:mfs:utils:with-mfs-root");async function qI(a,b){if(b&&b.signal&&b.signal.aborted)throw a7(Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await a.repo.datastore.open();let c;try{let d=await a.repo.datastore.get(cY);c=bm.CID.decode(d)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e;qH("Creating new MFS root");let f=bQ({Data:new bl({type:"directory"}).marshal(),Links:[]}),g=await dA.sha256.digest(f);if(await a.repo.blocks.put(c=bm.CID.createV0(g),f),b&&b.signal&&b.signal.aborted)throw a7(Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await a.repo.datastore.put(cY,c.bytes)}return qH(`Loaded MFS root /ipfs/${c}`),c}function qJ(a=""){return(a.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}let qK="ipfs",qL=async(a,b,c)=>{let d=await qI(a,c),e={entryType:"file"},f="";if((f=(f=(f=bm.CID.asCID(b)?`/ipfs/${b}`:b.toString()).trim()).replace(/(\/\/+)/g,"/")).endsWith("/")&&f.length>1&&(f=f.substring(0,f.length-1)),!f)throw a7(Error("paths must not be empty"),"ERR_NO_PATH");if("/"!==f.substring(0,1))throw a7(Error("paths must start with a leading slash"),"ERR_INVALID_PATH");"/"===f.substring(f.length-1)&&(f=f.substring(0,f.length-1));let g=qJ(f);if(g[0]===qK){let h;h=2===g.length?`/${g.join("/")}`:`/${g.slice(0,g.length-1).join("/")}`,e={type:"ipfs",depth:g.length-2,entryType:"file",mfsPath:`/${g.join("/")}`,mfsDirectory:h,parts:g,path:`/${g.join("/")}`,name:g[g.length-1]}}else{let i=`/${qK}/${d}${g.length?"/"+g.join("/"):""}`,j=`/${qK}/${d}/${g.slice(0,g.length-1).join("/")}`;e={type:"mfs",depth:g.length,entryType:"file",mfsDirectory:j,mfsPath:i,parts:g,path:`/${g.join("/")}`,name:g[g.length-1]}}let k="mfs"===e.type?e.mfsPath:e.path;try{let l=await ol(k,a.repo.blocks,c);e.cid=l.cid,e.mfsPath=`/ipfs/${l.path}`,e.entryType=l.type,e.content=l.content,("file"===e.entryType||"directory"===e.entryType)&&("file"===l.type||"directory"===l.type)&&(e.unixfs=l.unixfs)}catch(m){if("ERR_NOT_FOUND"!==m.code)throw m}return e.exists=Boolean(e.cid),e},qM=a0.bind({ignoreUndefined:!0}),qN=a6("ipfs:mfs:stat"),qO={withLocal:!1};function qP(a){async function b(b,c={}){c=qM(qO,c),qN(`Fetching stats for ${b}`);let{type:d,cid:e,mfsPath:f}=await qL(a,b,c),g="ipfs"===d&&e?e:f,h;try{h=await ol(g,a.repo.blocks)}catch(i){if("ERR_NOT_FOUND"===i.code)throw a7(Error(`${b} does not exist`),"ERR_NOT_FOUND");throw i}if(!qQ[h.type])throw Error(`Cannot stat codec ${h.cid.code}`);return qQ[h.type](h)}return cT(b)}let qQ={raw:a=>({cid:a.cid,size:a.node.length,cumulativeSize:a.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:a=>{let b={cid:a.cid,type:"file",size:a.unixfs.fileSize(),cumulativeSize:bQ(a.node).length+(a.node.Links||[]).reduce((a,b)=>a+(b.Tsize||0),0),blocks:a.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:a.unixfs.mode};return a.unixfs.mtime&&(b.mtime=a.unixfs.mtime),b},directory:a=>{let b={cid:a.cid,type:"directory",size:0,cumulativeSize:bQ(a.node).length+(a.node.Links||[]).reduce((a,b)=>a+(b.Tsize||0),0),blocks:a.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:a.unixfs.mode};return a.unixfs.mtime&&(b.mtime=a.unixfs.mtime),b},object:a=>({cid:a.cid,size:a.node.length,cumulativeSize:a.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:a=>({cid:a.cid,size:a.node.length,cumulativeSize:a.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},qR=a6("ipfs:mfs:utils:to-trail");async function qS(a,b){qR(`Creating trail for path ${b}`);let c=[];for await(let d of ok(b,a.repo.blocks))c.push({name:d.name,cid:d.cid,size:d.size,type:d.type});return c}let qT=async(a,b,c)=>{c.codec||(c.codec=aQ),c.hasher||(c.hasher=dA.sha256),void 0===c.cidVersion&&(c.cidVersion=1),c.codec===aQ&&c.hasher!==dA.sha256&&(c.cidVersion=1);let d=await c.hasher.digest(a),e=bm.CID.create(c.cidVersion,c.codec.code,d);return c.onlyHash||await b.put(e,a,{signal:c.signal}),e},qU=mI.code,qV=8;async function qW(a){return(await mI.encode(a)).slice(0,8).reverse()}class qX{constructor(a,b){this.options=b||{},this.root=a.root,this.dir=a.dir,this.path=a.path,this.dirty=a.dirty,this.flat=a.flat,this.parent=a.parent,this.parentKey=a.parentKey,this.unixfs=a.unixfs,this.mode=a.mode,this.mtime=a.mtime,this.cid=void 0,this.size=void 0}async put(a,b){}get(a){return Promise.resolve(this)}async *eachChildSeries(){}async *flush(a){}}class qY extends qX{constructor(a,b){super(a,b),this._bucket=(0,no.createHAMT)({hashFn:qW,bits:qV})}async put(a,b){await this._bucket.put(a,b)}get(a){return this._bucket.get(a)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async *eachChildSeries(){for await(let{key:a,value:b}of this._bucket.eachLeafSeries())yield{key:a,child:b}}async *flush(a){yield*qZ(this._bucket,a,this,this.options)}}async function*qZ(a,b,c,d){let e=a._children,f=[],g=0;for(let h=0;h<e.length;h++){let i=e.get(h);if(!i)continue;let j=h.toString(16).toUpperCase().padStart(2,"0");if(i instanceof no.Bucket){let k;for await(let l of(await qZ(i,b,null,d)))k=l;if(!k)throw Error("Could not flush sharded directory, no subshard found");f.push({Name:j,Tsize:k.size,Hash:k.cid}),g+=k.size}else if("function"==typeof i.value.flush){let m=i.value,n;for await(let o of m.flush(b))yield n=o;let p=j+i.key;f.push({Name:p,Tsize:n.size,Hash:n.cid}),g+=n.size}else{let q=i.value;if(!q.cid)continue;let r=j+i.key,s=q.size;f.push({Name:r,Tsize:s,Hash:q.cid}),g+=s}}let t=Uint8Array.from(e.bitField().reverse()),u=new bl({type:"hamt-sharded-directory",data:t,fanout:a.tableSize(),hashType:qU,mtime:c&&c.mtime,mode:c&&c.mode}),v={Data:u.marshal(),Links:f},w=bQ(bK(v)),x=await qT(w,b,d),y=w.length+g;yield{cid:x,node:v,size:y}}let q$=a6("ipfs:mfs:core:utils:hamt-utils"),q_=async(a,b,c,d)=>{if(!d.parent.Data)throw Error("Could not update HAMT directory because parent had no data");let e=Uint8Array.from(c._children.bitField().reverse()),f=bl.unmarshal(d.parent.Data),g=new bl({type:"hamt-sharded-directory",data:e,fanout:c.tableSize(),hashType:qU,mode:f.mode,mtime:f.mtime}),h=await a.hashers.getHasher(d.hashAlg),i={Data:g.marshal(),Links:b.sort((a,b)=>(a.Name||"").localeCompare(b.Name||""))},j=bQ(i),k=await h.digest(j),l=bm.CID.create(d.cidVersion,bP,k);return d.flush&&await a.repo.blocks.put(l,j),{node:i,cid:l,size:b.reduce((a,b)=>a+(b.Tsize||0),j.length)}},q0=async(a,b,c,d,e)=>{let f=new no.Bucket({hash:c._options.hash,bits:c._options.bits},d,e);return d._putObjectAt(e,f),await q2(a,b,f,c),f},q1=async a=>{let b=(0,no.createHAMT)({hashFn:qW,bits:qV});return await Promise.all(a.map(async a=>{let c=a.Name||"";if(2===c.length){let d=parseInt(c,16),e=new no.Bucket({hash:b._options.hash,bits:b._options.bits},b,d);return b._putObjectAt(d,e),Promise.resolve()}return b.put(c.substring(2),{size:a.Tsize,cid:a.Hash})})),b},q2=async(a,b,c,d)=>{await Promise.all(b.map(async b=>{let e=b.Name||"";if(2===e.length){q$("Populating sub bucket",e);let f=parseInt(e,16),g=await a.repo.blocks.get(b.Hash),h=bR(g),i=new no.Bucket({hash:d._options.hash,bits:d._options.bits},c,f);return c._putObjectAt(f,i),await q2(a,h.Links,i,d),Promise.resolve()}return d.put(e.substring(2),{size:b.Tsize,cid:b.Hash})}))},q3=a=>a.toString(16).toUpperCase().padStart(2,"0").substring(0,2),q4=async(a,b,c)=>{let d=await q1(c.Links),e=await d._findNewBucketAndPos(b),f=[{bucket:e.bucket,prefix:q3(e.pos)}],g=e.bucket;for(;g!==d;)f.push({bucket:g,prefix:q3(g._posAtParent)}),g=g._parent;f.reverse(),f[0].node=c;for(let h=0;h<f.length;h++){let i=f[h];if(!i.node)throw Error("Could not generate HAMT path");let j=i.node.Links.filter(a=>(a.Name||"").substring(0,2)===i.prefix).pop();if(!j){q$(`Link ${i.prefix}${b} will be added`);continue}if(j.Name===`${i.prefix}${b}`){q$(`Link ${i.prefix}${b} will be replaced`);continue}q$(`Found subshard ${i.prefix}`);let k=await a.repo.blocks.get(j.Hash),l=bR(k);if(!f[h+1]){q$(`Loaded new subshard ${i.prefix}`),await q0(a,l.Links,d,i.bucket,parseInt(i.prefix,16));let m=await d._findNewBucketAndPos(b);f.push({bucket:m.bucket,prefix:q3(m.pos),node:l});continue}let n=f[h+1];await q2(a,l.Links,n.bucket,d),n.node=l}return await d.put(b,!0),f.reverse(),{rootBucket:d,path:f}},q5=async(a,b,c={})=>{let d=new qY({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:c.mtime,mode:c.mode},c);for(let e=0;e<b.length;e++)await d._bucket.put(b[e].name,{size:b[e].size,cid:b[e].cid});let f=await dR(d.flush(a.repo.blocks));if(!f)throw Error("Flushing shard yielded no result");return f},q6=a6("ipfs:mfs:core:utils:add-link");async function q7(a,b){let c=b.parent;if(b.parentCid){let d=bm.CID.asCID(b.parentCid);if(null===d)throw a7(Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(d.code!==bP)throw a7(Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");q6(`Loading parent node ${d}`);let e=await a.repo.blocks.get(d);c=bR(e)}if(!c)throw a7(Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!b.cid)throw a7(Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!b.name)throw a7(Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!b.size&&0!==b.size)throw a7(Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!c.Data)throw a7(Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let f=bl.unmarshal(c.Data);return"hamt-sharded-directory"===f.type?(q6("Adding link to sharded directory"),ra(a,{...b,parent:c})):c.Links.length>=b.shardSplitThreshold?(q6("Converting directory to sharded directory"),q8(a,{...b,parent:c,mtime:f.mtime,mode:f.mode})):(q6(`Adding ${b.name} (${b.cid}) to regular directory`),q9(a,{...b,parent:c}))}let q8=async(a,b)=>{let c=await q5(a,b.parent.Links.map(a=>({name:a.Name||"",size:a.Tsize||0,cid:a.Hash})).concat({name:b.name,size:b.size,cid:b.cid}),b);return q6(`Converted directory to sharded directory ${c.cid}`),c},q9=async(a,b)=>{let c=b.parent.Links.filter(a=>a.Name!==b.name);if(c.push({Name:b.name,Tsize:b.size,Hash:b.cid}),!b.parent.Data)throw a7(Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let d=bl.unmarshal(b.parent.Data),e;if(d.mtime){let f=Date.now(),g=Math.floor(f/1e3);d.mtime={secs:g,nsecs:(f-1e3*g)*1e3},e=d.marshal()}else e=b.parent.Data;b.parent=bK({Data:e,Links:c});let h=await a.hashers.getHasher(b.hashAlg),i=bQ(b.parent),j=await h.digest(i),k=bm.CID.create(b.cidVersion,bP,j);return b.flush&&await a.repo.blocks.put(k,i),{node:b.parent,cid:k,size:i.length}},ra=async(a,b)=>{let{shard:c,path:d}=await rb(a,b),e=await dR(c.flush(a.repo.blocks));if(!e)throw Error("No result from flushing shard");let f=await a.repo.blocks.get(e.cid),g=bR(f),h=b.parent.Links.filter(a=>(a.Name||"").substring(0,2)!==d[0].prefix),i=g.Links.find(a=>(a.Name||"").substring(0,2)===d[0].prefix);if(!i)throw Error(`No link found with prefix ${d[0].prefix}`);return h.push(i),q_(a,h,d[0].bucket,b)},rb=async(a,b)=>{let c={name:b.name,cid:b.cid,size:b.size};if(!b.parent.Data)throw a7(Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let d=await q1(b.parent.Links),e=bl.unmarshal(b.parent.Data),f=new qY({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:e.mode},b);f._bucket=d,e.mtime&&(f.mtime={secs:Math.round(Date.now()/1e3)});let g=await d._findNewBucketAndPos(c.name),h=rc(g);h[0].node=b.parent;let i=0;for(;i<h.length;){let j=h[i];i++;let k=j.node;if(!k)throw Error("Segment had no node");let l=k.Links.find(a=>(a.Name||"").substring(0,2)===j.prefix);if(!l){q6(`Link ${j.prefix}${c.name} will be added`),i=h.length;break}if(l.Name===`${j.prefix}${c.name}`){q6(`Link ${j.prefix}${c.name} will be replaced`),i=h.length;break}if((l.Name||"").length>2){q6(`Link ${l.Name} ${l.Hash} will be replaced with a subshard`),i=h.length;break}q6(`Found subshard ${j.prefix}`);let m=await a.repo.blocks.get(l.Hash),n=bR(m);if(!h[i]){q6(`Loaded new subshard ${j.prefix}`),await q0(a,n.Links,d,j.bucket,parseInt(j.prefix,16));let o=await d._findNewBucketAndPos(c.name);h.push({bucket:o.bucket,prefix:q3(o.pos),node:n});break}let p=h[i];await q2(a,n.Links,p.bucket,d),p.node=n}return await f._bucket.put(c.name,{size:c.size,cid:c.cid}),{shard:f,path:h}},rc=a=>{let b=[{bucket:a.bucket,prefix:q3(a.pos)}],c=a.bucket._parent,d=a.bucket._posAtParent;for(;c;)b.push({bucket:c,prefix:q3(d)}),d=c._posAtParent,c=c._parent;return b.reverse(),b},rd=a6("ipfs:mfs:utils:update-tree"),re={shardSplitThreshold:1e3};async function rf(a,b,c){c=Object.assign({},re,c),rd("Trail",b),b=b.slice().reverse();let d=0,e;for await(let f of a.repo.blocks.getMany(b.map(a=>a.cid))){let g=bR(f),h=b[d].cid,i=b[d].name;if(d++,!e){e={cid:h,name:i,size:f.length};continue}let j=await q7(a,{parent:g,name:e.name,cid:e.cid,size:e.size,flush:c.flush,shardSplitThreshold:c.shardSplitThreshold,hashAlg:c.hashAlg,cidVersion:c.cidVersion});e={cid:j.cid,name:i,size:j.size}}let{cid:k}=e;return rd(`Final CID ${k}`),k}let rg=a6("ipfs:mfs:utils:update-mfs-root");async function rh(a,b,c){if(c&&c.signal&&c.signal.aborted)throw a7(Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return rg(`New MFS root will be ${b}`),await a.repo.datastore.put(cY,b.bytes),b}async function ri(a,b,c){let d=new bl({type:b,mode:c.mode,mtime:c.mtime}),e=await a.hashers.getHasher(c.hashAlg),f={Data:d.marshal(),Links:[]},g=bQ(f),h=await e.digest(g),i=bm.CID.create(c.cidVersion,bP,h);return c.flush&&await a.repo.blocks.put(i,g),{cid:i,node:f}}let rj=a0.bind({ignoreUndefined:!0}),rk=a6("ipfs:mfs:mkdir"),rl={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function rm(a){async function b(b,c={}){let d=rj(rl,c);if(!b)throw Error("no path given to Mkdir");if("/"===(b=b.trim())){if(d.parents)return;throw a7(Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if("/"!==b.substring(0,1))throw a7(Error("paths must start with a leading slash"),"ERR_INVALID_PATH");rk(`Creating ${b}`);let e=qJ(b);if("ipfs"===e[0])throw a7(Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let f=await qI(a,d),g,h=[],i=await ri(a,"directory",d);for(let j=0;j<=e.length;j++){let k=e.slice(0,j),l=`/ipfs/${f}/${k.join("/")}`;try{if(g=await ol(l,a.repo.blocks),"file"!==g.type&&"directory"!==g.type)throw a7(Error(`${b} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(j===e.length){if(d.parents)return;throw a7(Error("file already exists"),"ERR_ALREADY_EXISTS")}h.push({name:g.name,cid:g.cid})}catch(m){if("ERR_NOT_FOUND"===m.code){if(j<e.length&&!d.parents)throw a7(Error(`Intermediate directory path ${l} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await rn(a,k[k.length-1],i,h[h.length-1],h,d)}else throw m}}let n=await rf(a,h,d);await rh(a,n,d)}return cT(b)}let rn=async(a,b,c,d,e,f)=>{rk(`Adding empty dir called ${b} to ${d.cid}`);let g=await q7(a,{parent:d.node,parentCid:d.cid,size:0,cid:c.cid,name:b,hashAlg:f.hashAlg,cidVersion:f.cidVersion,flush:f.flush,shardSplitThreshold:f.shardSplitThreshold});e[e.length-1].cid=g.cid,e.push({name:b,cid:c.cid})},ro=a0.bind({ignoreUndefined:!0}),rp=a6("ipfs:mfs:cp"),rq={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function rr(a){async function b(b,c,d={}){let e=ro(rq,d);Array.isArray(b)||(b=[b]);let f=await Promise.all(b.map(b=>qL(a,b,e))),g=await qL(a,c,e);if(!f.length||!g)throw a7(Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let h=f.find(a=>!a.exists);if(h)throw a7(Error(`${h.path} does not exist`),"ERR_INVALID_PARAMS");let i=rs(g);if(g.exists){if(rp("Destination exists"),1===f.length&&!i)throw a7(Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(rp("Destination does not exist"),f.length>1){if(!e.parents)throw a7(Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await rm(a)(g.path,e),g=await qL(a,g.path,e)}else if(g.parts.length>1){let j=`/${g.parts.slice(0,-1).join("/")}`;try{await qP(a)(j,e)}catch(k){if("ERR_NOT_FOUND"!==k.code)throw k;if(!e.parents)throw a7(Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await rm(a)(j,e),g=await qL(a,g.path,e)}}let l=rs(g)?g.mfsPath:g.mfsDirectory,m=await qS(a,l);if(1===f.length){let n=f.pop();if(!n)throw a7(Error("could not find source"),"ERR_INVALID_PARAMS");let o=i?n.name:g.name;return rp(`Only one source, copying to destination ${i?"directory":"file"} ${o}`),rt(a,n,o,m,e)}return rp("Multiple sources, wrapping in a directory"),ru(a,f,g,m,e)}return cT(b)}let rs=a=>a.unixfs&&a.unixfs.type&&a.unixfs.type.includes("directory"),rt=async(a,b,c,d,e)=>{let f=d.pop();if(!f)throw a7(Error("destination had no parent"),"ERR_INVALID_PARAMS");f=await rv(a,b,c,f,e),d.push(f);let g=await rf(a,d,e);await rh(a,g,e)},ru=async(a,b,c,d,e)=>{for(let f=0;f<b.length;f++){let g=b[f];c=await rv(a,g,g.name,c,e)}d[d.length-1]=c;let h=await rf(a,d,e);await rh(a,h,e)},rv=async(a,b,c,d,e)=>{let f=await a.repo.blocks.get(b.cid),{node:g,cid:h,size:i}=await q7(a,{parentCid:d.cid,size:f.length,cid:b.cid,name:c,hashAlg:e.hashAlg,cidVersion:e.cidVersion,flush:e.flush,shardSplitThreshold:e.shardSplitThreshold});return d.node=g,d.cid=h,d.size=i,d},rw=a6("ipfs:mfs:core:utils:remove-link");async function rx(a,b){let c=b.parent;if(b.parentCid){let d=bm.CID.asCID(b.parentCid);if(null===d)throw a7(Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");rw(`Loading parent node ${d}`);let e=await a.repo.blocks.get(d);c=bR(e)}if(!c)throw a7(Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!b.name)throw a7(Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!c.Data)throw a7(Error("Parent node had no data"),"ERR_INVALID_NODE");let f=bl.unmarshal(c.Data);return"hamt-sharded-directory"===f.type?(rw(`Removing ${b.name} from sharded directory`),rz(a,{...b,parent:c})):(rw(`Removing link ${b.name} regular directory`),ry(a,{...b,parent:c}))}let ry=async(a,b)=>{b.parent.Links=b.parent.Links.filter(a=>a.Name!==b.name);let c=await bQ(b.parent),d=await a.hashers.getHasher(b.hashAlg),e=await d.digest(c),f=bm.CID.create(b.cidVersion,bP,e);return await a.repo.blocks.put(f,c),rw(`Updated regular directory ${f}`),{node:b.parent,cid:f}},rz=async(a,b)=>{let{rootBucket:c,path:d}=await q4(a,b.name,b.parent);await c.del(b.name);let{node:e}=await rA(a,d,b.name,b);return q_(a,e.Links,c,b)},rA=async(a,b,c,d)=>{let e=b.pop();if(!e)throw a7(Error("Could not find parent"),"EINVALIDPARENT");let{bucket:f,prefix:g,node:h}=e;if(!h)throw a7(Error("Could not find parent"),"EINVALIDPARENT");let i=h.Links.find(a=>(a.Name||"").substring(0,2)===g);if(!i)throw a7(Error(`No link found with prefix ${g} for file ${c}`),"ERR_NOT_FOUND");if(i.Name===`${g}${c}`){rw(`Removing existing link ${i.Name}`);let j=h.Links.filter(a=>a.Name!==i.Name);return await f.del(c),q_(a,j,f,d)}rw(`Descending into sub-shard ${i.Name} for ${g}${c}`);let k=await rA(a,b,c,d),l=k.cid,m=k.size,n=g;if(1===k.node.Links.length){rw(`Removing subshard for ${g}`);let o=k.node.Links[0];n=`${g}${(o.Name||"").substring(2)}`,l=o.Hash,m=o.Tsize||0}return rw(`Updating shard ${g} with name ${n}`),rB(a,f,h,g,n,m,l,d)},rB=(a,b,c,d,e,f,g,h)=>{let i=c.Links.filter(a=>a.Name!==d);return i.push({Name:e,Tsize:f,Hash:g}),q_(a,i,b,h)},rC=a0.bind({ignoreUndefined:!0}),rD={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function rE(a){async function b(b,c={}){let d=rC(rD,c);Array.isArray(b)||(b=[b]);let e=await Promise.all(b.map(b=>qL(a,b,d)));if(!e.length)throw a7(Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");for(let f of(e.forEach(a=>{if("/"===a.path)throw a7(Error("Cannot delete root"),"ERR_INVALID_PARAMS")}),e))await rF(a,f.path,d)}return cT(b)}let rF=async(a,b,c)=>{let d=await qL(a,b,c),e=await qS(a,d.mfsPath),f=e[e.length-1];e.pop();let g=e[e.length-1];if(!g)throw a7(Error(`${b} does not exist`),"ERR_NOT_FOUND");if("directory"===f.type&&!c.recursive)throw a7(Error(`${b} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:h}=await rx(a,{parentCid:g.cid,name:f.name,hashAlg:c.hashAlg,cidVersion:c.cidVersion,flush:c.flush,shardSplitThreshold:c.shardSplitThreshold});g.cid=h;let i=await rf(a,e,c);await rh(a,i,c)},rG=a0.bind({ignoreUndefined:!0}),rH=a6("ipfs:mfs:touch"),rI={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function rJ(a,b,c){let d=0;return(a.includes("x")||a.includes("X")&&(c||1&b||8&b||64&b))&&(d+=1),a.includes("w")&&(d+=2),a.includes("r")&&(d+=4),d}function rK(a,b){let c=0;return a.includes("u")&&(c+=b<<6),a.includes("g")&&(c+=b<<3),a.includes("o")&&(c+=b),c}function rL(a,b,c){return b.includes("t")&&(c+=parseInt("1000",8)),b.includes("s")&&(a.includes("u")&&(c+=parseInt("4000",8)),a.includes("g")&&(c+=parseInt("2000",8))),c}function rM(a,b,c){b||(b=0);let d=a.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!d)throw Error(`Invalid file mode: ${a}`);let[,e,f,g]=d;"a"!==e&&e||(e="ugo");let h=rJ(g,b,c);return(h=rK(e,h),h=rL(e,g,h),"="===f)?(e.includes("u")&&(b&=parseInt("7077",8),b|=h),e.includes("g")&&(b&=parseInt("7707",8),b|=h),e.includes("o")&&(b&=parseInt("7770",8),b|=h),b):"+"===f?h|b:"-"===f?h^b:b}function rN(a,b){if(a instanceof String||"string"==typeof a){let c=`${a}`;a=c.match(/^\d+$/g)?parseInt(c,8):0+c.split(",").reduce((a,c)=>rM(c,a,b.isDirectory()),b.mode||0)}return a}function rO(a){async function b(b,c,d={}){let e=rG(rI,d);rH(`Fetching stats for ${b}`);let{cid:f,mfsDirectory:g,name:h}=await qL(a,b,e);if(f.code!==bP)throw a7(Error(`${b} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(e.recursive){let i=await mk(async function*(){for await(let d of om(f,a.repo.blocks)){if("file"!==d.type&&"directory"!==d.type)throw a7(Error(`${b} was not a UnixFS node`),"ERR_NOT_UNIXFS");d.unixfs.mode=rN(c,d.unixfs);let e=bK({Data:d.unixfs.marshal(),Links:d.node.Links});yield{path:d.path,content:e}}},b=>nB(b,a.repo.blocks,{...e,pin:!1,dagBuilder:async function*(a,b,c){for await(let d of a)yield async function(){let a=d.content,e=bQ(a),f=await qT(e,b,c);if(!a.Data)throw a7(Error(`${f} had no data`),"ERR_INVALID_NODE");let g=bl.unmarshal(a.Data);return{cid:f,size:e.length,path:d.path,unixfs:g}}}}),a=>dR(a));if(!i)throw a7(Error(`Could not chmod ${b}`),"ERR_COULD_NOT_CHMOD");await rE(a)(b,e),await rr(a)(`/ipfs/${i.cid}`,b,e);return}let j=await a.repo.blocks.get(f),k=bR(j);if(!k.Data)throw a7(Error(`${f} had no data`),"ERR_INVALID_NODE");let l=bl.unmarshal(k.Data);l.mode=rN(c,l);let m=bQ({Data:l.marshal(),Links:k.Links}),n=e.hashAlg||rI.hashAlg,o=await a.hashers.getHasher(n),p=await o.digest(m),q=bm.CID.create(e.cidVersion,bP,p);e.flush&&await a.repo.blocks.put(q,m);let r=await qS(a,g),s=r[r.length-1],t=bm.CID.decode(s.cid.bytes),u=await a.repo.blocks.get(t),v=bR(u),w=await q7(a,{parent:v,name:h,cid:q,size:m.length,flush:e.flush,hashAlg:n,cidVersion:f.version,shardSplitThreshold:1/0});s.cid=w.cid;let x=await rf(a,r,e);await rh(a,x,e)}return cT(b)}let rP=a0.bind({ignoreUndefined:!0}),rQ={};function rR(a){async function b(b,c={}){c=rP(rQ,c);let{cid:d}=await qP(a)(b,c);return d}return cT(b)}let rS=a0.bind({ignoreUndefined:!0}),rT={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function rU(a){async function b(b,c,d={}){let e=rS(rT,d);await rr(a)(b,c,e),await rE(a)(b,{...e,recursive:!0})}return cT(b)}let rV=a0.bind({ignoreUndefined:!0}),rW=a6("ipfs:mfs:touch"),rX={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function rY(a){async function b(b,c={}){let d=rV(rX,c);d.mtime=d.mtime||new Date,rW(`Touching ${b} mtime: ${d.mtime}`);let{cid:e,mfsDirectory:f,name:g,exists:h}=await qL(a,b,d),i=c.hashAlg||rX.hashAlg,j=await a.hashers.getHasher(i),k,l,m=d.cidVersion;if(h){if(e.code!==bP)throw a7(Error(`${b} was not a UnixFS node`),"ERR_NOT_UNIXFS");m=e.version;let n=await a.repo.blocks.get(e),o=bR(n);if(!o.Data)throw a7(Error(`${b} had no data`),"ERR_INVALID_NODE");let p=bl.unmarshal(o.Data);p.mtime=d.mtime,k=bQ({Data:p.marshal(),Links:o.Links});let q=await j.digest(k);l=bm.CID.create(d.cidVersion,bP,q),d.flush&&await a.repo.blocks.put(l,k)}else{let r=new bl({type:"file",mtime:d.mtime});k=bQ({Data:r.marshal(),Links:[]});let s=await j.digest(k);l=bm.CID.create(d.cidVersion,bP,s),d.flush&&await a.repo.blocks.put(l,k)}let t=await qS(a,f),u=t[t.length-1],v=u.cid,w=await a.repo.blocks.get(v),x=bR(w),y=await q7(a,{parent:x,name:g,cid:l,size:k.length,flush:d.flush,shardSplitThreshold:d.shardSplitThreshold,hashAlg:d.hashAlg,cidVersion:m});u.cid=y.cid;let z=await rf(a,t,d);await rh(a,z,d)}return cT(b)}let rZ=a0.bind({ignoreUndefined:!0}),r$={offset:0,length:1/0};function r_(a){function b(b,c={}){return c=rZ(r$,c),{[Symbol.asyncIterator]:async function*(){let d=await qL(a,b,c),e=await ol(d.mfsPath,a.repo.blocks);if("file"!==e.type)throw a7(Error(`${b} was not a file`),"ERR_NOT_FILE");if(!e.content)throw a7(Error(`Could not load content stream from ${b}`),"ERR_NO_CONTENT");for await(let f of e.content({offset:c.offset,length:c.length}))yield f}}}return cT(b)}let r0=a6("ipfs:mfs:utils:to-async-iterator");function r1(a){if(!a)throw a7(Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if(("string"==typeof a||a instanceof String)&&(r0("Content was a string"),a=(0,cB.fromString)(a.toString())),a.length)return r0("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield a}};if(a[Symbol.asyncIterator])return r0("Content was an async iterator"),a;if(a[Symbol.iterator])return r0("Content was an iterator"),a;if(global.Blob&&a instanceof global.Blob){r0("Content was an HTML5 Blob");let b=0,c={next:()=>b>a.size?{done:!0}:new Promise((c,d)=>{let e=a.slice(b,cZ);b+=cZ;let f=new global.FileReader,g=a=>{if(f.removeEventListener("loadend",g,!1),a.error)return d(a.error);c({done:!1,value:new Uint8Array(f.result)})};f.addEventListener("loadend",g),f.readAsArrayBuffer(e)})};return{[Symbol.asyncIterator]:()=>c}}throw a7(Error(`Don't know how to convert ${a} into an async iterator`),"ERR_INVALID_PARAMS")}let r2=a0.bind({ignoreUndefined:!0}),r3=a6("ipfs:mfs:write"),r4={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(a,b)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function r5(a){async function b(b,c,d={}){let e=r2(r4,d),f,g,h;if(r3("Reading source, destination and parent"),await qG().readLock(async()=>{f=await r1(c),g=await qL(a,b,e),h=await qL(a,g.mfsDirectory,e)})(),r3("Read source, destination and parent"),!e.parents&&!h.exists)throw a7(Error("directory does not exist"),"ERR_NO_EXIST");if(null==f)throw a7(Error("could not create source"),"ERR_NO_SOURCE");if(null==g)throw a7(Error("could not create destination"),"ERR_NO_DESTINATION");if(!e.create&&!g.exists)throw a7(Error("file does not exist"),"ERR_NO_EXIST");if("file"!==g.entryType)throw a7(Error("not a file"),"ERR_NOT_A_FILE");return r6(a,b,f,g,e)}return cT(b)}let r6=async(a,b,c,d,e)=>{let f=await r7(a,c,d,e);await qG().writeLock(async()=>{let c=qJ(b),d=c.pop();if(null==d)throw a7(Error("source does not exist"),"ERR_NO_EXIST");let g=!1;try{await qP(a)(`/${c.join("/")}`,e),g=!0}catch(h){if("ERR_NOT_FOUND"!==h.code)throw h}g||await rm(a)(`/${c.join("/")}`,e);let i=await qL(a,b,e),j=await qS(a,i.mfsDirectory),k=j[j.length-1];if(!k)throw a7(Error("directory does not exist"),"ERR_NO_EXIST");if(!k.type||!k.type.includes("directory"))throw a7(Error(`cannot write to ${k.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let l=await a.repo.blocks.get(k.cid),m=bR(l),n=await q7(a,{parent:m,name:d,cid:f.cid,size:f.size,flush:e.flush,shardSplitThreshold:e.shardSplitThreshold,hashAlg:e.hashAlg,cidVersion:e.cidVersion});k.cid=n.cid;let o=await rf(a,j,e);await rh(a,o,e)})()},r7=async(a,b,c,d)=>{c.exists?r3(`Overwriting file ${c.cid} offset ${d.offset} length ${d.length}`):r3(`Writing file offset ${d.offset} length ${d.length}`);let e=[];if(d.offset>0){if(c.unixfs){if(r3(`Writing first ${d.offset} bytes of original file`),e.push(()=>c.content({offset:0,length:d.offset})),c.unixfs.fileSize()<d.offset){let f=d.offset-c.unixfs.fileSize();r3(`Writing zeros for extra ${f} bytes`),e.push(r9(f))}}else r3(`Writing zeros for first ${d.offset} bytes`),e.push(r9(d.offset))}e.push(r8(b,d.length));let g=sb(sa(e),a=>{if(c.unixfs&&!d.truncate){let b=c.unixfs.fileSize();if(b>a)return r3(`Writing last ${b-a} of ${b} bytes from original file starting at offset ${a}`),c.content({offset:a});r3("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),h;void 0!==d.mode&&null!==d.mode?h=bj(d.mode):c&&c.unixfs&&(h=c.unixfs.mode);let i;null!=d.mtime?i=bk(d.mtime):c&&c.unixfs&&(i=c.unixfs.mtime);let j=await a.hashers.getHasher(d.hashAlg),k=await dR(nB([{content:g,mode:h,mtime:i}],a.repo.blocks,{progress:d.progress,hasher:j,cidVersion:d.cidVersion,strategy:d.strategy,rawLeaves:d.rawLeaves,reduceSingleLeafToSelf:d.reduceSingleLeafToSelf,leafType:d.leafType}));if(!k)throw a7(Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return r3(`Wrote ${k.cid}`),{cid:k.cid,size:k.size}},r8=(a,b)=>async function*(){let c=0;for await(let d of a){if((c+=d.length)>b){yield d.slice(0,b-c);return}yield d}},r9=(a,b=cZ)=>{let c=new Uint8Array(b);async function*d(){for(;;)yield c.slice()}return r8(d(),a)},sa=async function*(a){for(let b=0;b<a.length;b++)yield*a[b]()},sb=async function*(a,b){let c=0;for await(let d of a)c+=d.length,yield d;for await(let e of b(c))c+=e.length,yield e},sc=a=>{let b={cid:a.cid,name:a.name,type:"directory"===a.type?"directory":"file",size:a.size};return("file"===a.type||"directory"===a.type)&&(b.mode=a.unixfs.mode,b.mtime=a.unixfs.mtime),b};function sd(a){async function*b(b,c={}){let d=await qL(a,b,c),e=await ol(d.mfsPath,a.repo.blocks);if("directory"===e.type){yield*jS(e.content(c),sc);return}yield sc(e)}return cT(b)}let se={stat:qP},sf={chmod:rO,cp:rr,flush:rR,mkdir:rm,mv:rU,rm:rE,touch:rY},sg={write:r5,read:r_,ls:sd},sh=({options:a,mfs:b,operations:c,lock:d})=>{Object.keys(c).forEach(e=>{b[e]=d(c[e](a))})},si={repoOwner:!0,repo:null};function sj(a){let{repoOwner:b}=Object.assign({},si||{},a),c=qG(b),d=a=>c.readLock(a),e=a=>c.writeLock(a),f={};return sh({options:a,mfs:f,operations:se,lock:d}),sh({options:a,mfs:f,operations:sf,lock:e}),Object.keys(sg).forEach(b=>{f[b]=sg[b](a)}),f}function sk({repo:a,preload:b,hashers:c,options:d}){let e=sj({repo:a,repoOwner:!1!==d.repoOwner,hashers:c}),f=a=>{let c=(...c)=>{let d=c.filter(a=>cC.ipfsPath(a)||cC.cid(a));if(d.length){let e=c[c.length-1];e&& !1!==e.preload&&d.forEach(a=>b(a))}return a(...c)};return c};return{...e,chmod:e.chmod,cp:f(e.cp),mkdir:e.mkdir,stat:f(e.stat),rm:e.rm,read:f(e.read),touch:e.touch,write:e.write,mv:f(e.mv),flush:e.flush,ls:f(async function*(...a){for await(let b of e.ls(...a))yield{...b,size:b.size||0}})}}function sl({keychain:a}){let b=(b,c)=>a.exportKey(b,c);return cT(b)}let sm="Ed25519",sn=2048;function so({keychain:a}){let b=(b,c={type:sm,size:sn})=>a.createKey(b,c.type||sm,c.size||sn);return cT(b)}function sp({keychain:a}){let b=(b,c,d)=>a.importKey(b,c,d);return cT(b)}function sq({keychain:a}){let b=b=>a.findKeyByName(b);return cT(b)}function sr({keychain:a}){let b=()=>a.listKeys();return cT(b)}function ss({keychain:a}){let b=async(b,c)=>{let d=await a.renameKey(b,c);return{was:b,now:d.name,id:d.id,overwrite:!1}};return cT(b)}function st({keychain:a}){let b=b=>a.removeKey(b);return cT(b)}class su{constructor({keychain:a}){this.gen=so({keychain:a}),this.list=sr({keychain:a}),this.rm=st({keychain:a}),this.rename=ss({keychain:a}),this.export=sl({keychain:a}),this.import=sp({keychain:a}),this.info=sq({keychain:a})}}function sv({repo:a,preload:b}){async function c(c,d={}){!1!==d.preload&&b(c);let e=await a.blocks.get(c,d);return bR(e)}return cT(c)}function sw({repo:a,preload:b}){let c=sv({repo:a,preload:b});async function d(a,b={}){let d=await c(a,b);return d.Data||new Uint8Array(0)}return cT(d)}function sx(a,b=[]){for(let c in a){let d=a[c];if("/"===c&&1===Object.keys(a).length)try{b.push({Name:"",Tsize:0,Hash:bm.CID.parse(d)});continue}catch(e){}let f=bm.CID.asCID(d);if(f){b.push({Name:"",Tsize:0,Hash:f});continue}Array.isArray(d)&&sx(d,b),d&&"object"==typeof d&&sx(d,b)}return b}function sy({repo:a,codecs:b}){async function c(c,d={}){let e=await b.getCodec(c.code),f=await a.blocks.get(c,d),g=e.decode(f);switch(c.code){case mQ.code:return[];case bP:return g.Links;case b_:case cm:return sx(g);default:throw Error(`Cannot resolve links from codec ${c.code}`)}}return cT(c)}function sz({repo:a,preload:b}){async function c(c={}){let d;if(c.template){if("unixfs-dir"===c.template)d=new bl({type:"directory"}).marshal();else throw Error("unknown template")}let e=bQ({Data:d,Links:[]}),f=await dA.sha256.digest(e),g=bm.CID.createV0(f);return await a.blocks.put(g,e,{signal:c.signal}),!1!==c.preload&&b(g),g}return cT(c)}function sA({repo:a,preload:b}){async function c(c,d={}){let e=await a.gcLock.readLock();try{let f=bQ(c),g=await dA.sha256.digest(f),h=bm.CID.createV1(bP,g);return await a.blocks.put(h,f,{signal:d.signal}),!1!==d.preload&&b(h),d.pin&&await a.pins.pinRecursively(h,{signal:d.signal}),h}finally{e()}}return cT(c)}function sB({repo:a,preload:b}){let c=sv({repo:a,preload:b});async function d(a,b={}){let d=await c(a,b),e=bQ(d),f=e.length,g=d.Links.reduce((a,b)=>a+(b.Tsize||0),0);return{Hash:a,NumLinks:d.Links.length,BlockSize:f,LinksSize:f-(d.Data||[]).length,DataSize:(d.Data||[]).length,CumulativeSize:f+g}}return cT(d)}function sC({repo:a,preload:b}){let c=sv({repo:a,preload:b}),d=sA({repo:a,preload:b});async function e(a,b,e={}){let f=await c(a,e);return d({...f,Links:f.Links.concat([b])},e)}return cT(e)}function sD({repo:a,preload:b}){let c=sv({repo:a,preload:b}),d=sA({repo:a,preload:b});async function e(a,b,e={}){let f=await c(a,e),g=(0,d7.concat)([f.Data||[],b]);return d({...f,Data:g},e)}return cT(e)}function sE({repo:a,preload:b}){let c=sv({repo:a,preload:b}),d=sA({repo:a,preload:b});async function e(a,b,e={}){let f=await c(a,e),g=("string"==typeof b?b:b.Name)||"";return f.Links=f.Links.filter(a=>a.Name!==g),d(f,e)}return cT(e)}function sF({repo:a,preload:b}){let c=sv({repo:a,preload:b}),d=sA({repo:a,preload:b});async function e(a,b,e={}){let f=await c(a,e);return d({...f,Data:b},e)}return cT(e)}class sG{constructor({repo:a,preload:b}){this.addLink=sC({repo:a,preload:b}),this.appendData=sD({repo:a,preload:b}),this.rmLink=sE({repo:a,preload:b}),this.setData=sF({repo:a,preload:b})}}class sH{constructor({repo:a,codecs:b,preload:c}){this.data=sw({repo:a,preload:c}),this.get=sv({repo:a,preload:c}),this.links=sy({repo:a,codecs:b}),this.new=sz({repo:a,preload:c}),this.put=sA({repo:a,preload:c}),this.stat=sB({repo:a,preload:c}),this.patch=new sG({repo:a,preload:c})}}let sI=a6("ipfs:repo:gc");function sJ({repo:a,hashers:b}){async function*c(c={}){let d=Date.now(),e;try{e=await qI({repo:a,hashers:b},c),await a.pins.pinRecursively(e),yield*a.gc()}finally{e&&await a.pins.unpin(e)}sI(`Complete (${Date.now()-d}ms)`)}return cT(c)}function sK({repo:a}){async function b(b={}){let c=await a.stat();return{numObjects:BigInt(c.numObjects.toString()),repoSize:BigInt(c.repoSize.toString()),repoPath:c.repoPath,version:`${c.version}`,storageMax:BigInt(c.storageMax.toString())}}return cT(b)}let sL=12;function sM({repo:a}){async function b(b={}){try{await a._checkInitialized(b)}catch(c){let d=[/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(a=>a.test(c.message));if(d)return sL;throw c}return a.version.get()}return cT(b)}class sN{constructor({repo:a,hashers:b}){this.gc=sJ({repo:a,hashers:b}),this.stat=sK({repo:a}),this.version=sM({repo:a}),this.setApiAddr=b=>a.apiAddr.set(b)}}function sO(a,b){let c;if(!(c=a.metrics?b.peer?a.metrics.forPeer(b.peer):b.proto?a.metrics.forProtocol(b.proto):a.metrics.getGlobal():void 0))return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let d=c.getMovingAverages(),e=c.getSnapshot();return{totalIn:e.dataReceived,totalOut:e.dataSent,rateIn:d.dataReceived[6e4].movingAverage/60,rateOut:d.dataSent[6e4].movingAverage/60}}function sP({network:a}){let b=async function*(b={}){let{libp2p:c}=await a.use(b);if(!b.poll){yield sO(c,b);return}let d=b.interval||1e3,e=-1;try{if(!(e="string"==typeof d?cR(d)|| -1:d)||e<0)throw Error("invalid duration")}catch(f){throw a7(f,"ERR_INVALID_POLL_INTERVAL")}let g;try{for(;;)yield sO(c,b),await new Promise(a=>{g=setTimeout(a,e)})}finally{clearTimeout(g)}};return cT(b)}class sQ{constructor({repo:a,network:b}){this.repo=sK({repo:a}),this.bw=sP({network:b}),this.bitswap=kF({network:b})}}var sR=c(44874),sS=c(93975);let sT=a2("ipfs:repo:migrator:migration-8");function sU(a){return a.child?sU(a.child):a}function sV(a){try{let b=a4.base32.decode(`b${a.toString().toLowerCase().slice(1)}`),c=bm.CID.decode(b).multihash.bytes,d=a4.base32.encode(c).slice(1).toUpperCase();return new cI(`/${d}`,!1)}catch(e){return a}}function sW(a){try{let b=a4.base32.decode(`b${a.toString().toLowerCase().slice(1)}`),c=dy.decode(b),d=a4.base32.encode(bm.CID.createV1(mQ.code,c).bytes).slice(1);return new cI(`/${d.toUpperCase()}`,!1)}catch{return a}}async function sX(a,b,c){let d=a.blocks;await d.open();let e=sU(d),f=await sS(e.queryKeys({filters:[a=>{let b=c(a);return b.toString()!==a.toString()}]}));try{let g=0;for await(let h of e.query({})){let i=c(h.key);i.toString()!==h.key.toString()&&(g+=1,sT(`Migrating Block from ${h.key} to ${i}`,await e.has(h.key)),await e.delete(h.key),await e.put(i,h.value),b(g/f*100,`Migrated Block from ${h.key} to ${i}`))}}finally{await d.close()}}let sY={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(a,b=()=>{})=>sX(a,b,sV),revert:(a,b=()=>{})=>sX(a,b,sW)},sZ=a8.Reader,s$=a8.Writer;a8.util;let s_=a8.roots.default||(a8.roots.default={}),s0=s_.ipfs=(()=>{let a={};return a.pin=function(){let a={};return a.Set=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.version=0,a.prototype.fanout=0,a.prototype.seed=0,a.encode=function(a,b){return b||(b=s$.create()),null!=a.version&&Object.hasOwnProperty.call(a,"version")&&b.uint32(8).uint32(a.version),null!=a.fanout&&Object.hasOwnProperty.call(a,"fanout")&&b.uint32(16).uint32(a.fanout),null!=a.seed&&Object.hasOwnProperty.call(a,"seed")&&b.uint32(29).fixed32(a.seed),b},a.decode=function(a,b){a instanceof sZ||(a=sZ.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new s_.ipfs.pin.Set;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.version=a.uint32();break;case 2:d.fanout=a.uint32();break;case 3:d.seed=a.fixed32();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof s_.ipfs.pin.Set)return a;var b=new s_.ipfs.pin.Set;return null!=a.version&&(b.version=a.version>>>0),null!=a.fanout&&(b.fanout=a.fanout>>>0),null!=a.seed&&(b.seed=a.seed>>>0),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(c.version=0,c.fanout=0,c.seed=0),null!=a.version&&a.hasOwnProperty("version")&&(c.version=a.version),null!=a.fanout&&a.hasOwnProperty("fanout")&&(c.fanout=a.fanout),null!=a.seed&&a.hasOwnProperty("seed")&&(c.seed=a.seed),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a}(),a})();var s1=c(96132);let s2=new cI("/local/pins"),s3=256,s4=8192,s5=bm.CID.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),s6={direct:"direct",recursive:"recursive"};function s7(a){return new cI(`/${a4.base32.encode(a.multihash.bytes).toUpperCase().substring(1)}`)}function s8(a,b){for(let c=0;c<a.byteLength;c++){if(a[c]<b[c])return -1;if(a[c]>b[c])return 1}return a.byteLength>b.byteLength?1:a.byteLength<b.byteLength?-1:0}let s9=s0.pin.Set;function ta(a){let b=a.Data;if(!b)throw Error("No data present");let c=k2.decode(b),d=k2.decode.bytes;if(d<=0)throw Error("Invalid Set header length");if(d+c>b.length)throw Error("Impossibly large set header length");let e=b.slice(d,c+d),f=s9.toObject(s9.decode(e),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==f.version)throw Error(`Unsupported Set version: ${f.version}`);if(f.fanout>a.Links.length)throw Error("Impossibly large fanout");return{header:f,data:b.slice(c+d)}}function tb(a,b){let c=new Uint8Array(4),d=new DataView(c.buffer);d.setUint32(0,a,!0);let e=(0,cB.fromString)(b.toString()),f=(0,d7.concat)([c,e],c.byteLength+e.byteLength);return s1((0,cE.toString)(f))}async function*tc(a,b){let c=ta(b),d=0;for(let e of b.Links){if(d<c.header.fanout){let f=e.Hash;if(!s5.equals(f)){let g=await a.get(f),h=bR(g);yield*tc(a,h)}}else yield e.Hash;d++}}async function*td(a,b,c){let d=b.Links.find(a=>a.Name===c);if(!d)throw Error("No link found with name "+c);let e=await a.get(d.Hash),f=bR(e);yield*tc(a,f)}function te(a,b){return c(b,0);async function c(b,d){let e=s9.encode({version:1,fanout:s3,seed:d}).finish(),f=k2.encode(e.length),g=(0,d7.concat)([f,e]),h=[];for(let i=0;i<s3;i++)h.push({Name:"",Tsize:1,Hash:s5});if(b.length<=s4){let j=b.map(a=>({link:{Name:"",Tsize:1,Hash:a.key},data:a.data||new Uint8Array})).sort((a,b)=>s8(a.link.Hash.bytes,b.link.Hash.bytes)),k=h.concat(j.map(a=>a.link)),l=(0,d7.concat)([g,...j.map(a=>a.data)]);return{Data:l,Links:k}}{let m=b.reduce((a,b)=>{let c=tb(d,b.key)%s3;return a[c]=c in a?a[c].concat([b]):[b],a},[]),n=0;for(let o of m){let p=await c(o,d+1);await q(p,n),n++}return{Data:g,Links:h}}async function q(b,c){let d=bQ(b),e=await dA.sha256.digest(d),f=bm.CID.createV0(e);await a.put(f,d);let g=b.Links.reduce((a,b)=>a+(b.Tsize||0),0)+d.length;h[c]={Name:"",Tsize:g,Hash:f}}}}async function tf(a,b,c){let d=await te(a,c.map(a=>({key:a}))),e=bQ(d),f=await dA.sha256.digest(e),g=bm.CID.createV0(f);await a.put(g,e);let h=d.Links.reduce((a,b)=>a+b.Tsize,0)+e.length;return{Name:b,Tsize:h,Hash:g}}async function tg(a,b,c,d){if(!await b.has(s2))return;let e=await b.get(s2),f=bm.CID.decode(e),g=await a.get(f),h=bR(g),i=0,j=await sS(td(a,h,s6.recursive))+await sS(td(a,h,s6.direct));for await(let k of td(a,h,s6.recursive)){i++;let l={depth:1/0};0!==k.version&&(l.version=k.version),k.code!==bP&&(l.codec=k.code),await c.put(s7(k),bS.cv(l)),d(i/j*100,`Migrated recursive pin ${k}`)}for await(let m of td(a,h,s6.direct)){i++;let n={depth:0};0!==m.version&&(n.version=m.version),m.code!==bP&&(n.codec=m.code),await c.put(s7(m),bS.cv(n)),d(i/j*100,`Migrated direct pin ${m}`)}await a.delete(f),await b.delete(s2)}async function th(a,b,c,d){let e=[],f=[],g=0,h=await sS(c.queryKeys({}));for await(let{key:i,value:j}of c.query({})){g++;let k=bS.Jx(j),l=bm.CID.create(k.version||0,k.codec||bP,dy.decode(a4.base32.decode("b"+i.toString().toLowerCase().split("/").pop())));0===k.depth?(d(g/h*100,`Reverted direct pin ${l}`),f.push(l)):(d(g/h*100,`Reverted recursive pin ${l}`),e.push(l))}d(100,"Updating pin root");let m={Links:[await tf(a,s6.direct,f),await tf(a,s6.recursive,e)]},n=bQ(m),o=await dA.sha256.digest(n),p=bm.CID.createV0(o);await a.put(p,n),await b.put(s2,p.bytes)}async function ti(a,b,c){let d=a.blocks,e=a.datastore,f=a.pins;await d.open(),await e.open(),await f.open();try{await c(d,e,f,b)}finally{await f.close(),await e.close(),await d.close()}}let tj={version:9,description:"Migrates pins to datastore",migrate:(a,b=()=>{})=>ti(a,b,tg),revert:(a,b=()=>{})=>ti(a,b,th)},tk=new cI("/config"),tl=new cI("/version");function tm(a){let b=a;for(;b.db||b.child;)if("level-js"===(b=b.db||b.child).type||"Level"===b.constructor.name)return b}async function tn(a,b,c){let d=await b(a);if(d)return d;let e=tm(c);return!!e&&new Promise((b,c)=>{let d=e.store("readonly").get(a.toString());d.transaction.onabort=()=>{c(d.transaction.error)},d.transaction.oncomplete=()=>{b(Boolean(d.result))}})}async function to(a,b,c,d){if(await c(a))return b(a);let e=tm(d);if(!e)throw d5();return new Promise((b,c)=>{let d=e.store("readonly").get(a.toString());d.transaction.onabort=()=>{c(d.transaction.error)},d.transaction.oncomplete=()=>{if(d.result)return b(d.result);c(d5())}})}function tp(a){let b=a.get.bind(a),c=a.has.bind(a);return a.get=d=>to(d,b,c,a),a.has=b=>tn(b,c,a),a}function tq(a){return{...a,root:tp(a.root),datastore:tp(a.datastore),pins:tp(a.pins),keys:tp(a.keys)}}async function tr(a,b,c=()=>{}){let d=tm(b);if(!d){c(`${a} did not need an upgrade`);return}c(`Upgrading ${a}`);let e=(a,b)=>[{type:"del",key:a},{type:"put",key:(0,cB.fromString)(a),value:b}];await tw(d,e)}async function ts(a,b,c=()=>{}){let d=tm(b);if(!d){c(`${a} did not need a downgrade`);return}c(`Downgrading ${a}`);let e=(a,b)=>[{type:"del",key:a},{type:"put",key:(0,cE.toString)(a),value:b}];await tw(d,e)}function tt(a){return a.child?tt(a.child):a}async function tu(a,b,c){let d=Object.entries(a).map(([a,b])=>({key:a,backend:tt(b)})).filter(({key:a,backend:b})=>"LevelDatastore"===b.constructor.name).map(({key:a,backend:b})=>({name:a,store:b}));b(0,`Migrating ${d.length} dbs`);let e=0,f=a=>{b(Math.round(e/d.length*100),a)};for(let{name:g,store:h}of d){await h.open();try{await c(g,h,f)}finally{e++,await h.close()}}b(100,`Migrated ${d.length} dbs`)}let tv={version:10,description:"Migrates datastore-level keys to binary",migrate:(a,b=()=>{})=>tu(a,b,tr),revert:(a,b=()=>{})=>tu(a,b,ts)};function tw(a,b){function c(b,c){let d=a.store("readwrite"),e=d.transaction,f=0,g;function h(){let a=b[f++],c=a.key,i;try{i="del"===a.type?d.delete(c):d.put(a.value,c)}catch(j){g=j,e.abort();return}f<b.length&&(i.onsuccess=h)}e.onabort=()=>c(g||e.error||Error("aborted by user")),e.oncomplete=()=>c(),h()}return new Promise((d,e)=>{let f=a.iterator(),g=a=>a;function h(){let a=(a,g,i)=>{if(a|| void 0===g){let j=a=>{if(a){e(a);return}d()};f.end(j);return}c(b(g,i),h)};f.next(a)}f._deserializeKey=f._deserializeValue=g,h()})}let tx=new cI("/local/filesroot");async function ty(a,b=()=>{}){if(b(100,"Migrating MFS root to repo datastore"),await a.root.open(),await a.datastore.open(),await a.root.has(tx)){let c=await a.root.get(tx);await a.datastore.put(tx,c),await a.root.delete(tx)}await a.datastore.close(),await a.root.close(),b(100,"Stored MFS root in repo datastore")}async function tz(a,b=()=>{}){if(b(100,"Migrating MFS root to repo root datastore"),await a.root.open(),await a.datastore.open(),await a.datastore.has(tx)){let c=await a.datastore.get(tx);await a.root.put(tx,c),await a.datastore.delete(tx)}await a.datastore.close(),await a.root.close(),b(100,"Stored MFS root in repo root datastore")}let tA={version:11,description:"Store mfs root in the datastore",migrate:ty,revert:tz},tB=a8.Reader,tC=a8.Writer,tD=a8.util,tE=a8.roots.default||(a8.roots.default={}),tF=tE.Protocols=(()=>{function a(a){if(this.protocols=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.protocols=tD.emptyArray,a.encode=function(a,b){if(b||(b=tC.create()),null!=a.protocols&&a.protocols.length)for(var c=0;c<a.protocols.length;++c)b.uint32(10).string(a.protocols[c]);return b},a.decode=function(a,b){a instanceof tB||(a=tB.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tE.Protocols;a.pos<c;){var e=a.uint32();e>>>3==1?(d.protocols&&d.protocols.length||(d.protocols=[]),d.protocols.push(a.string())):a.skipType(7&e)}return d},a.fromObject=function(a){if(a instanceof tE.Protocols)return a;var b=new tE.Protocols;if(a.protocols){if(!Array.isArray(a.protocols))throw TypeError(".Protocols.protocols: array expected");b.protocols=[];for(var c=0;c<a.protocols.length;++c)b.protocols[c]=String(a.protocols[c])}return b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.protocols=[]),a.protocols&&a.protocols.length){c.protocols=[];for(var d=0;d<a.protocols.length;++d)c.protocols[d]=a.protocols[d]}return c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})(),tG=a8.Reader,tH=a8.Writer,tI=a8.util,tJ=a8.roots.default||(a8.roots.default={}),tK=tJ.Addresses=(()=>{function a(a){if(this.addrs=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.addrs=tI.emptyArray,a.prototype.certifiedRecord=null,a.encode=function(a,b){if(b||(b=tH.create()),null!=a.addrs&&a.addrs.length)for(var c=0;c<a.addrs.length;++c)tJ.Addresses.Address.encode(a.addrs[c],b.uint32(10).fork()).ldelim();return null!=a.certifiedRecord&&Object.hasOwnProperty.call(a,"certifiedRecord")&&tJ.Addresses.CertifiedRecord.encode(a.certifiedRecord,b.uint32(18).fork()).ldelim(),b},a.decode=function(a,b){a instanceof tG||(a=tG.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tJ.Addresses;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.addrs&&d.addrs.length||(d.addrs=[]),d.addrs.push(tJ.Addresses.Address.decode(a,a.uint32()));break;case 2:d.certifiedRecord=tJ.Addresses.CertifiedRecord.decode(a,a.uint32());break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tJ.Addresses)return a;var b=new tJ.Addresses;if(a.addrs){if(!Array.isArray(a.addrs))throw TypeError(".Addresses.addrs: array expected");b.addrs=[];for(var c=0;c<a.addrs.length;++c){if("object"!=typeof a.addrs[c])throw TypeError(".Addresses.addrs: object expected");b.addrs[c]=tJ.Addresses.Address.fromObject(a.addrs[c])}}if(null!=a.certifiedRecord){if("object"!=typeof a.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");b.certifiedRecord=tJ.Addresses.CertifiedRecord.fromObject(a.certifiedRecord)}return b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.addrs=[]),b.defaults&&(c.certifiedRecord=null),a.addrs&&a.addrs.length){c.addrs=[];for(var d=0;d<a.addrs.length;++d)c.addrs[d]=tJ.Addresses.Address.toObject(a.addrs[d],b)}return null!=a.certifiedRecord&&a.hasOwnProperty("certifiedRecord")&&(c.certifiedRecord=tJ.Addresses.CertifiedRecord.toObject(a.certifiedRecord,b)),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a.Address=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}a.prototype.multiaddr=tI.newBuffer([]),a.prototype.isCertified=null;let b;return Object.defineProperty(a.prototype,"_isCertified",{get:tI.oneOfGetter(b=["isCertified"]),set:tI.oneOfSetter(b)}),a.encode=function(a,b){return b||(b=tH.create()),null!=a.multiaddr&&Object.hasOwnProperty.call(a,"multiaddr")&&b.uint32(10).bytes(a.multiaddr),null!=a.isCertified&&Object.hasOwnProperty.call(a,"isCertified")&&b.uint32(16).bool(a.isCertified),b},a.decode=function(a,b){a instanceof tG||(a=tG.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tJ.Addresses.Address;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.multiaddr=a.bytes();break;case 2:d.isCertified=a.bool();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tJ.Addresses.Address)return a;var b=new tJ.Addresses.Address;return null!=a.multiaddr&&("string"==typeof a.multiaddr?tI.base64.decode(a.multiaddr,b.multiaddr=tI.newBuffer(tI.base64.length(a.multiaddr)),0):a.multiaddr.length&&(b.multiaddr=a.multiaddr)),null!=a.isCertified&&(b.isCertified=Boolean(a.isCertified)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.multiaddr="":(c.multiaddr=[],b.bytes!==Array&&(c.multiaddr=tI.newBuffer(c.multiaddr)))),null!=a.multiaddr&&a.hasOwnProperty("multiaddr")&&(c.multiaddr=b.bytes===String?tI.base64.encode(a.multiaddr,0,a.multiaddr.length):b.bytes===Array?Array.prototype.slice.call(a.multiaddr):a.multiaddr),null!=a.isCertified&&a.hasOwnProperty("isCertified")&&(c.isCertified=a.isCertified,b.oneofs&&(c._isCertified="isCertified")),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a.CertifiedRecord=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.seq=tI.Long?tI.Long.fromBits(0,0,!0):0,a.prototype.raw=tI.newBuffer([]),a.encode=function(a,b){return b||(b=tH.create()),null!=a.seq&&Object.hasOwnProperty.call(a,"seq")&&b.uint32(8).uint64(a.seq),null!=a.raw&&Object.hasOwnProperty.call(a,"raw")&&b.uint32(18).bytes(a.raw),b},a.decode=function(a,b){a instanceof tG||(a=tG.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tJ.Addresses.CertifiedRecord;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.seq=a.uint64();break;case 2:d.raw=a.bytes();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tJ.Addresses.CertifiedRecord)return a;var b=new tJ.Addresses.CertifiedRecord;return null!=a.seq&&(tI.Long?(b.seq=tI.Long.fromValue(a.seq)).unsigned=!0:"string"==typeof a.seq?b.seq=parseInt(a.seq,10):"number"==typeof a.seq?b.seq=a.seq:"object"==typeof a.seq&&(b.seq=new tI.LongBits(a.seq.low>>>0,a.seq.high>>>0).toNumber(!0))),null!=a.raw&&("string"==typeof a.raw?tI.base64.decode(a.raw,b.raw=tI.newBuffer(tI.base64.length(a.raw)),0):a.raw.length&&(b.raw=a.raw)),b},a.toObject=function(a,b){b||(b={});var c={};if(b.defaults){if(tI.Long){var d=new tI.Long(0,0,!0);c.seq=b.longs===String?d.toString():b.longs===Number?d.toNumber():d}else c.seq=b.longs===String?"0":0;b.bytes===String?c.raw="":(c.raw=[],b.bytes!==Array&&(c.raw=tI.newBuffer(c.raw)))}return null!=a.seq&&a.hasOwnProperty("seq")&&("number"==typeof a.seq?c.seq=b.longs===String?String(a.seq):a.seq:c.seq=b.longs===String?tI.Long.prototype.toString.call(a.seq):b.longs===Number?new tI.LongBits(a.seq.low>>>0,a.seq.high>>>0).toNumber(!0):a.seq),null!=a.raw&&a.hasOwnProperty("raw")&&(c.raw=b.bytes===String?tI.base64.encode(a.raw,0,a.raw.length):b.bytes===Array?Array.prototype.slice.call(a.raw):a.raw),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a})(),tL=a8.Reader,tM=a8.Writer,tN=a8.util,tO=a8.roots.default||(a8.roots.default={}),tP=tO.Peer=(()=>{function a(a){if(this.addresses=[],this.protocols=[],this.metadata=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}a.prototype.addresses=tN.emptyArray,a.prototype.protocols=tN.emptyArray,a.prototype.metadata=tN.emptyArray,a.prototype.pubKey=null,a.prototype.peerRecordEnvelope=null;let b;return Object.defineProperty(a.prototype,"_pubKey",{get:tN.oneOfGetter(b=["pubKey"]),set:tN.oneOfSetter(b)}),Object.defineProperty(a.prototype,"_peerRecordEnvelope",{get:tN.oneOfGetter(b=["peerRecordEnvelope"]),set:tN.oneOfSetter(b)}),a.encode=function(a,b){if(b||(b=tM.create()),null!=a.addresses&&a.addresses.length)for(var c=0;c<a.addresses.length;++c)tO.Address.encode(a.addresses[c],b.uint32(10).fork()).ldelim();if(null!=a.protocols&&a.protocols.length)for(var c=0;c<a.protocols.length;++c)b.uint32(18).string(a.protocols[c]);if(null!=a.metadata&&a.metadata.length)for(var c=0;c<a.metadata.length;++c)tO.Metadata.encode(a.metadata[c],b.uint32(26).fork()).ldelim();return null!=a.pubKey&&Object.hasOwnProperty.call(a,"pubKey")&&b.uint32(34).bytes(a.pubKey),null!=a.peerRecordEnvelope&&Object.hasOwnProperty.call(a,"peerRecordEnvelope")&&b.uint32(42).bytes(a.peerRecordEnvelope),b},a.decode=function(a,b){a instanceof tL||(a=tL.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tO.Peer;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.addresses&&d.addresses.length||(d.addresses=[]),d.addresses.push(tO.Address.decode(a,a.uint32()));break;case 2:d.protocols&&d.protocols.length||(d.protocols=[]),d.protocols.push(a.string());break;case 3:d.metadata&&d.metadata.length||(d.metadata=[]),d.metadata.push(tO.Metadata.decode(a,a.uint32()));break;case 4:d.pubKey=a.bytes();break;case 5:d.peerRecordEnvelope=a.bytes();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tO.Peer)return a;var b=new tO.Peer;if(a.addresses){if(!Array.isArray(a.addresses))throw TypeError(".Peer.addresses: array expected");b.addresses=[];for(var c=0;c<a.addresses.length;++c){if("object"!=typeof a.addresses[c])throw TypeError(".Peer.addresses: object expected");b.addresses[c]=tO.Address.fromObject(a.addresses[c])}}if(a.protocols){if(!Array.isArray(a.protocols))throw TypeError(".Peer.protocols: array expected");b.protocols=[];for(var c=0;c<a.protocols.length;++c)b.protocols[c]=String(a.protocols[c])}if(a.metadata){if(!Array.isArray(a.metadata))throw TypeError(".Peer.metadata: array expected");b.metadata=[];for(var c=0;c<a.metadata.length;++c){if("object"!=typeof a.metadata[c])throw TypeError(".Peer.metadata: object expected");b.metadata[c]=tO.Metadata.fromObject(a.metadata[c])}}return null!=a.pubKey&&("string"==typeof a.pubKey?tN.base64.decode(a.pubKey,b.pubKey=tN.newBuffer(tN.base64.length(a.pubKey)),0):a.pubKey.length&&(b.pubKey=a.pubKey)),null!=a.peerRecordEnvelope&&("string"==typeof a.peerRecordEnvelope?tN.base64.decode(a.peerRecordEnvelope,b.peerRecordEnvelope=tN.newBuffer(tN.base64.length(a.peerRecordEnvelope)),0):a.peerRecordEnvelope.length&&(b.peerRecordEnvelope=a.peerRecordEnvelope)),b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.addresses=[],c.protocols=[],c.metadata=[]),a.addresses&&a.addresses.length){c.addresses=[];for(var d=0;d<a.addresses.length;++d)c.addresses[d]=tO.Address.toObject(a.addresses[d],b)}if(a.protocols&&a.protocols.length){c.protocols=[];for(var d=0;d<a.protocols.length;++d)c.protocols[d]=a.protocols[d]}if(a.metadata&&a.metadata.length){c.metadata=[];for(var d=0;d<a.metadata.length;++d)c.metadata[d]=tO.Metadata.toObject(a.metadata[d],b)}return null!=a.pubKey&&a.hasOwnProperty("pubKey")&&(c.pubKey=b.bytes===String?tN.base64.encode(a.pubKey,0,a.pubKey.length):b.bytes===Array?Array.prototype.slice.call(a.pubKey):a.pubKey,b.oneofs&&(c._pubKey="pubKey")),null!=a.peerRecordEnvelope&&a.hasOwnProperty("peerRecordEnvelope")&&(c.peerRecordEnvelope=b.bytes===String?tN.base64.encode(a.peerRecordEnvelope,0,a.peerRecordEnvelope.length):b.bytes===Array?Array.prototype.slice.call(a.peerRecordEnvelope):a.peerRecordEnvelope,b.oneofs&&(c._peerRecordEnvelope="peerRecordEnvelope")),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})();tO.Address=(()=>{function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}a.prototype.multiaddr=tN.newBuffer([]),a.prototype.isCertified=null;let b;return Object.defineProperty(a.prototype,"_isCertified",{get:tN.oneOfGetter(b=["isCertified"]),set:tN.oneOfSetter(b)}),a.encode=function(a,b){return b||(b=tM.create()),null!=a.multiaddr&&Object.hasOwnProperty.call(a,"multiaddr")&&b.uint32(10).bytes(a.multiaddr),null!=a.isCertified&&Object.hasOwnProperty.call(a,"isCertified")&&b.uint32(16).bool(a.isCertified),b},a.decode=function(a,b){a instanceof tL||(a=tL.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tO.Address;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.multiaddr=a.bytes();break;case 2:d.isCertified=a.bool();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tO.Address)return a;var b=new tO.Address;return null!=a.multiaddr&&("string"==typeof a.multiaddr?tN.base64.decode(a.multiaddr,b.multiaddr=tN.newBuffer(tN.base64.length(a.multiaddr)),0):a.multiaddr.length&&(b.multiaddr=a.multiaddr)),null!=a.isCertified&&(b.isCertified=Boolean(a.isCertified)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.multiaddr="":(c.multiaddr=[],b.bytes!==Array&&(c.multiaddr=tN.newBuffer(c.multiaddr)))),null!=a.multiaddr&&a.hasOwnProperty("multiaddr")&&(c.multiaddr=b.bytes===String?tN.base64.encode(a.multiaddr,0,a.multiaddr.length):b.bytes===Array?Array.prototype.slice.call(a.multiaddr):a.multiaddr),null!=a.isCertified&&a.hasOwnProperty("isCertified")&&(c.isCertified=a.isCertified,b.oneofs&&(c._isCertified="isCertified")),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})(),tO.Metadata=(()=>{function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.key="",a.prototype.value=tN.newBuffer([]),a.encode=function(a,b){return b||(b=tM.create()),null!=a.key&&Object.hasOwnProperty.call(a,"key")&&b.uint32(10).string(a.key),null!=a.value&&Object.hasOwnProperty.call(a,"value")&&b.uint32(18).bytes(a.value),b},a.decode=function(a,b){a instanceof tL||(a=tL.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tO.Metadata;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.key=a.string();break;case 2:d.value=a.bytes();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tO.Metadata)return a;var b=new tO.Metadata;return null!=a.key&&(b.key=String(a.key)),null!=a.value&&("string"==typeof a.value?tN.base64.decode(a.value,b.value=tN.newBuffer(tN.base64.length(a.value)),0):a.value.length&&(b.value=a.value)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(c.key="",b.bytes===String?c.value="":(c.value=[],b.bytes!==Array&&(c.value=tN.newBuffer(c.value)))),null!=a.key&&a.hasOwnProperty("key")&&(c.key=a.key),null!=a.value&&a.hasOwnProperty("value")&&(c.value=b.bytes===String?tN.base64.encode(a.value,0,a.value.length):b.bytes===Array?Array.prototype.slice.call(a.value):a.value),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})();let tQ=a8.Reader,tR=a8.Writer,tS=a8.util,tT=a8.roots.default||(a8.roots.default={}),tU=tT.Envelope=(()=>{function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.publicKey=tS.newBuffer([]),a.prototype.payloadType=tS.newBuffer([]),a.prototype.payload=tS.newBuffer([]),a.prototype.signature=tS.newBuffer([]),a.encode=function(a,b){return b||(b=tR.create()),null!=a.publicKey&&Object.hasOwnProperty.call(a,"publicKey")&&b.uint32(10).bytes(a.publicKey),null!=a.payloadType&&Object.hasOwnProperty.call(a,"payloadType")&&b.uint32(18).bytes(a.payloadType),null!=a.payload&&Object.hasOwnProperty.call(a,"payload")&&b.uint32(26).bytes(a.payload),null!=a.signature&&Object.hasOwnProperty.call(a,"signature")&&b.uint32(42).bytes(a.signature),b},a.decode=function(a,b){a instanceof tQ||(a=tQ.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tT.Envelope;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.publicKey=a.bytes();break;case 2:d.payloadType=a.bytes();break;case 3:d.payload=a.bytes();break;case 5:d.signature=a.bytes();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tT.Envelope)return a;var b=new tT.Envelope;return null!=a.publicKey&&("string"==typeof a.publicKey?tS.base64.decode(a.publicKey,b.publicKey=tS.newBuffer(tS.base64.length(a.publicKey)),0):a.publicKey.length&&(b.publicKey=a.publicKey)),null!=a.payloadType&&("string"==typeof a.payloadType?tS.base64.decode(a.payloadType,b.payloadType=tS.newBuffer(tS.base64.length(a.payloadType)),0):a.payloadType.length&&(b.payloadType=a.payloadType)),null!=a.payload&&("string"==typeof a.payload?tS.base64.decode(a.payload,b.payload=tS.newBuffer(tS.base64.length(a.payload)),0):a.payload.length&&(b.payload=a.payload)),null!=a.signature&&("string"==typeof a.signature?tS.base64.decode(a.signature,b.signature=tS.newBuffer(tS.base64.length(a.signature)),0):a.signature.length&&(b.signature=a.signature)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.publicKey="":(c.publicKey=[],b.bytes!==Array&&(c.publicKey=tS.newBuffer(c.publicKey))),b.bytes===String?c.payloadType="":(c.payloadType=[],b.bytes!==Array&&(c.payloadType=tS.newBuffer(c.payloadType))),b.bytes===String?c.payload="":(c.payload=[],b.bytes!==Array&&(c.payload=tS.newBuffer(c.payload))),b.bytes===String?c.signature="":(c.signature=[],b.bytes!==Array&&(c.signature=tS.newBuffer(c.signature)))),null!=a.publicKey&&a.hasOwnProperty("publicKey")&&(c.publicKey=b.bytes===String?tS.base64.encode(a.publicKey,0,a.publicKey.length):b.bytes===Array?Array.prototype.slice.call(a.publicKey):a.publicKey),null!=a.payloadType&&a.hasOwnProperty("payloadType")&&(c.payloadType=b.bytes===String?tS.base64.encode(a.payloadType,0,a.payloadType.length):b.bytes===Array?Array.prototype.slice.call(a.payloadType):a.payloadType),null!=a.payload&&a.hasOwnProperty("payload")&&(c.payload=b.bytes===String?tS.base64.encode(a.payload,0,a.payload.length):b.bytes===Array?Array.prototype.slice.call(a.payload):a.payload),null!=a.signature&&a.hasOwnProperty("signature")&&(c.signature=b.bytes===String?tS.base64.encode(a.signature,0,a.signature.length):b.bytes===Array?Array.prototype.slice.call(a.signature):a.signature),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a})(),tV=a8.Reader,tW=a8.Writer,tX=a8.util,tY=a8.roots.default||(a8.roots.default={}),tZ=tY.PeerRecord=(()=>{function a(a){if(this.addresses=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.peerId=tX.newBuffer([]),a.prototype.seq=tX.Long?tX.Long.fromBits(0,0,!0):0,a.prototype.addresses=tX.emptyArray,a.encode=function(a,b){if(b||(b=tW.create()),null!=a.peerId&&Object.hasOwnProperty.call(a,"peerId")&&b.uint32(10).bytes(a.peerId),null!=a.seq&&Object.hasOwnProperty.call(a,"seq")&&b.uint32(16).uint64(a.seq),null!=a.addresses&&a.addresses.length)for(var c=0;c<a.addresses.length;++c)tY.PeerRecord.AddressInfo.encode(a.addresses[c],b.uint32(26).fork()).ldelim();return b},a.decode=function(a,b){a instanceof tV||(a=tV.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tY.PeerRecord;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.peerId=a.bytes();break;case 2:d.seq=a.uint64();break;case 3:d.addresses&&d.addresses.length||(d.addresses=[]),d.addresses.push(tY.PeerRecord.AddressInfo.decode(a,a.uint32()));break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof tY.PeerRecord)return a;var b=new tY.PeerRecord;if(null!=a.peerId&&("string"==typeof a.peerId?tX.base64.decode(a.peerId,b.peerId=tX.newBuffer(tX.base64.length(a.peerId)),0):a.peerId.length&&(b.peerId=a.peerId)),null!=a.seq&&(tX.Long?(b.seq=tX.Long.fromValue(a.seq)).unsigned=!0:"string"==typeof a.seq?b.seq=parseInt(a.seq,10):"number"==typeof a.seq?b.seq=a.seq:"object"==typeof a.seq&&(b.seq=new tX.LongBits(a.seq.low>>>0,a.seq.high>>>0).toNumber(!0))),a.addresses){if(!Array.isArray(a.addresses))throw TypeError(".PeerRecord.addresses: array expected");b.addresses=[];for(var c=0;c<a.addresses.length;++c){if("object"!=typeof a.addresses[c])throw TypeError(".PeerRecord.addresses: object expected");b.addresses[c]=tY.PeerRecord.AddressInfo.fromObject(a.addresses[c])}}return b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.addresses=[]),b.defaults){if(b.bytes===String?c.peerId="":(c.peerId=[],b.bytes!==Array&&(c.peerId=tX.newBuffer(c.peerId))),tX.Long){var d=new tX.Long(0,0,!0);c.seq=b.longs===String?d.toString():b.longs===Number?d.toNumber():d}else c.seq=b.longs===String?"0":0}if(null!=a.peerId&&a.hasOwnProperty("peerId")&&(c.peerId=b.bytes===String?tX.base64.encode(a.peerId,0,a.peerId.length):b.bytes===Array?Array.prototype.slice.call(a.peerId):a.peerId),null!=a.seq&&a.hasOwnProperty("seq")&&("number"==typeof a.seq?c.seq=b.longs===String?String(a.seq):a.seq:c.seq=b.longs===String?tX.Long.prototype.toString.call(a.seq):b.longs===Number?new tX.LongBits(a.seq.low>>>0,a.seq.high>>>0).toNumber(!0):a.seq),a.addresses&&a.addresses.length){c.addresses=[];for(var e=0;e<a.addresses.length;++e)c.addresses[e]=tY.PeerRecord.AddressInfo.toObject(a.addresses[e],b)}return c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a.AddressInfo=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.multiaddr=tX.newBuffer([]),a.encode=function(a,b){return b||(b=tW.create()),null!=a.multiaddr&&Object.hasOwnProperty.call(a,"multiaddr")&&b.uint32(10).bytes(a.multiaddr),b},a.decode=function(a,b){a instanceof tV||(a=tV.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new tY.PeerRecord.AddressInfo;a.pos<c;){var e=a.uint32();e>>>3==1?d.multiaddr=a.bytes():a.skipType(7&e)}return d},a.fromObject=function(a){if(a instanceof tY.PeerRecord.AddressInfo)return a;var b=new tY.PeerRecord.AddressInfo;return null!=a.multiaddr&&("string"==typeof a.multiaddr?tX.base64.decode(a.multiaddr,b.multiaddr=tX.newBuffer(tX.base64.length(a.multiaddr)),0):a.multiaddr.length&&(b.multiaddr=a.multiaddr)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.multiaddr="":(c.multiaddr=[],b.bytes!==Array&&(c.multiaddr=tX.newBuffer(c.multiaddr)))),null!=a.multiaddr&&a.hasOwnProperty("multiaddr")&&(c.multiaddr=b.bytes===String?tX.base64.encode(a.multiaddr,0,a.multiaddr.length):b.bytes===Array?Array.prototype.slice.call(a.multiaddr):a.multiaddr),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a})();var t$=c(46584);async function t_(a,b=()=>{}){b(0,"Storing each peerstore key under a single datastore key"),await a.datastore.open();let c={},d=[];for await(let{key:e,value:f}of a.datastore.query({prefix:"/peers"})){d.push(e);let g=e.toString(),[h,i,j,k,l]=g.split("/");if("peers"===i&&["protos","addrs","metadata","keys"].includes(j)&&k){if(c[k]=c[k]||{addresses:[],protocols:[],metadata:[]},"protos"===j){let m=tF.decode(f);c[k].protocols=m.protocols.sort()}else if("addrs"===j){let n=tK.decode(f);c[k].addresses=n.addrs.sort((a,b)=>new t$.Multiaddr(a.multiaddr).toString().localeCompare(new t$.Multiaddr(b.multiaddr).toString())),n.certifiedRecord&&n.certifiedRecord.raw&&(c[k].peerRecordEnvelope=n.certifiedRecord.raw)}else"metadata"===j?c[k].metadata.push({key:l,value:f}):"keys"===j&&(c[k].pubKey=f)}}for(let o of(b(33,"Read peer data from store"),d))await a.datastore.delete(o);for(let p of(b(66,"Removed existing peer data from store"),Object.keys(c))){let q=c[p];q.metadata=q.metadata.sort((a,b)=>a.key.localeCompare(b.key));let r=tP.encode(q).finish();await a.datastore.put(new cI(`/peers/${p}`),r)}await a.datastore.close(),b(100,"Stored each peerstore key under a single datastore key")}async function t0(a,b=()=>{}){b(0,"Storing each peerstore key under a multiple datastore keys"),await a.datastore.open();let c={},d=[];for await(let{key:e,value:f}of a.datastore.query({prefix:"/peers"})){d.push(e);let g=e.toString(),[h,i,j]=g.split("/");c[j]=tP.decode(f)}for(let k of(b(33,"Read peer data from store"),d))await a.datastore.delete(k);for(let[l,m]of(b(66,"Removed existing peer data from store"),Object.entries(c))){if(m.protocols&&m.protocols.length>0&&await a.datastore.put(new cI(`/peers/protos/${l}`),tF.encode({protocols:m.protocols}).finish()),m.addresses&&m.addresses.length>0){let n=m.peerRecordEnvelope,o;if(n){let p=tU.decode(n),q=tZ.decode(p.payload);o={raw:n,seq:q.seq}}await a.datastore.put(new cI(`/peers/addrs/${l}`),tK.encode({addrs:m.addresses,certifiedRecord:o}).finish())}if(m.metadata&&m.metadata.length>0)for(let{key:r,value:s}of m.metadata)await a.datastore.put(new cI(`/peers/metadata/${l}/${r}`),s);m.pubKey&&await a.datastore.put(new cI(`/peers/keys/${l}`),m.pubKey)}await a.datastore.close(),b(100,"Stored each peerstore key under multiple datastore keys")}a8.util.Long=void 0,a8.configure();let t1={version:12,description:"Store each peerstore peer under a single datastore key",migrate:t_,revert:t0},t2={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};var t3=[Object.assign({version:1},t2),Object.assign({version:2},t2),Object.assign({version:3},t2),Object.assign({version:4},t2),Object.assign({version:5},t2),Object.assign({version:6},t2),Object.assign({version:7},t2),sY,tj,tv,tA,t1];class t4 extends Error{constructor(a){super(a),this.name="NonReversibleMigrationError",this.code=t4.code,this.message=a}}t4.code="ERR_NON_REVERSIBLE_MIGRATION";class t5 extends Error{constructor(a){super(a),this.name="NotInitializedRepoError",this.code=t5.code,this.message=a}}t5.code="ERR_NOT_INITIALIZED_REPO";class t6 extends Error{constructor(a){super(a),this.name="RequiredParameterError",this.code=t6.code,this.message=a}}t6.code="ERR_REQUIRED_PARAMETER";class t7 extends Error{constructor(a){super(a),this.name="InvalidValueError",this.code=t7.code,this.message=a}}t7.code="ERR_INVALID_VALUE";class t8 extends Error{constructor(a){super(a),this.name="MissingRepoOptionsError",this.code=t8.code,this.message=a}}t8.code="ERR_MISSING_REPO_OPTIONS";let t9=a2("ipfs:repo:migrator:repo:init");async function ua(a){if(!a)throw new t8("Please pass repo options when trying to open a repo");let b=a.root;try{await b.open();let c=await b.has(tl),d=await b.has(tk);if(!c||!d)return t9(`Version entry present: ${c}`),t9(`Config entry present: ${d}`),!1;return!0}catch(e){return t9("While checking if repo is initialized error was thrown: "+e.message),!1}finally{if(void 0!==b)try{await b.close()}catch{}}}async function ub(a){if(!await ua(a))throw new t5("Repo is not initialized!");let b=a.root;await b.open();try{return parseInt((0,cE.toString)(await b.get(tl)))}finally{await b.close()}}async function uc(a,b){if(!b)throw new t8("Please pass repo options when trying to open a repo");let c=b.root;await c.open(),await c.put(tl,(0,cB.fromString)(String(a))),await c.close()}let ud=a2("ipfs:repo:migrator");function ue(a){return Array.isArray(a=a||t3)&&0!==a.length?a[a.length-1].version:0}async function uf(a,b,c,d,{ignoreLock:e=!1,onProgress:f,isDryRun:g=!1,migrations:h}){if(h=h||t3,!a)throw new ui.RequiredParameterError("Path argument is required!");if(!c)throw new ui.RequiredParameterError("repoOptions argument is required!");if(!d)throw new ui.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(d)||d<=0)throw new ui.InvalidValueError("Version has to be positive integer!");b=tq(b);let i=await ub(b);if(i===d){ud("Nothing to migrate.");return}if(i>d)throw new ui.InvalidValueError(`Current repo's version (${i}) is higher then toVersion (${d}), you probably wanted to revert it?`);uh(h,i,d);let j;g||e||(j=await c.repoLock.lock(a));try{for(let k of h){if(void 0!==d&&k.version>d)break;if(!(k.version<=i)){ud(`Migrating version ${k.version}`);try{if(!g){let l=()=>{};f&&(l=(a,b)=>f(k.version,a.toFixed(2),b)),await k.migrate(b,l)}}catch(m){let n=k.version-1;throw ud(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${n}`),await uc(n,b),Error(`During migration to version ${k.version} exception was raised: ${m.stack||m.message||m}`)}ud(`Migrating to version ${k.version} finished`)}}g||await uc(d||ue(h),b),ud("Repo successfully migrated",void 0!==d?`to version ${d}!`:"to latest version!")}finally{g||e||!j||await j.close()}}async function ug(a,b,c,d,{ignoreLock:e=!1,onProgress:f,isDryRun:g=!1,migrations:h}){if(h=h||t3,!a)throw new ui.RequiredParameterError("Path argument is required!");if(!c)throw new ui.RequiredParameterError("repoOptions argument is required!");if(!d)throw new ui.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(d)||d<=0)throw new ui.InvalidValueError("Version has to be positive integer!");b=tq(b);let i=await ub(b);if(i===d){ud("Nothing to revert.");return}if(i<d)throw new ui.InvalidValueError(`Current repo's version (${i}) is lower then toVersion (${d}), you probably wanted to migrate it?`);uh(h,d,i,!0);let j;g||e||(j=await c.repoLock.lock(a)),ud(`Reverting from version ${i} to ${d}`);try{let k=h.slice().reverse();for(let l of k){if(l.version<=d)break;if(!(l.version>i)){ud(`Reverting migration version ${l.version}`);try{if(!g){let m=()=>{};f&&(m=(a,b)=>f(l.version,a.toFixed(2),b)),await l.revert(b,m)}}catch(n){let o=l.version;throw ud(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${o}`),await uc(o,b),n.message=`During reversion to version ${l.version} exception was raised: ${n.message}`,n}ud(`Reverting to version ${l.version} finished`)}}g||await uc(d,b),ud(`All migrations successfully reverted to version ${d}!`)}finally{g||e||!j||await j.close()}}function uh(a,b,c,d=!1){let e=0;for(let f of a){if(f.version>c)break;if(f.version>b){if(d&&!f.revert)throw new ui.NonReversibleMigrationError(`It is not possible to revert to version ${b} because migration version ${f.version} is not reversible. Cancelling reversion.`);e++}}if(e!==c-b)throw new ui.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${b} to ${c}`)}let ui=aW;var uj=c(79830);class uk extends Error{constructor(a){super(a),this.name="LockExistsError",this.code=uk.code}}uk.code="ERR_LOCK_EXISTS";class ul extends Error{constructor(a){super(a),this.name="NotFoundError",this.code=ul.code}}ul.code="ERR_NOT_FOUND";class um extends Error{constructor(a){super(a),this.name="InvalidRepoVersionError",this.code=um.code}}um.code="ERR_INVALID_REPO_VERSION";let un="ERR_REPO_NOT_INITIALIZED",uo="ERR_REPO_ALREADY_OPEN",up="ERR_REPO_ALREADY_CLOSED";async function uq(a,b,c){let d=await b(a);if(d)return d;let e=us(c);return!!e&&new Promise((b,c)=>{let d=e.store("readonly").get(a.toString());d.transaction.onabort=()=>{c(d.transaction.error)},d.transaction.oncomplete=()=>{b(Boolean(d.result))}})}async function ur(a,b,c,d){if(await c(a))return b(a);let e=us(d);if(!e)throw new ul;return new Promise((b,c)=>{let d=e.store("readonly").get(a.toString());d.transaction.onabort=()=>{c(d.transaction.error)},d.transaction.oncomplete=()=>{if(d.result)return b(d.result);c(new ul)}})}function us(a){let b=a;for(;b.db||b.child;)if("level-js"===(b=b.db||b.child).type||"Level"===b.constructor.name)return b}let ut=a2("ipfs:repo:version"),uu=new cI("version");function uv(a){return{async exists(){return uq(uu,a.has.bind(a),a)},async get(){let b=await ur(uu,a.get.bind(a),a.has.bind(a),a);return parseInt((0,cE.toString)(b),10)},set(b){return a.put(uu,(0,cB.fromString)(String(b)))},async check(a){let b=await this.get();ut("comparing version: %s and %s",b,a);let c=6===b&&7===a||6===a&&7===b;return b===a||c}}}var uw=c(56827),ux=c(57027);let uy=uw.default?uw.default:uw,uz=new cI("config");function uA(a){let b=new uy({concurrency:1}),c={async getAll(b={}){let c=await ur(uz,a.get.bind(a),a.has.bind(a),a);return JSON.parse((0,cE.toString)(c))},async get(a,b={}){if(null==a)throw new ul(`Key ${a} does not exist in config`);let c=await this.getAll(b),d=sR(c,a);if(void 0===d)throw new ul(`Key ${a} does not exist in config`);return d},set(a,c,e={}){if("string"!=typeof a&&!(a instanceof String))throw a7(Error("Invalid key type: "+typeof a),"ERR_INVALID_KEY");if(void 0===c||c instanceof Uint8Array)throw a7(Error("Invalid value type: "+typeof c),"ERR_INVALID_VALUE");return b.add(()=>d({key:a,value:c},e.signal))},replace(a,c={}){if(!a||a instanceof Uint8Array)throw a7(Error("Invalid value type: "+typeof a),"ERR_INVALID_VALUE");return b.add(()=>d({key:void 0,value:a},c.signal))},async exists(){return uq(uz,a.has.bind(a),a)}};return c;async function d(a,b){if(b&&b.aborted)return;let d=a.key,f=a.value;if(d){let g=await c.getAll();return"object"==typeof g&&null!==g&&ux(g,d,f),e(g)}return e(f)}function e(b){let c=(0,cB.fromString)(JSON.stringify(b,null,2));return a.put(uz,c)}}var uB=c(33694);let uC=new cI("datastore_spec");function uD(a){return{exists(){return a.has(uC)},async get(){let b=await a.get(uC);return JSON.parse((0,cE.toString)(b))},async set(b){return a.put(uC,(0,cB.fromString)(JSON.stringify(uB(b,{deep:!0}))))}}}let uE=new cI("api");function uF(a){return{async get(){let b=await a.get(uE);return b&&b.toString()},set(b){return a.put(uE,(0,cB.fromString)(b.toString()))},delete(){return a.delete(uE)}}}var uG=c(40677);function uH(a){return{open(){return a.open()},close(){return a.close()},query(b,c){return a.query(b,c)},queryKeys(b,c){return a.queryKeys(b,c)},async get(b,c){let d=uI(b);return d.isIdentity?Promise.resolve(d.digest):a.get(b,c)},async *getMany(a,b){for await(let c of a)yield this.get(c,b)},async put(b,c,d){let{isIdentity:e}=uI(b);!e&&await a.put(b,c,d)},async *putMany(b,c){let d=uG(),e=globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout;e(async()=>{try{await jC(a.putMany(async function*(){for await(let{key:a,value:c}of b)uI(a).isIdentity||(yield{key:a,value:c}),d.push({key:a,value:c})}())),d.end()}catch(c){d.end(c)}}),yield*d},has(b,c){let{isIdentity:d}=uI(b);return d?Promise.resolve(!0):a.has(b,c)},delete(b,c){let{isIdentity:d}=uI(b);return d?Promise.resolve():a.delete(b,c)},deleteMany(b,c){return a.deleteMany(jD(b,a=>!uI(a).isIdentity),c)},batch(){let b=a.batch();return{put(a,c){let{isIdentity:d}=uI(a);!d&&b.put(a,c)},delete(a){let{isIdentity:c}=uI(a);!c&&b.delete(a)},commit:a=>b.commit(a)}}}}function uI(a){let b=bm.CID.asCID(a);if(null==b)throw a7(Error("Not a valid cid"),"ERR_INVALID_CID");return b.multihash.code!==cr.identity.code?{isIdentity:!1}:{isIdentity:!0,digest:b.multihash.digest}}let uJ=a2("ipfs:repo:lock:memory"),uK="repo.lock",uL={};async function uM(a){let b=a+"/"+uK;if(uJ("locking %s",b),!0===uL[b])throw new uk(`Lock already being held for file: ${b}`);uL[b]=!0;let c={async close(){uL[b]&&delete uL[b]}};return c}async function uN(a){let b=a+"/"+uK;return uJ(`checking lock: ${b}`),Boolean(uL[b])}let uO={lock:uM,locked:uN};var uP={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:uO},uQ={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function uR(a){let b=b2.k0.asCID(a);if(null==b)throw a7(Error("Not a valid cid"),"ERR_INVALID_CID");let c=a4.base32.encode(b.multihash.bytes);return new cI("/"+c.slice(1).toUpperCase(),!1)}function uS(a){return dy.decode(a4.base32.decode(`b${a.toString().toLowerCase().substring(1)}`))}let uT=a2("ipfs:repo:utils:walk-dag");async function*uU(a,b,c,d){try{let e=await b.get(a,d),f=await c(a.code),g=pk({bytes:e,cid:a,codec:f});for(let[,h]of g.links())yield h,yield*uU(h,b,c,d)}catch(i){throw uT("Could not walk DAG for CID",a.toString(),i),i}}function uV(a){let b=`Invalid type '${a}', must be one of {direct, indirect, recursive, all}`;return a7(Error(b),"ERR_INVALID_PIN_TYPE")}class uW{constructor({pinstore:a,blockstore:b,loadCodec:c}){this.pinstore=a,this.blockstore=b,this.loadCodec=c,this.log=a2("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(a,b={}){await this.blockstore.get(a,b);let c={depth:0};return 0!==a.version&&(c.version=a.version),a.code!==bP&&(c.codec=a.code),b.metadata&&(c.metadata=b.metadata),this.pinstore.put(uR(a),bS.cv(c))}unpin(a,b){return this.pinstore.delete(uR(a),b)}async pinRecursively(a,b={}){await this.fetchCompleteDag(a,b);let c={depth:1/0};0!==a.version&&(c.version=a.version),a.code!==bP&&(c.codec=a.code),b.metadata&&(c.metadata=b.metadata),await this.pinstore.put(uR(a),bS.cv(c))}async *directKeys(a){for await(let b of this.pinstore.query({filters:[a=>{let b=bS.Jx(a.value);return 0===b.depth}]})){let c=bS.Jx(b.value),d=c.version||0,e=null!=c.codec?c.codec:bP,f=uS(b.key);yield{cid:bm.CID.create(d,e,f),metadata:c.metadata}}}async *recursiveKeys(a){for await(let b of this.pinstore.query({filters:[a=>{let b=bS.Jx(a.value);return b.depth===1/0}]})){let c=bS.Jx(b.value),d=c.version||0,e=null!=c.codec?c.codec:bP,f=uS(b.key);yield{cid:bm.CID.create(d,e,f),metadata:c.metadata}}}async *indirectKeys(a){for await(let{cid:b}of this.recursiveKeys())for await(let c of uU(b,this.blockstore,this.loadCodec,a)){let d=[dV.recursive],e=await this.isPinnedWithType(c,d);!e.pinned&&(yield c)}}async isPinnedWithType(a,b,c){Array.isArray(b)||(b=[b]);let d=b.includes(dV.all),e=b.includes(dV.direct),f=b.includes(dV.recursive),g=b.includes(dV.indirect);if(f||e||d){let h=await pR(this.pinstore.query({prefix:uR(a).toString(),filters:[a=>{if(d)return!0;let c=bS.Jx(a.value);return b.includes(0===c.depth?dV.direct:dV.recursive)}],limit:1}));if(h){let i=bS.Jx(h.value);return{cid:a,pinned:!0,reason:0===i.depth?dV.direct:dV.recursive,metadata:i.metadata}}}let j=this;async function*k(a,b){for await(let{cid:c}of b)for await(let d of uU(c,j.blockstore,j.loadCodec))if(d.equals(a)){yield c;return}}if(d||g){let l=await pR(k(a,this.recursiveKeys()));if(l)return{cid:a,pinned:!0,reason:dV.indirect,parent:l}}return{cid:a,pinned:!1}}async fetchCompleteDag(a,b){let c=new Set,d=async(a,b)=>{if(c.has(a.toString()))return;c.add(a.toString());let e=await this.blockstore.get(a,b),f=await this.loadCodec(a.code),g=pk({bytes:e,cid:a,codec:f});await Promise.all([...g.links()].map(([,a])=>d(a,b)))};await d(a,b)}static checkPinType(a){if("string"!=typeof a||!Object.keys(dV).includes(a))throw uV(a);return!0}}function uX(a,b){return{open(){return b.open()},close(){return b.close()},query(a,c){return b.query(a,c)},queryKeys(a,c){return b.queryKeys(a,c)},async get(a,c){return b.get(a,c)},async *getMany(a,c){yield*b.getMany(a,c)},async put(a,c,d){await b.put(a,c,d)},async *putMany(a,c){yield*b.putMany(a,c)},has(a,c){return b.has(a,c)},async delete(c,d){return await uY(c,a),b.delete(c,d)},deleteMany(c,d){return b.deleteMany(jS(c,async b=>(await uY(b,a),b)),d)},batch(){return b.batch()}}}async function uY(a,b){let{pinned:c,reason:d}=await b.isPinnedWithType(a,dV.all);if(c)throw a7(Error(`pinned: ${d}`),"ERR_BLOCK_PINNED")}var uZ=c(59526),u$=c(25457);let u_=a2("ipfs:repo:gc"),u0=d5().code,u1=256,u2=new cI("/local/filesroot");function u3({gcLock:a,pins:b,blockstore:c,root:d,loadCodec:e}){async function*f(){let f=Date.now();u_("Creating set of marked blocks");let g=await a.writeLock();try{let h=await u4({pins:b,blockstore:c,root:d,loadCodec:e}),i=c.queryKeys({});yield*u5({blockstore:c},h,i),u_(`Complete (${Date.now()-f}ms)`)}finally{g()}}return f}async function u4({pins:a,blockstore:b,loadCodec:c,root:d}){let e=async function*(){let a;try{a=await d.get(u2)}catch(e){if(e.code===u0){u_("No blocks in MFS");return}throw e}let f=bm.CID.decode(a);yield f,yield*uU(f,b,c)}(),f=jW(jS(a.recursiveKeys(),({cid:a})=>a),a.indirectKeys(),jS(a.directKeys(),({cid:a})=>a),e),g=new Set;for await(let h of jW(f,e))g.add(a4.base32.encode(h.multihash.bytes));return g}async function*u5({blockstore:a},b,c){let d=0,e=0,f=async c=>async function(){d++;try{let f=a4.base32.encode(c.multihash.bytes);if(b.has(f))return null;try{await a.delete(c),e++}catch(g){return{err:Error(`Could not delete block with CID ${c}: ${g.message}`)}}return{cid:c}}catch(h){let i=`Could delete block with CID ${c}`;return u_(i,h),{err:Error(i+`: ${h.message}`)}}};yield*(0,u$.pipe)(mE(jS(c,f),u1),a=>jD(a,Boolean)),u_(`Marked set has ${b.size} unique blocks. Blockstore has ${d} blocks. Deleted ${e} blocks.`)}let u6=a2("ipfs:repo"),u7=Number.MAX_SAFE_INTEGER,u8="repoAutoMigrate";class u9{constructor(a,b,c,d){if("string"!=typeof a)throw Error("missing repo path");if("function"!=typeof b)throw Error("missing codec loader");this.options=a0(uP,d),this.closed=!0,this.path=a,this.root=c.root,this.datastore=c.datastore,this.keys=c.keys;let e=c.blocks,f=c.pins;this.pins=new uW({pinstore:f,blockstore:e,loadCodec:b});let g=uX(this.pins,e);this.blocks=uH(g),this.version=uv(this.root),this.config=uA(this.root),this.spec=uD(this.root),this.apiAddr=uF(this.root),this.gcLock=uZ(a,{singleProcess:!1!==this.options.repoOwner}),this.gc=u3({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:b})}async init(a){u6("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(vc(a)),await this.spec.set(vd(a)),await this.version.set(sL)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(a){return!1}}async open(){if(!this.closed)throw a7(Error("repo is already open"),uo);u6("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),u6("acquired repo.lock");let a=await this.version.check(sL);if(!a){if(await this._isAutoMigrationEnabled())await this._migrate(sL,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new um("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.")}u6("creating datastore"),await this.datastore.open(),u6("creating blocks"),await this.blocks.open(),u6("creating keystore"),await this.keys.open(),u6("creating pins"),await this.pins.pinstore.open(),this.closed=!1,u6("all opened")}catch(b){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(c){u6("error removing lock",c)}throw b}}async _openRoot(){try{await this.root.open()}catch(a){if("Already open"!==a.message)throw a}}async _openLock(){let a=await this.options.repoLock.lock(this.path);if("function"!=typeof a.close)throw a7(Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return a}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){u6("init check");let a;try{[a]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(b){if("ERR_NOT_FOUND"===b.code)throw a7(Error("repo is not initialized yet"),un,{path:this.path});throw b}if(!a)throw a7(Error("repo is not initialized yet"),un,{path:this.path})}async close(){if(this.closed)throw a7(Error("repo is already closed"),up);u6("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(a){if(a.code!==un&&!a.message.startsWith("ENOENT"))throw a}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(a=>a&&a.close())),u6("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[a,b,c,d,e]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),va(this.datastore),va(this.keys)]),f=b.size+d+e;return{repoPath:this.path,storageMax:a,version:c,numObjects:b.count,repoSize:f}}throw a7(Error("repo is not initialized yet"),un,{path:this.path})}async _isAutoMigrationEnabled(){if(void 0!==this.options.autoMigrate)return this.options.autoMigrate;let a;try{a=await this.config.get(u8)}catch(b){if(b.code===ul.code)a=!0;else throw b}return a}async _migrate(a,b){let c=await this.version.get();return c>a?(u6(`reverting to version ${a}`),ug(this.path,b,this.options,a,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(u6(`migrating to version ${a}`),uf(this.path,b,this.options,a,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let a=await this.config.get("Datastore.StorageMax");return BigInt(uj(a))}catch(b){return BigInt(u7)}}async _blockStat(){let a=BigInt(0),b=BigInt(0);if(this.blocks)for await(let{key:c,value:d}of this.blocks.query({}))a+=BigInt(1),b+=BigInt(d.byteLength),b+=BigInt(c.bytes.byteLength);return{count:a,size:b}}}async function va(a){let b=BigInt(0);for await(let c of a.query({}))b+=BigInt(c.value.byteLength),b+=BigInt(c.key.uint8Array().byteLength);return b}function vb(a,b,c,d){return new u9(a,b,c,d)}function vc(a){return a.Datastore=Object.assign({},uQ,sR(a,"datastore")),a}function vd(a){let b={...uQ.Spec,...sR(a,"Datastore.Spec")};return{type:b.type,mounts:b.mounts.map(a=>({mountpoint:a.mountpoint,type:a.child.type,path:a.child.path,shardFunc:a.child.shardFunc}))}}var ve=c(97515),vf=c(63145);class vg extends jF{constructor(a,b){super(),this.path=a,this.opts=b,b&&b.db?(this.database=b.db,delete b.db):this.database=vf}_initDb(){return new Promise((a,b)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},c=>{if(c)return b(c);a(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(a){throw d2(a)}}async put(a,b){try{await this.db.put(a.toString(),b)}catch(c){throw d4(c)}}async get(a){let b;try{b=await this.db.get(a.toString())}catch(c){if(c.notFound)throw d5(c);throw d4(c)}return b}async has(a){try{await this.db.get(a.toString())}catch(b){if(b.notFound)return!1;throw b}return!0}async delete(a){try{await this.db.del(a.toString())}catch(b){throw d3(b)}}close(){return this.db&&this.db.close()}batch(){let a=[];return{put:(b,c)=>{a.push({type:"put",key:b.toString(),value:c})},delete:b=>{a.push({type:"del",key:b.toString()})},commit:()=>this.db.batch(a)}}query(a){let b=this._query({values:!0,prefix:a.prefix});Array.isArray(a.filters)&&(b=a.filters.reduce((a,b)=>jD(a,b),b)),Array.isArray(a.orders)&&(b=a.orders.reduce((a,b)=>ve(a,b),b));let{offset:c,limit:d}=a;if(c){let e=0;b=jD(b,()=>(e++)>=c)}return d&&(b=jE(b,d)),b}queryKeys(a){let b=jS(this._query({values:!1,prefix:a.prefix}),({key:a})=>a);Array.isArray(a.filters)&&(b=a.filters.reduce((a,b)=>jD(a,b),b)),Array.isArray(a.orders)&&(b=a.orders.reduce((a,b)=>ve(a,b),b));let{offset:c,limit:d}=a;if(c){let e=0;b=jD(b,()=>(e++)>=c)}return d&&(b=jE(b,d)),b}_query(a){let b={keys:!0,keyAsBuffer:!0,values:a.values};if(null!=a.prefix){let c=a.prefix.toString();b.gte=c,b.lt=c+"\xff"}return vh(this.db.iterator(b))}}function vh(a){return{[Symbol.asyncIterator](){return{next:()=>new Promise((b,c)=>{a.next((d,e,f)=>d?c(d):null==e?a.end(a=>{if(a)return c(a);b({done:!0,value:void 0})}):void b({done:!1,value:{key:new cI(e,!1),value:f}}))}),return:()=>new Promise((b,c)=>{a.end(a=>{if(a)return c(a);b({done:!0,value:void 0})})})}}}}var vi=c(76701);let vj=(a,b)=>(async function*(){let c=await jA(a);yield*c.sort(b)})();class vk{open(){return Promise.reject(Error(".open is not implemented"))}close(){return Promise.reject(Error(".close is not implemented"))}put(a,b,c){return Promise.reject(Error(".put is not implemented"))}get(a,b){return Promise.reject(Error(".get is not implemented"))}has(a,b){return Promise.reject(Error(".has is not implemented"))}delete(a,b){return Promise.reject(Error(".delete is not implemented"))}async *putMany(a,b={}){for await(let{key:c,value:d}of a)await this.put(c,d,b),yield{key:c,value:d}}async *getMany(a,b={}){for await(let c of a)yield this.get(c,b)}async *deleteMany(a,b={}){for await(let c of a)await this.delete(c,b),yield c}batch(){let a=[],b=[];return{put(b,c){a.push({key:b,value:c})},delete(a){b.push(a)},commit:async c=>{await jC(this.putMany(a,c)),a=[],await jC(this.deleteMany(b,c)),b=[]}}}async *_all(a,b){throw Error("._all is not implemented")}async *_allKeys(a,b){throw Error("._allKeys is not implemented")}query(a,b){let c=this._all(a,b);if(null!=a.prefix&&(c=jD(c,b=>b.key.toString().startsWith(a.prefix||""))),Array.isArray(a.filters)&&(c=a.filters.reduce((a,b)=>jD(a,b),c)),Array.isArray(a.orders)&&(c=a.orders.reduce((a,b)=>vj(a,b),c)),null!=a.offset){let d=0;c=jD(c,()=>(d++)>=(a.offset||0))}return null!=a.limit&&(c=jE(c,a.limit)),c}queryKeys(a,b){let c=this._allKeys(a,b);if(null!=a.prefix&&(c=jD(c,b=>b.toString().startsWith(a.prefix||""))),Array.isArray(a.filters)&&(c=a.filters.reduce((a,b)=>jD(a,b),c)),Array.isArray(a.orders)&&(c=a.orders.reduce((a,b)=>vj(a,b),c)),null!=a.offset){let d=0;c=jD(c,()=>(d++)>=a.offset)}return null!=a.limit&&(c=jE(c,a.limit)),c}}function vl(a){let b=bm.CID.asCID(a);if(!b)throw a7(Error("Not a valid cid"),"ERR_INVALID_CID");return new cI("/"+a4.base32.encode(b.multihash.bytes).slice(1).toUpperCase(),!1)}function vm(a){return bm.CID.createV1(mQ.code,dy.decode(a4.base32.decode("b"+a.toString().slice(1).toLowerCase())))}function vn(a){let b=a.substring(0,1);if("/"===b)return vn(a.substring(1));let c;c="b"===b.toLowerCase()?a=>a4.base32.decode(a.toLowerCase()).subarray(2):"c"===b.toLowerCase()?a=>a4.base32pad.decode(a.toLowerCase()).subarray(2):"z"===b?a=>a3.base58btc.decode(a).subarray(2):"Q"===b?a=>a3.base58btc.decode("z"+a):a=>a4.base32.decode("b"+a.toLowerCase()).subarray(2);let d;for(let e=1;e<a.length;e++)try{d=c(a.substring(0,e))}catch(f){if("Unexpected end of data"!==f.message)throw f}let g="/C";return d&&(g=`/${a4.base32.encode(d).slice(1,-1).toUpperCase()||"C"}`),g}function vo(a){return{...a,prefix:a.prefix?vn(a.prefix):void 0,filters:a.filters?a.filters.map(a=>b=>a({key:vm(b.key),value:b.value})):void 0,orders:a.orders?a.orders.map(a=>(b,c)=>a({key:vm(b.key),value:b.value},{key:vm(c.key),value:c.value})):void 0}}function vp(a){return{...a,prefix:a.prefix?vn(a.prefix):void 0,filters:a.filters?a.filters.map(a=>b=>a(vm(b))):void 0,orders:a.orders?a.orders.map(a=>(b,c)=>a(vm(b),vm(c))):void 0}}class vq extends vk{constructor(a){super(),this.child=a}open(){return this.child.open()}close(){return this.child.close()}async *query(a,b){for await(let{key:c,value:d}of this.child.query(vo(a),b))yield{key:vm(c),value:d}}async *queryKeys(a,b){for await(let c of this.child.queryKeys(vp(a),b))yield vm(c)}async get(a,b){return this.child.get(vl(a),b)}async *getMany(a,b){for await(let c of a)yield this.get(c,b)}async put(a,b,c){await this.child.put(vl(a),b,c)}async *putMany(a,b){let c=vi(),d=globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout;d(async()=>{try{let d=this.child;await jC(this.child.putMany(async function*(){for await(let e of a){let f=vl(e.key),g=await d.has(f,b);g||(yield{key:f,value:e.value}),c.push(e)}}())),c.end()}catch(e){c.end(e)}}),yield*c}has(a,b){return this.child.has(vl(a),b)}delete(a,b){return this.child.delete(vl(a),b)}deleteMany(a,b){let c=vi();return jC(this.child.deleteMany(async function*(){for await(let b of a)yield vl(b),c.push(b);c.end()}(),b)).catch(a=>{c.end(a)}),c}}function vr(a,b,c){let d=c.path||"ipfs";return vb(d,a=>b.getCodec(a),{root:new vg(d,{prefix:"",version:2}),blocks:new vq(new vg(`${d}/blocks`,{prefix:"",version:2})),datastore:new vg(`${d}/datastore`,{prefix:"",version:2}),keys:new vg(`${d}/keys`,{prefix:"",version:2}),pins:new vg(`${d}/pins`,{prefix:"",version:2})},{autoMigrate:c.autoMigrate,onMigrationProgress:c.onMigrationProgress||a,repoLock:uO})}let vs={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};(xh=ac||(ac={})).codec=()=>e2({1:{name:"publicKey",codec:eF},2:{name:"payloadType",codec:eF},3:{name:"payload",codec:eF},5:{name:"signature",codec:eF}}),xh.encode=a=>ew(a,xh.codec()),xh.decode=a=>ev(a,xh.codec());class vt{constructor(a){let{peerId:b,payloadType:c,payload:d,signature:e}=a;this.peerId=b,this.payloadType=c,this.payload=d,this.signature=e}marshal(){if(null==this.peerId.publicKey)throw Error("Missing public key");return null==this.marshaled&&(this.marshaled=ac.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload,signature:this.signature})),this.marshaled}equals(a){return(0,dz.equals)(this.marshal(),a.marshal())}async validate(a){let b=vu(a,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw Error("Missing public key");let c=iG(this.peerId.publicKey);return await c.verify(b,this.signature)}}ad=vt,vt.createFromProtobuf=async a=>{let b=ac.decode(a),c=await dO(b.publicKey);return new vt({peerId:c,payloadType:b.payloadType,payload:b.payload,signature:b.signature})},vt.seal=async(a,b)=>{let c=a.domain,d=a.codec,e=a.marshal(),f=vu(c,d,e);if(null==b.privateKey)throw Error("Missing private key");let g=await iI(b.privateKey),h=await g.sign(f);return new vt({peerId:b,payloadType:d,payload:e,signature:h})},vt.openAndCertify=async(a,b)=>{let c=await vt.createFromProtobuf(a),d=await c.validate(b);if(!d)throw a7(Error("envelope signature is not valid for the given domain"),vs.ERR_SIGNATURE_NOT_VALID);return c};let vu=(a,b,c)=>{let d=(0,cB.fromString)(a),e=k2.encode(d.byteLength),f=k2.encode(b.length),g=k2.encode(c.length);return(0,d7.concat)([new Uint8Array(e),d,new Uint8Array(f),b,new Uint8Array(g),c])};function vv(a,b){let c=(a,b)=>a.toString().localeCompare(b.toString());return a.length===b.length&&b.sort(c)&&a.sort(c).every((a,c)=>b[c].equals(a))}let vw;(xj=vw=(xi=ae||(ae={})).AddressInfo||(xi.AddressInfo={})).codec=()=>e2({1:{name:"multiaddr",codec:eF}}),xj.encode=a=>ew(a,xj.codec()),xj.decode=a=>ev(a,xj.codec()),xi.codec=()=>e2({1:{name:"peerId",codec:eF},2:{name:"seq",codec:fp},3:{name:"addresses",codec:xi.AddressInfo.codec(),repeats:!0}}),xi.encode=a=>ew(a,xi.codec()),xi.decode=a=>ev(a,xi.codec());let vx="libp2p-peer-record",vy=Uint8Array.from([3,1]);class vz{constructor(a){this.domain=vz.DOMAIN,this.codec=vz.CODEC;let{peerId:b,multiaddrs:c,seqNumber:d}=a;this.peerId=b,this.multiaddrs=c??[],this.seqNumber=d??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=ae.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(a=>({multiaddr:a.bytes}))})),this.marshaled}equals(a){return!!(a instanceof vz&&this.peerId.equals(a.peerId)&&this.seqNumber===a.seqNumber&&vv(this.multiaddrs,a.multiaddrs))}}vz.createFromProtobuf=a=>{let b=ae.decode(a),c=dM(b.peerId),d=(b.addresses??[]).map(a=>new lC(a.multiaddr)),e=b.seq;return new vz({peerId:c,multiaddrs:d,seqNumber:e})},vz.DOMAIN=vx,vz.CODEC=vy;let vA=Symbol.for("@libp2p/topology");function vB(a){return null!=a&&Boolean(a[vA])}let vC=()=>{};class vD{constructor(a){this.min=a.min??0,this.max=a.max??1/0,this.peers=new Set,this.onConnect=a.onConnect??vC,this.onDisconnect=a.onDisconnect??vC}get[Symbol.toStringTag](){return vA.toString()}get[vA](){return!0}async setRegistrar(a){this.registrar=a}disconnect(a){this.onDisconnect(a)}}function vE(a){return new vD(a)}var vF=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};class vG extends EventTarget{constructor(){super(...arguments),af.set(this,new Map)}listenerCount(a){let b=vF(this,af,"f").get(a);return null==b?0:b.length}addEventListener(a,b,c){super.addEventListener(a,b,c);let d=vF(this,af,"f").get(a);null==d&&(d=[],vF(this,af,"f").set(a,d)),d.push({callback:b,once:(!0!==c&& !1!==c&&c?.once)?? !1})}removeEventListener(a,b,c){super.removeEventListener(a.toString(),b??null,c);let d=vF(this,af,"f").get(a);null!=d&&(d=d.filter(({callback:a})=>a!==b),vF(this,af,"f").set(a,d))}dispatchEvent(a){let b=super.dispatchEvent(a),c=vF(this,af,"f").get(a.type);return null==c||(c=c.filter(({once:a})=>!a),vF(this,af,"f").set(a.type,c)),b}}af=new WeakMap;class vH extends Event{constructor(a,b){super(a,b),this.detail=b?.detail}}let vI=globalThis.CustomEvent??vH,vJ=(a,b,c)=>{let d=k2.encode(a,b,c);return vJ.bytes=k2.encode.bytes,b??Uint8Array.from(d)};vJ.bytes=0;let vK=8,vL=10240;function vM(a){a=a??{};let b=Math.max(a.poolSize??vL,a.minPoolSize??vK),c=a.lengthEncoder??vJ,d=async function*(a){let d=new Uint8Array(b),e=0;for await(let f of a){c(f.length,d,e);let g=d.slice(e,e+c.bytes);e+=c.bytes,d.length-e<vK&&(d=new Uint8Array(b),e=0),yield(0,d7.concat)([g,f.slice()],g.length+f.length)}};return d}vM.single=(a,b)=>{b=b??{};let c=b.lengthEncoder??vJ;return new eb(c(a.length),a.slice())};let vN=a=>{let b=k2.decode(a);return vN.bytes=k2.decode.bytes,b};vN.bytes=0;let vO=8,vP=4194304,vQ=new eb,vR={LENGTH:"readLength",DATA:"readData"},vS={[vR.LENGTH]:(a,b,c,d)=>{let e=d?.lengthDecoder??vN,f=d?.maxLengthLength??vO,g=d?.maxDataLength??vP;b.append(a);let h;try{h=e(b.slice())}catch(i){if(b.length>f)throw a7(Error("message length too long"),"ERR_MSG_LENGTH_TOO_LONG");if(i instanceof RangeError)return{mode:vR.LENGTH,buffer:b,chunk:void 0,state:void 0,data:void 0};throw i}if(h>g)throw a7(Error("message data too long"),"ERR_MSG_DATA_TOO_LONG");return(a=b.subarray(e.bytes),b=new eb,d?.onLength!=null&&d.onLength(h),h<=0)?{mode:vR.LENGTH,chunk:a,buffer:b,data:vQ}:{mode:vR.DATA,chunk:a,buffer:b,state:{dataLength:h},data:void 0}},[vR.DATA]:(a,b,c,d)=>{if(b.append(a),null==c)throw Error("state is required");if(b.length<c.dataLength)return{mode:vR.DATA,buffer:b,state:c,chunk:void 0,data:void 0};let{dataLength:e}=c,f=b.subarray(0,e),g=b.length>e?b.subarray(e):void 0;return b=new eb,{mode:vR.LENGTH,chunk:g,buffer:b,state:void 0,data:f}}};function vT(a){let b=async function*(b){let c=new eb,d=vR.LENGTH,e;for await(let f of b){let g=new eb(f);for(;null!=g;){let h=vS[d](g,c,e,a);if(d=h.mode,g=h.chunk,c=h.buffer,e=h.state,null!=h.data){let i=h.data.slice();a?.onData!=null&&a.onData(i),yield i}}}if(c.length>0)throw a7(Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")};return b}function vU(a){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(a):new Uint8Array(a)}vT.fromReader=(a,b)=>{let c=1,d=async function*(){for(;;)try{let{done:b,value:d}=await a.next(c);if(!0===b)return;null!=d&&(yield d)}catch(e){if("ERR_UNDER_READ"===e.code)return{done:!0,value:null};throw e}finally{c=1}}(),e=a=>{c=a};return vT({...b??{},onLength:e})(d)};let vV=(a,b,c)=>{b=b??vU(4);let d=new DataView(b.buffer,b.byteOffset,b.byteLength);return d.setInt32(c??0,a,!1),b};vV.bytes=4;let vW=a=>{if(a.length<4)throw RangeError("Could not decode int32BE");let b=new DataView(a.buffer,a.byteOffset,a.byteLength);return b.getInt32(0,!1)};vW.bytes=4;class vX{constructor(a){if(!(a>0)||(a-1&a)!=0)throw Error("Max size for a FixedFIFO should be a power of two");this.buffer=Array(a),this.mask=a-1,this.top=0,this.btm=0,this.next=null}push(a){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=a,this.top=this.top+1&this.mask,!0)}shift(){let a=this.buffer[this.btm];if(void 0!==a)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,a}isEmpty(){return void 0===this.buffer[this.btm]}}class vY{constructor(a){this.hwm=a??16,this.head=new vX(this.hwm),this.tail=this.head}push(a){if(!this.head.push(a)){let b=this.head;this.head=b.next=new vX(2*this.head.buffer.length),this.head.push(a)}}shift(){let a=this.tail.shift();if(void 0===a&&null!=this.tail.next){let b=this.tail.next;return this.tail.next=null,this.tail=b,this.tail.shift()}return a}isEmpty(){return this.head.isEmpty()}}function vZ(a){let b=a=>{let b=a.shift();if(null==b)return{done:!0};if(null!=b.error)throw b.error;return{done:!0===b.done,value:b.value}};return v$(b,a)}function v$(a,b){let c=(b=b??{}).onEnd,d=new vY,e,f,g,h=async()=>d.isEmpty()?g?{done:!0}:await new Promise((b,c)=>{f=g=>{f=null,d.push(g);try{b(a(d))}catch(h){c(h)}return e}}):a(d),i=a=>null!=f?f(a):(d.push(a),e),j=a=>(d=new vY,null!=f)?f({error:a}):(d.push({error:a}),e),k=a=>g?e:i({done:!1,value:a}),l=a=>g?e:(g=!0,null!=a?j(a):i({done:!0})),m=()=>(d=new vY,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l},null==c)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),null!=c&&(c(a),c=void 0),{done:!0}},return(){return o.return(),null!=c&&(c(),c=void 0),{done:!0}},push:k,end(a){return o.end(a),null!=c&&(c(a),c=void 0),e}}}class v_ extends Error{constructor(a,b){super(a??"The operation was aborted"),this.type="aborted",this.code=b??"ABORT_ERR"}}function v0(a){if(null!=a){if("function"==typeof a[Symbol.iterator])return a[Symbol.iterator]();if("function"==typeof a[Symbol.asyncIterator])return a[Symbol.asyncIterator]();if("function"==typeof a.next)return a}throw Error("argument is not an iterator or iterable")}function v1(a,b,c){let d=c??{},e=v0(a);async function*f(){let c,f=()=>{null!=c&&c()};for(b.addEventListener("abort",f);;){let g;try{if(b.aborted){let{abortMessage:h,abortCode:i}=d;throw new v_(h,i)}let j=new Promise((a,b)=>{c=()=>{let{abortMessage:a,abortCode:c}=d;b(new v_(a,c))}});g=await Promise.race([j,e.next()]),c=null}catch(k){b.removeEventListener("abort",f);let l="aborted"===k.type&&b.aborted;if(l&&null!=d.onAbort&&await d.onAbort(a),"function"==typeof e.return)try{let m=e.return();m instanceof Promise&&m.catch(a=>{null!=d.onReturnError&&d.onReturnError(a)})}catch(n){null!=d.onReturnError&&d.onReturnError(n)}if(l&& !0===d.returnOnAbort)return;throw k}if(!0===g.done)break;yield g.value}b.removeEventListener("abort",f)}return f()}function v2(a,b,c){return d=>a(v1(d,b,c))}function v3(a,b,c){return{sink:v2(a.sink,b,{...c,onAbort:void 0}),source:v1(a.source,b,c)}}let v4=a6("libp2p-pubsub:peer-streams");class v5 extends vG{constructor(a){super(),this.id=a.id,this.protocol=a.protocol,this._inboundAbortController=new AbortController,this.closed=!1}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(a){if(null==this.outboundStream){let b=this.id.toString();throw Error("No writable connection to "+b)}this.outboundStream.push(a)}attachInboundStream(a){return this._rawInboundStream=a,this.inboundStream=v1(mk(this._rawInboundStream,vT()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.dispatchEvent(new vI("stream:inbound")),this.inboundStream}async attachOutboundStream(a){let b=this.outboundStream;return null!=this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=a,this.outboundStream=vZ({onEnd:a=>{null!=this._rawOutboundStream&&null!=this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=void 0,this.outboundStream=void 0,null!=a&&this.dispatchEvent(new vI("close"))}}),mk(this.outboundStream,vM(),this._rawOutboundStream).catch(a=>{v4.error(a)}),null==b&&this.dispatchEvent(new vI("stream:outbound")),this.outboundStream}close(){!this.closed&&(this.closed=!0,null!=this.outboundStream&&this.outboundStream.end(),null!=this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=void 0,this.outboundStream=void 0,this._rawInboundStream=void 0,this.inboundStream=void 0,this.dispatchEvent(new vI("close")))}}class v6{constructor(a,b,c){this.gossip=a,this.msgs=new Map,this.history=[],this.msgIdToStrFn=c;for(let d=0;d<b;d++)this.history[d]=[]}get size(){return this.msgs.size}put(a,b,c=!1){let{msgIdStr:d}=a;return!this.msgs.has(d)&&(this.msgs.set(d,{message:b,validated:c,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...a,topic:b.topic}),!0)}observeDuplicate(a,b){let c=this.msgs.get(a);c&&!c.validated&&c.originatingPeers.add(b)}get(a){return this.msgs.get(this.msgIdToStrFn(a))?.message}getWithIWantCount(a,b){let c=this.msgs.get(a);if(!c)return null;let d=(c.iwantCounts.get(b)??0)+1;return c.iwantCounts.set(b,d),{msg:c.message,count:d}}getGossipIDs(a){let b=new Map;for(let c=0;c<this.gossip;c++)this.history[c].forEach(c=>{let d=this.msgs.get(c.msgIdStr);if(d&&d.validated&&a.has(c.topic)){let e=b.get(c.topic);e||(e=[],b.set(c.topic,e)),e.push(c.msgId)}});return b}validate(a){let b=this.msgs.get(a);if(!b)return null;let{message:c,originatingPeers:d}=b;return b.validated=!0,b.originatingPeers=new Set,{message:c,originatingPeers:d}}shift(){let a=this.history[this.history.length-1];a.forEach(a=>{this.msgs.delete(a.msgIdStr)}),this.history.pop(),this.history.unshift([])}remove(a){let b=this.msgs.get(a);return b?(this.msgs.delete(a),b):null}}let v7,v8,v9,wa,wb,wc,wd,we;(xl=v7=(xk=ag||(ag={})).SubOpts||(xk.SubOpts={})).codec=()=>e2({1:{name:"subscribe",codec:eB,optional:!0},2:{name:"topic",codec:fi,optional:!0}}),xl.encode=a=>ew(a,xl.codec()),xl.decode=a=>ev(a,xl.codec()),(xm=v8=xk.Message||(xk.Message={})).codec=()=>e2({1:{name:"from",codec:eF,optional:!0},2:{name:"data",codec:eF,optional:!0},3:{name:"seqno",codec:eF,optional:!0},4:{name:"topic",codec:fi},5:{name:"signature",codec:eF,optional:!0},6:{name:"key",codec:eF,optional:!0}}),xm.encode=a=>ew(a,xm.codec()),xm.decode=a=>ev(a,xm.codec()),(xn=v9=xk.ControlMessage||(xk.ControlMessage={})).codec=()=>e2({1:{name:"ihave",codec:xk.ControlIHave.codec(),repeats:!0},2:{name:"iwant",codec:xk.ControlIWant.codec(),repeats:!0},3:{name:"graft",codec:xk.ControlGraft.codec(),repeats:!0},4:{name:"prune",codec:xk.ControlPrune.codec(),repeats:!0}}),xn.encode=a=>ew(a,xn.codec()),xn.decode=a=>ev(a,xn.codec()),(xo=wa=xk.ControlIHave||(xk.ControlIHave={})).codec=()=>e2({1:{name:"topicID",codec:fi,optional:!0},2:{name:"messageIDs",codec:eF,repeats:!0}}),xo.encode=a=>ew(a,xo.codec()),xo.decode=a=>ev(a,xo.codec()),(xp=wb=xk.ControlIWant||(xk.ControlIWant={})).codec=()=>e2({1:{name:"messageIDs",codec:eF,repeats:!0}}),xp.encode=a=>ew(a,xp.codec()),xp.decode=a=>ev(a,xp.codec()),(xq=wc=xk.ControlGraft||(xk.ControlGraft={})).codec=()=>e2({1:{name:"topicID",codec:fi,optional:!0}}),xq.encode=a=>ew(a,xq.codec()),xq.decode=a=>ev(a,xq.codec()),(xr=wd=xk.ControlPrune||(xk.ControlPrune={})).codec=()=>e2({1:{name:"topicID",codec:fi,optional:!0},2:{name:"peers",codec:xk.PeerInfo.codec(),repeats:!0},3:{name:"backoff",codec:fp,optional:!0}}),xr.encode=a=>ew(a,xr.codec()),xr.decode=a=>ev(a,xr.codec()),(xs=we=xk.PeerInfo||(xk.PeerInfo={})).codec=()=>e2({1:{name:"peerID",codec:eF,optional:!0},2:{name:"signedPeerRecord",codec:eF,optional:!0}}),xs.encode=a=>ew(a,xs.codec()),xs.decode=a=>ev(a,xs.codec()),xk.codec=()=>e2({1:{name:"subscriptions",codec:xk.SubOpts.codec(),repeats:!0},2:{name:"messages",codec:xk.Message.codec(),repeats:!0},3:{name:"control",codec:xk.ControlMessage.codec(),optional:!0}}),xk.encode=a=>ew(a,xk.codec()),xk.decode=a=>ev(a,xk.codec());let wf=1e3,wg=60*wf,wh="/floodsub/1.0.0",wi="/meshsub/1.0.0",wj="/meshsub/1.1.0",wk=6,wl=4,wm=12,wn=4,wo=2,wp=5,wq=3,wr=6,ws=.25,wt=3,wu=100,wv=wf,ww=wg,wx=16,wy=wg,wz=15,wA=300,wB=wf,wC=60,wD=2,wE=10*wf,wF=5e3,wG=10,wH=3*wf,wI=2*wg,wJ=12e4,wK="ERR_TOPIC_VALIDATOR_REJECT",wL="ERR_TOPIC_VALIDATOR_IGNORE",wM=0,wN=128,wO=1e3,wP=1e3;function wQ(a=[],b){return{subscriptions:[],messages:a,control:b?{graft:b.graft||[],prune:b.prune||[],ihave:b.ihave||[],iwant:b.iwant||[]}:void 0}}function wR(a){if(a.length<=1)return a;let b=()=>Math.floor(Math.random()*Math.floor(a.length));for(let c=0;c<a.length;c++){let d=b(),e=a[c];a[c]=a[d],a[d]=e}return a}function wS(a){return a===wi||a===wj}function wT(a){return(0,cE.toString)(a,"base64")}let wU="StrictSign",wV="StrictNoSign";function wW(a){switch(a){case aj.Ignore:return ak.Ignore;case aj.Reject:return ak.Reject}}async function wX(a,b){switch(a){case wU:{if(!b)throw Error("Must provide PeerId");if(null==b.privateKey)throw Error("Cannot sign message, no private key present");if(null==b.publicKey)throw Error("Cannot sign message, no public key present");let c=await iI(b.privateKey);return{type:ai.Signing,author:b,key:b.publicKey,privateKey:c}}case wV:return{type:ai.Anonymous};default:throw Error(`Unknown signature policy "${a}"`)}}(xt=ah||(ah={})).StrictSign="StrictSign",xt.StrictNoSign="StrictNoSign",(xu=ai||(ai={}))[xu.Signing=0]="Signing",xu[xu.Author=1]="Author",xu[xu.Anonymous=2]="Anonymous",(xv=aj||(aj={})).Accept="accept",xv.Ignore="ignore",xv.Reject="reject",(xw=ak||(ak={})).Error="error",xw.Ignore="ignore",xw.Reject="reject",xw.Blacklisted="blacklisted",(xx=al||(al={})).InvalidSignature="invalid_signature",xx.InvalidSeqno="invalid_seqno",xx.InvalidPeerId="invalid_peerid",xx.SignaturePresent="signature_present",xx.SeqnoPresent="seqno_present",xx.FromPresent="from_present",xx.TransformFailed="transform_failed",(xy=am||(am={})).duplicate="duplicate",xy.invalid="invalid",xy.valid="valid";let wY="ERR_INVALID_PEER_SCORE_PARAMS",wZ={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},w$={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function w_(a={}){return{...wZ,...a,topics:a.topics?Object.entries(a.topics).reduce((a,[b,c])=>(a[b]=w0(c),a),{}):{}}}function w0(a={}){return{...w$,...a}}function w1(a){for(let[b,c]of Object.entries(a.topics))try{w2(c)}catch(d){throw a7(Error(`invalid score parameters for topic ${b}: ${d.message}`),wY)}if(a.topicScoreCap<0)throw a7(Error("invalid topic score cap; must be positive (or 0 for no cap)"),wY);if(null===a.appSpecificScore|| void 0===a.appSpecificScore)throw a7(Error("missing application specific score function"),wY);if(a.IPColocationFactorWeight>0)throw a7(Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),wY);if(0!==a.IPColocationFactorWeight&&a.IPColocationFactorThreshold<1)throw a7(Error("invalid IPColocationFactorThreshold; must be at least 1"),wY);if(a.behaviourPenaltyWeight>0)throw a7(Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),wY);if(0!==a.behaviourPenaltyWeight&&(a.behaviourPenaltyDecay<=0||a.behaviourPenaltyDecay>=1))throw a7(Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),wY);if(a.decayInterval<1e3)throw a7(Error("invalid DecayInterval; must be at least 1s"),wY);if(a.decayToZero<=0||a.decayToZero>=1)throw a7(Error("invalid DecayToZero; must be between 0 and 1"),wY)}function w2(a){if(a.topicWeight<0)throw a7(Error("invalid topic weight; must be >= 0"),wY);if(0===a.timeInMeshQuantum)throw a7(Error("invalid TimeInMeshQuantum; must be non zero"),wY);if(a.timeInMeshWeight<0)throw a7(Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),wY);if(0!==a.timeInMeshWeight&&a.timeInMeshQuantum<=0)throw a7(Error("invalid TimeInMeshQuantum; must be positive"),wY);if(0!==a.timeInMeshWeight&&a.timeInMeshCap<=0)throw a7(Error("invalid TimeInMeshCap; must be positive"),wY);if(a.firstMessageDeliveriesWeight<0)throw a7(Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),wY);if(0!==a.firstMessageDeliveriesWeight&&(a.firstMessageDeliveriesDecay<=0||a.firstMessageDeliveriesDecay>=1))throw a7(Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),wY);if(0!==a.firstMessageDeliveriesWeight&&a.firstMessageDeliveriesCap<=0)throw a7(Error("invalid FirstMessageDeliveriesCap; must be positive"),wY);if(a.meshMessageDeliveriesWeight>0)throw a7(Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),wY);if(0!==a.meshMessageDeliveriesWeight&&(a.meshMessageDeliveriesDecay<=0||a.meshMessageDeliveriesDecay>=1))throw a7(Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),wY);if(0!==a.meshMessageDeliveriesWeight&&a.meshMessageDeliveriesCap<=0)throw a7(Error("invalid MeshMessageDeliveriesCap; must be positive"),wY);if(0!==a.meshMessageDeliveriesWeight&&a.meshMessageDeliveriesThreshold<=0)throw a7(Error("invalid MeshMessageDeliveriesThreshold; must be positive"),wY);if(a.meshMessageDeliveriesWindow<0)throw a7(Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),wY);if(0!==a.meshMessageDeliveriesWeight&&a.meshMessageDeliveriesActivation<1e3)throw a7(Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),wY);if(a.meshFailurePenaltyWeight>0)throw a7(Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),wY);if(0!==a.meshFailurePenaltyWeight&&(a.meshFailurePenaltyDecay<=0||a.meshFailurePenaltyDecay>=1))throw a7(Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),wY);if(a.invalidMessageDeliveriesWeight>0)throw a7(Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),wY);if(a.invalidMessageDeliveriesDecay<=0||a.invalidMessageDeliveriesDecay>=1)throw a7(Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),wY)}let w3={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function w4(a={}){return{...w3,...a}}function w5(a,b,c,d){let e=0;Object.entries(b.topics).forEach(([a,b])=>{let d=c.topics[a];if(void 0===d)return;let f=0;if(b.inMesh){let g=b.meshTime/d.timeInMeshQuantum;g>d.timeInMeshCap&&(g=d.timeInMeshCap),f+=g*d.timeInMeshWeight}let h=b.firstMessageDeliveries;if(h>d.firstMessageDeliveriesCap&&(h=d.firstMessageDeliveriesCap),f+=h*d.firstMessageDeliveriesWeight,b.meshMessageDeliveriesActive&&b.meshMessageDeliveries<d.meshMessageDeliveriesThreshold){let i=d.meshMessageDeliveriesThreshold-b.meshMessageDeliveries,j=i*i;f+=j*d.meshMessageDeliveriesWeight}let k=b.meshFailurePenalty;f+=k*d.meshFailurePenaltyWeight;let l=b.invalidMessageDeliveries*b.invalidMessageDeliveries;f+=l*d.invalidMessageDeliveriesWeight,e+=f*d.topicWeight}),c.topicScoreCap>0&&e>c.topicScoreCap&&(e=c.topicScoreCap);let f=c.appSpecificScore(a);if(e+=f*c.appSpecificWeight,b.ips.forEach(a=>{if(c.IPColocationFactorWhitelist.has(a))return;let b=d.get(a),f=b?b.size:0;if(f>c.IPColocationFactorThreshold){let g=f-c.IPColocationFactorThreshold,h=g*g;e+=h*c.IPColocationFactorWeight}}),b.behaviourPenalty>c.behaviourPenaltyThreshold){let g=b.behaviourPenalty-c.behaviourPenaltyThreshold,h=g*g;e+=h*c.behaviourPenaltyWeight}return e}var w6,w7,w8,w9,xa,xb,xc,xd,xe,xf,xg,xh,xi,xj,xk,xl,xm,xn,xo,xp,xq,xr,xs,xt,xu,xv,xw,xx,xy,xz,xA=c(45001);(xz=an||(an={}))[xz.unknown=0]="unknown",xz[xz.valid=1]="valid",xz[xz.invalid=2]="invalid",xz[xz.ignored=3]="ignored";class xB{constructor(){this.records=new Map,this.queue=new xA}ensureRecord(a){let b=this.records.get(a);if(b)return b;b={status:an.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(a,b);let c={msgId:a,expire:Date.now()+wJ};return this.queue.push(c),b}gc(){let a=Date.now(),b=this.queue.peekFront();for(;b&&b.expire<a;)this.records.delete(b.msgId),this.queue.shift(),b=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function xC(a){return null!=a&&"function"==typeof a.start&&"function"==typeof a.stop}function xD(a){return null!=a&&"function"==typeof a.init}class xE{constructor(a={}){this.started=!1,null!=a.peerId&&this.setPeerId(a.peerId),null!=a.addressManager&&this.setAddressManager(a.addressManager),null!=a.peerStore&&this.setPeerStore(a.peerStore),null!=a.upgrader&&this.setUpgrader(a.upgrader),null!=a.metrics&&this.setMetrics(a.metrics),null!=a.registrar&&this.setRegistrar(a.registrar),null!=a.connectionManager&&this.setConnectionManager(a.connectionManager),null!=a.transportManager&&this.setTransportManager(a.transportManager),null!=a.connectionGater&&this.setConnectionGater(a.connectionGater),null!=a.contentRouting&&this.setContentRouting(a.contentRouting),null!=a.peerRouting&&this.setPeerRouting(a.peerRouting),null!=a.datastore&&this.setDatastore(a.datastore),null!=a.connectionProtector&&this.setConnectionProtector(a.connectionProtector),null!=a.dht&&this.setDHT(a.dht),null!=a.pubsub&&this.setPubSub(a.pubsub)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(a=>xC(a)).map(async a=>{null!=a.beforeStart&&await a.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(a=>xC(a)).map(async a=>{await a.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(a=>xC(a)).map(async a=>{null!=a.afterStart&&await a.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(a=>xC(a)).map(async a=>{null!=a.beforeStop&&await a.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(a=>xC(a)).map(async a=>{await a.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(a=>xC(a)).map(async a=>{null!=a.afterStop&&await a.afterStop()}))}setPeerId(a){return this.peerId=a,a}getPeerId(){if(null==this.peerId)throw a7(Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(a){return this.metrics=a,xD(a)&&a.init(this),a}getMetrics(){return this.metrics}setAddressManager(a){return this.addressManager=a,xD(a)&&a.init(this),a}getAddressManager(){if(null==this.addressManager)throw a7(Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(a){return this.peerStore=a,xD(a)&&a.init(this),a}getPeerStore(){if(null==this.peerStore)throw a7(Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(a){return this.upgrader=a,xD(a)&&a.init(this),a}getUpgrader(){if(null==this.upgrader)throw a7(Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(a){return this.registrar=a,xD(a)&&a.init(this),a}getRegistrar(){if(null==this.registrar)throw a7(Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(a){return this.connectionManager=a,xD(a)&&a.init(this),a}getConnectionManager(){if(null==this.connectionManager)throw a7(Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(a){return this.transportManager=a,xD(a)&&a.init(this),a}getTransportManager(){if(null==this.transportManager)throw a7(Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(a){return this.connectionGater=a,xD(a)&&a.init(this),a}getConnectionGater(){if(null==this.connectionGater)throw a7(Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(a){return this.contentRouting=a,xD(a)&&a.init(this),a}getContentRouting(){if(null==this.contentRouting)throw a7(Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(a){return this.peerRouting=a,xD(a)&&a.init(this),a}getPeerRouting(){if(null==this.peerRouting)throw a7(Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(a){return this.datastore=a,xD(a)&&a.init(this),a}getDatastore(){if(null==this.datastore)throw a7(Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(a){return this.connectionProtector=a,xD(a)&&a.init(this),a}getConnectionProtector(){return this.connectionProtector}setDHT(a){return this.dht=a,xD(a)&&a.init(this),a}getDHT(){if(null==this.dht)throw a7(Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(a){return this.pubsub=a,xD(a)&&a.init(this),a}getPubSub(){if(null==this.pubsub)throw a7(Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}}let xF=a6("libp2p:gossipsub:score");class xG{constructor(a,b,c){this.params=a,this.metrics=b,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new xB,this.components=new xE,w1(a),this.scoreCacheValidityMs=c.scoreCacheValidityMs,this.computeScore=c.computeScore??w5}init(a){this.components=a}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){xF("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),xF("started")}stop(){if(!this._backgroundInterval){xF("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),xF("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([a,b])=>[a,b]))}refreshScores(){let a=Date.now(),b=this.params.decayToZero;this.peerStats.forEach((c,d)=>{if(!c.connected){a>c.expire&&(this.removeIPs(d,c.ips),this.peerStats.delete(d),this.scoreCache.delete(d));return}Object.entries(c.topics).forEach(([c,d])=>{let e=this.params.topics[c];void 0!==e&&(d.firstMessageDeliveries*=e.firstMessageDeliveriesDecay,d.firstMessageDeliveries<b&&(d.firstMessageDeliveries=0),d.meshMessageDeliveries*=e.meshMessageDeliveriesDecay,d.meshMessageDeliveries<b&&(d.meshMessageDeliveries=0),d.meshFailurePenalty*=e.meshFailurePenaltyDecay,d.meshFailurePenalty<b&&(d.meshFailurePenalty=0),d.invalidMessageDeliveries*=e.invalidMessageDeliveriesDecay,d.invalidMessageDeliveries<b&&(d.invalidMessageDeliveries=0),d.inMesh&&(d.meshTime=a-d.graftTime,d.meshTime>e.meshMessageDeliveriesActivation&&(d.meshMessageDeliveriesActive=!0)))}),c.behaviourPenalty*=this.params.behaviourPenaltyDecay,c.behaviourPenalty<b&&(c.behaviourPenalty=0)})}score(a){this.metrics?.scoreFnCalls.inc();let b=this.peerStats.get(a);if(!b)return 0;let c=Date.now(),d=this.scoreCache.get(a);if(d&&d.cacheUntil>c)return d.score;this.metrics?.scoreFnRuns.inc();let e=this.computeScore(a,b,this.params,this.peerIPs),f=c+this.scoreCacheValidityMs;return d?(this.metrics?.scoreCachedDelta.observe(Math.abs(e-d.score)),d.score=e,d.cacheUntil=f):this.scoreCache.set(a,{score:e,cacheUntil:f}),e}addPenalty(a,b,c){let d=this.peerStats.get(a);d&&(d.behaviourPenalty+=b,this.metrics?.onScorePenalty(c))}addPeer(a){let b={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(a,b);let c=this.getIPs(a);this.setIPs(a,c,b.ips),b.ips=c}removePeer(a){let b=this.peerStats.get(a);if(b){if(this.score(a)>0){this.removeIPs(a,b.ips),this.peerStats.delete(a);return}Object.entries(b.topics).forEach(([a,b])=>{b.firstMessageDeliveries=0;let c=this.params.topics[a].meshMessageDeliveriesThreshold;if(b.inMesh&&b.meshMessageDeliveriesActive&&b.meshMessageDeliveries<c){let d=c-b.meshMessageDeliveries;b.meshFailurePenalty+=d*d}b.inMesh=!1,b.meshMessageDeliveriesActive=!1}),b.connected=!1,b.expire=Date.now()+this.params.retainScore}}graft(a,b){let c=this.peerStats.get(a);if(c){let d=this.getPtopicStats(c,b);d&&(d.inMesh=!0,d.graftTime=Date.now(),d.meshTime=0,d.meshMessageDeliveriesActive=!1)}}prune(a,b){let c=this.peerStats.get(a);if(c){let d=this.getPtopicStats(c,b);if(d){let e=this.params.topics[b].meshMessageDeliveriesThreshold;if(d.meshMessageDeliveriesActive&&d.meshMessageDeliveries<e){let f=e-d.meshMessageDeliveries;d.meshFailurePenalty+=f*f}d.meshMessageDeliveriesActive=!1,d.inMesh=!1}}}validateMessage(a){this.deliveryRecords.ensureRecord(a)}deliverMessage(a,b,c){this.markFirstMessageDelivery(a,c);let d=this.deliveryRecords.ensureRecord(b),e=Date.now();if(d.status!==an.unknown){xF("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",a,e-d.firstSeen,an[d.status]);return}d.status=an.valid,d.validated=e,d.peers.forEach(b=>{b!==a.toString()&&this.markDuplicateMessageDelivery(b,c)})}rejectInvalidMessage(a,b){this.markInvalidMessageDelivery(a,b)}rejectMessage(a,b,c,d){switch(d){case ak.Error:this.markInvalidMessageDelivery(a,c);return;case ak.Blacklisted:return}let e=this.deliveryRecords.ensureRecord(b);if(e.status!==an.unknown){xF("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",a,Date.now()-e.firstSeen,an[e.status]);return}if(d===ak.Ignore){e.status=an.ignored,e.peers.clear();return}e.status=an.invalid,this.markInvalidMessageDelivery(a,c),e.peers.forEach(a=>{this.markInvalidMessageDelivery(a,c)}),e.peers.clear()}duplicateMessage(a,b,c){let d=this.deliveryRecords.ensureRecord(b);if(!d.peers.has(a))switch(d.status){case an.unknown:d.peers.add(a);break;case an.valid:d.peers.add(a),this.markDuplicateMessageDelivery(a,c,d.validated);break;case an.invalid:this.markInvalidMessageDelivery(a,c);case an.ignored:}}markInvalidMessageDelivery(a,b){let c=this.peerStats.get(a);if(c){let d=this.getPtopicStats(c,b);d&&(d.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(a,b){let c=this.peerStats.get(a);if(c){let d=this.getPtopicStats(c,b);if(d){let e=this.params.topics[b].firstMessageDeliveriesCap;d.firstMessageDeliveries=Math.min(e,d.firstMessageDeliveries+1),d.inMesh&&(e=this.params.topics[b].meshMessageDeliveriesCap,d.meshMessageDeliveries=Math.min(e,d.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(a,b,c){let d=this.peerStats.get(a);if(d){let e=void 0!==c?Date.now():0,f=this.getPtopicStats(d,b);if(f&&f.inMesh){let g=this.params.topics[b];if(void 0!==c){let h=e-c,i=h>g.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(b,h,i),i)return}let j=g.meshMessageDeliveriesCap;f.meshMessageDeliveries=Math.min(j,f.meshMessageDeliveries+1)}}}getIPs(a){return this.components.getConnectionManager().getConnections(dL(a)).map(a=>a.remoteAddr.toOptions().host)}setIPs(a,b,c){addNewIPs:for(let d of b){for(let e of c)if(d===e)continue addNewIPs;let f=this.peerIPs.get(d);f||(f=new Set,this.peerIPs.set(d,f)),f.add(a)}removeOldIPs:for(let g of c){for(let h of b)if(g===h)continue removeOldIPs;let i=this.peerIPs.get(g);i&&(i.delete(a),i.size||this.peerIPs.delete(g))}}removeIPs(a,b){b.forEach(b=>{let c=this.peerIPs.get(b);c&&(c.delete(a),c.size||this.peerIPs.delete(b))})}updateIPs(){this.peerStats.forEach((a,b)=>{let c=this.getIPs(b);this.setIPs(b,c,a.ips),a.ips=c})}getPtopicStats(a,b){let c=a.topics[b];return void 0!==c?c:void 0!==this.params.topics[b]?(c={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},a.topics[b]=c,c):null}}class xH{constructor(a,b,c){this.gossipsubIWantFollowupMs=a,this.msgIdToStrFn=b,this.metrics=c,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*a}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(a,b){let c=Math.floor(Math.random()*b.length),d=b[c],e=this.msgIdToStrFn(d),f=this.promises.get(e);f||(f=new Map,this.promises.set(e,f));let g=Date.now();f.has(a)||(f.set(a,g+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(e)||this.requestMsByMsg.set(e,g)))}getBrokenPromises(){let a=Date.now(),b=new Map,c=0;return this.promises.forEach((d,e)=>{d.forEach((e,f)=>{e<a&&(b.set(f,(b.get(f)??0)+1),d.delete(f),c++)}),d.size||this.promises.delete(e)}),this.metrics?.iwantPromiseBroken.inc(c),b}deliverMessage(a){this.trackMessage(a);let b=this.promises.get(a);b&&(this.promises.delete(a),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(b.size)))}rejectMessage(a,b){this.trackMessage(a),b!==ak.Error&&this.promises.delete(a)}clear(){this.promises.clear()}prune(){let a=Date.now()-this.requestMsByMsgExpire;for(let[b,c]of this.requestMsByMsg.entries())if(c<a)this.requestMsByMsg.delete(b);else break}trackMessage(a){if(this.metrics){let b=this.requestMsByMsg.get(a);void 0!==b&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-b)/1e3),this.requestMsByMsg.delete(a))}}}class xI{constructor(a){this.entries=new Map,this.validityMs=a.validityMs}get size(){return this.entries.size}put(a,b){this.entries.set(a,{value:b,validUntilMs:Date.now()+this.validityMs})}prune(){let a=Date.now();for(let[b,c]of this.entries.entries())if(c.validUntilMs<a)this.entries.delete(b);else break}has(a){return this.entries.has(a)}get(a){let b=this.entries.get(a);return b&&b.validUntilMs>=Date.now()?b.value:void 0}clear(){this.entries.clear()}}function xJ(a,b,c){return{protocolsEnabled:a.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:a.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:a.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:a.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:a.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:a.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:a.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:a.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:a.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:a.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:a.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:a.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:a.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:a.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:a.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:a.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:a.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:a.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:a.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:a.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:a.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:a.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:a.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:a.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:a.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:a.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:a.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:a.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:a.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:a.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:a.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:a.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:a.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:a.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:a.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:a.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:a.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:a.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:a.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:a.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*c.maxMeshMessageDeliveriesWindowSec,.5*c.maxMeshMessageDeliveriesWindowSec,1*c.maxMeshMessageDeliveriesWindowSec,2*c.maxMeshMessageDeliveriesWindowSec,4*c.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:a.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:a.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:a.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:a.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:a.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:a.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:a.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:a.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:a.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:a.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*c.behaviourPenaltyThreshold,.5*c.behaviourPenaltyThreshold,1*c.behaviourPenaltyThreshold,2*c.behaviourPenaltyThreshold,4*c.behaviourPenaltyThreshold]}),ihaveRcvIgnored:a.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:a.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:a.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:a.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:a.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:a.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:a.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:a.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:a.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:a.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*c.gossipPromiseExpireSec,1*c.gossipPromiseExpireSec,2*c.gossipPromiseExpireSec,4*c.gossipPromiseExpireSec]}),cacheSize:a.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:a.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:b,toTopic(a){return this.topicStrToLabel.get(a)??a},onJoin(a){this.topicSubscriptionStatus.set({topicStr:a},1),this.meshPeerCounts.set({topicStr:a},0)},onLeave(a){this.topicSubscriptionStatus.set({topicStr:a},0),this.meshPeerCounts.set({topicStr:a},0)},onAddToMesh(a,b,c){let d=this.toTopic(a);this.meshPeerInclusionEvents.inc({topic:d,reason:b},c)},onRemoveFromMesh(a,b,c){let d=this.toTopic(a);this.meshPeerChurnEvents.inc({topic:d,reason:b},c)},onReportValidationMcacheHit(a){this.asyncValidationMcacheHit.inc({hit:a?"hit":"miss"})},onReportValidation(a,b){let c=this.toTopic(a);this.asyncValidationResult.inc({topic:c,acceptance:b})},onScorePenalty(a){this.scoringPenalties.inc({penalty:a},1)},onIhaveRcv(a,b,c){let d=this.toTopic(a);this.ihaveRcvMsgids.inc({topic:d},b),this.ihaveRcvNotSeenMsgids.inc({topic:d},c)},onIwantRcv(a,b){for(let[c,d]of a){let e=this.toTopic(c);this.iwantRcvMsgids.inc({topic:e},d)}this.iwantRcvDonthaveMsgids.inc(b)},onForwardMsg(a,b){let c=this.toTopic(a);this.msgForwardCount.inc({topic:c},1),this.msgForwardPeers.inc({topic:c},b)},onPublishMsg(a,b,c,d){let e=this.toTopic(a);this.msgPublishCount.inc({topic:e},1),this.msgPublishBytes.inc({topic:e},c*d),this.msgPublishPeers.inc({topic:e},c),this.msgPublishPeersByGroup.inc({topic:e,peerGroup:"direct"},b.direct),this.msgPublishPeersByGroup.inc({topic:e,peerGroup:"floodsub"},b.floodsub),this.msgPublishPeersByGroup.inc({topic:e,peerGroup:"mesh"},b.mesh),this.msgPublishPeersByGroup.inc({topic:e,peerGroup:"fanout"},b.fanout)},onMsgRecvPreValidation(a){let b=this.toTopic(a);this.msgReceivedPreValidation.inc({topic:b},1)},onMsgRecvResult(a,b){let c=this.toTopic(a);this.msgReceivedStatus.inc({topic:c,status:b})},onMsgRecvInvalid(a,b){let c=this.toTopic(a),d=b.reason===ak.Error?b.error:b.reason;this.msgReceivedInvalid.inc({topic:c,error:d},1)},onDuplicateMsgDelivery(a,b,c){if(this.duplicateMsgDeliveryDelay.observe(b/1e3),c){let d=this.toTopic(a);this.duplicateMsgLateDelivery.inc({topic:d},1)}},onRpcRecv(a,b){this.rpcRecvBytes.inc(b),this.rpcRecvCount.inc(1),this.rpcRecvSubscription.inc(a.subscriptions.length),this.rpcRecvMessage.inc(a.messages.length),a.control&&(this.rpcRecvControl.inc(1),this.rpcRecvIHave.inc(a.control.ihave.length),this.rpcRecvIWant.inc(a.control.iwant.length),this.rpcRecvGraft.inc(a.control.graft.length),this.rpcRecvPrune.inc(a.control.prune.length))},onRpcSent(a,b){if(this.rpcSentBytes.inc(b),this.rpcSentCount.inc(1),this.rpcSentSubscription.inc(a.subscriptions.length),this.rpcSentMessage.inc(a.messages.length),a.control){let c=a.control.ihave.length,d=a.control.iwant.length,e=a.control.graft.length,f=a.control.prune.length;c>0&&this.rpcSentIHave.inc(c),d>0&&this.rpcSentIWant.inc(d),e>0&&this.rpcSentGraft.inc(e),f>0&&this.rpcSentPrune.inc(f),(c>0||d>0||e>0||f>0)&&this.rpcSentControl.inc(1)}},registerScores(a,b){let c=0,d=0,e=0,f=0;for(let g of a)g>=b.graylistThreshold&&c++,g>=b.publishThreshold&&d++,g>=b.gossipThreshold&&e++,g>=0&&f++;this.peersByScoreThreshold.set({threshold:at.graylist},c),this.peersByScoreThreshold.set({threshold:at.publish},d),this.peersByScoreThreshold.set({threshold:at.gossip},e),this.peersByScoreThreshold.set({threshold:at.mesh},f),this.score.set(a)},registerScoreWeights(a){for(let[b,c]of a.byTopic)this.scoreWeights.set({topic:b,p:"p1"},c.p1w),this.scoreWeights.set({topic:b,p:"p2"},c.p2w),this.scoreWeights.set({topic:b,p:"p3"},c.p3w),this.scoreWeights.set({topic:b,p:"p3b"},c.p3bw),this.scoreWeights.set({topic:b,p:"p4"},c.p4w);this.scoreWeights.set({p:"p5"},a.p5w),this.scoreWeights.set({p:"p6"},a.p6w),this.scoreWeights.set({p:"p7"},a.p7w)},registerScorePerMesh(a,b){let c=new Map;for(let[d,e]of(a.forEach((a,b)=>{let d=this.topicStrToLabel.get(b)??"unknown",e=c.get(d);e||(e=new Set,c.set(d,e)),a.forEach(a=>e?.add(a))}),c)){let f=[];e.forEach(a=>{f.push(b.get(a)??0)}),this.scorePerMesh.set({topic:d},f)}}}}(GF=ao||(ao={})).forward="forward",GF.publish="publish",(GG=ap||(ap={})).Fanout="fanout",GG.Random="random",GG.Subscribed="subscribed",GG.Outbound="outbound",GG.NotEnough="not_enough",GG.Opportunistic="opportunistic",(GH=aq||(aq={})).Dc="disconnected",GH.BadScore="bad_score",GH.Prune="prune",GH.Unsub="unsubscribed",GH.Excess="excess",(GI=ar||(ar={})).GraftBackoff="graft_backoff",GI.BrokenPromise="broken_promise",GI.MessageDeficit="message_deficit",GI.IPColocation="IP_colocation",(GJ=as||(as={})).LowScore="low_score",GJ.MaxIhave="max_ihave",GJ.MaxIasked="max_iasked",(GK=at||(at={})).graylist="graylist",GK.publish="publish",GK.gossip="gossip",GK.mesh="mesh";var xK=c(29309);let xL=(0,cB.fromString)("libp2p-pubsub:");async function xM(a,b,c){switch(a.type){case ai.Signing:{let d={from:a.author.toBytes(),data:c,seqno:(0,xK.randomBytes)(8),topic:b,signature:void 0,key:void 0},e=(0,d7.concat)([xL,ag.Message.encode(d)]);return d.signature=await a.privateKey.sign(e),d.key=a.key,d}case ai.Author:return{from:a.author.toBytes(),data:c,seqno:(0,xK.randomBytes)(8),topic:b,signature:void 0,key:void 0};case ai.Anonymous:return{from:void 0,data:c,seqno:void 0,topic:b,signature:void 0,key:void 0}}}async function xN(a,b){switch(a){case wV:if(null!=b.signature)return{valid:!1,error:al.SignaturePresent};if(null!=b.seqno)return{valid:!1,error:al.SeqnoPresent};if(null!=b.key)return{valid:!1,error:al.FromPresent};return{valid:!0,fromPeerId:null};case wU:{if(null==b.seqno||8!==b.seqno.length)return{valid:!1,error:al.InvalidSeqno};if(null==b.signature)return{valid:!1,error:al.InvalidSignature};if(null==b.from)return{valid:!1,error:al.InvalidPeerId};let c;try{c=dM(b.from)}catch(d){return{valid:!1,error:al.InvalidPeerId}}let e;if(b.key){if(e=iG(b.key),void 0!==c.publicKey&&!(0,dz.equals)(e.bytes,c.publicKey))return{valid:!1,error:al.InvalidPeerId}}else{if(null==c.publicKey)return{valid:!1,error:al.InvalidPeerId};e=iG(c.publicKey)}let f={from:b.from,data:b.data,seqno:b.seqno,topic:b.topic,signature:void 0,key:void 0},g=(0,d7.concat)([xL,ag.Message.encode(f)]);if(!await e.verify(g,b.signature))return{valid:!1,error:al.InvalidSignature};return{valid:!0,fromPeerId:c}}}}let xO=(a,b)=>{let c=(0,cB.fromString)(b.toString(16).padStart(16,"0"),"base16"),d=new Uint8Array(a.length+c.length);return d.set(a,0),d.set(c,a.length),d};function xP(a){if(null==a.sequenceNumber)throw Error("missing seqno field");return xO(a.from.toBytes(),a.sequenceNumber)}async function xQ(a){return await dA.sha256.encode(a.data)}function xR(a,b,c,d,e){let f=0,g=new Map;if(Object.entries(b.topics).forEach(([a,b])=>{let d=e.get(a)??"unknown",h=c.topics[a];if(void 0===h)return;let i=g.get(d);i||(i={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},g.set(d,i));let j=0,k=0,l=0,m=0,n=0;if(b.inMesh){let o=Math.max(b.meshTime/h.timeInMeshQuantum,h.timeInMeshCap);j+=o*h.timeInMeshWeight}let p=b.firstMessageDeliveries;if(p>h.firstMessageDeliveriesCap&&(p=h.firstMessageDeliveriesCap),k+=p*h.firstMessageDeliveriesWeight,b.meshMessageDeliveriesActive&&b.meshMessageDeliveries<h.meshMessageDeliveriesThreshold){let q=h.meshMessageDeliveriesThreshold-b.meshMessageDeliveries,r=q*q;l+=r*h.meshMessageDeliveriesWeight}let s=b.meshFailurePenalty;m+=s*h.meshFailurePenaltyWeight;let t=b.invalidMessageDeliveries*b.invalidMessageDeliveries;n+=t*h.invalidMessageDeliveriesWeight,f+=(j+k+l+m+n)*h.topicWeight,i.p1w+=j,i.p2w+=k,i.p3w+=l,i.p3bw+=m,i.p4w+=n}),c.topicScoreCap>0&&f>c.topicScoreCap){f=c.topicScoreCap;let h=c.topicScoreCap/f;for(let i of g.values())i.p1w*=h,i.p2w*=h,i.p3w*=h,i.p3bw*=h,i.p4w*=h}let j=0,k=0,l=0,m=c.appSpecificScore(a);j+=m*c.appSpecificWeight,b.ips.forEach(a=>{if(c.IPColocationFactorWhitelist.has(a))return;let b=d.get(a),e=b?b.size:0;if(e>c.IPColocationFactorThreshold){let f=e-c.IPColocationFactorThreshold,g=f*f;k+=g*c.IPColocationFactorWeight}});let n=b.behaviourPenalty*b.behaviourPenalty;return l+=n*c.behaviourPenaltyWeight,f+=j+k+l,{byTopic:g,p5w:j,p6w:k,p7w:l,score:f}}function xS(a,b,c,d,e){let f={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let g of a){let h=b.get(g);if(h){let i=xR(g,h,c,d,e);for(let[j,k]of i.byTopic){let l=f.byTopic.get(j);l||(l={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},f.byTopic.set(j,l)),l.p1w.push(k.p1w),l.p2w.push(k.p2w),l.p3w.push(k.p3w),l.p3bw.push(k.p3bw),l.p4w.push(k.p4w)}f.p5w.push(i.p5w),f.p6w.push(i.p6w),f.p7w.push(i.p7w),f.score.push(i.score)}else f.p5w.push(0),f.p6w.push(0),f.p7w.push(0),f.score.push(0)}return f}function xT(a,b,c=()=>!0){let d=new Set;if(b<=0)return d;for(let e of a){if(d.size>=b)break;c(e)&&(d.add(e),a.delete(e))}return d}function xU(a,b){return xT(a,b,()=>!0)}(GL=au||(au={}))[GL.started=0]="started",GL[GL.stopped=1]="stopped";class xV extends vG{constructor(a={}){super(),this.multicodecs=[wj,wi],this.peers=new Map,this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new xE,this.directPeerInitial=null,this.status={code:au.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let a=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(a=>{this.log("Error running heartbeat",a)}).finally(()=>{if(null!=a&&a(),this.status.code===au.started){clearTimeout(this.status.heartbeatTimeout);let b=(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;b<.25*this.opts.heartbeatInterval&&(b+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,b)}})};let b={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:wk,Dlo:wl,Dhi:wm,Dscore:wn,Dout:wo,Dlazy:wr,heartbeatInterval:wv,fanoutTTL:ww,mcacheLength:wp,mcacheGossip:wq,seenTTL:wI,gossipsubIWantFollowupMs:wH,prunePeers:wx,pruneBackoff:wy,graftFloodThreshold:wE,opportunisticGraftPeers:wD,opportunisticGraftTicks:wC,directConnectTicks:wA,...a,scoreParams:w_(a.scoreParams),scoreThresholds:w4(a.scoreThresholds)};if(this.globalSignaturePolicy=b.globalSignaturePolicy??wU,b.fallbackToFloodsub&&this.multicodecs.push(wh),this.log=a6(b.debugName??"libp2p:gossipsub"),this.opts=b,this.direct=new Set(b.directPeers.map(a=>a.id.toString())),this.seenCache=new xI({validityMs:b.seenTTL}),this.publishedMessageIds=new xI({validityMs:b.seenTTL}),a.msgIdFn)this.msgIdFn=a.msgIdFn;else switch(this.globalSignaturePolicy){case wU:this.msgIdFn=xP;break;case wV:this.msgIdFn=xQ}if(a.fastMsgIdFn&&(this.fastMsgIdFn=a.fastMsgIdFn,this.fastMsgIdCache=new xI({validityMs:b.seenTTL})),this.msgIdToStrFn=a.msgIdToStrFn??wT,this.mcache=a.messageCache||new v6(b.mcacheGossip,b.mcacheLength,this.msgIdToStrFn),a.dataTransform&&(this.dataTransform=a.dataTransform),a.metricsRegister){if(!a.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let c=Math.max(...Object.values(b.scoreParams.topics).map(a=>a.meshMessageDeliveriesWindow),wP),d=xJ(a.metricsRegister,a.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:b.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:c/1e3});for(let e of(d.mcacheSize.addCollect(()=>this.onScrapeMetrics(d)),this.multicodecs))d.protocolsEnabled.set({protocol:e},1);this.metrics=d}else this.metrics=null;this.gossipTracer=new xH(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new xG(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:b.heartbeatInterval})}getPeers(){return[...this.peers.keys()].map(a=>dL(a))}isStarted(){return this.status.code===au.started}async init(a){this.components=a,this.score.init(a)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await wX(this.globalSignaturePolicy,this.components.getPeerId()),await Promise.all(this.opts.directPeers.map(async a=>{await this.components.getPeerStore().addressBook.add(a.id,a.addrs)})),await this.components.getRegistrar().handle(this.multicodecs,this.onIncomingStream.bind(this));let a=vE({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),b=await this.components.getRegistrar().register(this.multicodecs,a),c=setTimeout(this.runHeartbeat,wu);this.status={code:au.started,registrarTopologyId:b,heartbeatTimeout:c,hearbeatStartMs:Date.now()+wu},this.log("started"),this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async a=>await this.connect(a)))}).catch(a=>{this.log(a)})},wB)}async stop(){if(this.log("stopping"),this.status.code!==au.started)return;let{registrarTopologyId:a}=this.status;for(let b of(this.status={code:au.stopped},this.components.getRegistrar().unregister(a),this.peers.values()))b.close();this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({protocol:a,stream:b,connection:c}){if(!this.isStarted())return;let d=c.remotePeer,e=this.addPeer(d,a,c.stat.direction),f=e.attachInboundStream(b);this.pipePeerReadStream(d,f).catch(a=>this.log(a))}onPeerConnected(a,b){this.isStarted()&&(this.log("topology peer connected %p %s",a,b.stat.direction),Promise.resolve().then(async()=>{try{let{stream:c,protocol:d}=await b.newStream(this.multicodecs),e=this.addPeer(a,d,b.stat.direction);await e.attachOutboundStream(c)}catch(f){this.log(f)}this.subscriptions.size>0&&this.sendSubscriptions(a.toString(),Array.from(this.subscriptions),!0)}))}onPeerDisconnected(a){this.log("connection ended %p",a),this.removePeer(a)}addPeer(a,b,c){let d=a.toString(),e=this.peers.get(d);return void 0===e&&(this.log("new peer %p",a),e=new v5({id:a,protocol:b}),this.peers.set(d,e),e.addEventListener("close",()=>this.removePeer(a))),this.score.addPeer(d),b===wh&&this.floodsubPeers.add(d),this.metrics?.peersPerProtocol.inc({protocol:b},1),this.outbound.get(d)||this.outbound.set(d,"outbound"===c),e}removePeer(a){let b=a.toString(),c=this.peers.get(b);if(null!=c)for(let d of(this.metrics?.peersPerProtocol.inc({protocol:c.protocol},-1),this.log("delete peer %p",a),this.peers.delete(b),c.close(),this.topics.values()))d.delete(b);for(let[e,f]of this.mesh)!0===f.delete(b)&&this.metrics?.onRemoveFromMesh(e,aq.Dc,1);for(let g of this.fanout.values())g.delete(b);return this.floodsubPeers.delete(b),this.gossip.delete(b),this.control.delete(b),this.outbound.delete(b),this.score.removePeer(b),this.acceptFromWhitelist.delete(b),c}get started(){return this.status.code===au.started}getMeshPeers(a){let b=this.mesh.get(a);return b?Array.from(b):[]}getSubscribers(a){let b=this.topics.get(a);return(b?Array.from(b):[]).map(a=>dL(a))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(a,b){try{await mk(b,async b=>{for await(let c of b)try{let d=c instanceof Uint8Array?c:c.slice(),e=ag.decode(d);this.metrics?.onRpcRecv(e,d.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(a,e):this.handleReceivedRpc(a,e).catch(a=>this.log(a))}catch(f){this.log(f)}})}catch(c){this.log.error(c),this.onPeerDisconnected(a)}}async handleReceivedRpc(a,b){if(!this.acceptFrom(a.toString())){this.log("received message from unacceptable peer %p",a),this.metrics?.rpcRecvNotAccepted.inc();return}for(let c of(this.log("rpc from %p",a),b.subscriptions.length>0&&(b.subscriptions.forEach(b=>{this.handleReceivedSubscription(a,b)}),this.dispatchEvent(new vI("subscription-change",{detail:{peerId:a,subscriptions:b.subscriptions.filter(a=>null!==a.topic).map(a=>({topic:a.topic??"",subscribe:Boolean(a.subscribe)}))}}))),b.messages)){let d=this.handleReceivedMessage(a,c).catch(a=>this.log(a));this.opts.awaitRpcMessageHandler&&await d}b.control&&await this.handleControlMessage(a.toString(),b.control)}handleReceivedSubscription(a,b){if(null==b.topic)return;this.log("subscription update from %p topic %s",a,b.topic);let c=this.topics.get(b.topic);null==c&&(c=new Set,this.topics.set(b.topic,c)),b.subscribe?c.add(a.toString()):c.delete(a.toString())}async handleReceivedMessage(a,b){this.metrics?.onMsgRecvPreValidation(b.topic);let c=await this.validateReceivedMessage(a,b);switch(this.metrics?.onMsgRecvResult(b.topic,c.code),c.code){case am.duplicate:this.score.duplicateMessage(a.toString(),c.msgIdStr,b.topic),this.mcache.observeDuplicate(c.msgIdStr,a.toString());return;case am.invalid:if(c.msgIdStr){let d=c.msgIdStr;this.score.rejectMessage(a.toString(),d,b.topic,c.reason),this.gossipTracer.rejectMessage(d,c.reason)}else this.score.rejectInvalidMessage(a.toString(),b.topic);this.metrics?.onMsgRecvInvalid(b.topic,c);return;case am.valid:if(this.score.validateMessage(c.messageId.msgIdStr),this.gossipTracer.deliverMessage(c.messageId.msgIdStr),this.mcache.put(c.messageId,b,!this.opts.asyncValidation),this.subscriptions.has(b.topic)){let e=this.components.getPeerId().equals(a);(!e||this.opts.emitSelf)&&(super.dispatchEvent(new vI("gossipsub:message",{detail:{propagationSource:a,msgId:c.messageId.msgIdStr,msg:c.msg}})),super.dispatchEvent(new vI("message",{detail:c.msg})))}this.opts.asyncValidation||this.forwardMessage(c.messageId.msgIdStr,b,a.toString())}}async validateReceivedMessage(a,b){let c=this.fastMsgIdFn?.(b),d=c?this.fastMsgIdCache?.get(c):void 0;if(d)return{code:am.duplicate,msgIdStr:d};let e=await xN(this.globalSignaturePolicy,b);if(!e.valid)return{code:am.invalid,reason:ak.Error,error:e.error};let f;try{let g=b.data??new Uint8Array(0);f=this.dataTransform?this.dataTransform.inboundTransform(b.topic,g):g}catch(h){return this.log("Invalid message, transform failed",h),{code:am.invalid,reason:ak.Error,error:al.TransformFailed}}if(null==b.from)return this.log("Invalid message, transform failed"),{code:am.invalid,reason:ak.Error,error:al.TransformFailed};let i={from:dM(b.from),data:f,sequenceNumber:null==b.seqno?void 0:BigInt(`0x${(0,cE.toString)(b.seqno,"base16")}`),topic:b.topic},j=await this.msgIdFn(i),k=this.msgIdToStrFn(j),l={msgId:j,msgIdStr:k};if(c&&this.fastMsgIdCache?.put(c,k),this.seenCache.has(k))return{code:am.duplicate,msgIdStr:k};this.seenCache.put(k);let m=this.topicValidators.get(b.topic);if(null!=m){let n;try{n=await m(i.topic,i,a)}catch(o){let p=o.code;p===wL&&(n=aj.Ignore),n=p===wK?aj.Reject:aj.Ignore}if(n!==aj.Accept)return{code:am.invalid,reason:wW(n),msgIdStr:k}}return{code:am.valid,messageId:l,msg:i}}getScore(a){return this.score.score(a)}sendSubscriptions(a,b,c){this.sendRpc(a,{subscriptions:b.map(a=>({topic:a,subscribe:c})),messages:[]})}async handleControlMessage(a,b){if(void 0===b)return;let c=this.handleIHave(a,b.ihave),d=this.handleIWant(a,b.iwant),e=await this.handleGraft(a,b.graft);await this.handlePrune(a,b.prune),(c.length||d.length||e.length)&&this.sendRpc(a,wQ(d,{iwant:c,prune:e}))}acceptFrom(a){if(this.direct.has(a))return!0;let b=Date.now(),c=this.acceptFromWhitelist.get(a);if(c&&c.messagesAccepted<wN&&c.acceptUntil>=b)return c.messagesAccepted+=1,!0;let d=this.score.score(a);return d>=wM?this.acceptFromWhitelist.set(a,{messagesAccepted:0,acceptUntil:b+wO}):this.acceptFromWhitelist.delete(a),d>=this.opts.scoreThresholds.graylistThreshold}handleIHave(a,b){if(!b.length)return[];let c=this.score.score(a);if(c<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",a,c),this.metrics?.ihaveRcvIgnored.inc({reason:as.LowScore}),[];let d=(this.peerhave.get(a)??0)+1;if(this.peerhave.set(a,d),d>wG)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",a,d),this.metrics?.ihaveRcvIgnored.inc({reason:as.MaxIhave}),[];let e=this.iasked.get(a)??0;if(e>=wF)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",a,e),this.metrics?.ihaveRcvIgnored.inc({reason:as.MaxIasked}),[];let f=new Map;if(b.forEach(({topicID:a,messageIDs:b})=>{if(!a||!this.mesh.has(a))return;let c=0;b.forEach(a=>{let b=this.msgIdToStrFn(a);!this.seenCache.has(b)&&(f.set(b,a),c++)}),this.metrics?.onIhaveRcv(a,b.length,c)}),!f.size)return[];let g=f.size;g+e>wF&&(g=wF-e),this.log("IHAVE: Asking for %d out of %d messages from %s",g,f.size,a);let h=Array.from(f.values());return wR(h),h=h.slice(0,g),this.iasked.set(a,e+g),this.gossipTracer.addPromise(a,h),[{messageIDs:h}]}handleIWant(a,b){if(!b.length)return[];let c=this.score.score(a);if(c<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",a,c),[];let d=new Map,e=new Map,f=0;return(b.forEach(({messageIDs:b})=>{b.forEach(b=>{let c=this.msgIdToStrFn(b),g=this.mcache.getWithIWantCount(c,a);if(null==g){f++;return}if(e.set(g.msg.topic,1+(e.get(g.msg.topic)??0)),g.count>wt){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",a,b);return}d.set(c,g.msg)})}),this.metrics?.onIwantRcv(e,f),d.size)?(this.log("IWANT: Sending %d messages to %s",d.size,a),Array.from(d.values())):(this.log("IWANT: Could not provide any wanted messages to %s",a),[])}async handleGraft(a,b){let c=[],d=this.score.score(a),e=Date.now(),f=this.opts.doPX;return(b.forEach(({topicID:b})=>{if(!b)return;let g=this.mesh.get(b);if(!g){f=!1;return}if(g.has(a))return;if(this.direct.has(a)){this.log("GRAFT: ignoring request from direct peer %s",a),c.push(b),f=!1;return}let h=this.backoff.get(b)?.get(a);if("number"==typeof h&&e<h){this.log("GRAFT: ignoring backed off peer %s",a),this.score.addPenalty(a,1,ar.GraftBackoff),f=!1;let i=h+this.opts.graftFloodThreshold-this.opts.pruneBackoff;e<i&&this.score.addPenalty(a,1,ar.GraftBackoff),this.addBackoff(a,b),c.push(b);return}if(d<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",a,d,b),c.push(b),f=!1,this.addBackoff(a,b);return}if(g.size>=this.opts.Dhi&&!this.outbound.get(a)){c.push(b),this.addBackoff(a,b);return}this.log("GRAFT: Add mesh link from %s in %s",a,b),this.score.graft(a,b),g.add(a),this.metrics?.onAddToMesh(b,ap.Subscribed,1)}),c.length)?await Promise.all(c.map(b=>this.makePrune(a,b,f))):[]}async handlePrune(a,b){let c=this.score.score(a);for(let{topicID:d,backoff:e,peers:f}of b){if(null==d)continue;let g=this.mesh.get(d);if(!g)return;if(this.log("PRUNE: Remove mesh link to %s in %s",a,d),this.score.prune(a,d),g.has(a)&&(g.delete(a),this.metrics?.onRemoveFromMesh(d,aq.Unsub,1)),"number"==typeof e&&e>0?this.doAddBackoff(a,d,1e3*e):this.addBackoff(a,d),f.length){if(c<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",a,c,d);continue}await this.pxConnect(f)}}}addBackoff(a,b){this.doAddBackoff(a,b,this.opts.pruneBackoff)}doAddBackoff(a,b,c){let d=this.backoff.get(b);d||(d=new Map,this.backoff.set(b,d));let e=Date.now()+c,f=d.get(a)??0;f<e&&d.set(a,e)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((a,b)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",b,a),this.score.addPenalty(b,a,ar.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%wz!=0)return;let a=Date.now();this.backoff.forEach((b,c)=>{b.forEach((c,d)=>{c<a&&b.delete(d)}),0===b.size&&this.backoff.delete(c)})}async directConnect(){let a=[];this.direct.forEach(b=>{let c=this.peers.get(b);c&&c.isWritable||a.push(b)}),await Promise.all(a.map(async a=>await this.connect(a)))}async pxConnect(a){a.length>this.opts.prunePeers&&(wR(a),a=a.slice(0,this.opts.prunePeers));let b=[];await Promise.all(a.map(async a=>{if(!a.peerID)return;let c=dM(a.peerID).toString();if(!this.peers.has(c)){if(!a.signedPeerRecord){b.push(c);return}try{let d=await vt.openAndCertify(a.signedPeerRecord,"libp2p-peer-record"),e=d.peerId;if(!d.peerId.equals(c)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",e,c);return}if(!await this.components.getPeerStore().addressBook.consumePeerRecord(d)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}b.push(c)}catch(f){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),b.length&&await Promise.all(b.map(async a=>await this.connect(a)))}async connect(a){this.log("Initiating connection with %s",a);let b=await this.components.getConnectionManager().openConnection(dL(a));await b.newStream(this.multicodecs)}subscribe(a){if(this.status.code!==au.started)throw Error("Pubsub has not started");if(!this.subscriptions.has(a))for(let b of(this.subscriptions.add(a),this.peers.keys()))this.sendSubscriptions(b,[a],!0);this.join(a)}unsubscribe(a){if(this.status.code!==au.started)throw Error("Pubsub is not started");let b=this.subscriptions.delete(a);if(this.log("unsubscribe from %s - am subscribed %s",a,b),b)for(let c of this.peers.keys())this.sendSubscriptions(c,[a],!1);this.leave(a).catch(a=>{this.log(a)})}join(a){if(this.status.code!==au.started)throw Error("Gossipsub has not started");if(this.mesh.has(a))return;this.log("JOIN %s",a),this.metrics?.onJoin(a);let b=new Set,c=this.fanout.get(a);if(c&&(this.fanout.delete(a),this.fanoutLastpub.delete(a),c.forEach(a=>{!this.direct.has(a)&&this.score.score(a)>=0&&b.add(a)}),this.metrics?.onAddToMesh(a,ap.Fanout,b.size)),b.size<this.opts.D){let d=b.size,e=this.getRandomGossipPeers(a,this.opts.D,a=>!b.has(a)&&!this.direct.has(a)&&this.score.score(a)>=0);e.forEach(a=>{b.add(a)}),this.metrics?.onAddToMesh(a,ap.Random,b.size-d)}this.mesh.set(a,b),b.forEach(b=>{this.log("JOIN: Add mesh link to %s in %s",b,a),this.sendGraft(b,a)})}async leave(a){if(this.status.code!==au.started)throw Error("Gossipsub has not started");this.log("LEAVE %s",a),this.metrics?.onLeave(a);let b=this.mesh.get(a);b&&(await Promise.all(Array.from(b).map(async b=>(this.log("LEAVE: Remove mesh link to %s in %s",b,a),await this.sendPrune(b,a)))),this.mesh.delete(a))}selectPeersToForward(a,b,c){let d=new Set,e=this.topics.get(a);e&&(this.direct.forEach(a=>{e.has(a)&&b!==a&&!c?.has(a)&&d.add(a)}),this.floodsubPeers.forEach(a=>{e.has(a)&&b!==a&&!c?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&d.add(a)}));let f=this.mesh.get(a);return f&&f.size>0&&f.forEach(a=>{b===a||c?.has(a)||d.add(a)}),d}selectPeersToPublish(a){let b=new Set,c={direct:0,floodsub:0,mesh:0,fanout:0},d=this.topics.get(a);if(d){if(this.opts.floodPublish)d.forEach(a=>{this.direct.has(a)?(b.add(a),c.direct++):this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&(b.add(a),c.floodsub++)});else{this.direct.forEach(a=>{d.has(a)&&(b.add(a),c.direct++)}),this.floodsubPeers.forEach(a=>{d.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&(b.add(a),c.floodsub++)});let e=this.mesh.get(a);if(e&&e.size>0)e.forEach(a=>{b.add(a),c.mesh++});else{let f=this.fanout.get(a);if(f&&f.size>0)f.forEach(a=>{b.add(a),c.fanout++});else{let g=this.getRandomGossipPeers(a,this.opts.D,a=>this.score.score(a)>=this.opts.scoreThresholds.publishThreshold);g.size>0&&(this.fanout.set(a,g),g.forEach(a=>{b.add(a),c.fanout++}))}this.fanoutLastpub.set(a,Date.now())}}}return{tosend:b,tosendCount:c}}forwardMessage(a,b,c,d){c&&this.score.deliverMessage(c,a,b.topic);let e=this.selectPeersToForward(b.topic,c,d),f=wQ([b]);e.forEach(a=>{this.sendRpc(a,f)}),this.metrics?.onForwardMsg(b.topic,e.size)}async publish(a,b){let c=this.dataTransform?this.dataTransform.outboundTransform(a,b):b;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");let d=await xM(this.publishConfig,a,c);if(null==d.from)throw Error("PublishError.InvalidMessage");let e={from:dM(d.from),data:b,sequenceNumber:null==d.seqno?void 0:BigInt(`0x${(0,cE.toString)(d.seqno,"base16")}`),topic:a,signature:d.signature,key:d.key},f=await this.msgIdFn(e),g=this.msgIdToStrFn(f);if(this.seenCache.has(g))throw Error("PublishError.Duplicate");let{tosend:h,tosendCount:i}=this.selectPeersToPublish(d.topic),j=!0===this.opts.emitSelf&&this.subscriptions.has(a);if(0===h.size&&!this.opts.allowPublishToZeroPeers&&!j)throw Error("PublishError.InsufficientPeers");this.seenCache.put(g),this.mcache.put({msgId:f,msgIdStr:g},d,!0),this.publishedMessageIds.put(g);let k=wQ([d]);for(let l of h){let m=this.sendRpc(l,k);m||h.delete(l)}return this.metrics?.onPublishMsg(a,i,h.size,null!=d.data?d.data.length:0),j&&(h.add(this.components.getPeerId().toString()),super.dispatchEvent(new vI("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:g,msg:e}})),super.dispatchEvent(new vI("message",{detail:e}))),{recipients:Array.from(h.values()).map(a=>dL(a))}}reportMessageValidationResult(a,b,c){if(c===aj.Accept){let d=this.mcache.validate(a);if(this.metrics?.onReportValidationMcacheHit(null!==d),null!=d){let{message:e,originatingPeers:f}=d;this.score.deliverMessage(b.toString(),a,e.topic),this.forwardMessage(a,d.message,b.toString(),f),this.metrics?.onReportValidation(e.topic,c)}}else{let g=this.mcache.remove(a);if(this.metrics?.onReportValidationMcacheHit(null!==g),g){let h=wW(c),{message:i,originatingPeers:j}=g;for(let k of(this.score.rejectMessage(b.toString(),a,i.topic,h),j))this.score.rejectMessage(k,a,i.topic,h);this.metrics?.onReportValidation(i.topic,c)}}}sendGraft(a,b){let c=[{topicID:b}],d=wQ([],{graft:c});this.sendRpc(a,d)}async sendPrune(a,b){let c=[await this.makePrune(a,b,this.opts.doPX)],d=wQ([],{prune:c});this.sendRpc(a,d)}sendRpc(a,b){let c=this.peers.get(a);if(!c||!c.isWritable)return this.log(`Cannot send RPC to ${a} as there is no open stream to it available`),!1;let d=this.control.get(a);d&&(this.piggybackControl(a,b,d),this.control.delete(a));let e=this.gossip.get(a);e&&(this.piggybackGossip(a,b,e),this.gossip.delete(a));let f=ag.encode(b);return c.write(f),this.metrics?.onRpcSent(b,f.length),!0}piggybackControl(a,b,c){let d=c.graft.filter(({topicID:b})=>(b&&this.mesh.get(b)||new Set).has(a)),e=c.prune.filter(({topicID:b})=>!(b&&this.mesh.get(b)||new Set).has(a));(d.length||e.length)&&(b.control?(b.control.graft=b.control.graft.concat(d),b.control.prune=b.control.prune.concat(e)):b.control={graft:d,prune:e,ihave:[],iwant:[]})}piggybackGossip(a,b,c){b.control||(b.control={ihave:[],iwant:[],graft:[],prune:[]}),b.control.ihave=c}async sendGraftPrune(a,b,c){let d=this.opts.doPX;for(let[e,f]of a){let g=f.map(a=>({topicID:a})),h=[],i=b.get(e);i&&(h=await Promise.all(i.map(async a=>await this.makePrune(e,a,d&&!c.get(e)))),b.delete(e));let j=wQ([],{graft:g,prune:h});this.sendRpc(e,j)}for(let[k,l]of b){let m=await Promise.all(l.map(async a=>await this.makePrune(k,a,d&&!c.get(k)))),n=wQ([],{prune:m});this.sendRpc(k,n)}}emitGossip(a){let b=this.mcache.getGossipIDs(new Set(a.keys()));for(let[c,d]of a)this.doEmitGossip(c,d,b.get(c)??[])}doEmitGossip(a,b,c){if(!c.length||(wR(c),c.length>wF&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",c.length),!b.size))return;let d=this.opts.Dlazy,e=ws*b.size,f=b;e>d&&(d=e),d>f.size?d=f.size:f=wR(Array.from(f)).slice(0,d),f.forEach(b=>{let d=c;c.length>wF&&(d=wR(d.slice()).slice(0,wF)),this.pushGossip(b,{topicID:a,messageIDs:d})})}flush(){for(let[a,b]of this.gossip.entries())this.gossip.delete(a),this.sendRpc(a,wQ([],{ihave:b}));for(let[c,d]of this.control.entries())this.control.delete(c),this.sendRpc(c,wQ([],{graft:d.graft,prune:d.prune}))}pushGossip(a,b){this.log("Add gossip to %s",a);let c=this.gossip.get(a)||[];this.gossip.set(a,c.concat(b))}async makePrune(a,b,c){if(this.score.prune(a,b),this.peers.get(a).protocol===wi)return{topicID:b,peers:[]};let d=BigInt(this.opts.pruneBackoff/1e3);if(!c)return{topicID:b,peers:[],backoff:d};let e=this.getRandomGossipPeers(b,this.opts.prunePeers,b=>b!==a&&this.score.score(b)>=0),f=await Promise.all(Array.from(e).map(async a=>{let b=dL(a);return{peerID:b.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(b)}}));return{topicID:b,peers:f,backoff:d}}async heartbeat(){let{D:a,Dlo:b,Dhi:c,Dscore:d,Dout:e,fanoutTTL:f}=this.opts;this.heartbeatTicks++;let g=new Map,h=a=>{let b=g.get(a);return void 0===b&&(b=this.score.score(a),g.set(a,b)),b},i=new Map,j=new Map,k=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks==0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((f,g)=>{let m=this.topics.get(g),n=new Set,o=new Set;if(l.set(g,o),m){let p=wR(Array.from(m)),q=this.backoff.get(g);for(let r of p){let s=this.peers.get(r);if(s&&wS(s.protocol)&&!f.has(r)&&!this.direct.has(r)){let t=h(r);q&&q.has(r)||!(t>=0)||n.add(r),t>=this.opts.scoreThresholds.gossipThreshold&&o.add(r)}}}let u=(a,b)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",a,g),this.addBackoff(a,g),f.delete(a),h(a)>=this.opts.scoreThresholds.gossipThreshold&&o.add(a),this.metrics?.onRemoveFromMesh(g,b,1);let c=j.get(a);c?c.push(g):j.set(a,[g])},v=(a,b)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",a,g),this.score.graft(a,g),f.add(a),o.delete(a),this.metrics?.onAddToMesh(g,b,1);let c=i.get(a);c?c.push(g):i.set(a,[g])};if(f.forEach(a=>{let b=h(a);b<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",a,b,g),u(a,aq.BadScore),k.set(a,!0))}),f.size<b){let w=a-f.size,x=xU(n,w);x.forEach(a=>{v(a,ap.NotEnough)})}if(f.size>c){let y=Array.from(f);y.sort((a,b)=>h(b)-h(a));let z=0;if((y=y.slice(0,d).concat(wR(y.slice(d)))).slice(0,a).forEach(a=>{this.outbound.get(a)&&z++}),z<e){let A=a=>{let b=y[a];for(let c=a;c>0;c--)y[c]=y[c-1];y[0]=b};if(z>0){let B=z;for(let C=1;C<a&&B>0;C++)this.outbound.get(y[C])&&(A(C),B--)}let D=a-z;for(let E=a;E<y.length&&D>0;E++)this.outbound.get(y[E])&&(A(E),D--)}y.slice(a).forEach(a=>{u(a,aq.Excess)})}if(f.size>=b){let F=0;if(f.forEach(a=>{this.outbound.get(a)&&F++}),F<e){let G=e-F,H=xT(n,G,a=>!0===this.outbound.get(a));H.forEach(a=>{v(a,ap.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks==0&&f.size>1){let I=Array.from(f).sort((a,b)=>h(a)-h(b)),J=Math.floor(f.size/2),K=h(I[J]);if(K<this.opts.scoreThresholds.opportunisticGraftThreshold){let L=this.opts.opportunisticGraftPeers,M=xT(n,L,a=>h(a)>K);for(let N of M)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",N,g),v(N,ap.Opportunistic)}}});let m=Date.now();this.fanoutLastpub.forEach((a,b)=>{a+f<m&&(this.fanout.delete(b),this.fanoutLastpub.delete(b))}),this.fanout.forEach((b,c)=>{let d=this.topics.get(c);b.forEach(a=>{(!d.has(a)||h(a)<this.opts.scoreThresholds.publishThreshold)&&b.delete(a)});let e=this.topics.get(c),f=[],g=new Set;if(l.set(c,g),e){let i=wR(Array.from(e));for(let j of i){let k=this.peers.get(j);if(k&&wS(k.protocol)&&!b.has(j)&&!this.direct.has(j)){let m=h(j);m>=this.opts.scoreThresholds.publishThreshold&&f.push(j),m>=this.opts.scoreThresholds.gossipThreshold&&g.add(j)}}}if(b.size<a){let n=a-b.size;f.slice(0,n).forEach(a=>{b.add(a),g?.delete(a)})}}),this.emitGossip(l),await this.sendGraftPrune(i,j,k),this.flush(),this.mcache.shift(),this.dispatchEvent(new vI("gossipsub:heartbeat"))}getRandomGossipPeers(a,b,c=()=>!0){let d=this.topics.get(a);if(!d)return new Set;let e=[];return d.forEach(a=>{let b=this.peers.get(a);b&&wS(b.protocol)&&c(a)&&e.push(a)}),e=wR(e),b>0&&e.length>b&&(e=e.slice(0,b)),new Set(e)}onScrapeMetrics(a){a.mcacheSize.set(this.mcache.size),a.cacheSize.set({cache:"direct"},this.direct.size),a.cacheSize.set({cache:"seenCache"},this.seenCache.size),a.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),a.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),a.cacheSize.set({cache:"mcache"},this.mcache.size),a.cacheSize.set({cache:"score"},this.score.size),a.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),a.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),a.cacheSize.set({cache:"topics"},this.topics.size),a.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),a.cacheSize.set({cache:"mesh"},this.mesh.size),a.cacheSize.set({cache:"fanout"},this.fanout.size),a.cacheSize.set({cache:"peers"},this.peers.size),a.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),a.cacheSize.set({cache:"gossip"},this.gossip.size),a.cacheSize.set({cache:"control"},this.control.size),a.cacheSize.set({cache:"peerhave"},this.peerhave.size),a.cacheSize.set({cache:"outbound"},this.outbound.size);let b=0;for(let c of this.backoff.values())b+=c.size;for(let[d,e]of(a.cacheSize.set({cache:"backoff"},b),this.topics))a.topicPeersCount.set({topicStr:d},e.size);for(let[f,g]of this.mesh)a.meshPeerCounts.set({topicStr:f},g.size);let h=[],i=new Map;for(let j of(a.behaviourPenalty.reset(),this.peers.keys())){let k=this.score.score(j);h.push(k),i.set(j,k),a.behaviourPenalty.observe(this.score.peerStats.get(j)?.behaviourPenalty??0)}a.registerScores(h,this.opts.scoreThresholds),a.registerScorePerMesh(this.mesh,i);let l=xS(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,a.topicStrToLabel);a.registerScoreWeights(l)}}xV.multicodec=wj;let xW=()=>({gossipsub:new xV({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0})});function xX(){let a={};return a.promise=new Promise((b,c)=>{a.resolve=b,a.reject=c}),a}let xY=a6("libp2p-delegated-peer-routing"),xZ=3e4,x$=4;class x_{constructor(a){if(null==a)throw Error("missing ipfs http client");this.client=a,this.started=!1,this.abortController=new AbortController,this.httpQueue=new dm({concurrency:x$});let{protocol:b,host:c,port:d}=a.getEndpointConfig();xY(`enabled DelegatedPeerRouting via ${b}://${c}:${d}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(a,b={}){xY("findPeer starts: %p",a),b.timeout=b.timeout??xZ,b.signal=cN([this.abortController.signal].concat(null!=b.signal?[b.signal]:[]));let c=xX(),d=xX();this.httpQueue.add(async()=>(c.resolve(),await d.promise));try{for await(let e of(await c.promise,this.client.dht.findPeer(a,b)))if("FINAL_PEER"===e.name){let f={id:e.peer.id,multiaddrs:e.peer.multiaddrs.map(a=>new lC(a.toString())),protocols:[]};return f}}catch(g){throw xY.error("findPeer errored: %o",g),g}finally{d.resolve(),xY("findPeer finished: %p",a)}throw a7(Error("Not found"),"ERR_NOT_FOUND")}async *getClosestPeers(a,b={}){let c,d=bm.CID.asCID(a);c=null!=d?d:dM(a),xY("getClosestPeers starts: %s",c),b.timeout=b.timeout??xZ,b.signal=cN([this.abortController.signal].concat(null!=b.signal?[b.signal]:[]));let e=xX(),f=xX();this.httpQueue.add(async()=>(e.resolve(),await f.promise));try{for await(let g of(await e.promise,this.client.dht.query(c,b)))"PEER_RESPONSE"===g.name&&(yield*g.closer.map(a=>({id:a.id,multiaddrs:a.multiaddrs.map(a=>new lC(a.toString())),protocols:[]})))}catch(h){throw xY.error("getClosestPeers errored:",h),h}finally{f.resolve(),xY("getClosestPeers finished: %b",a)}}}let x0=a6("libp2p:delegated-content-routing"),x1=3e4,x2=4,x3=2;class x4{constructor(a){if(null==a)throw Error("missing ipfs http client");this.client=a,this.started=!1,this.abortController=new AbortController,this.httpQueue=new dm({concurrency:x2}),this.httpQueueRefs=new dm({concurrency:x3});let{protocol:b,host:c,port:d}=a.getEndpointConfig();x0(`enabled DelegatedContentRouting via ${b}://${c}:${d}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async *findProviders(a,b={}){x0("findProviders starts: %c",a),b.timeout=b.timeout??x1,b.signal=cN([this.abortController.signal].concat(null!=b.signal?[b.signal]:[]));let c=xX(),d=xX();this.httpQueue.add(async()=>(c.resolve(),await d.promise));try{for await(let e of(await c.promise,this.client.dht.findProvs(a,b)))"PROVIDER"===e.name&&(yield*e.providers.map(a=>{let b={id:a.id,protocols:[],multiaddrs:a.multiaddrs.map(a=>new lC(a.toString()))};return b}))}catch(f){throw x0.error("findProviders errored:",f),f}finally{d.resolve(),x0("findProviders finished: %c",a)}}async provide(a,b={}){x0("provide starts: %c",a),b.timeout=b.timeout??x1,b.signal=cN([this.abortController.signal].concat(null!=b.signal?[b.signal]:[])),await this.httpQueueRefs.add(async()=>{await this.client.block.stat(a,b),await jC(this.client.dht.provide(a,b))}),x0("provide finished: %c",a)}async put(a,b,c={}){x0("put value start: %b",a),c.timeout=c.timeout??x1,c.signal=cN([this.abortController.signal].concat(null!=c.signal?[c.signal]:[])),await this.httpQueue.add(async()=>{await jC(this.client.dht.put(a,b,c))}),x0("put value finished: %b",a)}async get(a,b={}){return x0("get value start: %b",a),b.timeout=b.timeout??x1,b.signal=cN([this.abortController.signal].concat(null!=b.signal?[b.signal]:[])),await this.httpQueue.add(async()=>{for await(let c of this.client.dht.get(a,b))if("VALUE"===c.name)return x0("get value finished: %b",a),c.value;throw a7(Error("Not found"),"ERR_NOT_FOUND")})}}let x5=a=>Promise.reject(Error(`No base found for "${a}"`));class x6{constructor(a){for(let b of(this._basesByName={},this._basesByPrefix={},this._loadBase=a.loadBase||x5,a.bases))this.addBase(b)}addBase(a){if(this._basesByName[a.name]||this._basesByPrefix[a.prefix])throw Error(`Codec already exists for codec "${a.name}"`);this._basesByName[a.name]=a,this._basesByPrefix[a.prefix]=a}removeBase(a){delete this._basesByName[a.name],delete this._basesByPrefix[a.prefix]}async getBase(a){if(this._basesByName[a])return this._basesByName[a];if(this._basesByPrefix[a])return this._basesByPrefix[a];let b=await this._loadBase(a);return null==this._basesByName[b.name]&&null==this._basesByPrefix[b.prefix]&&this.addBase(b),b}listBases(){return Object.values(this._basesByName)}}let x7=a=>Promise.reject(Error(`No codec found for "${a}"`));class x8{constructor(a){for(let b of(this._codecsByName={},this._codecsByCode={},this._loadCodec=a.loadCodec||x7,a.codecs))this.addCodec(b)}addCodec(a){if(this._codecsByName[a.name]||this._codecsByCode[a.code])throw Error(`Resolver already exists for codec "${a.name}"`);this._codecsByName[a.name]=a,this._codecsByCode[a.code]=a}removeCodec(a){delete this._codecsByName[a.name],delete this._codecsByCode[a.code]}async getCodec(a){let b="string"==typeof a?this._codecsByName:this._codecsByCode;if(b[a])return b[a];let c=await this._loadCodec(a);return null==b[a]&&this.addCodec(c),c}listCodecs(){return Object.values(this._codecsByName)}}let x9=a=>Promise.reject(Error(`No hasher found for "${a}"`));class ya{constructor(a){for(let b of(this._hashersByName={},this._hashersByCode={},this._loadHasher=a.loadHasher||x9,a.hashers))this.addHasher(b)}addHasher(a){if(this._hashersByName[a.name]||this._hashersByCode[a.code])throw Error(`Resolver already exists for codec "${a.name}"`);this._hashersByName[a.name]=a,this._hashersByCode[a.code]=a}removeHasher(a){delete this._hashersByName[a.name],delete this._hashersByCode[a.code]}async getHasher(a){let b="string"==typeof a?this._hashersByName:this._hashersByCode;if(b[a])return b[a];let c=await this._loadHasher(a);return null==b[a]&&this.addHasher(c),c}listHashers(){return Object.values(this._hashersByName)}}function yb(a){try{a=p6(new lC(a))}catch(b){}return a=a.toString()}var yc=()=>{};let yd=a6("ipfs-http-client:lib:error-handler"),ye=a0.bind({ignoreUndefined:!0}),yf=a1.isBrowser||a1.isWebWorker?location.protocol:"http",yg=a1.isBrowser||a1.isWebWorker?location.hostname:"localhost",yh=a1.isBrowser||a1.isWebWorker?location.port:"5001",yi=(a={})=>{let b,c={},d;if("string"==typeof a||lC.isMultiaddr(a))b=new URL(yb(a));else if(a instanceof URL)b=a;else if("string"==typeof a.url||lC.isMultiaddr(a.url))b=new URL(yb(a.url)),c=a;else if(a.url instanceof URL)b=a.url,c=a;else{c=a||{};let e=(c.protocol||yf).replace(":",""),f=(c.host||yg).split(":")[0],g=c.port||yh;b=new URL(`${e}://${f}:${g}`)}if(c.apiPath?b.pathname=c.apiPath:("/"===b.pathname|| void 0===b.pathname)&&(b.pathname="api/v0"),a1.isNode){let h=yc(b);d=c.agent||new h({keepAlive:!0,maxSockets:6})}return{...c,host:b.host,protocol:b.protocol.replace(":",""),port:Number(b.port),apiPath:b.pathname,url:b,agent:d}},yj=async a=>{let b;try{if((a.headers.get("Content-Type")||"").startsWith("application/json")){let c=await a.json();yd(c),b=c.Message||c.message}else b=await a.text()}catch(d){yd("Failed to parse error response",d),b=d.message}let e=new dn.HTTPError(a);throw b&&(b.includes("deadline has elapsed")&&(e=new dn.TimeoutError),b&&b.includes("context deadline exceeded")&&(e=new dn.TimeoutError)),b&&b.includes("request timed out")&&(e=new dn.TimeoutError),b&&(e.message=b),e},yk=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,yl=a=>a.replace(yk,function(a){return"-"+a.toLowerCase()}),ym=a=>"string"==typeof a?cR(a):a;class yn extends dn{constructor(a={}){let b=yi(a);super({timeout:ym(b.timeout||0)||void 0,headers:b.headers,base:`${b.url}`,handleError:yj,transformSearchParams:a=>{let b=new URLSearchParams;for(let[c,d]of a)"undefined"!==d&&"null"!==d&&"signal"!==c&&b.append(yl(c),d),"timeout"!==c||isNaN(d)||b.append(yl(c),d);return b},agent:b.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;let c=this.fetch;this.fetch=(a,d={})=>("string"!=typeof a||a.startsWith("/")||(a=`${b.url}/${a}`),c.call(this,a,ye(d,{method:"POST"})))}}dn.HTTPError;let yo=a=>b=>a(new yn(b),b);function yp(a){return null==a?void 0:"string"==typeof a?a:a.toString(8).padStart(4,"0")}function yq(a){if(null==a)return;let b;if(null!=a.secs&&(b={secs:a.secs,nsecs:a.nsecs}),null!=a.Seconds&&(b={secs:a.Seconds,nsecs:a.FractionalNanoseconds}),Array.isArray(a)&&(b={secs:a[0],nsecs:a[1]}),a instanceof Date){let c=a.getTime(),d=Math.floor(c/1e3);b={secs:d,nsecs:(c-1e3*d)*1e3}}if(Object.prototype.hasOwnProperty.call(b,"secs")){if(null!=b&&null!=b.nsecs&&(b.nsecs<0||b.nsecs>999999999))throw a7(Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return b}}function yr({arg:a,searchParams:b,hashAlg:c,mtime:d,mode:e,...f}={}){b&&(f={...f,...b}),c&&(f.hash=c),null!=d&&(d=yq(d),f.mtime=d.secs,f.mtimeNsecs=d.nsecs),null!=e&&(f.mode=yp(e)),f.timeout&&!isNaN(f.timeout)&&(f.timeout=`${f.timeout}ms`),null==a?a=[]:Array.isArray(a)||(a=[a]);let g=new URLSearchParams(f);return a.forEach(a=>g.append("arg",a)),g}let ys=yo(a=>{async function b(b={}){let c=await (await a.post("bitswap/wantlist",{signal:b.signal,searchParams:yr(b),headers:b.headers})).json();return(c.Keys||[]).map(a=>bm.CID.parse(a["/"]))}return b}),yt=yo(a=>{async function b(b,c={}){let d=await (await a.post("bitswap/wantlist",{signal:c.signal,searchParams:yr({...c,peer:b.toString()}),headers:c.headers})).json();return(d.Keys||[]).map(a=>bm.CID.parse(a["/"]))}return b}),yu=yo(a=>{async function b(b={}){let c=await a.post("bitswap/stat",{searchParams:yr(b),signal:b.signal,headers:b.headers});return yv(await c.json())}return b});function yv(a){return{provideBufLen:a.ProvideBufLen,wantlist:(a.Wantlist||[]).map(a=>bm.CID.parse(a["/"])),peers:(a.Peers||[]).map(a=>dL(a)),blocksReceived:BigInt(a.BlocksReceived),dataReceived:BigInt(a.DataReceived),blocksSent:BigInt(a.BlocksSent),dataSent:BigInt(a.DataSent),dupBlksReceived:BigInt(a.DupBlksReceived),dupDataReceived:BigInt(a.DupDataReceived)}}let yw=yo(a=>{async function b(b,c={}){let d=await a.post("bitswap/unwant",{signal:c.signal,searchParams:yr({arg:b.toString(),...c}),headers:c.headers});return d.json()}return b});function yx(a){return{wantlist:ys(a),wantlistForPeer:yt(a),unwant:yw(a),stat:yu(a)}}let yy=yo(a=>{async function b(b,c={}){let d=await a.post("block/get",{signal:c.signal,searchParams:yr({arg:b.toString(),...c}),headers:c.headers});return new Uint8Array(await d.arrayBuffer())}return b});async function yz(a){if(mt(a))return new Blob([a]);if("string"==typeof a||a instanceof String)return new Blob([a.toString()]);if(mu(a))return a;if(mw(a)&&(a=mq(a)),Symbol.iterator in a||Symbol.asyncIterator in a){let b=ms(a),{value:c,done:d}=await b.peek();if(d)return yA(b);if(b.push(c),Number.isInteger(c))return new Blob([Uint8Array.from(await jA(b))]);if(mt(c)||"string"==typeof c||c instanceof String)return yA(b)}throw a7(Error(`Unexpected input: ${a}`),"ERR_UNEXPECTED_INPUT")}async function yA(a){let b=[];for await(let c of a)b.push(c);return new Blob(b)}function yB(a){return nC(a,yz,!0)}function yC(a){return null==a?void 0:"string"==typeof a?a:a.toString(8).padStart(4,"0")}async function yD(a,b,c={}){let d=[],e=new FormData,f=0,g=0;for await(let{content:h,path:i,mode:j,mtime:k}of yB(a)){let l="",m=h?"file":"dir";f>0&&(l=`-${f}`);let n=m+l,o=[];if(null!=j&&o.push(`mode=${yC(j)}`),null!=k){let{secs:p,nsecs:q}=k;o.push(`mtime=${p}`),null!=q&&o.push(`mtime-nsecs=${q}`)}if(o.length&&(n=`${n}?${o.join("&")}`),h){e.set(n,h,null!=i?encodeURIComponent(i):void 0);let r=g+h.size;d.push({name:i,start:g,end:r}),g=r}else if(null!=i)e.set(n,new File([""],encodeURIComponent(i),{type:"application/x-directory"}));else throw Error("path or content or both must be set");f++}return{total:g,parts:d,headers:c,body:e}}function yE(a){return a.filter(Boolean)}function yF(...a){return(0,cN.anySignal)(yE(a))}let yG=yo(a=>{async function b(c,d={}){let e=new AbortController,f=yF(e.signal,d.signal),g;try{let h=await a.post("block/put",{signal:f,searchParams:yr(d),...await yD([c],e,d.headers)});g=await h.json()}catch(i){if("dag-pb"===d.format)return b(c,{...d,format:"protobuf"});if("dag-cbor"===d.format)return b(c,{...d,format:"cbor"});throw i}return bm.CID.parse(g.Key)}return b}),yH=yo(a=>{async function*b(b,c={}){Array.isArray(b)||(b=[b]);let d=await a.post("block/rm",{signal:c.signal,searchParams:yr({arg:b.map(a=>a.toString()),"stream-channels":!0,...c}),headers:c.headers});for await(let e of d.ndjson())yield yI(e)}return b});function yI(a){let b={cid:bm.CID.parse(a.Hash)};return a.Error&&(b.error=Error(a.Error)),b}let yJ=yo(a=>{async function b(b,c={}){let d=await a.post("block/stat",{signal:c.signal,searchParams:yr({arg:b.toString(),...c}),headers:c.headers}),e=await d.json();return{cid:bm.CID.parse(e.Key),size:e.Size}}return b});function yK(a){return{get:yy(a),put:yG(a),rm:yH(a),stat:yJ(a)}}let yL=yo(a=>{async function b(b,c={}){let d=await a.post("bootstrap/add",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),{Peers:e}=await d.json();return{Peers:e.map(a=>new lC(a))}}return b}),yM=yo(a=>{async function b(b={}){let c=await a.post("bootstrap/rm",{signal:b.signal,searchParams:yr({...b,all:!0}),headers:b.headers}),{Peers:d}=await c.json();return{Peers:d.map(a=>new lC(a))}}return b}),yN=yo(a=>{async function b(b={}){let c=await a.post("bootstrap/list",{signal:b.signal,searchParams:yr(b),headers:b.headers}),{Peers:d}=await c.json();return{Peers:d.map(a=>new lC(a))}}return b}),yO=yo(a=>{async function b(b={}){let c=await a.post("bootstrap/add",{signal:b.signal,searchParams:yr({...b,default:!0}),headers:b.headers}),{Peers:d}=await c.json();return{Peers:d.map(a=>new lC(a))}}return b}),yP=yo(a=>{async function b(b,c={}){let d=await a.post("bootstrap/rm",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),{Peers:e}=await d.json();return{Peers:e.map(a=>new lC(a))}}return b});function yQ(a){return{add:yL(a),clear:yM(a),list:yN(a),reset:yO(a),rm:yP(a)}}let yR=yo(a=>{async function b(b,c={}){let d=await a.post("config/profile/apply",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return{original:e.OldCfg,updated:e.NewCfg}}return b});function yS(a){if(null==a)return a;let b=/^[A-Z]+$/,c={};return Object.keys(a).reduce((c,d)=>(b.test(d)?c[d.toLowerCase()]=a[d]:b.test(d[0])?c[d[0].toLowerCase()+d.slice(1)]=a[d]:c[d]=a[d],c),c)}let yT=yo(a=>{async function b(b={}){let c=await a.post("config/profile/list",{signal:b.signal,searchParams:yr(b),headers:b.headers}),d=await c.json();return d.map(a=>yS(a))}return b});function yU(a){return{apply:yR(a),list:yT(a)}}let yV=yo(a=>{let b=async(b,c={})=>{if(!b)throw Error("key argument is required");let d=await a.post("config",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return e.Value};return b}),yW=yo(a=>{let b=async(b={})=>{let c=await a.post("config/show",{signal:b.signal,searchParams:yr({...b}),headers:b.headers}),d=await c.json();return d};return b}),yX=yo(a=>{let b=async(b,c={})=>{let d=new AbortController,e=yF(d.signal,c.signal),f=await a.post("config/replace",{signal:e,searchParams:yr(c),...await yD([(0,cB.fromString)(JSON.stringify(b))],d,c.headers)});await f.text()};return b}),yY=yo(a=>{let b=async(b,c,d={})=>{if("string"!=typeof b)throw Error("Invalid key type");let e={...d,...yZ(b,c)},f=await a.post("config",{signal:d.signal,searchParams:yr(e),headers:d.headers});await f.text()};return b}),yZ=(a,b)=>{switch(typeof b){case"boolean":return{arg:[a,b.toString()],bool:!0};case"string":return{arg:[a,b]};default:return{arg:[a,JSON.stringify(b)],json:!0}}};function y$(a){return{getAll:yW(a),get:yV(a),set:yY(a),replace:yX(a),profiles:yU(a)}}let y_=yo(a=>{async function*b(b,c={}){let d=await a.post("dag/export",{signal:c.signal,searchParams:yr({arg:b.toString()}),headers:c.headers});yield*d.iterator()}return b});async function*y0(a,b,c,d,e){let f=async a=>{let b=await c.getCodec(a.code),f=await d(a,e);return b.decode(f)},g=b.split("/").filter(Boolean),h=await f(a),i=a;for(;g.length;){let j=g.shift();if(!j)throw a7(Error(`Could not resolve path "${b}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(h,j))yield{value:h=h[j],remainderPath:g.join("/")};else throw a7(Error(`no link named "${j}" under ${i}`),"ERR_NO_LINK");let k=bm.CID.asCID(h);k&&(i=k,h=await f(h))}yield{value:h,remainderPath:""}}let y1=(a,b)=>{let c=yo((b,c)=>{let d=yy(c),e=async(b,c={})=>{if(c.path){let e=c.localResolve?await pR(y0(b,c.path,a,d,c)):await dR(y0(b,c.path,a,d,c)),f=e;if(!f)throw a7(Error("Not found"),"ERR_NOT_FOUND");return f}let g=await a.getCodec(b.code),h=await d(b,c),i=g.decode(h);return{value:i,remainderPath:""}};return e});return c(b)},y2=yo(a=>{async function*b(b,c={}){let d=new AbortController,e=yF(d.signal,c.signal),{headers:f,body:g}=await yD(b,d,c.headers),h=await a.post("dag/import",{signal:e,headers:f,body:g,searchParams:yr({"pin-roots":c.pinRoots})});for await(let{Root:i}of h.ndjson())if(void 0!==i){let{Cid:{"/":j},PinErrorMsg:k}=i;yield{root:{cid:bm.CID.parse(j),pinErrorMsg:k}}}}return b}),y3=(a,b)=>{let c=yo(b=>{let c=async(c,d={})=>{let e={storeCodec:"dag-cbor",hashAlg:"sha2-256",...d},f;if(e.inputCodec){if(!(c instanceof Uint8Array))throw Error("Can only inputCodec on raw bytes that can be decoded");f=c}else{let g=await a.getCodec(e.storeCodec);f=g.encode(c),e.inputCodec=e.storeCodec}let h=new AbortController,i=yF(h.signal,e.signal),j=await b.post("dag/put",{timeout:e.timeout,signal:i,searchParams:yr(e),...await yD([f],h,e.headers)}),k=await j.json();return bm.CID.parse(k.Cid["/"])};return c});return c(b)},y4=yo(a=>{let b=async(b,c={})=>{let d=await a.post("dag/resolve",{signal:c.signal,searchParams:yr({arg:`${b}${c.path?`/${c.path}`.replace(/\/[/]+/g,"/"):""}`,...c}),headers:c.headers}),e=await d.json();return{cid:bm.CID.parse(e.Cid["/"]),remainderPath:e.RemPath}};return b});function y5(a,b){return{export:y_(b),get:y1(a,b),import:y2(b),put:y3(a,b),resolve:y4(b)}}let y6=0,y7=1,y8=2,y9=3,za=4,zb=5,zc=6,zd=7,ze=a=>{if(a.Type===y6)return{name:"SENDING_QUERY",type:a.Type};if(a.Type===y7)return{from:dL(a.ID),name:"PEER_RESPONSE",type:a.Type,messageType:0,messageName:"PUT_VALUE",closer:(a.Responses||[]).map(({ID:a,Addrs:b})=>({id:dL(a),multiaddrs:b.map(a=>new lC(a)),protocols:[]})),providers:(a.Responses||[]).map(({ID:a,Addrs:b})=>({id:dL(a),multiaddrs:b.map(a=>new lC(a)),protocols:[]}))};if(a.Type===y8){let b={id:a.ID??dL(a.ID),multiaddrs:[],protocols:[]};return a.Responses&&a.Responses.length&&(b={id:dL(a.Responses[0].ID),multiaddrs:a.Responses[0].Addrs.map(a=>new lC(a)),protocols:[]}),{name:"FINAL_PEER",type:a.Type,peer:b}}if(a.Type===y9)return{name:"QUERY_ERROR",type:a.Type,error:Error(a.Extra)};if(a.Type===za)return{name:"PROVIDER",type:a.Type,providers:a.Responses.map(({ID:a,Addrs:b})=>({id:dL(a),multiaddrs:b.map(a=>new lC(a)),protocols:[]}))};if(a.Type===zb)return{name:"VALUE",type:a.Type,value:(0,cB.fromString)(a.Extra,"base64pad")};if(a.Type===zc){let c=a.Responses.map(({ID:a})=>dL(a));if(!c.length)throw Error("No peer found");return{name:"ADDING_PEER",type:a.Type,peer:c[0]}}if(a.Type===zd)return{name:"DIALING_PEER",type:a.Type,peer:dL(a.ID)};throw Error("Unknown DHT event type")},zf=yo(a=>{async function*b(b,c={}){let d=await a.post("dht/findpeer",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers});for await(let e of d.ndjson())yield ze(e)}return b}),zg=yo(a=>{async function*b(b,c={}){let d=await a.post("dht/findprovs",{signal:c.signal,searchParams:yr({arg:b.toString(),...c}),headers:c.headers});for await(let e of d.ndjson())yield ze(e)}return b}),zh=yo(a=>{async function*b(b,c={}){let d=await a.post("dht/get",{signal:c.signal,searchParams:yr({arg:b instanceof Uint8Array?(0,cE.toString)(b):b.toString(),...c}),headers:c.headers});for await(let e of d.ndjson())yield ze(e)}return b}),zi=yo(a=>{async function*b(b,c={recursive:!1}){let d=Array.isArray(b)?b:[b],e=await a.post("dht/provide",{signal:c.signal,searchParams:yr({arg:d.map(a=>a.toString()),...c}),headers:c.headers});for await(let f of e.ndjson())yield ze(f)}return b}),zj=yo(a=>{async function*b(b,c,d={}){let e=new AbortController,f=yF(e.signal,d.signal),g=await a.post("dht/put",{signal:f,searchParams:yr({arg:b instanceof Uint8Array?(0,cE.toString)(b):b.toString(),...d}),...await yD([c],e,d.headers)});for await(let h of g.ndjson())yield ze(h)}return b}),zk=yo(a=>{async function*b(b,c={}){let d=await a.post("dht/query",{signal:c.signal,searchParams:yr({arg:b.toString(),...c}),headers:c.headers});for await(let e of d.ndjson())yield ze(e)}return b});function zl(a){return{findPeer:zf(a),findProvs:zg(a),get:zh(a),provide:zi(a),put:zj(a),query:zk(a)}}let zm=yo(a=>{async function b(b={}){let c=await a.post("diag/cmds",{signal:b.signal,searchParams:yr(b),headers:b.headers});return c.json()}return b}),zn=yo(a=>{async function b(b={}){let c=await a.post("diag/net",{signal:b.signal,searchParams:yr(b),headers:b.headers});return c.json()}return b}),zo=yo(a=>{async function b(b={}){let c=await a.post("diag/sys",{signal:b.signal,searchParams:yr(b),headers:b.headers});return c.json()}return b});function zp(a){return{cmds:zm(a),net:zn(a),sys:zo(a)}}let zq=yo(a=>{async function b(b,c,d={}){let e=await a.post("files/chmod",{signal:d.signal,searchParams:yr({arg:b,mode:c,...d}),headers:d.headers});await e.text()}return b}),zr=yo(a=>{async function b(b,c,d={}){let e=Array.isArray(b)?b:[b],f=await a.post("files/cp",{signal:d.signal,searchParams:yr({arg:e.concat(c).map(a=>bm.CID.asCID(a)?`/ipfs/${a}`:a),...d}),headers:d.headers});await f.text()}return b}),zs=yo(a=>{async function b(b,c={}){if(!b||"string"!=typeof b)throw Error("ipfs.files.flush requires a path");let d=await a.post("files/flush",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return bm.CID.parse(e.Cid)}return b});function zt(a){let b=yS(a);return Object.prototype.hasOwnProperty.call(b,"mode")&&(b.mode=parseInt(b.mode,8)),Object.prototype.hasOwnProperty.call(b,"mtime")&&(b.mtime={secs:b.mtime,nsecs:b.mtimeNsecs||0},delete b.mtimeNsecs),b}let zu=yo(a=>{async function*b(b,c={}){if(!b)throw Error("ipfs.files.ls requires a path");let d=await a.post("files/ls",{signal:c.signal,searchParams:yr({arg:bm.CID.asCID(b)?`/ipfs/${b}`:b,long:!0,...c,stream:!0}),headers:c.headers});for await(let e of d.ndjson())if("Entries"in e)for(let f of e.Entries||[])yield zv(zt(f));else yield zv(zt(e))}return b});function zv(a){return a.hash&&(a.cid=bm.CID.parse(a.hash)),delete a.hash,a.type=1===a.type?"directory":"file",a}let zw=yo(a=>{async function b(b,c={}){let d=await a.post("files/mkdir",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers});await d.text()}return b}),zx=yo(a=>{async function b(b,c,d={}){Array.isArray(b)||(b=[b]);let e=await a.post("files/mv",{signal:d.signal,searchParams:yr({arg:b.concat(c),...d}),headers:d.headers});await e.text()}return b});var zy=c(50590);let zz=yo(a=>{async function*b(b,c={}){let d=await a.post("files/read",{signal:c.signal,searchParams:yr({arg:b,count:c.length,...c}),headers:c.headers});yield*zy(d.body)}return b}),zA=yo(a=>{async function b(b,c={}){let d=await a.post("files/rm",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.text();if(""!==e){let f=new dn.HTTPError(d);throw f.message=e,f}}return b}),zB=yo(a=>{async function b(b,c={}){let d=await a.post("files/stat",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return e.WithLocality=e.WithLocality||!1,zC(zt(e))}return b});function zC(a){return a.cid=bm.CID.parse(a.hash),delete a.hash,a}let zD=yo(a=>{async function b(b,c={}){let d=await a.post("files/touch",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers});await d.text()}return b}),zE=yo(a=>{async function b(b,c,d={}){let e=new AbortController,f=yF(e.signal,d.signal),g=await a.post("files/write",{signal:f,searchParams:yr({arg:b,streamChannels:!0,count:d.length,...d}),...await yD([{content:c,path:"arg",mode:yp(d.mode),mtime:yq(d.mtime)}],e,d.headers)});await g.text()}return b});function zF(a){return{chmod:zq(a),cp:zr(a),flush:zs(a),ls:zu(a),mkdir:zw(a),mv:zx(a),read:zz(a),rm:zA(a),stat:zB(a),touch:zD(a),write:zE(a)}}let zG=yo(a=>{let b=async(a,b,c={})=>{throw a7(Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return b}),zH=yo(a=>{async function b(b,c={type:"Ed25519"}){let d=await a.post("key/gen",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return yS(e)}return b}),zI=yo(a=>{async function b(b,c,d,e={}){let f=await a.post("key/import",{signal:e.signal,searchParams:yr({arg:b,pem:c,password:d,...e}),headers:e.headers}),g=await f.json();return yS(g)}return b}),zJ=yo(a=>{let b=async(a,b={})=>{throw a7(Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return b}),zK=yo(a=>{async function b(b={}){let c=await a.post("key/list",{signal:b.signal,searchParams:yr(b),headers:b.headers}),d=await c.json();return(d.Keys||[]).map(a=>yS(a))}return b}),zL=yo(a=>{async function b(b,c,d={}){let e=await a.post("key/rename",{signal:d.signal,searchParams:yr({arg:[b,c],...d}),headers:d.headers});return yS(await e.json())}return b}),zM=yo(a=>{async function b(b,c={}){let d=await a.post("key/rm",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return yS(e.Keys[0])}return b});function zN(a){return{export:zG(a),gen:zH(a),import:zI(a),info:zJ(a),list:zK(a),rename:zL(a),rm:zM(a)}}let zO=yo(a=>{async function b(b,c,d={}){let e=await a.post("log/level",{signal:d.signal,searchParams:yr({arg:[b,c],...d}),headers:d.headers});return yS(await e.json())}return b}),zP=yo(a=>{async function b(b={}){let c=await a.post("log/ls",{signal:b.signal,searchParams:yr(b),headers:b.headers}),d=await c.json();return d.Strings}return b}),zQ=yo(a=>{async function*b(b={}){let c=await a.post("log/tail",{signal:b.signal,searchParams:yr(b),headers:b.headers});yield*c.ndjson()}return b});function zR(a){return{level:zO(a),ls:zP(a),tail:zQ(a)}}let zS=yo(a=>{async function b(b,c={}){let d=await a.post("name/publish",{signal:c.signal,searchParams:yr({arg:`${b}`,...c}),headers:c.headers});return yS(await d.json())}return b}),zT=yo(a=>{async function*b(b,c={}){let d=await a.post("name/resolve",{signal:c.signal,searchParams:yr({arg:b,stream:!0,...c}),headers:c.headers});for await(let e of d.ndjson())yield e.Path}return b}),zU=yo(a=>{async function b(b,c={}){let d=await a.post("name/pubsub/cancel",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers});return yS(await d.json())}return b}),zV=yo(a=>{async function b(b={}){let c=await a.post("name/pubsub/state",{signal:b.signal,searchParams:yr(b),headers:b.headers});return yS(await c.json())}return b}),zW=yo(a=>{async function b(b={}){let c=await a.post("name/pubsub/subs",{signal:b.signal,searchParams:yr(b),headers:b.headers}),d=await c.json();return d.Strings||[]}return b});function zX(a){return{cancel:zU(a),state:zV(a),subs:zW(a)}}function zY(a){return{publish:zS(a),resolve:zT(a),pubsub:zX(a)}}let zZ=yo(a=>{async function b(b,c={}){let d=await a.post("object/data",{signal:c.signal,searchParams:yr({arg:`${b instanceof Uint8Array?bm.CID.decode(b):b}`,...c}),headers:c.headers}),e=await d.arrayBuffer();return new Uint8Array(e,0,e.byteLength)}return b}),z$=yo(a=>{async function b(b,c={}){let d=await a.post("object/get",{signal:c.signal,searchParams:yr({arg:`${b instanceof Uint8Array?bm.CID.decode(b):b}`,dataEncoding:"base64",...c}),headers:c.headers}),e=await d.json();return{Data:(0,cB.fromString)(e.Data,"base64pad"),Links:(e.Links||[]).map(a=>({Name:a.Name,Hash:bm.CID.parse(a.Hash),Tsize:a.Size}))}}return b}),z_=yo(a=>{async function b(b,c={}){let d=await a.post("object/links",{signal:c.signal,searchParams:yr({arg:`${b instanceof Uint8Array?bm.CID.decode(b):b}`,...c}),headers:c.headers}),e=await d.json();return(e.Links||[]).map(a=>({Name:a.Name,Tsize:a.Size,Hash:bm.CID.parse(a.Hash)}))}return b}),z0=yo(a=>{async function b(b={}){let c=await a.post("object/new",{signal:b.signal,searchParams:yr({arg:b.template,...b}),headers:b.headers}),{Hash:d}=await c.json();return bm.CID.parse(d)}return b}),z1=(a,b)=>{let c=yo(c=>{let d=y3(a,b);async function e(a,b={}){return d(a,{...b,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return e});return c(b)},z2=yo(a=>{async function b(b,c={}){let d=await a.post("object/stat",{signal:c.signal,searchParams:yr({arg:`${b}`,...c}),headers:c.headers}),e=await d.json();return{...e,Hash:bm.CID.parse(e.Hash)}}return b}),z3=yo(a=>{async function b(b,c,d={}){let e=await a.post("object/patch/add-link",{signal:d.signal,searchParams:yr({arg:[`${b}`,c.Name||c.name||"",(c.Hash||c.cid||"").toString()||null],...d}),headers:d.headers}),{Hash:f}=await e.json();return bm.CID.parse(f)}return b}),z4=yo(a=>{async function b(b,c,d={}){let e=new AbortController,f=yF(e.signal,d.signal),g=await a.post("object/patch/append-data",{signal:f,searchParams:yr({arg:`${b}`,...d}),...await yD([c],e,d.headers)}),{Hash:h}=await g.json();return bm.CID.parse(h)}return b}),z5=yo(a=>{async function b(b,c,d={}){let e=await a.post("object/patch/rm-link",{signal:d.signal,searchParams:yr({arg:[`${b}`,c.Name||c.name||null],...d}),headers:d.headers}),{Hash:f}=await e.json();return bm.CID.parse(f)}return b}),z6=yo(a=>{async function b(b,c,d={}){let e=new AbortController,f=yF(e.signal,d.signal),g=await a.post("object/patch/set-data",{signal:f,searchParams:yr({arg:[`${b}`],...d}),...await yD([c],e,d.headers)}),{Hash:h}=await g.json();return bm.CID.parse(h)}return b});function z7(a){return{addLink:z3(a),appendData:z4(a),rmLink:z5(a),setData:z6(a)}}function z8(a,b){return{data:zZ(b),get:z$(b),links:z_(b),new:z0(b),put:z1(a,b),stat:z2(b),patch:z7(b)}}let z9=yo(a=>{async function*b(b,c={}){for await(let{path:d,recursive:e,metadata:f}of dT(b)){let g=await a.post("pin/add",{signal:c.signal,searchParams:yr({...c,arg:d,recursive:e,metadata:f?JSON.stringify(f):void 0,stream:!0}),headers:c.headers});for await(let h of g.ndjson()){if(h.Pins){for(let i of h.Pins)yield bm.CID.parse(i);continue}yield bm.CID.parse(h)}}}return b});function Aa(a){let b=z9(a);return yo(()=>{async function a(a,c={}){return dR(b([{path:a,...c}],c))}return a})(a)}function Ab(a,b,c){let d={type:a,cid:bm.CID.parse(b)};return c&&(d.metadata=c),d}let Ac=yo(a=>{async function*b(b={}){let c=[];b.paths&&(c=Array.isArray(b.paths)?b.paths:[b.paths]);let d=await a.post("pin/ls",{signal:b.signal,searchParams:yr({...b,arg:c.map(a=>`${a}`),stream:!0}),headers:b.headers});for await(let e of d.ndjson()){if(e.Keys){for(let f of Object.keys(e.Keys))yield Ab(e.Keys[f].Type,f,e.Keys[f].Metadata);return}yield Ab(e.Type,e.Cid,e.Metadata)}}return b}),Ad=yo(a=>{async function*b(b,c={}){for await(let{path:d,recursive:e}of dT(b)){let f=new URLSearchParams(c.searchParams);f.append("arg",`${d}`),null!=e&&f.set("recursive",String(e));let g=await a.post("pin/rm",{signal:c.signal,headers:c.headers,searchParams:yr({...c,arg:`${d}`,recursive:e})});for await(let h of g.ndjson()){if(h.Pins){yield*h.Pins.map(a=>bm.CID.parse(a));continue}yield bm.CID.parse(h)}}}return b}),Ae=a=>{let b=Ad(a);return yo(()=>{async function a(a,c={}){return dR(b([{path:a,...c}],c))}return a})(a)},Af=({Name:a,Status:b,Cid:c})=>({cid:bm.CID.parse(c),name:a,status:b}),Ag=a=>{if("string"==typeof a&&""!==a)return a;throw TypeError("service name must be passed")},Ah=a=>{if(bm.CID.asCID(a))return a.toString();throw TypeError(`CID instance expected instead of ${typeof a}`)},Ai=({service:a,cid:b,name:c,status:d,all:e})=>{let f=yr({service:Ag(a),name:c,force:!!e||void 0});if(b)for(let g of b)f.append("cid",Ah(g));if(d)for(let h of d)f.append("status",h);return f},Aj=({cid:a,service:b,background:c,name:d,origins:e})=>{let f=yr({arg:Ah(a),service:Ag(b),name:d,background:!!c||void 0});if(e)for(let g of e)f.append("origin",g.toString());return f};function Ak(a){async function b(b,{timeout:c,signal:d,headers:e,...f}){let g=await a.post("pin/remote/add",{timeout:c,signal:d,headers:e,searchParams:Aj({cid:b,...f})});return Af(await g.json())}return b}function Al(a){async function*b({timeout:b,signal:c,headers:d,...e}){let f=await a.post("pin/remote/ls",{timeout:b,signal:c,headers:d,searchParams:Ai(e)});for await(let g of f.ndjson())yield Af(g)}return b}function Am(a){async function b({timeout:b,signal:c,headers:d,...e}){await a.post("pin/remote/rm",{timeout:b,signal:c,headers:d,searchParams:Ai({...e,all:!1})})}return b}function An(a){async function b({timeout:b,signal:c,headers:d,...e}){await a.post("pin/remote/rm",{timeout:b,signal:c,headers:d,searchParams:Ai({...e,all:!0})})}return b}function Ao(a){let b=String(a);if("undefined"===b)throw Error("endpoint is required");return"/"===b[b.length-1]?b.slice(0,-1):b}function Ap(a){return{service:a.Service,endpoint:new URL(a.ApiEndpoint),...a.Stat&&{stat:Aq(a.Stat)}}}function Aq(a){switch(a.Status){case"valid":{let{Pinning:b,Pinned:c,Queued:d,Failed:e}=a.PinCount;return{status:"valid",pinCount:{queued:d,pinning:b,pinned:c,failed:e}}}case"invalid":return{status:"invalid"};default:return{status:a.Status}}}function Ar(a){async function b(b,c){let{endpoint:d,key:e,headers:f,timeout:g,signal:h}=c;await a.post("pin/remote/service/add",{timeout:g,signal:h,searchParams:yr({arg:[b,Ao(d),e]}),headers:f})}return b}function As(a){async function b(b={}){let{stat:c,headers:d,timeout:e,signal:f}=b,g=await a.post("pin/remote/service/ls",{timeout:e,signal:f,headers:d,searchParams:!0===c?yr({stat:c}):void 0}),{RemoteServices:h}=await g.json();return h.map(Ap)}return b}function At(a){async function b(b,c={}){await a.post("pin/remote/service/rm",{signal:c.signal,headers:c.headers,searchParams:yr({arg:b})})}return b}function Au(a){let b=new yn(a);return{add:Ar(b),ls:As(b),rm:At(b)}}function Av(a){let b=new yn(a);return{add:Ak(b),ls:Al(b),rm:Am(b),rmAll:An(b),service:Au(a)}}function Aw(a){return{addAll:z9(a),add:Aa(a),ls:Ac(a),rmAll:Ad(a),rm:Ae(a),remote:Av(a)}}let Ax=a=>Array.isArray(a)?a.map(Ay):a,Ay=a=>(0,cE.toString)(Az(a)),Az=a=>a5.base64url.decode(a),AA=a=>BigInt(`0x${(0,cE.toString)(a5.base64url.decode(a),"base16")}`),AB=a=>a5.base64url.encode((0,cB.fromString)(a)),AC=yo(a=>{async function b(b={}){let{Strings:c}=await (await a.post("pubsub/ls",{signal:b.signal,searchParams:yr(b),headers:b.headers})).json();return Ax(c)||[]}return b}),AD=yo(a=>{async function b(b,c={}){let d=await a.post("pubsub/peers",{signal:c.signal,searchParams:yr({arg:AB(b),...c}),headers:c.headers}),{Strings:e}=await d.json();return e||[]}return b}),AE=yo(a=>{async function b(b,c,d={}){let e=yr({arg:AB(b),...d}),f=new AbortController,g=yF(f.signal,d.signal),h=await a.post("pubsub/pub",{signal:g,searchParams:e,...await yD([c],f,d.headers)});await h.text()}return b}),AF=a6("ipfs-http-client:pubsub:subscribe"),AG=(a,b)=>yo(a=>{async function c(c,d,e={}){e.signal=b.subscribe(c,d,e.signal);let f,g,h=new Promise((a,b)=>{f=a,g=b}),i=setTimeout(()=>f(),1e3);return a.post("pubsub/sub",{signal:e.signal,searchParams:yr({arg:AB(c),...e}),headers:e.headers}).catch(a=>{b.unsubscribe(c,d),g(a)}).then(a=>{clearTimeout(i),a&&(AH(a,{onMessage:a=>{if(d){if("function"==typeof d){d(a);return}"function"==typeof d.handleEvent&&d.handleEvent(a)}},onEnd:()=>b.unsubscribe(c,d),onError:e.onError}),f())}),h}return c})(a);async function AH(a,{onMessage:b,onEnd:c,onError:d}){d=d||AF;try{for await(let e of a.ndjson())try{if(!e.from)continue;b({from:dL(e.from),data:Az(e.data),sequenceNumber:AA(e.seqno),topic:Ay(e.topicIDs[0])})}catch(f){f.message=`Failed to parse pubsub message: ${f.message}`,d(f,!1,e)}}catch(g){AI(g)||d(g,!0)}finally{c()}}let AI=a=>{switch(a.type){case"aborted":case"abort":return!0;default:return"AbortError"===a.name}},AJ=(a,b)=>{async function c(a,c){b.unsubscribe(a,c)}return c};class AK{constructor(){this._subs=new Map}subscribe(a,b,c){let d=this._subs.get(a)||[];if(d.find(a=>a.handler===b))throw Error(`Already subscribed to ${a} with this handler`);let e=new AbortController;return this._subs.set(a,[{handler:b,controller:e}].concat(d)),c&&c.addEventListener("abort",()=>this.unsubscribe(a,b)),e.signal}unsubscribe(a,b){let c=this._subs.get(a)||[],d;b?(this._subs.set(a,c.filter(a=>a.handler!==b)),d=c.filter(a=>a.handler===b)):(this._subs.set(a,[]),d=c),(this._subs.get(a)||[]).length||this._subs.delete(a),d.forEach(a=>a.controller.abort())}}function AL(a){let b=new AK;return{ls:AC(a),peers:AD(a),publish:AE(a),subscribe:AG(a,b),unsubscribe:AJ(a,b)}}let AM=yo(a=>{async function*b(b={}){let c=await a.post("refs/local",{signal:b.signal,transform:yS,searchParams:yr(b),headers:b.headers});yield*c.ndjson()}return b}),AN=yo((a,b)=>{let c=async function*(b,c={}){let d=Array.isArray(b)?b:[b],e=await a.post("refs",{signal:c.signal,searchParams:yr({arg:d.map(a=>`${a instanceof Uint8Array?bm.CID.decode(a):a}`),...c}),headers:c.headers,transform:yS});yield*e.ndjson()};return Object.assign(c,{local:AM(b)})}),AO=yo(a=>{async function*b(b={}){let c=await a.post("repo/gc",{signal:b.signal,searchParams:yr(b),headers:b.headers,transform:a=>({err:a.Error?Error(a.Error):null,cid:(a.Key||{})["/"]?bm.CID.parse(a.Key["/"]):null})});yield*c.ndjson()}return b}),AP=yo(a=>{async function b(b={}){let c=await a.post("repo/stat",{signal:b.signal,searchParams:yr(b),headers:b.headers}),d=await c.json();return{numObjects:BigInt(d.NumObjects),repoSize:BigInt(d.RepoSize),repoPath:d.RepoPath,version:d.Version,storageMax:BigInt(d.StorageMax)}}return b}),AQ=yo(a=>{async function b(b={}){let c=await (await a.post("repo/version",{signal:b.signal,searchParams:yr(b),headers:b.headers})).json();return c.Version}return b});function AR(a){return{gc:AO(a),stat:AP(a),version:AQ(a)}}let AS=yo(a=>{async function*b(b={}){let c=await a.post("stats/bw",{signal:b.signal,searchParams:yr(b),headers:b.headers,transform:a=>({totalIn:BigInt(a.TotalIn),totalOut:BigInt(a.TotalOut),rateIn:parseFloat(a.RateIn),rateOut:parseFloat(a.RateOut)})});yield*c.ndjson()}return b});function AT(a){return{bitswap:yu(a),repo:AP(a),bw:AS(a)}}let AU=yo(a=>{async function b(b={}){let c=await a.post("swarm/addrs",{signal:b.signal,searchParams:yr(b),headers:b.headers}),{Addrs:d}=await c.json();return Object.keys(d).map(a=>({id:dL(a),addrs:(d[a]||[]).map(a=>new lC(a))}))}return b}),AV=yo(a=>{async function b(b,c={}){let d=await a.post("swarm/connect",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),{Strings:e}=await d.json();return e||[]}return b}),AW=yo(a=>{async function b(b,c={}){let d=await a.post("swarm/disconnect",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),{Strings:e}=await d.json();return e||[]}return b}),AX=yo(a=>{async function b(b={}){let c=await a.post("swarm/addrs/local",{signal:b.signal,searchParams:yr(b),headers:b.headers}),{Strings:d}=await c.json();return(d||[]).map(a=>new lC(a))}return b}),AY=yo(a=>{async function b(b={}){let c=await a.post("swarm/peers",{signal:b.signal,searchParams:yr(b),headers:b.headers}),{Peers:d}=await c.json();return(d||[]).map(a=>({addr:new lC(a.Addr),peer:dL(a.Peer),muxer:a.Muxer,latency:a.Latency,streams:a.Streams,direction:null==a.Direction?void 0:0===a.Direction?"inbound":"outbound"}))}return b});function AZ(a){return{addrs:AU(a),connect:AV(a),disconnect:AW(a),localAddrs:AX(a),peers:AY(a)}}let A$=yo(a=>{async function*b(b,c={}){let d=new AbortController,e=yF(d.signal,c.signal),{headers:f,body:g,total:h,parts:i}=await yD(b,d,c.headers),[j,k]="function"==typeof c.progress?A_(h,i,c.progress):[void 0,void 0],l=await a.post("add",{searchParams:yr({"stream-channels":!0,...c,progress:Boolean(j)}),onUploadProgress:k,signal:e,headers:f,body:g});for await(let m of l.ndjson())void 0!==(m=yS(m)).hash?yield A1(m):j&&j(m.bytes||0,m.name)}return b}),A_=(a,b,c)=>b?[void 0,A0(a,b,c)]:[c,void 0],A0=(a,b,c)=>{let d=0,e=b.length;return({loaded:f,total:g})=>{let h=Math.floor(f/g*a);for(;d<e;){let{start:i,end:j,name:k}=b[d];if(h<j){c(h-i,k);break}c(j-i,k),d+=1}}};function A1({name:a,hash:b,size:c,mode:d,mtime:e,mtimeNsecs:f}){let g={path:a,cid:bm.CID.parse(b),size:parseInt(c)};return null!=d&&(g.mode=parseInt(d,8)),null!=e&&(g.mtime={secs:e,nsecs:f||0}),g}function A2(a){let b=A$(a);return yo(()=>{async function a(a,c={}){return await dR(b(mC(a),c))}return a})(a)}let A3=yo(a=>{async function*b(b,c={}){let d=await a.post("cat",{signal:c.signal,searchParams:yr({arg:b.toString(),...c}),headers:c.headers});yield*d.iterator()}return b}),A4=yo(a=>{let b=async(b={})=>{let c=await a.post("commands",{signal:b.signal,searchParams:yr(b),headers:b.headers});return c.json()};return b}),A5=yo(a=>{let b=async(b,c={})=>{let d=await a.post("dns",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),e=await d.json();return e.Path};return b}),A6=yo(a=>()=>{let b=new URL(a.opts.base||"");return{host:b.hostname,port:b.port,protocol:b.protocol,pathname:b.pathname,"api-path":b.pathname}}),A7=yo(a=>{async function*b(b,c={}){let d={arg:`${b instanceof Uint8Array?bm.CID.decode(b):b}`,...c};d.compressionLevel&&(d["compression-level"]=d.compressionLevel,delete d.compressionLevel);let e=await a.post("get",{signal:c.signal,searchParams:yr(d),headers:c.headers});yield*e.iterator()}return b}),A8=yo(a=>{async function b(b={}){let c=await a.post("id",{signal:b.signal,searchParams:yr({arg:b.peerId?b.peerId.toString():void 0,...b}),headers:b.headers}),d=await c.json(),e={...yS(d)};return e.id=dL(e.id),e.addresses&&(e.addresses=e.addresses.map(a=>new lC(a))),e}return b}),A9=a=>{let b=A8(a);async function c(a={}){let c=await b(a);return Boolean(c&&c.addresses&&c.addresses.length)}return c},Ba=yo((a,b)=>{async function*c(c,d={}){let e=`${c instanceof Uint8Array?bm.CID.decode(c):c}`;async function f(a){let c=a.Hash;if(c.includes("/")){let d=c.startsWith("/ipfs/")?c:`/ipfs/${c}`,f=await zB(b)(d);c=f.cid}else c=bm.CID.parse(c);let g={name:a.Name,path:e+(a.Name?`/${a.Name}`:""),size:a.Size,cid:c,type:Bb(a)};return a.Mode&&(g.mode=parseInt(a.Mode,8)),void 0!==a.Mtime&&null!==a.Mtime&&(g.mtime={secs:a.Mtime},void 0!==a.MtimeNsecs&&null!==a.MtimeNsecs&&(g.mtime.nsecs=a.MtimeNsecs)),g}let g=await a.post("ls",{signal:d.signal,searchParams:yr({arg:e,...d}),headers:d.headers});for await(let h of g.ndjson()){if(!(h=h.Objects))throw Error("expected .Objects in results");if(!(h=h[0]))throw Error("expected one array in results.Objects");let i=h.Links;if(!Array.isArray(i))throw Error("expected one array in results.Objects[0].Links");if(!i.length){yield f(h);return}yield*i.map(f)}}return c});function Bb(a){switch(a.Type){case 1:case 5:return"dir";default:return"file"}}let Bc=yo(a=>{async function b(b={}){let c=await a.post("dns",{signal:b.signal,searchParams:yr(b),headers:b.headers});return yS(await c.json())}return b}),Bd=yo(a=>{async function*b(b,c={}){let d=await a.post("ping",{signal:c.signal,searchParams:yr({arg:`${b}`,...c}),headers:c.headers,transform:yS});yield*d.ndjson()}return b}),Be=yo(a=>{async function b(b,c={}){let d=await a.post("resolve",{signal:c.signal,searchParams:yr({arg:b,...c}),headers:c.headers}),{Path:e}=await d.json();return e}return b}),Bf=yo(a=>{let b=async(a={})=>{throw a7(Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return b}),Bg=yo(a=>{async function b(b={}){let c=await a.post("shutdown",{signal:b.signal,searchParams:yr(b),headers:b.headers});await c.text()}return b}),Bh=yo(a=>{async function b(b={}){let c=await a.post("version",{signal:b.signal,searchParams:yr(b),headers:b.headers});return{...yS(await c.json()),"ipfs-http-client":"1.0.0"}}return b});function Bi(a={}){let b={name:cr.identity.name,code:cr.identity.code,encode:a=>a,decode:a=>a},c=Object.values(cs.gh);(a.ipld&&a.ipld.bases?a.ipld.bases:[]).forEach(a=>c.push(a));let d=new x6({bases:c,loadBase:a.ipld&&a.ipld.loadBase}),e=Object.values(cs.QB);[aQ,aR,aS,cq,b].concat(a.ipld&&a.ipld.codecs||[]).forEach(a=>e.push(a));let f=new x8({codecs:e,loadCodec:a.ipld&&a.ipld.loadCodec}),g=Object.values(cs.kq);(a.ipld&&a.ipld.hashers?a.ipld.hashers:[]).forEach(a=>g.push(a));let h=new ya({hashers:g,loadHasher:a.ipld&&a.ipld.loadHasher}),i={add:A2(a),addAll:A$(a),bitswap:yx(a),block:yK(a),bootstrap:yQ(a),cat:A3(a),commands:A4(a),config:y$(a),dag:y5(f,a),dht:zl(a),diag:zp(a),dns:A5(a),files:zF(a),get:A7(a),getEndpointConfig:A6(a),id:A8(a),isOnline:A9(a),key:zN(a),log:zR(a),ls:Ba(a),mount:Bc(a),name:zY(a),object:z8(f,a),pin:Aw(a),ping:Bd(a),pubsub:AL(a),refs:AN(a),repo:AR(a),resolve:Be(a),start:Bf(a),stats:AT(a),stop:Bg(a),swarm:AZ(a),version:Bh(a),bases:d,codecs:f,hashers:h};return i}c(63897),c(46953);let Bj=421,Bk=290,Bl=2e3,Bm=Object.create(null);Bm.open="0",Bm.close="1",Bm.ping="2",Bm.pong="3",Bm.message="4",Bm.upgrade="5",Bm.noop="6";let Bn=Object.create(null);Object.keys(Bm).forEach(a=>{Bn[Bm[a]]=a});let Bo={type:"error",data:"parser error"},Bp="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Bq="function"==typeof ArrayBuffer,Br=a=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer instanceof ArrayBuffer,Bs=({type:a,data:b},c,d)=>Bp&&b instanceof Blob?c?d(b):Bt(b,d):Bq&&(b instanceof ArrayBuffer||Br(b))?c?d(b):Bt(new Blob([b]),d):d(Bm[a]+(b||"")),Bt=(a,b)=>{let c=new FileReader;return c.onload=function(){let a=c.result.split(",")[1];b("b"+a)},c.readAsDataURL(a)};var Bu=Bs;let Bv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bw="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let Bx=0;Bx<Bv.length;Bx++)Bw[Bv.charCodeAt(Bx)]=Bx;let By=a=>{let b=.75*a.length,c=a.length,d,e=0,f,g,h,i;"="===a[a.length-1]&&(b--,"="===a[a.length-2]&&b--);let j=new ArrayBuffer(b),k=new Uint8Array(j);for(d=0;d<c;d+=4)f=Bw[a.charCodeAt(d)],g=Bw[a.charCodeAt(d+1)],h=Bw[a.charCodeAt(d+2)],i=Bw[a.charCodeAt(d+3)],k[e++]=f<<2|g>>4,k[e++]=(15&g)<<4|h>>2,k[e++]=(3&h)<<6|63&i;return j},Bz="function"==typeof ArrayBuffer,BA=(a,b)=>{if("string"!=typeof a)return{type:"message",data:BC(a,b)};let c=a.charAt(0);if("b"===c)return{type:"message",data:BB(a.substring(1),b)};let d=Bn[c];return d?a.length>1?{type:Bn[c],data:a.substring(1)}:{type:Bn[c]}:Bo},BB=(a,b)=>{if(!Bz)return{base64:!0,data:a};{let c=By(a);return BC(c,b)}},BC=(a,b)=>"blob"===b?a instanceof ArrayBuffer?new Blob([a]):a:a;var BD=BA;let BE="\x1e",BF=(a,b)=>{let c=a.length,d=Array(c),e=0;a.forEach((a,f)=>{Bu(a,!1,a=>{d[f]=a,++e===c&&b(d.join(BE))})})},BG=(a,b)=>{let c=a.split(BE),d=[];for(let e=0;e<c.length;e++){let f=BD(c[e],b);if(d.push(f),"error"===f.type)break}return d},BH=4;function BI(a){if(a)return BJ(a)}function BJ(a){for(var b in BI.prototype)a[b]=BI.prototype[b];return a}BI.prototype.on=BI.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this},BI.prototype.once=function(a,b){function c(){this.off(a,c),b.apply(this,arguments)}return c.fn=b,this.on(a,c),this},BI.prototype.off=BI.prototype.removeListener=BI.prototype.removeAllListeners=BI.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c,d=this._callbacks["$"+a];if(!d)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var e=0;e<d.length;e++)if((c=d[e])===b||c.fn===b){d.splice(e,1);break}return 0===d.length&&delete this._callbacks["$"+a],this},BI.prototype.emit=function(a){this._callbacks=this._callbacks||{};for(var b=Array(arguments.length-1),c=this._callbacks["$"+a],d=1;d<arguments.length;d++)b[d-1]=arguments[d];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},BI.prototype.emitReserved=BI.prototype.emit,BI.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]},BI.prototype.hasListeners=function(a){return!!this.listeners(a).length};let BK="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function BL(a,...b){return b.reduce((b,c)=>(a.hasOwnProperty(c)&&(b[c]=a[c]),b),{})}let BM=setTimeout,BN=clearTimeout;function BO(a,b){b.useNativeTimers?(a.setTimeoutFn=BM.bind(BK),a.clearTimeoutFn=BN.bind(BK)):(a.setTimeoutFn=setTimeout.bind(BK),a.clearTimeoutFn=clearTimeout.bind(BK))}let BP=1.33;function BQ(a){return"string"==typeof a?BR(a):Math.ceil((a.byteLength||a.size)*BP)}function BR(a){let b=0,c=0;for(let d=0,e=a.length;d<e;d++)(b=a.charCodeAt(d))<128?c+=1:b<2048?c+=2:b<55296||b>=57344?c+=3:(d++,c+=4);return c}class BS extends Error{constructor(a,b,c){super(a),this.description=b,this.context=c,this.type="TransportError"}}class BT extends BI{constructor(a){super(),this.writable=!1,BO(this,a),this.opts=a,this.query=a.query,this.readyState="",this.socket=a.socket}onError(a,b,c){return super.emitReserved("error",new BS(a,b,c)),this}open(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(a){"open"===this.readyState&&this.write(a)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){let b=BD(a,this.socket.binaryType);this.onPacket(b)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}}let BU="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),BV=64,BW={},BX=0,BY=0,BZ;function B$(a){let b="";do b=BU[a%BV]+b,a=Math.floor(a/BV);while(a>0);return b}function B_(){let a=B$(+new Date);return a!==BZ?(BX=0,BZ=a):a+"."+B$(BX++)}for(;BY<BV;BY++)BW[BU[BY]]=BY;function B0(a){let b="";for(let c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b}function B1(a){let b={},c=a.split("&");for(let d=0,e=c.length;d<e;d++){let f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}let B2=!1;try{B2="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(B3){}let B4=B2;function B5(a){let b=a.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!b||B4))return new XMLHttpRequest}catch(c){}if(!b)try{return new BK[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(d){}}function B6(){}let B7=function(){let a=new B5({xdomain:!1});return null!=a.responseType}();class B8 extends BT{constructor(a){if(super(a),this.polling=!1,"undefined"!=typeof location){let b="https:"===location.protocol,c=location.port;c||(c=b?"443":"80"),this.xd="undefined"!=typeof location&&a.hostname!==location.hostname||c!==a.port,this.xs=a.secure!==b}let d=a&&a.forceBase64;this.supportsBinary=B7&&!d}get name(){return"polling"}doOpen(){this.poll()}pause(a){this.readyState="pausing";let b=()=>{this.readyState="paused",a()};if(this.polling||!this.writable){let c=0;this.polling&&(c++,this.once("pollComplete",function(){--c||b()})),this.writable||(c++,this.once("drain",function(){--c||b()}))}else b()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){let b=a=>{if("opening"===this.readyState&&"open"===a.type&&this.onOpen(),"close"===a.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};BG(a,this.socket.binaryType).forEach(b),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){let a=()=>{this.write([{type:"close"}])};"open"===this.readyState?a():this.once("open",a)}write(a){this.writable=!1,BF(a,a=>{this.doWrite(a,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let a=this.query||{},b=this.opts.secure?"https":"http",c="";!1!==this.opts.timestampRequests&&(a[this.opts.timestampParam]=B_()),this.supportsBinary||a.sid||(a.b64=1),this.opts.port&&("https"===b&&443!==Number(this.opts.port)||"http"===b&&80!==Number(this.opts.port))&&(c=":"+this.opts.port);let d=B0(a),e=-1!==this.opts.hostname.indexOf(":");return b+"://"+(e?"["+this.opts.hostname+"]":this.opts.hostname)+c+this.opts.path+(d.length?"?"+d:"")}request(a={}){return Object.assign(a,{xd:this.xd,xs:this.xs},this.opts),new B9(this.uri(),a)}doWrite(a,b){let c=this.request({method:"POST",data:a});c.on("success",b),c.on("error",(a,b)=>{this.onError("xhr post error",a,b)})}doPoll(){let a=this.request();a.on("data",this.onData.bind(this)),a.on("error",(a,b)=>{this.onError("xhr poll error",a,b)}),this.pollXhr=a}}class B9 extends BI{constructor(a,b){super(),BO(this,b),this.opts=b,this.method=b.method||"GET",this.uri=a,this.async=!1!==b.async,this.data=void 0!==b.data?b.data:null,this.create()}create(){let a=BL(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");a.xdomain=!!this.opts.xd,a.xscheme=!!this.opts.xs;let b=this.xhr=new B5(a);try{b.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(let c in b.setDisableHeaderCheck&&b.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(c)&&b.setRequestHeader(c,this.opts.extraHeaders[c])}catch(d){}if("POST"===this.method)try{b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{b.setRequestHeader("Accept","*/*")}catch(f){}"withCredentials"in b&&(b.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(b.timeout=this.opts.requestTimeout),b.onreadystatechange=()=>{4===b.readyState&&(200===b.status||1223===b.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof b.status?b.status:0)},0))},b.send(this.data)}catch(g){this.setTimeoutFn(()=>{this.onError(g)},0);return}"undefined"!=typeof document&&(this.index=B9.requestsCount++,B9.requests[this.index]=this)}onError(a){this.emitReserved("error",a,this.xhr),this.cleanup(!0)}cleanup(a){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=B6,a)try{this.xhr.abort()}catch(b){}"undefined"!=typeof document&&delete B9.requests[this.index],this.xhr=null}}onLoad(){let a=this.xhr.responseText;null!==a&&(this.emitReserved("data",a),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(B9.requestsCount=0,B9.requests={},"undefined"!=typeof document){if("function"==typeof attachEvent)attachEvent("onunload",Cb);else if("function"==typeof addEventListener){let Ca="onpagehide"in BK?"pagehide":"unload";addEventListener(Ca,Cb,!1)}}function Cb(){for(let a in B9.requests)B9.requests.hasOwnProperty(a)&&B9.requests[a].abort()}let Cc=(()=>{let a="function"==typeof Promise&&"function"==typeof Promise.resolve;return a?a=>Promise.resolve().then(a):(a,b)=>b(a,0)})(),Cd=BK.WebSocket||BK.MozWebSocket,Ce=!0,Cf="arraybuffer";var Cg=c(48764).Buffer;let Ch="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class Ci extends BT{constructor(a){super(a),this.supportsBinary=!a.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let a=this.uri(),b=this.opts.protocols,c=Ch?{}:BL(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(c.headers=this.opts.extraHeaders);try{this.ws=Ce&&!Ch?b?new Cd(a,b):new Cd(a):new Cd(a,b,c)}catch(d){return this.emitReserved("error",d)}this.ws.binaryType=this.socket.binaryType||Cf,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let b=0;b<a.length;b++){let c=a[b],d=b===a.length-1;Bu(c,this.supportsBinary,a=>{let b={};if(!Ce&&(c.options&&(b.compress=c.options.compress),this.opts.perMessageDeflate)){let e="string"==typeof a?Cg.byteLength(a):a.length;e<this.opts.perMessageDeflate.threshold&&(b.compress=!1)}try{Ce?this.ws.send(a):this.ws.send(a,b)}catch(f){}d&&Cc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let a=this.query||{},b=this.opts.secure?"wss":"ws",c="";this.opts.port&&("wss"===b&&443!==Number(this.opts.port)||"ws"===b&&80!==Number(this.opts.port))&&(c=":"+this.opts.port),this.opts.timestampRequests&&(a[this.opts.timestampParam]=B_()),this.supportsBinary||(a.b64=1);let d=B0(a),e=-1!==this.opts.hostname.indexOf(":");return b+"://"+(e?"["+this.opts.hostname+"]":this.opts.hostname)+c+this.opts.path+(d.length?"?"+d:"")}check(){return!!Cd}}let Cj={websocket:Ci,polling:B8},Ck=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Cl=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Cm(a){let b=a,c=a.indexOf("["),d=a.indexOf("]");-1!=c&& -1!=d&&(a=a.substring(0,c)+a.substring(c,d).replace(/:/g,";")+a.substring(d,a.length));let e=Ck.exec(a||""),f={},g=14;for(;g--;)f[Cl[g]]=e[g]||"";return -1!=c&& -1!=d&&(f.source=b,f.host=f.host.substring(1,f.host.length-1).replace(/;/g,":"),f.authority=f.authority.replace("[","").replace("]","").replace(/;/g,":"),f.ipv6uri=!0),f.pathNames=Cn(f,f.path),f.queryKey=Co(f,f.query),f}function Cn(a,b){let c=/\/{2,9}/g,d=b.replace(c,"/").split("/");return("/"==b.substr(0,1)||0===b.length)&&d.splice(0,1),"/"==b.substr(b.length-1,1)&&d.splice(d.length-1,1),d}function Co(a,b){let c={};return b.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,b,d){b&&(c[b]=d)}),c}class Cp extends BI{constructor(a,b={}){super(),a&&"object"==typeof a&&(b=a,a=null),a?(a=Cm(a),b.hostname=a.host,b.secure="https"===a.protocol||"wss"===a.protocol,b.port=a.port,a.query&&(b.query=a.query)):b.host&&(b.hostname=Cm(b.host).host),BO(this,b),this.secure=null!=b.secure?b.secure:"undefined"!=typeof location&&"https:"===location.protocol,b.hostname&&!b.port&&(b.port=this.secure?"443":"80"),this.hostname=b.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=b.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=b.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},b),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=B1(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(a){let b=Object.assign({},this.opts.query);b.EIO=BH,b.transport=a,this.id&&(b.sid=this.id);let c=Object.assign({},this.opts.transportOptions[a],this.opts,{query:b,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Cj[a](c)}open(){let a;if(this.opts.rememberUpgrade&&Cp.priorWebsocketSuccess&& -1!==this.transports.indexOf("websocket"))a="websocket";else if(0===this.transports.length){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else a=this.transports[0];this.readyState="opening";try{a=this.createTransport(a)}catch(b){this.transports.shift(),this.open();return}a.open(),this.setTransport(a)}setTransport(a){this.transport&&this.transport.removeAllListeners(),this.transport=a,a.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",a=>this.onClose("transport close",a))}probe(a){let b=this.createTransport(a),c=!1;Cp.priorWebsocketSuccess=!1;let d=()=>{c||(b.send([{type:"ping",data:"probe"}]),b.once("packet",a=>{if(!c){if("pong"===a.type&&"probe"===a.data)this.upgrading=!0,this.emitReserved("upgrading",b),b&&(Cp.priorWebsocketSuccess="websocket"===b.name,this.transport.pause(()=>{!c&&"closed"!==this.readyState&&(j(),this.setTransport(b),b.send([{type:"upgrade"}]),this.emitReserved("upgrade",b),b=null,this.upgrading=!1,this.flush())}));else{let d=Error("probe error");d.transport=b.name,this.emitReserved("upgradeError",d)}}}))};function e(){c||(c=!0,j(),b.close(),b=null)}let f=a=>{let c=Error("probe error: "+a);c.transport=b.name,e(),this.emitReserved("upgradeError",c)};function g(){f("transport closed")}function h(){f("socket closed")}function i(a){b&&a.name!==b.name&&e()}let j=()=>{b.removeListener("open",d),b.removeListener("error",f),b.removeListener("close",g),this.off("close",h),this.off("upgrading",i)};b.once("open",d),b.once("error",f),b.once("close",g),this.once("close",h),this.once("upgrading",i),b.open()}onOpen(){if(this.readyState="open",Cp.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let a=0,b=this.upgrades.length;for(;a<b;a++)this.probe(this.upgrades[a])}}onPacket(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let b=Error("server error");b.code=a.data,this.onError(b);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data)}}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.maxPayload=a.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let a=this.getWritablePackets();this.transport.send(a),this.prevBufferLen=a.length,this.emitReserved("flush")}}getWritablePackets(){let a=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!a)return this.writeBuffer;let b=1;for(let c=0;c<this.writeBuffer.length;c++){let d=this.writeBuffer[c].data;if(d&&(b+=BQ(d)),c>0&&b>this.maxPayload)return this.writeBuffer.slice(0,c);b+=2}return this.writeBuffer}write(a,b,c){return this.sendPacket("message",a,b,c),this}send(a,b,c){return this.sendPacket("message",a,b,c),this}sendPacket(a,b,c,d){if("function"==typeof b&&(d=b,b=void 0),"function"==typeof c&&(d=c,c=null),"closing"===this.readyState||"closed"===this.readyState)return;(c=c||{}).compress=!1!==c.compress;let e={type:a,data:b,options:c};this.emitReserved("packetCreate",e),this.writeBuffer.push(e),d&&this.once("flush",d),this.flush()}close(){let a=()=>{this.onClose("forced close"),this.transport.close()},b=()=>{this.off("upgrade",b),this.off("upgradeError",b),a()},c=()=>{this.once("upgrade",b),this.once("upgradeError",b)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?c():a()}):this.upgrading?c():a()),this}onError(a){Cp.priorWebsocketSuccess=!1,this.emitReserved("error",a),this.onClose("transport error",a)}onClose(a,b){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",a,b),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(a){let b=[],c=0,d=a.length;for(;c<d;c++)~this.transports.indexOf(a[c])&&b.push(a[c]);return b}}function Cq(a,b="",c){let d=a;c=c||"undefined"!=typeof location&&location,null==a&&(a=c.protocol+"//"+c.host),"string"==typeof a&&("/"===a.charAt(0)&&(a="/"===a.charAt(1)?c.protocol+a:c.host+a),/^(https?|wss?):\/\//.test(a)||(a=void 0!==c?c.protocol+"//"+a:"https://"+a),d=Cm(a)),!d.port&&(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/";let e=-1!==d.host.indexOf(":"),f=e?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+f+":"+d.port+b,d.href=d.protocol+"://"+f+(c&&c.port===d.port?"":":"+d.port),d}Cp.protocol=BH,Cp.protocol;let Cr="function"==typeof ArrayBuffer,Cs=a=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a.buffer instanceof ArrayBuffer,Ct=Object.prototype.toString,Cu="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Ct.call(Blob),Cv="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Ct.call(File);function Cw(a){return Cr&&(a instanceof ArrayBuffer||Cs(a))||Cu&&a instanceof Blob||Cv&&a instanceof File}function Cx(a,b){if(!a||"object"!=typeof a)return!1;if(Array.isArray(a)){for(let c=0,d=a.length;c<d;c++)if(Cx(a[c]))return!0;return!1}if(Cw(a))return!0;if(a.toJSON&&"function"==typeof a.toJSON&&1===arguments.length)return Cx(a.toJSON(),!0);for(let e in a)if(Object.prototype.hasOwnProperty.call(a,e)&&Cx(a[e]))return!0;return!1}function Cy(a){let b=[],c=a.data,d=a;return d.data=Cz(c,b),d.attachments=b.length,{packet:d,buffers:b}}function Cz(a,b){if(!a)return a;if(Cw(a)){let c={_placeholder:!0,num:b.length};return b.push(a),c}if(Array.isArray(a)){let d=Array(a.length);for(let e=0;e<a.length;e++)d[e]=Cz(a[e],b);return d}if("object"==typeof a&&!(a instanceof Date)){let f={};for(let g in a)Object.prototype.hasOwnProperty.call(a,g)&&(f[g]=Cz(a[g],b));return f}return a}function CA(a,b){return a.data=CB(a.data,b),a.attachments=void 0,a}function CB(a,b){if(!a)return a;if(a&& !0===a._placeholder){let c="number"==typeof a.num&&a.num>=0&&a.num<b.length;if(c)return b[a.num];throw Error("illegal attachments")}if(Array.isArray(a))for(let d=0;d<a.length;d++)a[d]=CB(a[d],b);else if("object"==typeof a)for(let e in a)Object.prototype.hasOwnProperty.call(a,e)&&(a[e]=CB(a[e],b));return a}let CC=5;(GM=av||(av={}))[GM.CONNECT=0]="CONNECT",GM[GM.DISCONNECT=1]="DISCONNECT",GM[GM.EVENT=2]="EVENT",GM[GM.ACK=3]="ACK",GM[GM.CONNECT_ERROR=4]="CONNECT_ERROR",GM[GM.BINARY_EVENT=5]="BINARY_EVENT",GM[GM.BINARY_ACK=6]="BINARY_ACK";class CD{constructor(a){this.replacer=a}encode(a){return(a.type===av.EVENT||a.type===av.ACK)&&Cx(a)?(a.type=a.type===av.EVENT?av.BINARY_EVENT:av.BINARY_ACK,this.encodeAsBinary(a)):[this.encodeAsString(a)]}encodeAsString(a){let b=""+a.type;return(a.type===av.BINARY_EVENT||a.type===av.BINARY_ACK)&&(b+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(b+=a.nsp+","),null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data,this.replacer)),b}encodeAsBinary(a){let b=Cy(a),c=this.encodeAsString(b.packet),d=b.buffers;return d.unshift(c),d}}class CE extends BI{constructor(a){super(),this.reviver=a}add(a){let b;if("string"==typeof a){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");(b=this.decodeString(a)).type===av.BINARY_EVENT||b.type===av.BINARY_ACK?(this.reconstructor=new CF(b),0===b.attachments&&super.emitReserved("decoded",b)):super.emitReserved("decoded",b)}else if(Cw(a)||a.base64){if(this.reconstructor)(b=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,super.emitReserved("decoded",b));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+a)}decodeString(a){let b=0,c={type:Number(a.charAt(0))};if(void 0===av[c.type])throw Error("unknown packet type "+c.type);if(c.type===av.BINARY_EVENT||c.type===av.BINARY_ACK){let d=b+1;for(;"-"!==a.charAt(++b)&&b!=a.length;);let e=a.substring(d,b);if(e!=Number(e)||"-"!==a.charAt(b))throw Error("Illegal attachments");c.attachments=Number(e)}if("/"===a.charAt(b+1)){let f=b+1;for(;++b;){let g=a.charAt(b);if(","===g||b===a.length)break}c.nsp=a.substring(f,b)}else c.nsp="/";let h=a.charAt(b+1);if(""!==h&&Number(h)==h){let i=b+1;for(;++b;){let j=a.charAt(b);if(null==j||Number(j)!=j){--b;break}if(b===a.length)break}c.id=Number(a.substring(i,b+1))}if(a.charAt(++b)){let k=this.tryParse(a.substr(b));if(CE.isPayloadValid(c.type,k))c.data=k;else throw Error("invalid payload")}return c}tryParse(a){try{return JSON.parse(a,this.reviver)}catch(b){return!1}}static isPayloadValid(a,b){switch(a){case av.CONNECT:return"object"==typeof b;case av.DISCONNECT:return void 0===b;case av.CONNECT_ERROR:return"string"==typeof b||"object"==typeof b;case av.EVENT:case av.BINARY_EVENT:return Array.isArray(b)&&b.length>0;case av.ACK:case av.BINARY_ACK:return Array.isArray(b)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class CF{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){let b=CA(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function CG(a,b,c){return a.on(b,c),function(){a.off(b,c)}}let CH=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class CI extends BI{constructor(a,b,c){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=b,c&&c.auth&&(this.auth=c.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let a=this.io;this.subs=[CG(a,"open",this.onopen.bind(this)),CG(a,"packet",this.onpacket.bind(this)),CG(a,"error",this.onerror.bind(this)),CG(a,"close",this.onclose.bind(this)),]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...b){if(CH.hasOwnProperty(a))throw Error('"'+a+'" is a reserved event name');b.unshift(a);let c={type:av.EVENT,data:b};if(c.options={},c.options.compress=!1!==this.flags.compress,"function"==typeof b[b.length-1]){let d=this.ids++,e=b.pop();this._registerAckCallback(d,e),c.id=d}let f=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,g=this.flags.volatile&&(!f||!this.connected);return g||(this.connected?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(a,b){let c=this.flags.timeout;if(void 0===c){this.acks[a]=b;return}let d=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===a&&this.sendBuffer.splice(c,1);b.call(this,Error("operation has timed out"))},c);this.acks[a]=(...a)=>{this.io.clearTimeoutFn(d),b.apply(this,[null,...a])}}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){"function"==typeof this.auth?this.auth(a=>{this.packet({type:av.CONNECT,data:a})}):this.packet({type:av.CONNECT,data:this.auth})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,b){this.connected=!1,delete this.id,this.emitReserved("disconnect",a,b)}onpacket(a){let b=a.nsp===this.nsp;if(b)switch(a.type){case av.CONNECT:if(a.data&&a.data.sid){let c=a.data.sid;this.onconnect(c)}else this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case av.EVENT:case av.BINARY_EVENT:this.onevent(a);break;case av.ACK:case av.BINARY_ACK:this.onack(a);break;case av.DISCONNECT:this.ondisconnect();break;case av.CONNECT_ERROR:this.destroy();let d=Error(a.data.message);d.data=a.data.data,this.emitReserved("connect_error",d)}}onevent(a){let b=a.data||[];null!=a.id&&b.push(this.ack(a.id)),this.connected?this.emitEvent(b):this.receiveBuffer.push(Object.freeze(b))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length){let b=this._anyListeners.slice();for(let c of b)c.apply(this,a)}super.emit.apply(this,a)}ack(a){let b=this,c=!1;return function(...d){c||(c=!0,b.packet({type:av.ACK,id:a,data:d}))}}onack(a){let b=this.acks[a.id];"function"==typeof b&&(b.apply(this,a.data),delete this.acks[a.id])}onconnect(a){this.id=a,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:av.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){let b=this._anyListeners;for(let c=0;c<b.length;c++)if(a===b[c]){b.splice(c,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){let b=this._anyOutgoingListeners;for(let c=0;c<b.length;c++)if(a===b[c]){b.splice(c,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let b=this._anyOutgoingListeners.slice();for(let c of b)c.apply(this,a.data)}}}function CJ(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}CJ.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=(1&Math.floor(10*b))==0?a-c:a+c}return 0|Math.min(a,this.max)},CJ.prototype.reset=function(){this.attempts=0},CJ.prototype.setMin=function(a){this.ms=a},CJ.prototype.setMax=function(a){this.max=a},CJ.prototype.setJitter=function(a){this.jitter=a};class CK extends BI{constructor(a,b){var c;super(),this.nsps={},this.subs=[],a&&"object"==typeof a&&(b=a,a=void 0),(b=b||{}).path=b.path||"/socket.io",this.opts=b,BO(this,b),this.reconnection(!1!==b.reconnection),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(c=b.randomizationFactor)&& void 0!==c?c:.5),this.backoff=new CJ({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this._readyState="closed",this.uri=a;let d=b.parser||aX;this.encoder=new d.Encoder,this.decoder=new d.Decoder,this._autoConnect=!1!==b.autoConnect,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection}reconnectionAttempts(a){return void 0===a?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var b;return void 0===a?this._reconnectionDelay:(this._reconnectionDelay=a,null===(b=this.backoff)|| void 0===b||b.setMin(a),this)}randomizationFactor(a){var b;return void 0===a?this._randomizationFactor:(this._randomizationFactor=a,null===(b=this.backoff)|| void 0===b||b.setJitter(a),this)}reconnectionDelayMax(a){var b;return void 0===a?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,null===(b=this.backoff)|| void 0===b||b.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(a){if(~this._readyState.indexOf("open"))return this;this.engine=new Cp(this.uri,this.opts);let b=this.engine,c=this;this._readyState="opening",this.skipReconnect=!1;let d=CG(b,"open",function(){c.onopen(),a&&a()}),e=CG(b,"error",b=>{c.cleanup(),c._readyState="closed",this.emitReserved("error",b),a?a(b):c.maybeReconnectOnOpen()});if(!1!==this._timeout){let f=this._timeout;0===f&&d();let g=this.setTimeoutFn(()=>{d(),b.close(),b.emit("error",Error("timeout"))},f);this.opts.autoUnref&&g.unref(),this.subs.push(function(){clearTimeout(g)})}return this.subs.push(d),this.subs.push(e),this}connect(a){return this.open(a)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let a=this.engine;this.subs.push(CG(a,"ping",this.onping.bind(this)),CG(a,"data",this.ondata.bind(this)),CG(a,"error",this.onerror.bind(this)),CG(a,"close",this.onclose.bind(this)),CG(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){this.decoder.add(a)}ondecoded(a){this.emitReserved("packet",a)}onerror(a){this.emitReserved("error",a)}socket(a,b){let c=this.nsps[a];return c||(c=new CI(this,a,b),this.nsps[a]=c),c}_destroy(a){let b=Object.keys(this.nsps);for(let c of b){let d=this.nsps[c];if(d.active)return}this._close()}_packet(a){let b=this.encoder.encode(a);for(let c=0;c<b.length;c++)this.engine.write(b[c],a.options)}cleanup(){this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(a,b){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,b),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let b=this.backoff.duration();this._reconnecting=!0;let c=this.setTimeoutFn(()=>{!a.skipReconnect&&(this.emitReserved("reconnect_attempt",a.backoff.attempts),a.skipReconnect||a.open(b=>{b?(a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",b)):a.onreconnect()}))},b);this.opts.autoUnref&&c.unref(),this.subs.push(function(){clearTimeout(c)})}}onreconnect(){let a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}let CL={};function CM(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};let c=Cq(a,b.path||"/socket.io"),d=c.source,e=c.id,f=c.path,g=CL[e]&&f in CL[e].nsps,h=b.forceNew||b["force new connection"]|| !1===b.multiplex||g,i;return h?i=new CK(d,b):(CL[e]||(CL[e]=new CK(d,b)),i=CL[e]),c.query&&!b.query&&(b.query=c.queryKey),i.socket(c.path,b)}Object.assign(CM,{Manager:CK,Socket:CI,io:CM,connect:CM});let CN=65536,CO=5e3;class CP{constructor(a,b){this.label=a.label,this.open=xX(),this.channel=a,this.channel.binaryType="arraybuffer",this.log=b.log,"number"==typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=CN),a.addEventListener("message",a=>{b.onMessage(a)}),a.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),a.addEventListener("open",()=>{this.open.resolve(),b.onOpen()}),a.addEventListener("close",()=>{b.onClose()}),a.addEventListener("error",c=>{if(c.error?.message==="Transport channel closed")return this.close();b.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',a.readyState,c.error?.message,c.error?.errorDetail);let d=c.error instanceof Error?c.error:Error(`datachannel error: ${c.error?.message} ${c.error?.errorDetail}`);b.onError(a7(d,"ERR_DATA_CHANNEL"))});let c=!1;this.closingInterval=setInterval(()=>{"closing"===a.readyState?(c&&b.onClose(),c=!0):c=!1},CO)}async send(a){await this.open.promise,this.channel.send(a),this.channel.bufferedAmount>CN&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=xX())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var CQ=c(65780);let CR={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function CS(){if("undefined"==typeof globalThis)throw a7(Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");let a={RTCPeerConnection:(globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection)??globalThis.webkitRTCPeerConnection,RTCSessionDescription:(globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription)??globalThis.webkitRTCSessionDescription,RTCIceCandidate:(globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate)??globalThis.webkitRTCIceCandidate};if(null==a.RTCPeerConnection)throw a7(Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return a}class CT extends vG{constructor(a){super(),this.id=a.id??(0,cE.toString)(fI(4),"hex").slice(0,7),this.log=a6(`libp2p:webrtc-peer:${a.logPrefix}:${this.id}`),this.wrtc=a.wrtc??CS(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},CR,a.peerConnectionConfig)),this.closed=!1,this.connected=xX(),this.source=vZ(),this.sink=async a=>{if(await this.connected.promise,null==this.channel)throw a7(Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(let b of a)await this.channel.send(b);await this.close()}}handleDataChannelEvent(a){let b=a.channel;if(null==b){this.close(a7(Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(a=>{this.log("Error closing after event channel was found to be null",a)});return}this.channel=new CP(b,{log:this.log,onMessage:a=>{this.source.push(new Uint8Array(a.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new vI("ready"))},onClose:()=>{this.close().catch(a=>{this.log("error closing connection after channel close",a)})},onError:a=>{this.close(a).catch(a=>{this.log("error closing connection after channel error",a)})}})}async close(a){if(this.closed=!0,null==a&&null!=this.channel)for(;this.channel.bufferedAmount>0;)await CQ(100);this.channel?.close(),this.peerConnection.close(),this.source.end(a),this.dispatchEvent(new vI("close"))}}class CU extends vG{constructor(a){super(),this.log=a.log,this.peerConnection=a.peerConnection,this.wrtc=a.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch(a=>{this.log.error("could not renegotiate %o",a)})})}async handleSignal(a){if(this.log('incoming signal "%s"',a.type),"offer"===a.type)return await this.handleOffer(a);if("answer"===a.type)return await this.handleAnswer(a);if("candidate"===a.type)return await this.handleCandidate(a);if("renegotiate"===a.type)return await this.handleRenegotiate(a);if("goodbye"===a.type)return await this.handleGoodye(a);this.log(`Unknown signal type ${a.type}`)}async handleOffer(a){}async handleAnswer(a){}async handleRenegotiate(a){}async handleGoodye(a){this.peerConnection.close()}async handleCandidate(a){let b=new this.wrtc.RTCIceCandidate(a.candidate);try{await this.peerConnection.addIceCandidate(b)}catch(c){if(null==b.address||b.address.endsWith(".local"))this.log("ignoring unsupported ICE candidate.");else throw a7(c,"ERR_ADD_ICE_CANDIDATE")}}}let CV=a6("libp2p:webrtc-peer:receiver");class CW extends CT{constructor(a={}){super({...a,logPrefix:"receiver"}),this.handshake=new CX({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:a.answerOptions}),this.handshake.addEventListener("signal",a=>this.dispatchEvent(new vI("signal",{detail:a.detail}))),this.peerConnection.addEventListener("datachannel",a=>{this.handleDataChannelEvent(a)})}handleSignal(a){this.handshake.handleSignal(a).catch(b=>{this.log("error handling signal %o %o",a,b)})}}class CX extends CU{constructor(a){super(a),this.options=a,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){CV.trace("renegotiate"),this.dispatchEvent(new vI("signal",{detail:{type:"renegotiate"}}))}async handleOffer(a){for(let b of(await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(a)),this.iceCandidates))await this.handleCandidate(b);this.iceCandidates=[];let c=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(c),CV.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new vI("signal",{detail:this.peerConnection.localDescription??c}))}async handleCandidate(a){if(null==this.peerConnection.remoteDescription||null==this.peerConnection.remoteDescription.type){this.iceCandidates.push(a);return}await super.handleCandidate(a)}}let CY=a=>{let b=a.on||a.addListener||a.addEventListener,c=a.off||a.removeListener||a.removeEventListener;if(!b||!c)throw TypeError("Emitter is not compatible");return{addListener:b.bind(a),removeListener:c.bind(a)}};function CZ(a,b,c){let d,e=new Promise((e,f)=>{if(!((c={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...c}).count>=0&&(c.count===Number.POSITIVE_INFINITY||Number.isInteger(c.count))))throw TypeError("The `count` option should be at least 0 or more");let g=[b].flat(),h=[],{addListener:i,removeListener:j}=CY(a),k=(...a)=>{let b=c.multiArgs?a:a[0];(!c.filter||c.filter(b))&&(h.push(b),c.count===h.length&&(d(),e(h)))},l=a=>{d(),f(a)};for(let m of(d=()=>{for(let a of g)j(a,k);for(let b of c.rejectionEvents)j(b,l)},g))i(m,k);for(let n of c.rejectionEvents)i(n,l);c.resolveImmediately&&e(h)});if(e.cancel=d,"number"==typeof c.timeout){let f=de(e,c.timeout);return f.cancel=d,f}return e}function C$(a,b,c){"function"==typeof c&&(c={filter:c}),c={...c,count:1,resolveImmediately:!1};let d=CZ(a,b,c),e=d.then(a=>a[0]);return e.cancel=d.cancel,e}let C_=a6("libp2p:webrtc-peer:initator"),C0=1e3;class C1 extends CT{constructor(a={}){super({...a,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(a.dataChannelLabel??(0,cE.toString)(fI(20),"hex").slice(0,7),a.dataChannelInit)}),this.handshake=new C2({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:a.offerOptions}),this.handshake.addEventListener("signal",a=>{this.dispatchEvent(new vI("signal",{detail:a.detail}))})}handleSignal(a){this.handshake.handleSignal(a).catch(b=>{this.log("error handling signal %o %o",a,b)})}}class C2 extends CU{constructor(a){super(a),this.options=a,this.status="idle",this.peerConnection.addEventListener("icecandidate",a=>{if(null==a.candidate)return;let b={type:"candidate",candidate:{candidate:a.candidate.candidate,sdpMLineIndex:a.candidate.sdpMLineIndex,sdpMid:a.candidate.sdpMid}};C_.trace("create candidate",b),this.dispatchEvent(new vI("signal",{detail:b})),this.dispatchEvent(new vI("ice-candidate"))})}async handleRenegotiate(){if("negotiating"===this.status){this.log("already negotiating, queueing");return}this.status="negotiating";let a=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(a),await C$(this,"ice-candidate"),await CQ(C0),C_.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new vI("signal",{detail:this.peerConnection.localDescription??a}))}async handleAnswer(a){C_.trace("handle answer",a),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(a)),this.status="idle"}}let C3=a6("libp2p:webrtc-star:socket");function C4(a,b){let{sink:c,source:d}=a,e={remoteAddr:b.remoteAddr,async sink(a){null!=b.signal&&(a=v1(a,b.signal));try{await c(a)}catch(d){"aborted"!==d.type&&C3.error(d)}},source:null!=b.signal?v1(d,b.signal):d,timeline:{open:Date.now()},async close(){if(a.closed)return;let b=Date.now(),c=setTimeout(()=>{if(null!=e.remoteAddr){let{host:c,port:d}=e.remoteAddr.toOptions();C3("timeout closing socket to %s:%s after %dms, destroying it manually",c,d,Date.now()-b)}a.closed||a.close().catch(a=>{C3.error("could not close socket",a)})},Bl);try{await a.close()}finally{clearTimeout(c)}}};return a.addEventListener("close",()=>{null==e.timeline.close&&(e.timeline.close=Date.now())},{once:!0}),e}function C5(a){let b=a.toString().split("/"),c=a.protos()[1].name,d=a.protos()[2].name,e=a.stringTuples()[1][1];if("tcp"!==c||"ws"!==d&&"wss"!==d)throw Error(`invalid multiaddr: ${a.toString()}`);if(!lC.isName(a))return`http://${b[2]}:${b[4]}`;if("ws"===d)return`http://${b[2]}${null==e||"80"===e?"":`:${e}`}`;if("wss"===d)return`https://${b[2]}${null==e||"443"===e?"":`:${e}`}`;throw Error("invalid multiaddr: "+a.toString())}function C6(a){let b="/libp2p-webrtc-star";if(a.startsWith(b)){a=a.substring(b.length,a.length);let c=new lC(a),d=c.stringTuples().filter(a=>421===a[0])[0];if(null==d[1])throw Error("invalid multiaddr: "+a);a=(c=(c=(c=c.decapsulate("p2p")).encapsulate("/p2p-webrtc-star")).encapsulate(`/p2p/${d[1]}`)).toString()}return a}let C7=a6("libp2p:webrtc-star:listener"),C8={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};class C9 extends vG{constructor(a,b,c,d,e){super(),this.signallingAddr=b,this.socket=CM(a,C8),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=c,this.handler=d,this.channelOptions=e,this.handleWsHandshake=this.handleWsHandshake.bind(this),this.socket.once("connect_error",a=>{this.dispatchEvent(new vI("error",{detail:a}))}),this.socket.once("error",a=>{this.dispatchEvent(new vI("error",{detail:a}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",a=>{this.dispatchEvent(new vI("peer",{detail:a}))}),this.socket.on("connect",()=>this.socket.emit("ss-join",b.toString())),this.socket.once("connect",()=>{this.dispatchEvent(new vI("listening"))})}_createChannel(a,b,c){let d={...this.channelOptions},e=new CW(d),f=a=>{let b=a.detail;C7.error("incoming connection errored",b)};return e.addEventListener("error",f),e.addEventListener("close",()=>{e.removeEventListener("error",f)},{once:!0}),e.addEventListener("signal",d=>{let e=d.detail;this.socket.emit("ss-handshake",{intentId:a,srcMultiaddr:b,dstMultiaddr:c,answer:!0,signal:e})}),e.addEventListener("ready",()=>{let b=C4(e,{remoteAddr:this.signallingAddr});C7("new inbound connection %s",b.remoteAddr);try{this.upgrader.upgradeInbound(b).then(c=>{C7("inbound connection %s upgraded",b.remoteAddr),this.connections.push(b);let d=()=>{this.connections=this.connections.filter(a=>a!==b),this.channels.delete(a),this.pendingSignals.delete(a)};e.addEventListener("close",d,{once:!0}),this.dispatchEvent(new vI("connection",{detail:c})),this.handler(c)}).catch(a=>{C7.error("inbound connection failed to upgrade",a),b.close().catch(a=>{C7.error("inbound connection failed to close after failing to upgrade",a)})})}catch(c){C7.error("inbound connection failed to upgrade",c),b.close().catch(a=>{C7.error("inbound connection failed to close after failing to upgrade",a)})}},{once:!0}),e}handleWsHandshake(a){if(C7('incoming handshake. signal type "%s" is answer %s',a.signal.type,a.answer),!0===a.answer||null!=a.err||null==a.intentId)return;let b=a.intentId,c=this.pendingSignals.get(b);null==c&&(c=[],this.pendingSignals.set(b,c)),c.push(a);let d=this.channels.get(b);if(null==d){if("offer"!==a.signal.type){C7("handshake is not an offer and channel does not exist, buffering until we receive an offer");return}C7("creating new channel to handle offer handshake"),d=this._createChannel(a.intentId,a.srcMultiaddr,a.dstMultiaddr),this.channels.set(b,d)}else C7("channel already exists, using it to handle handshake");for(;c.length>0;){let e=c.shift();e?.signal!=null&&d.handleSignal(e.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map(async a=>await a.close()),...Array.from(this.channels.values()).map(async a=>await a.close())]),this.dispatchEvent(new vI("close"))}}class Da extends vG{constructor(a,b,c,d,e){super(),this.upgrader=a,this.handler=b,this.peerId=c,this.transport=d,this.options=e}async listen(a){if(null!=this.listeningAddr)throw a7(Error("listener already in use"),"ERR_ALREADY_LISTENING");let b=xX();this.listeningAddr=a;let c;c=a.protoCodes().includes(Bj)?a:a.encapsulate(`/p2p/${this.peerId.toString()}`),this.signallingUrl=C5(a),C7("connecting to signalling server on: %s",this.signallingUrl);let d=new C9(this.signallingUrl,c,this.upgrader,this.handler,this.options.channelOptions);return d.addEventListener("error",a=>{let c=a.detail;C7("error connecting to signalling server %o",c),d.close().catch(a=>{C7.error("error closing server after error",a)}),b.reject(c)}),d.addEventListener("listening",()=>{C7("connected to signalling server"),this.dispatchEvent(new vI("listening")),b.resolve()}),d.addEventListener("peer",a=>{this.transport.peerDiscovered(a.detail)}),d.addEventListener("connection",b=>{let c=b.detail;if(null==c.remoteAddr)try{c.remoteAddr=a.decapsulateCode(Bj).encapsulate(`/p2p/${c.remotePeer.toString()}`)}catch(d){C7.error("could not determine remote address",d)}this.dispatchEvent(new vI("connection",{detail:c}))}),this.transport.sigServers.set(this.signallingUrl,d),await b.promise}async close(){if(null!=this.signallingUrl){let a=this.transport.sigServers.get(this.signallingUrl);null!=a&&(await a.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new vI("close")),this.listeningAddr=void 0}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}function Db(a,b,c,d,e){return new Da(a,b,c,d,e)}let Dc=Symbol.for("@libp2p/transport"),Dd=Symbol.for("@libp2p/peer-discovery"),De="RTCPeerConnection"in globalThis,Df=a6("libp2p:webrtc-star"),Dg=()=>{};class Dh extends vG{constructor(){super(...arguments),this.started=!1}get[Dd](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(a){return!!this.isStarted()&&super.dispatchEvent(a)}}class Di{constructor(a){this.components=new xE,a?.wrtc!=null&&(this.wrtc=a.wrtc),this.sigServers=new Map,this.discovery=new Dh,this.peerDiscovered=this.peerDiscovered.bind(this)}get[Dc](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}init(a){this.components=a}async dial(a,b){let c=await this._connect(a,b),d=C4(c,{remoteAddr:a,signal:b.signal});Df("new outbound connection %s",d.remoteAddr);let e=await b.upgrader.upgradeOutbound(d);return Df("outbound connection %s upgraded",d.remoteAddr),e}async _connect(a,b){if(b.signal?.aborted=== !0)throw new v_;let c={...b.channelOptions??{}};null!=this.wrtc&&(c.wrtc=this.wrtc);let d=a.toOptions(),e=(0,cE.toString)(fI(36),"hex");return await new Promise((f,g)=>{let h=this.sigServers.get(C5(a));if(h?.socket==null)return g(a7(Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let i=!1;Df("dialing %s:%s",d.host,d.port);let j=new C1(c),k=a=>{let b=a.detail;if(!i){let c=`connection error ${d.host}:${d.port}: ${b.message}`;Df.error(c),n(b)}},l=()=>{i=!0,Df("connection opened %s:%s",d.host,d.port),n()},m=()=>{Df.error("connection aborted %s:%s",d.host,d.port),j.close().finally(()=>{n(new v_)})},n=a=>{j.removeEventListener("ready",l),b.signal?.removeEventListener("abort",m),null==a?f(j):g(a)};j.addEventListener("ready",l,{once:!0}),j.addEventListener("close",()=>{j.removeEventListener("error",k)}),b.signal?.addEventListener("abort",m),j.addEventListener("signal",b=>{let c=b.detail;h.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:h.signallingAddr.toString(),dstMultiaddr:a.toString(),signal:c})}),h.socket.on("ws-handshake",a=>{a.intentId===e&&null!=a.err&&j.close().finally(()=>{g(a7(Error(a.err),"ERR_SIGNALLING_FAILED"))}),a.intentId===e&&null!=a.answer&&!j.closed&&j.handleSignal(a.signal)})})}createListener(a){if(!De&&null==this.wrtc)throw a7(Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return a.channelOptions=a.channelOptions??{},null!=this.wrtc&&(a.channelOptions.wrtc=this.wrtc),Db(a.upgrader,a.handler??Dg,this.components.getPeerId(),this,a)}filter(a){return(a=Array.isArray(a)?a:[a]).filter(a=>!a.protoCodes().includes(Bk)&&lQ.matches(a))}peerDiscovered(a){Df("peer discovered: %s",a),a=C6(a);let b=new lC(a),c=b.getPeerId();if(null==c)return;let d=dL(c);this.discovery.dispatchEvent(new vI("peer",{detail:{id:d,multiaddrs:[b],protocols:[]}}))}}function Dj(){let a=new Di,b={transports:[a],peerDiscovery:[a.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}};return b}async function*Dk(a,b){yield*jS(a,async a=>(await b.addressBook.add(a.id,a.multiaddrs),a))}function Dl(a){let b=new Set;return jD(a,a=>!b.has(a.id.toString())&&(b.add(a.id.toString()),!0))}async function*Dm(a,b=1){let c=0;for await(let d of a)c++,yield d;if(c<b)throw a7(Error("not found"),"NOT_FOUND")}(GN=aw||(aw={})).NOT_STARTED_YET="The libp2p node is not started yet",GN.DHT_DISABLED="DHT is not available",GN.PUBSUB_DISABLED="PubSub is not available",GN.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",GN.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",GN.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",GN.NOT_FOUND="Not found",(GO=ax||(ax={})).DHT_DISABLED="ERR_DHT_DISABLED",GO.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",GO.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",GO.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",GO.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",GO.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",GO.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",GO.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",GO.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",GO.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",GO.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",GO.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",GO.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",GO.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",GO.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",GO.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",GO.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",GO.ERR_DIALED_SELF="ERR_DIALED_SELF",GO.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",GO.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",GO.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",GO.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",GO.ERR_INVALID_KEY="ERR_INVALID_KEY",GO.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",GO.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",GO.ERR_INVALID_PEER="ERR_INVALID_PEER",GO.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",GO.ERR_NOT_FOUND="ERR_NOT_FOUND",GO.ERR_TIMEOUT="ERR_TIMEOUT",GO.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",GO.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",GO.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",GO.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",GO.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",GO.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",GO.ERR_FIND_SELF="ERR_FIND_SELF",GO.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",GO.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",GO.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",GO.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",GO.ERR_INVALID_CMS="ERR_INVALID_CMS",GO.ERR_MISSING_KEYS="ERR_MISSING_KEYS",GO.ERR_NO_KEY="ERR_NO_KEY",GO.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",GO.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",GO.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",GO.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",GO.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",GO.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",GO.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",GO.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",GO.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",GO.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",GO.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",GO.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",GO.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",GO.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",GO.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",GO.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",GO.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",GO.ERR_INVALID_RECORD="ERR_INVALID_RECORD",GO.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED";var Dn=c(27695),Do=c(17187);let Dp=a6("libp2p:peer-routing");class Dq{constructor(a,b){this.components=a,this.routers=b.routers,this.refreshManagerInit=b.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){!this.started&&0!==this.routers.length&&null==this.timeoutId&& !1!==this.refreshManagerInit.enabled&&(this.timeoutId=(0,Dn.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(null==this.abortController)try{this.abortController=new cM.TimeoutController(this.refreshManagerInit.timeout??1e4);try{Do.setMaxListeners?.(1/0,this.abortController.signal)}catch{}await jC(this.getClosestPeers(this.components.getPeerId().toBytes(),{signal:this.abortController.signal}))}catch(a){Dp.error(a)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,Dn.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(a,b){if(0===this.routers.length)throw a7(Error("No peer routers available"),ax.ERR_NO_ROUTERS_AVAILABLE);if(a.toString()===this.components.getPeerId().toString())throw a7(Error("Should not try to find self"),ax.ERR_FIND_SELF);let c=await mk(jW(...this.routers.map(c=>(async function*(){try{yield await c.findPeer(a,b)}catch(d){Dp.error(d)}})())),a=>jD(a,Boolean),a=>Dk(a,this.components.getPeerStore()),async a=>await pR(a));if(null!=c)return c;throw a7(Error(aw.NOT_FOUND),ax.ERR_NOT_FOUND)}async *getClosestPeers(a,b){if(0===this.routers.length)throw a7(Error("No peer routers available"),ax.ERR_NO_ROUTERS_AVAILABLE);yield*mk(jW(...this.routers.map(c=>c.getClosestPeers(a,b))),a=>Dk(a,this.components.getPeerStore()),a=>Dl(a),a=>Dm(a))}}class Dr{constructor(a,b){this.routers=b.routers??[],this.started=!1,this.components=a}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async *findProviders(a,b={}){if(0===this.routers.length)throw a7(Error("No content this.routers available"),ax.ERR_NO_ROUTERS_AVAILABLE);yield*mk(jW(...this.routers.map(c=>c.findProviders(a,b))),a=>Dk(a,this.components.getPeerStore()),a=>Dl(a),a=>Dm(a))}async provide(a,b={}){if(0===this.routers.length)throw a7(Error("No content routers available"),ax.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async c=>await c.provide(a,b)))}async put(a,b,c){if(!this.isStarted())throw a7(Error(aw.NOT_STARTED_YET),ax.DHT_NOT_STARTED);let d=this.components.getDHT();null!=d&&await jC(d.put(a,b,c))}async get(a,b){if(!this.isStarted())throw a7(Error(aw.NOT_STARTED_YET),ax.DHT_NOT_STARTED);let c=this.components.getDHT();if(null!=c){for await(let d of c.get(a,b))if("VALUE"===d.name)return d.value}throw a7(Error(aw.NOT_FOUND),ax.ERR_NOT_FOUND)}async *getMany(a,b,c){if(!this.isStarted())throw a7(Error(aw.NOT_STARTED_YET),ax.DHT_NOT_STARTED);if(null==b||0===b)return;let d=0,e=this.components.getDHT();if(null!=e){for await(let f of e.get(a,c))if("VALUE"===f.name&&(yield{from:f.from,val:f.value},++d===b))break}if(0===d)throw a7(Error(aw.NOT_FOUND),ax.ERR_NOT_FOUND)}}function Ds(a){let b=a.getPeerId();if(null==b)throw a7(Error(`${a.toString()} does not have a valid peer type`),ax.ERR_INVALID_MULTIADDR);try{return dL(b)}catch(c){throw a7(Error(`${a.toString()} is not a valid peer type`),ax.ERR_INVALID_MULTIADDR)}}function Dt(a){if(d1(a))return{id:a,multiaddrs:[],protocols:[]};"string"==typeof a&&(a=new lC(a));let b;return lC.isMultiaddr(a)&&(b=a,a=Ds(a)),{id:a,multiaddrs:null!=b?[b]:[],protocols:[]}}let Du=a=>a;class Dv extends vG{constructor(a,b){super();let{listen:c=[],announce:d=[]}=b;this.components=a,this.listen=new Set(c.map(a=>a.toString())),this.announce=new Set(d.map(a=>a.toString())),this.observed=new Set,this.announceFilter=b.announceFilter??Du}getListenAddrs(){return Array.from(this.listen).map(a=>new lC(a))}getAnnounceAddrs(){return Array.from(this.announce).map(a=>new lC(a))}getObservedAddrs(){return Array.from(this.observed).map(a=>new lC(a))}addObservedAddr(a){let b=new lC(a),c=b.getPeerId();if(null!=c){let d=dL(c);d.equals(this.components.getPeerId())&&(b=b.decapsulate(new lC(`/p2p/${this.components.getPeerId().toString()}`)))}let e=b.toString();!this.observed.has(e)&&(this.observed.add(e),this.dispatchEvent(new vI("change:addresses")))}getAddresses(){let a=this.getAnnounceAddrs().map(a=>a.toString());0===a.length&&(a=this.components.getTransportManager().getAddrs().map(a=>a.toString())),a=a.concat(this.getObservedAddrs().map(a=>a.toString()));let b=new Set(a);return this.announceFilter(Array.from(b).map(a=>new lC(a))).map(a=>a.getPeerId()===this.components.getPeerId().toString()?a:a.encapsulate(`/p2p/${this.components.getPeerId().toString()}`))}}let Dw=a6("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class Dx extends vG{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",null!=globalThis.document&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let a="hidden",b="visibilitychange";void 0!==globalThis.document.hidden?(a="hidden",b="visibilitychange"):void 0!==globalThis.document.mozHidden?(a="mozHidden",b="mozvisibilitychange"):void 0!==globalThis.document.msHidden?(a="msHidden",b="msvisibilitychange"):void 0!==globalThis.document.webkitHidden&&(a="webkitHidden",b="webkitvisibilitychange"),this.hidden=a,this.visibilityChange=b}_addVisibilityChangeListener(){void 0===globalThis.document.addEventListener|| void 0===document[this.hidden]?Dw("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this.hidden&& void 0!==document[this.hidden])return null==document[this.hidden]}_handleVisibilityChange(){let a=!1===globalThis.document[this.hidden];Dw(a?"Page Visible":"Page Hidden"),this.dispatchEvent(new vI("visibilityChange",{detail:a}))}}let Dy=a6("libp2p:connection-manager:latency-monitor");class Dz extends vG{constructor(a={}){super();let{latencyCheckIntervalMs:b,dataEmitIntervalMs:c,asyncTestFn:d,latencyRandomPercentage:e}=a;this.latencyCheckIntervalMs=b??500,this.latencyRandomPercentage=e??10,this.latencyCheckMultiply=2*(this.latencyRandomPercentage/100)*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=null===c||0===c?void 0:c??5e3,Dy("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),null!=this.dataEmitIntervalMs?Dy("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):Dy("Not emitting summaries"),this.asyncTestFn=d,globalThis.process?.hrtime!=null?(Dy("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=a=>{let b=this.now(a);return 1e3*b[0]+b[1]/1e6}):"undefined"!=typeof window&&window.performance?.now!=null?(Dy("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=a=>Math.round(this.now()-a)):(Dy("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=a=>this.now()-a),this.latencyData=this.initLatencyData()}start(){DA()&&(this.visibilityChangeEmitter=new Dx,this.visibilityChangeEmitter.addEventListener("visibilityChange",a=>{let{detail:b}=a;b?this._startTimers():(this._emitSummary(),this._stopTimers())})),!0===this.visibilityChangeEmitter?.isVisible()&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){null==this.checkLatencyID&&(this.checkLatency(),null!=this.dataEmitIntervalMs&&(this.emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),"function"==typeof this.emitIntervalID.unref&&this.emitIntervalID.unref()))}_stopTimers(){null!=this.checkLatencyID&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),null!=this.emitIntervalID&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){let a=this.getSummary();a.events>0&&this.dispatchEvent(new vI("data",{detail:a}))}getSummary(){let a={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),Dy.trace("Summary: %O",a),a}checkLatency(){let a=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,b={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+a),startTime:this.now()},c=()=>{if(null==this.checkLatencyID)return;let a=this.getDeltaMS(b.startTime)-b.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,a),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,a),this.latencyData.totalMs+=a,Dy.trace("MS: %s Data: %O",a,this.latencyData)};Dy.trace("localData: %O",b),this.checkLatencyID=setTimeout(()=>{null!=this.asyncTestFn?(b.deltaOffset=0,b.startTime=this.now(),this.asyncTestFn(c)):(b.deltaOffset-=1,c())},b.deltaOffset),"function"==typeof this.checkLatencyID.unref&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function DA(){return void 0!==globalThis.window}var DB=c(82916);class DC extends Map{constructor(a){super();let{system:b,component:c,metric:d,metrics:e}=a;this.system=b??"libp2p",this.component=c,this.metric=d,this.metrics=e,this.updateComponentMetric()}set(a,b){return super.set(a,b),this.updateComponentMetric(),this}delete(a){let b=super.delete(a);return this.updateComponentMetric(),b}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}}function DD(a){let{system:b,component:c,metric:d,metrics:e}=a,f;return null!=e?new DC({system:b,component:c,metric:d,metrics:e}):new Map}let DE="OPEN",DF="CLOSING",DG="CLOSED";class DH extends Error{constructor(a="The operation was aborted"){super(a),this.code=DH.code,this.type=DH.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}var DI=c(35103);let DJ=a6("libp2p:dialer:dial-request");class DK{constructor(a){let{addrs:b,dialAction:c,dialer:d}=a;this.addrs=b,this.dialer=d,this.dialAction=c}async run(a={}){let b=this.dialer.getTokens(this.addrs.length);if(b.length<1)throw a7(Error("No dial tokens available"),ax.ERR_NO_DIAL_TOKENS);let c=new DI;for(let d of b)c.push(d).catch(a=>{DJ.error(a)});let e=this.addrs.map(()=>{let a=new AbortController;try{Do.setMaxListeners?.(1/0,a.signal)}catch{}return a});if(null!=a.signal)try{Do.setMaxListeners?.(1/0,a.signal)}catch{}let f=0,g=!1;try{return await Promise.any(this.addrs.map(async(d,h)=>{let i=await c.shift();if(g)throw this.dialer.releaseToken(b.splice(b.indexOf(i),1)[0]),a7(Error("dialAction already succeeded"),ax.ERR_ALREADY_SUCCEEDED);let j=e[h];if(null==j)throw a7(Error("dialAction did not come with an AbortController"),ax.ERR_INVALID_PARAMETERS);let k;try{let l=j.signal;k=await this.dialAction(d,{...a,signal:null!=a.signal?(0,cN.anySignal)([l,a.signal]):l}),e[h]=void 0}finally{f++,this.addrs.length-f>=b.length?c.push(i).catch(a=>{DJ.error(a)}):this.dialer.releaseToken(b.splice(b.indexOf(i),1)[0])}if(null==k)throw a7(Error("dialAction led to empty object"),ax.ERR_TRANSPORT_DIAL_FAILED);return g=!0,k}))}finally{e.forEach(a=>{void 0!==a&&a.abort()}),b.forEach(a=>this.dialer.releaseToken(a))}}}var DL=c(290);function DM(a){let{address:b}=a.nodeAddress();return Boolean(DL(b))}function DN(a,b){let c=DM(a.multiaddr),d=DM(b.multiaddr);return c&&!d?1:!c&&d?-1:a.isCertified&&!b.isCertified?-1:!a.isCertified&&b.isCertified?1:0}let DO=3e4,DP=100,DQ=4,DR=25,DS={computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},DT=a6("libp2p:dialer"),DU="dialler",DV="pending-dials",DW="pending-dial-targets";class DX{constructor(a={}){for(let[b,c]of(this.components=new xE,this.started=!1,this.addressSorter=a.addressSorter??DN,this.maxAddrsToDial=a.maxAddrsToDial??DR,this.timeout=a.dialTimeout??DO,this.maxDialsPerPeer=a.maxDialsPerPeer??DQ,this.tokens=[...Array(a.maxParallelDials??DP)].map((a,b)=>b),this.pendingDials=DD({component:DU,metric:DV,metrics:a.metrics}),this.pendingDialTargets=DD({component:DU,metric:DW,metrics:a.metrics}),Object.entries(a.resolvers??{})))lC.resolvers.set(b,c)}init(a){this.components=a}isStarted(){return this.started}async start(){this.started=!0}async stop(){for(let a of(this.started=!1,this.pendingDials.values()))try{a.controller.abort()}catch(b){DT.error(b)}for(let c of(this.pendingDials.clear(),this.pendingDialTargets.values()))c.reject(new DH("Dialer was destroyed"));this.pendingDialTargets.clear()}async dial(a,b={}){let{id:c,multiaddrs:d}=Dt(a);if(this.components.getPeerId().equals(c))throw a7(Error("Tried to dial self"),ax.ERR_DIALED_SELF);if(DT("check multiaddrs %p",c),null!=d&&d.length>0&&(DT("storing multiaddrs %p",c,d),await this.components.getPeerStore().addressBook.add(c,d)),await this.components.getConnectionGater().denyDialPeer(c))throw a7(Error("The dial request is blocked by gater.allowDialPeer"),ax.ERR_PEER_DIAL_INTERCEPTED);DT("creating dial target for %p",c);let e=await this._createCancellableDialTarget(c);if(0===e.addrs.length)throw a7(Error("The dial request has no valid addresses"),ax.ERR_NO_VALID_ADDRESSES);let f=this.pendingDials.get(e.id)??this._createPendingDial(e,b);try{let g=await f.promise;return DT("dial succeeded to %s",e.id),g}catch(h){throw DT("dial failed to %s",e.id,h),f.controller.signal.aborted&&(h.code=ax.ERR_TIMEOUT),DT.error(h),h}finally{f.destroy()}}async _createCancellableDialTarget(a){let b=`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`,c=new Promise((a,c)=>{this.pendingDialTargets.set(b,{resolve:a,reject:c})});try{let d=await Promise.race([this._createDialTarget(a),c]);return d}finally{this.pendingDialTargets.delete(b)}}async _createDialTarget(a){let b=await mk(await this.components.getPeerStore().addressBook.get(a),b=>jD(b,async b=>!await this.components.getConnectionGater().denyDialMultiaddr(a,b.multiaddr)),a=>ve(a,this.addressSorter),b=>jS(b,b=>{let c=b.multiaddr;return a.toString()===c.getPeerId()?c:c.encapsulate(`/p2p/${a.toString()}`)}),async a=>await jA(a)),c=[];for(let d of b){let e=await this._resolve(d);e.forEach(a=>c.push(a))}let f=c.filter(a=>this.components.getTransportManager().transportForMultiaddr(a));if(f.length>this.maxAddrsToDial)throw await this.components.getPeerStore().delete(a),a7(Error("dial with more addresses than allowed"),ax.ERR_TOO_MANY_ADDRESSES);return{id:a.toString(),addrs:f}}_createPendingDial(a,b={}){let c=async(a,b={})=>{if(b.signal?.aborted=== !0)throw a7(Error("already aborted"),ax.ERR_ALREADY_ABORTED);return await this.components.getTransportManager().dial(a,b)},d=new DK({addrs:a.addrs,dialAction:c,dialer:this}),e=new cM.TimeoutController(this.timeout),f=[e.signal];null!=b.signal&&f.push(b.signal);let g=(0,cN.anySignal)(f);try{Do.setMaxListeners?.(1/0,g)}catch{}let h={dialRequest:d,controller:e,promise:d.run({...b,signal:g}),destroy:()=>{e.clear(),this.pendingDials.delete(a.id)}};return this.pendingDials.set(a.id,h),h}getTokens(a){let b=Math.min(a,this.maxDialsPerPeer,this.tokens.length),c=this.tokens.splice(0,b);return DT("%d tokens request, returning %d, %d remaining",a,b,this.tokens.length),c}releaseToken(a){!this.tokens.includes(a)&&(DT("token %d released",a),this.tokens.push(a))}async _resolve(a){let b=a.protoNames().includes("dnsaddr");if(!b)return[a];let c=await this._resolveRecord(a),d=await Promise.all(c.map(async a=>await this._resolve(a))),e=d.flat();return e.reduce((a,b)=>(null==a.find(a=>a.equals(b))&&a.push(b),a),[])}async _resolveRecord(a){try{a=new lC(a.toString());let b=await a.resolve();return b}catch(c){return DT.error(`multiaddr ${a.toString()} could not be resolved`,c),[]}}}let DY=a6("libp2p:connection-manager"),DZ={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:.5},D$="connection-manager",D_="peer-connections",D0="peer-values";class D1 extends vG{constructor(a){if(super(),this.components=new xE,this.opts=a0.call({ignoreUndefined:!0},DZ,a),this.opts.maxConnections<this.opts.minConnections)throw a7(Error("Connection Manager maxConnections must be greater than minConnections"),ax.ERR_INVALID_PARAMETERS);DY("options: %o",this.opts),this.peerValues=DD({component:D$,metric:D0,metrics:this.components.getMetrics()}),this.connections=DD({component:D$,metric:D_,metrics:this.components.getMetrics()}),this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new Dz({latencyCheckIntervalMs:a.pollInterval,dataEmitIntervalMs:a.pollInterval});try{Do.setMaxListeners?.(1/0,this)}catch{}this.dialer=new DX(this.opts),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this)}init(a){this.components=a,this.dialer.init(a)}isStarted(){return this.started}async start(){null!=this.components.getMetrics()&&(this.timer=this.timer??DB(this._checkMetrics,this.opts.pollInterval)),this.latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor.addEventListener("data",this._onLatencyMeasure),await this.dialer.start(),this.started=!0,DY("started")}async afterStart(){this.components.getUpgrader().addEventListener("connection",this.onConnect),this.components.getUpgrader().addEventListener("connectionEnd",this.onDisconnect)}async beforeStop(){this.components.getUpgrader().removeEventListener("connection",this.onConnect),this.components.getUpgrader().removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.timer?.clear(),this.latencyMonitor.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor.stop(),await this.dialer.stop(),this.started=!1,await this._close(),DY("stopped")}async _close(){let a=[];for(let b of this.connections.values())for(let c of b)a.push((async()=>{try{await c.close()}catch(a){DY.error(a)}})());DY("closing %d connections",a.length),await Promise.all(a),this.connections.clear()}setPeerValue(a,b){if(b<0||b>1)throw Error("value should be a number between 0 and 1");this.peerValues.set(a.toString(),b)}async _checkMetrics(){let a=this.components.getMetrics();if(null!=a)try{let b=a.getGlobal().getMovingAverages(),c=b.dataReceived[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxReceivedData",c);let d=b.dataSent[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxSentData",d);let e=c+d;await this._checkMaxLimit("maxData",e),DY.trace("metrics update",e)}finally{this.timer=DB(this._checkMetrics,this.opts.pollInterval)}}onConnect(a){this._onConnect(a).catch(a=>{DY.error(a)})}async _onConnect(a){let{detail:b}=a;if(!this.started){await b.close();return}let c=b.remotePeer,d=c.toString(),e=this.connections.get(d);null!=e?e.push(b):this.connections.set(d,[b]),null!=c.publicKey&&await this.components.getPeerStore().keyBook.set(c,c.publicKey),this.peerValues.has(d)||this.peerValues.set(d,this.opts.defaultPeerValue);let f=this.getConnections().length,g=f-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",f,g),this.dispatchEvent(new vI("peer:connect",{detail:b}))}onDisconnect(a){let{detail:b}=a;if(!this.started)return;let c=b.remotePeer.toString(),d=this.connections.get(c);null!=d&&d.length>1?(d=d.filter(a=>a.id!==b.id),this.connections.set(c,d)):null!=d&&(this.connections.delete(c),this.peerValues.delete(b.remotePeer.toString()),this.dispatchEvent(new vI("peer:disconnect",{detail:b})),this.components.getMetrics()?.onPeerDisconnected(b.remotePeer))}getConnections(a){if(null!=a)return this.connections.get(a.toString())??[];let b=[];for(let c of this.connections.values())b=b.concat(c);return b}async openConnection(a,b){DY("dial to %p",a);let c=this.getConnections(a);if(c.length>0)return DY("had an existing connection to %p",a),c[0];let d=await this.dialer.dial(a,b),e=this.connections.get(a.toString());null==e&&(e=[],this.connections.set(a.toString(),e));let f=!1;for(let g of e)g.id===d.id&&(f=!0);return f||e.push(d),d}async closeConnections(a){let b=this.connections.get(a.toString())??[];await Promise.all(b.map(async a=>await a.close()))}getAll(a){if(!d1(a))throw a7(Error("peerId must be an instance of peer-id"),ax.ERR_INVALID_PARAMETERS);let b=a.toString(),c=this.connections.get(b);return null!=c?c.filter(a=>a.stat.status===DE):[]}_onLatencyMeasure(a){let{detail:b}=a;this._checkMaxLimit("maxEventLoopDelay",b.avgMs,1).catch(a=>{DY.error(a)})}async _checkMaxLimit(a,b,c=1){let d=this.opts[a];DY.trace("checking limit of %s. current value: %d of %d",a,b,d),b>d&&(DY("%s: limit exceeded: %p, %d, pruning %d connection(s)",this.components.getPeerId(),a,b,c),await this._maybePruneConnections(c))}async _maybePruneConnections(a){let b=this.getConnections();if(b.length<=this.opts.minConnections||a<1)return;let c=Array.from(new Map([...this.peerValues.entries()].sort((a,b)=>a[1]-b[1])));DY.trace("sorted peer values: %j",c);let d=[];for(let[e]of c)for(let f of(DY("too many connections open - closing a connection to %p",e),b))if(f.remotePeer.toString()===e&&d.push(f),d.length===a)break;await Promise.all(d.map(async a=>{try{await a.close()}catch(b){DY.error(b)}this.onDisconnect(new vI("connectionEnd",{detail:a}))}))}}let D2=a6("libp2p:connection-manager:auto-dialler"),D3={enabled:!0,minConnections:0,autoDialInterval:1e4};class D4{constructor(a,b){this.components=a,this.options=a0.call({ignoreUndefined:!0},D3,b),this.running=!1,this._autoDial=this._autoDial.bind(this),D2("options: %j",this.options)}isStarted(){return this.running}async start(){if(!this.options.enabled){D2("not enabled");return}this.running=!0,this._autoDial().catch(a=>{D2.error("could start autodial",a)}),D2("started")}async stop(){if(!this.options.enabled){D2("not enabled");return}this.running=!1,null!=this.autoDialTimeout&&this.autoDialTimeout.clear(),D2("stopped")}async _autoDial(){null!=this.autoDialTimeout&&this.autoDialTimeout.clear();let a=this.options.minConnections;if(this.components.getConnectionManager().getConnections().length>=a){this.autoDialTimeout=DB(this._autoDial,this.options.autoDialInterval);return}let b=await this.components.getPeerStore().all(),c=await mk(b.sort(()=>Math.random()>.5?1:-1),a=>jD(a,a=>!a.id.equals(this.components.getPeerId())),a=>ve(a,(a,b)=>b.protocols.length>a.protocols.length?1:null!=b.id.publicKey&&null==a.id.publicKey?1:-1),async a=>await jA(a));for(let d=0;this.running&&d<c.length&&this.components.getConnectionManager().getConnections().length<a;d++){if(!this.running)return;let e=c[d];if(0===this.components.getConnectionManager().getConnections(e.id).length){D2("connecting to a peerStore stored peer %p",e.id);try{await this.components.getConnectionManager().openConnection(e.id)}catch(f){D2.error("could not connect to peerStore stored peer",f)}}}this.running&&(this.autoDialTimeout=DB(this._autoDial,this.options.autoDialInterval))}}let D5,D6,D7,D8,D9;(GQ=D5=(GP=ay||(ay={})).Status||(GP.Status={})).SUCCESS="SUCCESS",GQ.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",GQ.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",GQ.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",GQ.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",GQ.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",GQ.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",GQ.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",GQ.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",GQ.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",GQ.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",GQ.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",GQ.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",GQ.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",GQ.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",GQ.MALFORMED_MESSAGE="MALFORMED_MESSAGE",(GR=D6||(D6={}))[GR.SUCCESS=100]="SUCCESS",GR[GR.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",GR[GR.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",GR[GR.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",GR[GR.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",GR[GR.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",GR[GR.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",GR[GR.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",GR[GR.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",GR[GR.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",GR[GR.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",GR[GR.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",GR[GR.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",GR[GR.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",GR[GR.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",GR[GR.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",(GS=D5=GP.Status||(GP.Status={})).codec=()=>eJ(D6),(GT=D7=GP.Type||(GP.Type={})).HOP="HOP",GT.STOP="STOP",GT.STATUS="STATUS",GT.CAN_HOP="CAN_HOP",(GU=D8||(D8={}))[GU.HOP=1]="HOP",GU[GU.STOP=2]="STOP",GU[GU.STATUS=3]="STATUS",GU[GU.CAN_HOP=4]="CAN_HOP",(GV=D7=GP.Type||(GP.Type={})).codec=()=>eJ(D8),(GW=D9=GP.Peer||(GP.Peer={})).codec=()=>e2({1:{name:"id",codec:eF},2:{name:"addrs",codec:eF,repeats:!0}}),GW.encode=a=>ew(a,GW.codec()),GW.decode=a=>ev(a,GW.codec()),GP.codec=()=>e2({1:{name:"type",codec:GP.Type.codec(),optional:!0},2:{name:"srcPeer",codec:GP.Peer.codec(),optional:!0},3:{name:"dstPeer",codec:GP.Peer.codec(),optional:!0},4:{name:"code",codec:GP.Status.codec(),optional:!0}}),GP.encode=a=>ew(a,GP.codec()),GP.decode=a=>ev(a,GP.codec());let Ea=a6("libp2p:stream:converter");function Eb(a,b={}){let{stream:c,remoteAddr:d}=a,{sink:e,source:f}=c,g={async sink(a){null!=b.signal&&(a=v1(a,b.signal));try{await e(a),await h()}catch(c){"aborted"!==c.type&&Ea(c)}},source:null!=b.signal?v1(f,b.signal):f,remoteAddr:d,timeline:{open:Date.now(),close:void 0},async close(){await e(async function*(){yield new Uint8Array(0)}()),await h()}};async function h(){return null==g.timeline.close&&(g.timeline.close=Date.now()),await Promise.resolve()}return g}let Ec="/libp2p/circuit/relay/0.1.0";function Ed(a){let b=new Map;async function c(c){let d=c.toString().split("/p2p-circuit").find(a=>""!==a),f=new lC(d),g=f.getPeerId();if(null==g)throw Error("Could not determine relay peer from multiaddr");let h=dL(g);await a.peerStore.addressBook.add(h,[f]);let i=await a.connectionManager.openConnection(h),j=i.remoteAddr.encapsulate("/p2p-circuit");b.set(i.remotePeer.toString(),j),e.dispatchEvent(new vI("listening"))}function d(){let a=[];for(let c of b.values())a.push(c);return a}let e=Object.assign(new vG,{close:async()=>await Promise.resolve(),listen:c,getAddrs:d});return a.connectionManager.addEventListener("peer:disconnect",a=>{let{detail:c}=a,d=b.delete(c.remotePeer.toString());d&&e.dispatchEvent(new vI("close"))}),e}function Ee(a,b){a.write({type:ay.Type.STATUS,code:b})}function Ef(a,b){try{a.dstPeer?.addrs!=null&&a.dstPeer.addrs.forEach(a=>new lC(a))}catch(c){throw Ee(b,a.type===ay.Type.HOP?ay.Status.HOP_DST_MULTIADDR_INVALID:ay.Status.STOP_DST_MULTIADDR_INVALID),c}try{a.srcPeer?.addrs!=null&&a.srcPeer.addrs.forEach(a=>new lC(a))}catch(d){throw Ee(b,a.type===ay.Type.HOP?ay.Status.HOP_SRC_MULTIADDR_INVALID:ay.Status.STOP_SRC_MULTIADDR_INVALID),d}}function Eg(a){let b=vZ(),c=or(a.source),d=xX(),e,f=a.sink(async function*(){yield*b;let a=await d.promise;yield*a}());f.catch(a=>{e=a});let g={sink:async a=>null!=e?await Promise.reject(e):(d.resolve(a),await f),source:jS(c,a=>a.slice())};return{reader:c,writer:b,stream:g,rest:()=>b.end(),write:b.push,read:async()=>{let a=await c.next();if(null!=a.value)return a.value.slice()}}}let Eh=a6("libp2p:circuit:stream-handler");class Ei{constructor(a){let{stream:b,maxLength:c=4096}=a;this.stream=b,this.shake=Eg(this.stream),this.decoder=vT.fromReader(this.shake.reader,{maxDataLength:c})}async read(){let a=await this.decoder.next();if(null!=a.value){let b=ay.decode(a.value.slice());return Eh("read message type",b.type),b}Eh("read received no value, closing stream"),this.close()}write(a){Eh("write message type %s",a.type),this.shake.write(vM.single(ay.encode(a)).slice())}rest(){return this.shake.rest(),this.shake.stream}end(a){this.write(a),this.close()}close(){Eh("closing the stream"),this.rest().sink([]).catch(a=>{Eh.error(a)})}}let Ej=a6("libp2p:circuit:stop");function Ek(a){let{connection:b,request:c,streamHandler:d}=a;try{Ef(c,d)}catch(e){Ej.error("invalid stop request via peer %p %o",b.remotePeer,e);return}return Ej("stop request is valid"),d.write({type:ay.Type.STATUS,code:ay.Status.SUCCESS}),d.rest()}async function El(a){let{connection:b,request:c}=a,{stream:d}=await b.newStream([Ec]);Ej("starting stop request to %p",b.remotePeer);let e=new Ei({stream:d});e.write(c);let f=await e.read();if(null==f){e.close();return}if(f.code===ay.Status.SUCCESS)return Ej("stop request to %p was successful",b.remotePeer),e.rest();Ej("stop request failed with code %d",f.code),e.close()}let Em=a6("libp2p:circuit:hop");async function En(a){let{connection:b,request:c,streamHandler:d,circuit:e,connectionManager:f}=a;if(!e.hopEnabled())return Em("HOP request received but we are not acting as a relay"),d.end({type:ay.Type.STATUS,code:ay.Status.HOP_CANT_SPEAK_RELAY});try{Ef(c,d)}catch(g){Em.error("invalid hop request via peer %p %o",b.remotePeer,g);return}if(null==c.dstPeer){Em("HOP request received but we do not receive a dstPeer");return}let h=dM(c.dstPeer.id),i=f.getConnections(h);if(0===i.length&&!e.hopActive())return Em("HOP request received but we are not connected to the destination peer"),d.end({type:ay.Type.STATUS,code:ay.Status.HOP_NO_CONN_TO_DST});if(0===i.length)return Em("did not have connection to remote peer"),d.end({type:ay.Type.STATUS,code:ay.Status.HOP_NO_CONN_TO_DST});let j={type:ay.Type.STOP,dstPeer:c.dstPeer,srcPeer:c.srcPeer},k;try{Em("performing STOP request");let l=await El({connection:i[0],request:j});if(null==l)throw Error("Could not stop");k=l}catch(m){Em.error(m);return}Em("hop request from %p is valid",b.remotePeer),d.write({type:ay.Type.STATUS,code:ay.Status.SUCCESS});let n=d.rest();return Em("creating related connections"),await mk(n,k,n)}async function Eo(a){let{connection:b,request:c}=a,{stream:d}=await b.newStream(Ec),e=new Ei({stream:d});e.write(c);let f=await e.read();if(null==f)throw a7(Error("HOP request had no response"),ax.ERR_HOP_REQUEST_FAILED);if(f.code===ay.Status.SUCCESS)return Em("hop request was successful"),e.rest();throw Em("hop request failed with code %d, closing stream",f.code),e.close(),a7(Error(`HOP request failed with code "${f.code??"unknown"}"`),ax.ERR_HOP_REQUEST_FAILED)}async function Ep(a){let{connection:b}=a,{stream:c}=await b.newStream(Ec),d=new Ei({stream:c});d.write({type:ay.Type.CAN_HOP});let e=await d.read();return await d.close(),null!=e&&e.code===ay.Status.SUCCESS}function Eq(a){let{connection:b,streamHandler:c,circuit:d}=a,e=d.hopEnabled();Em("can hop (%s) request from %p",e,b.remotePeer),c.end({type:ay.Type.STATUS,code:e?ay.Status.SUCCESS:ay.Status.HOP_CANT_SPEAK_RELAY})}let Er=a6("libp2p:circuit");class Es{constructor(){this.components=new xE}init(a){this.components=a,this.components.getRegistrar().handle(Ec,a=>{this._onProtocol(a).catch(a=>{Er.error(a)})}).catch(a=>{Er.error(a)})}hopEnabled(){return!0}hopActive(){return!0}get[Dc](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(a){let{connection:b,stream:c}=a,d=new Ei({stream:c}),e=await d.read();if(null==e){Er("request was invalid, could not read from stream"),d.write({type:ay.Type.STATUS,code:ay.Status.MALFORMED_MESSAGE}),d.close();return}let f;switch(e.type){case ay.Type.CAN_HOP:Er("received CAN_HOP request from %p",b.remotePeer),await Eq({circuit:this,connection:b,streamHandler:d});break;case ay.Type.HOP:Er("received HOP request from %p",b.remotePeer),f=await En({connection:b,request:e,streamHandler:d,circuit:this,connectionManager:this.components.getConnectionManager()});break;case ay.Type.STOP:Er("received STOP request from %p",b.remotePeer),f=await Ek({connection:b,request:e,streamHandler:d});break;default:Er("Request of type %s not supported",e.type),d.write({type:ay.Type.STATUS,code:ay.Status.MALFORMED_MESSAGE}),d.close();return}if(null!=f){let g=new lC(e.dstPeer.addrs[0]),h=new lC(e.srcPeer.addrs[0]),i=Eb({stream:f,remoteAddr:g,localAddr:h}),j=e.type===ay.Type.HOP?"relay":"inbound";Er("new %s connection %s",j,i.remoteAddr);let k=await this.components.getUpgrader().upgradeInbound(i);Er("%s connection %s upgraded",j,i.remoteAddr),null!=this.handler&&this.handler(k)}}async dial(a,b={}){let c=a.toString().split("/p2p-circuit"),d=new lC(c[0]),e=new lC(c[c.length-1]),f=d.getPeerId(),g=e.getPeerId();if(null==f||null==g){let h="Circuit relay dial failed as addresses did not have peer id";throw Er.error(h),a7(Error(h),ax.ERR_RELAYED_DIAL)}let i=dL(f),j=dL(g),k=!1,l=this.components.getConnectionManager().getConnections(i),m=l[0];null==m&&(await this.components.getPeerStore().addressBook.add(i,[d]),m=await this.components.getConnectionManager().openConnection(i,b),k=!0);try{let n=await Eo({connection:m,request:{type:ay.Type.HOP,srcPeer:{id:this.components.getPeerId().toBytes(),addrs:this.components.getAddressManager().getAddresses().map(a=>a.bytes)},dstPeer:{id:j.toBytes(),addrs:[new lC(e).bytes]}}}),o=d.encapsulate(`/p2p-circuit/p2p/${this.components.getPeerId().toString()}`),p=Eb({stream:n,remoteAddr:a,localAddr:o});return Er("new outbound connection %s",p.remoteAddr),await this.components.getUpgrader().upgradeOutbound(p)}catch(q){throw Er.error("Circuit relay dial failed",q),k&&await m.close(),q}}createListener(a){return this.handler=a.handler,Ed({connectionManager:this.components.getConnectionManager(),peerStore:this.components.getPeerStore()})}filter(a){return(a=Array.isArray(a)?a:[a]).filter(a=>lW.matches(a))}}async function Et(a){let b=new TextEncoder().encode(a),c=await dA.sha256.digest(b);return bm.CID.createV0(c)}let Eu=6e4,Ev=15*Eu,Ew=30*Eu,Ex=290,Ey="hop_relay",Ez="true",EA="/libp2p/relay",EB=a6("libp2p:auto-relay"),EC=()=>{};class ED{constructor(a,b){this.components=a,this.addressSorter=b.addressSorter??DN,this.maxListeners=b.maxListeners??1,this.listenRelays=new Set,this.onError=b.onError??EC,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.getPeerStore().addEventListener("change:protocols",a=>{this._onProtocolChange(a).catch(a=>{EB.error(a)})}),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(a){let{peerId:b,protocols:c}=a.detail,d=b.toString(),e=c.find(a=>a===Ec);if(null==e){this.listenRelays.has(d)&&await this._removeListenRelay(d);return}if(!this.listenRelays.has(d))try{let f=this.components.getConnectionManager().getConnections(b);if(0===f.length)return;let g=f[0];if(g.remoteAddr.protoCodes().includes(Ex)){EB(`relayed connection to ${d} will not be used to hop on`);return}let h=await Ep({connection:g});h&&(await this.components.getPeerStore().metadataBook.setValue(b,Ey,(0,cB.fromString)(Ez)),await this._addListenRelay(g,d))}catch(i){this.onError(i)}}_onPeerDisconnected(a){let b=a.detail,c=b.remotePeer,d=c.toString();this.listenRelays.has(d)&&this._removeListenRelay(d).catch(a=>{EB.error(a)})}async _addListenRelay(a,b){try{if(this.listenRelays.size>=this.maxListeners)return;let c=await mk(await this.components.getPeerStore().addressBook.get(a.remotePeer),a=>ve(a,this.addressSorter),async a=>await jA(a)),d=await Promise.all(c.map(async b=>{try{let c=b.multiaddr;return null==c.getPeerId()&&(c=c.encapsulate(`/p2p/${a.remotePeer.toString()}`)),await this.components.getTransportManager().listen([c=c.encapsulate("/p2p-circuit")]),!0}catch(d){EB.error("error listening on circuit address",d),this.onError(d)}return!1}));d.includes(!0)&&this.listenRelays.add(b)}catch(e){this.onError(e),this.listenRelays.delete(b)}}async _removeListenRelay(a){this.listenRelays.delete(a)&&await this._listenOnAvailableHopRelays([a])}async _listenOnAvailableHopRelays(a=[]){if(this.listenRelays.size>=this.maxListeners)return;let b=[],c=await this.components.getPeerStore().all();for(let{id:d,metadata:e}of c){let f=d.toString();if(this.listenRelays.has(f)||a.includes(f))continue;let g=e.get(Ey);if(null==g||(0,cE.toString)(g)!==Ez)continue;let h=this.components.getConnectionManager().getConnections(d);if(0===h.length){b.push(d);continue}if(await this._addListenRelay(h[0],f),this.listenRelays.size>=this.maxListeners)return}for(let i of b)if(await this._tryToListenOnRelay(i),this.listenRelays.size>=this.maxListeners)return;try{let j=await Et(EA);for await(let k of this.components.getContentRouting().findProviders(j)){if(0===k.multiaddrs.length)continue;let l=k.id;if(await this.components.getPeerStore().addressBook.add(l,k.multiaddrs),await this._tryToListenOnRelay(l),this.listenRelays.size>=this.maxListeners)return}}catch(m){this.onError(m)}}async _tryToListenOnRelay(a){try{let b=await this.components.getConnectionManager().openConnection(a);await this._addListenRelay(b,a.toString())}catch(c){EB.error("Could not use %p as relay",a,c),this.onError(c,`could not connect and listen on known hop relay ${a.toString()}`)}}}let EE=a6("libp2p:relay");class EF{constructor(a,b){this.components=a,this.autoRelay=b.autoRelay?.enabled!== !1?new ED(a,{addressSorter:b.addressSorter,...b.autoRelay}):void 0,this.started=!1,this.init=b,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){!1!==this.init.hop.enabled&& !1!==this.init.advertise.enabled&&(this.timeout=(0,Dn.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){null!=this.timeout&&(0,Dn.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{let a=await Et(EA);await this.components.getContentRouting().provide(a)}catch(b){b.code===ax.ERR_NO_ROUTERS_AVAILABLE?(EE.error("a content router, such as a DHT, must be provided in order to advertise the relay service",b),await this.stop()):EE.error(b)}}}var EG=c(50202);c(79437),c(25414);let EH=fq.pki,EI=(a,b)=>{let c=EH.rsa.setPublicKey(b.n,b.e),d=EH.createCertificate();d.publicKey=c,d.serialNumber="01",d.validity.notBefore=new Date,d.validity.notAfter=new Date,d.validity.notAfter.setFullYear(d.validity.notBefore.getFullYear()+10);let e=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:a.id}];return d.setSubject(e),d.setIssuer(e),d.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),d.sign(b),d};async function EJ(a,b){let c=a.map(b),d=await Promise.all(c),e=d.findIndex(a=>a);return a[e]}let EK=a6("libp2p:keychain:cms"),EL=new WeakMap;class EM{constructor(a,b){if(null==a)throw a7(Error("keychain is required"),ax.ERR_KEYCHAIN_REQUIRED);this.keychain=a,EL.set(this,{dek:b})}async encrypt(a,b){if(!(b instanceof Uint8Array))throw a7(Error("Plain data must be a Uint8Array"),ax.ERR_INVALID_PARAMETERS);let c=await this.keychain.findKeyByName(a),d=await this.keychain.getPrivateKey(a),e=EL.get(this);if(null==e)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let f=e.dek,g=fq.pki.decryptRsaPrivateKey(d,f),h=await EI(c,g),i=fq.pkcs7.createEnvelopedData();i.addRecipient(h),i.content=fq.util.createBuffer(b),i.encrypt();let j=fq.asn1.toDer(i.toAsn1()).getBytes();return(0,cB.fromString)(j,"ascii")}async decrypt(a){if(!(a instanceof Uint8Array))throw a7(Error("CMS data is required"),ax.ERR_INVALID_PARAMETERS);let b;try{let c=fq.util.createBuffer((0,cE.toString)(a,"ascii")),d=fq.asn1.fromDer(c);b=fq.pkcs7.messageFromAsn1(d)}catch(e){throw EK.error(e),a7(Error("Invalid CMS"),ax.ERR_INVALID_CMS)}let f=b.recipients.filter(a=>a.issuer.find(a=>"O"===a.shortName&&"ipfs"===a.value)).filter(a=>a.issuer.find(a=>"CN"===a.shortName)).map(a=>({recipient:a,keyId:a.issuer.find(a=>"CN"===a.shortName).value})),g=await EJ(f,async a=>{try{let b=await this.keychain.findKeyById(a.keyId);if(null!=b)return!0}catch(c){}return!1});if(null==g){let h=f.map(a=>a.keyId);throw a7(Error(`Decryption needs one of the key(s): ${h.join(", ")}`),ax.ERR_MISSING_KEYS,{missingKeys:h})}let i=await this.keychain.findKeyById(g.keyId);if(null==i)throw a7(Error("No key available to decrypto"),ax.ERR_NO_KEY);let j=await this.keychain.getPrivateKey(i.name),k=EL.get(this);if(null==k)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let l=k.dek,m=fq.pki.decryptRsaPrivateKey(j,l);return b.decrypt(g.recipient,m),(0,cB.fromString)(b.content.getBytes(),"ascii")}}c(8925);var EN=c(98960);let EO={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function EP(a,b,c,d,e){if("sha1"!==e&&"sha2-256"!==e&&"sha2-512"!==e){let f=Object.keys(EO).join(" / ");throw a7(Error(`Hash '${e}' is unknown or not supported. Must be ${f}`),"ERR_UNSUPPORTED_HASH_TYPE")}let g=EO[e],h=EN(a,b,c,d,g);return fv.encode64(h,null)}let EQ=a6("libp2p:keychain"),ER="/pkcs8/",ES="/info/",ET=new WeakMap,EU={minKeyLength:14,minSaltLength:16,minIterationCount:1e3},EV={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function EW(a){return null!=a&&"string"==typeof a&&a===EG(a.trim())&&a.length>0}async function EX(){let a=200,b=1e3,c=Math.random()*(b-a)+a;await new Promise(a=>setTimeout(a,c))}function EY(a){return new cI(ER+a)}function EZ(a){return new cI(ES+a)}class E${constructor(a,b){if(this.components=a,this.init=a0(EV,b),null!=this.init.pass&&this.init.pass?.length<20)throw Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<EU.minKeyLength)throw Error(`dek.keyLength must be least ${EU.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<EU.minSaltLength)throw Error(`dek.saltLength must be least ${EU.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<EU.minIterationCount)throw Error(`dek.iterationCount must be least ${EU.minIterationCount}`);let c=null!=this.init.pass&&this.init.dek?.salt!=null?EP(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";ET.set(this,{dek:c})}get cms(){let a=ET.get(this);if(null==a)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let b=a.dek;return new EM(this,b)}static generateOptions(){let a=Object.assign({},EV),b=3*Math.ceil(EU.minSaltLength/3);return a.dek.salt=(0,cE.toString)(fJ(b),"base64"),a}static get options(){return EV}async createKey(a,b,c=2048){if(!EW(a)||"self"===a)throw await EX(),a7(Error("Invalid key name"),ax.ERR_INVALID_KEY_NAME);if("string"!=typeof b)throw await EX(),a7(Error("Invalid key type"),ax.ERR_INVALID_KEY_TYPE);let d=EY(a),e=await this.components.getDatastore().has(d);if(e)throw await EX(),a7(Error("Key name already exists"),ax.ERR_KEY_ALREADY_EXISTS);if("rsa"===b.toLowerCase()&&(!Number.isSafeInteger(c)||c<2048))throw await EX(),a7(Error("Invalid RSA key size"),ax.ERR_INVALID_KEY_SIZE);let f;try{let g=await iF(b,c),h=await g.id(),i=ET.get(this);if(null==i)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let j=i.dek,k=await g.export(j);f={name:a,id:h};let l=this.components.getDatastore().batch();l.put(d,(0,cB.fromString)(k)),l.put(EZ(a),(0,cB.fromString)(JSON.stringify(f))),await l.commit()}catch(m){throw await EX(),m}return f}async listKeys(){let a={prefix:ES},b=[];for await(let c of this.components.getDatastore().query(a))b.push(JSON.parse((0,cE.toString)(c.value)));return b}async findKeyById(a){try{let b=await this.listKeys();return b.find(b=>b.id===a)}catch(c){throw await EX(),c}}async findKeyByName(a){if(!EW(a))throw await EX(),a7(Error(`Invalid key name '${a}'`),ax.ERR_INVALID_KEY_NAME);let b=EZ(a);try{let c=await this.components.getDatastore().get(b);return JSON.parse((0,cE.toString)(c))}catch(d){throw await EX(),EQ.error(d),a7(Error(`Key '${a}' does not exist.`),ax.ERR_KEY_NOT_FOUND)}}async removeKey(a){if(!EW(a)||"self"===a)throw await EX(),a7(Error(`Invalid key name '${a}'`),ax.ERR_INVALID_KEY_NAME);let b=EY(a),c=await this.findKeyByName(a),d=this.components.getDatastore().batch();return d.delete(b),d.delete(EZ(a)),await d.commit(),c}async renameKey(a,b){if(!EW(a)||"self"===a)throw await EX(),a7(Error(`Invalid old key name '${a}'`),ax.ERR_OLD_KEY_NAME_INVALID);if(!EW(b)||"self"===b)throw await EX(),a7(Error(`Invalid new key name '${b}'`),ax.ERR_NEW_KEY_NAME_INVALID);let c=EY(a),d=EY(b),e=EZ(a),f=EZ(b),g=await this.components.getDatastore().has(d);if(g)throw await EX(),a7(Error(`Key '${b}' already exists`),ax.ERR_KEY_ALREADY_EXISTS);try{let h=await this.components.getDatastore().get(c),i=await this.components.getDatastore().get(e),j=JSON.parse((0,cE.toString)(i));j.name=b;let k=this.components.getDatastore().batch();return k.put(d,h),k.put(f,(0,cB.fromString)(JSON.stringify(j))),k.delete(c),k.delete(e),await k.commit(),j}catch(l){throw await EX(),l}}async exportKey(a,b){if(!EW(a))throw await EX(),a7(Error(`Invalid key name '${a}'`),ax.ERR_INVALID_KEY_NAME);if(null==b)throw await EX(),a7(Error("Password is required"),ax.ERR_PASSWORD_REQUIRED);let c=EY(a);try{let d=await this.components.getDatastore().get(c),e=(0,cE.toString)(d),f=ET.get(this);if(null==f)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let g=f.dek,h=await iJ(e,g);return await h.export(b)}catch(i){throw await EX(),i}}async importKey(a,b,c){if(!EW(a)||"self"===a)throw await EX(),a7(Error(`Invalid key name '${a}'`),ax.ERR_INVALID_KEY_NAME);if(null==b)throw await EX(),a7(Error("PEM encoded key is required"),ax.ERR_PEM_REQUIRED);let d=EY(a),e=await this.components.getDatastore().has(d);if(e)throw await EX(),a7(Error(`Key '${a}' already exists`),ax.ERR_KEY_ALREADY_EXISTS);let f;try{f=await iJ(b,c)}catch(g){throw await EX(),a7(Error("Cannot read the key, most likely the password is wrong"),ax.ERR_CANNOT_READ_KEY)}let h;try{h=await f.id();let i=ET.get(this);if(null==i)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let j=i.dek;b=await f.export(j)}catch(k){throw await EX(),k}let l={name:a,id:h},m=this.components.getDatastore().batch();return m.put(d,(0,cB.fromString)(b)),m.put(EZ(a),(0,cB.fromString)(JSON.stringify(l))),await m.commit(),l}async importPeer(a,b){try{if(!EW(a))throw a7(Error(`Invalid key name '${a}'`),ax.ERR_INVALID_KEY_NAME);if(null==b||null==b.privateKey)throw a7(Error("Peer.privKey is required"),ax.ERR_MISSING_PRIVATE_KEY);let c=await iI(b.privateKey),d=EY(a),e=await this.components.getDatastore().has(d);if(e)throw await EX(),a7(Error(`Key '${a}' already exists`),ax.ERR_KEY_ALREADY_EXISTS);let f=ET.get(this);if(null==f)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let g=f.dek,h=await c.export(g),i={name:a,id:b.toString()},j=this.components.getDatastore().batch();return j.put(d,(0,cB.fromString)(h)),j.put(EZ(a),(0,cB.fromString)(JSON.stringify(i))),await j.commit(),i}catch(k){throw await EX(),k}}async getPrivateKey(a){if(!EW(a))throw await EX(),a7(Error(`Invalid key name '${a}'`),ax.ERR_INVALID_KEY_NAME);try{let b=EY(a),c=await this.components.getDatastore().get(b);return(0,cE.toString)(c)}catch(d){throw await EX(),EQ.error(d),a7(Error(`Key '${a}' does not exist.`),ax.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(a,b){if("string"!=typeof a)throw await EX(),a7(Error(`Invalid old pass type '${typeof a}'`),ax.ERR_INVALID_OLD_PASS_TYPE);if("string"!=typeof b)throw await EX(),a7(Error(`Invalid new pass type '${typeof b}'`),ax.ERR_INVALID_NEW_PASS_TYPE);if(b.length<20)throw await EX(),a7(Error(`Invalid pass length ${b.length}`),ax.ERR_INVALID_PASS_LENGTH);EQ("recreating keychain");let c=ET.get(this);if(null==c)throw a7(Error("dek missing"),ax.ERR_INVALID_PARAMETERS);let d=c.dek;this.init.pass=b;let e=null!=b&&this.init.dek?.salt!=null?EP(b,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";ET.set(this,{dek:e});let f=await this.listKeys();for(let g of f){let h=await this.components.getDatastore().get(EY(g.name)),i=(0,cE.toString)(h),j=await iJ(i,d),k=e.toString(),l=await j.export(k),m=this.components.getDatastore().batch(),n={name:g.name,id:g.id};m.put(EY(g.name),(0,cB.fromString)(l)),m.put(EZ(g.name),(0,cB.fromString)(JSON.stringify(n))),await m.commit()}EQ("keychain reconstructed")}}var E_=c(4321);class E0{constructor(a){if("number"!=typeof a)throw Error("must provide a timespan to the moving average constructor");if(a<=0)throw Error("must provide a timespan > 0 to the moving average constructor");this.timespan=a,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(a,b){return 1-Math.exp(-(a-b)/this.timespan)}push(a,b){if(null!=this.previousTime){let c=this.alpha(a,this.previousTime),d=b-this.movingAverage,e=c*d;this.movingAverage=c*b+(1-c)*this.movingAverage,this.variance=(1-c)*(this.variance+d*e),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+c*d}else this.movingAverage=b;this.previousTime=a}}function E1(a){return new E0(a)}class E2 extends vG{constructor(a){super(),this.enabled=a.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=a.computeThrottleMaxQueueSize,this.computeThrottleTimeout=a.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=a.movingAverageIntervals;for(let b=0;b<a.initialCounters.length;b++){let c=a.initialCounters[b];this.stats[c]=0n,this.movingAverages[c]=[];for(let d=0;d<this.movingAverageIntervals.length;d++){let e=this.movingAverageIntervals[d],f=this.movingAverages[c][e]=E1(e);f.push(this.frequencyLastTime,0)}}}start(){this.enabled&&this.queue.length>0&&this._resetComputeTimeout()}stop(){null!=this.timeout&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(a,b){this.queue.push([a,b,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=DB(this._update,this._nextTimeout())}_nextTimeout(){let a=this.queue.length/this.computeThrottleMaxQueueSize,b=Math.max(this.computeThrottleTimeout*(1-a),0);return b}_update(){if(this.timeout=null,this.queue.length>0){let a=["",0,0];for(a of this.queue)this._applyOp(a);this.queue=[],a.length>2&&""!==a[0]&&this._updateFrequency(a[2]),this.dispatchEvent(new vI("update",{detail:this.stats}))}}_updateFrequency(a){let b=a-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",b,a),this._updateFrequencyFor("dataSent",b,a),this.frequencyLastTime=a}_updateFrequencyFor(a,b,c){let d=this.frequencyAccumulators[a]??0;this.frequencyAccumulators[a]=0;let e=b??1,f=d/e*1e3,g=this.movingAverages[a];null==g&&(g=this.movingAverages[a]=[]);let h=this.movingAverageIntervals;for(let i=0;i<h.length;i++){let j=h[i],k=g[j];null==k&&(k=g[j]=E1(j)),k.push(c,f)}}_applyOp(a){let b=a[0],c=a[1];if("number"!=typeof c)throw Error("invalid increment number");let d;d=Object.prototype.hasOwnProperty.call(this.stats,b)?this.stats[b]:this.stats[b]=0n,this.stats[b]=d+BigInt(c),null==this.frequencyAccumulators[b]&&(this.frequencyAccumulators[b]=0),this.frequencyAccumulators[b]+=c}}let E3=["dataReceived","dataSent"],E4={in:"dataReceived",out:"dataSent"};class E5{constructor(a){this.enabled=a.enabled,this.statsInit={...a,initialCounters:E3},this.globalStats=new E2(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=c7(a.maxOldPeersRetention??DS.maxOldPeersRetention),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}async start(){this.enabled&&(this.running=!0)}async stop(){if(this.running){for(let a of(this.running=!1,this.globalStats.stop(),this.peerStats.values()))a.stop();for(let b of this.protocolStats.values())b.stop()}}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(a){let{system:b="libp2p",component:c,metric:d,value:e}=a;this.systems.has(b)||this.systems.set(b,new Map);let f=this.systems.get(b);if(null==f)throw Error("Unknown metric system");f.has(c)||f.set(c,new Map);let g=f.get(c);if(null==g)throw Error("Unknown metric component");g.set(d,e)}forPeer(a){let b=a.toString();return this.peerStats.get(b)??this.oldPeers.get(b)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(a){return this.protocolStats.get(a)}onPeerDisconnected(a){let b=a.toString(),c=this.peerStats.get(b);null!=c&&(c.stop(),this.peerStats.delete(b),this.oldPeers.set(b,c))}_onMessage(a){if(!this.running)return;let{remotePeer:b,protocol:c,direction:d,dataLength:e}=a,f=E4[d],g=this.forPeer(b);if(null==g){let h=new E2(this.statsInit);this.peerStats.set(b.toString(),h),g=h}if(g.push(f,e),this.globalStats.push(f,e),null!=c){let i=this.forProtocol(c);if(null==i){let j=new E2(this.statsInit);this.protocolStats.set(c,j),i=j}i.push(f,e)}}updatePlaceholder(a,b){if(!this.running)return;let c=a.toString(),d=this.peerStats.get(c)??this.oldPeers.get(c),e=b.toString(),f=this.peerStats.get(e)??this.oldPeers.get(e),g=d;null!=f&&(g=E6(f,g),this.oldPeers.remove(e)),this.peerStats.delete(a.toString()),this.peerStats.set(e,g),g.start()}trackStream(a){let{stream:b,remotePeer:c,protocol:d}=a;if(!this.running)return b;let e=b.source;b.source=E_(e,a=>this._onMessage({remotePeer:c,protocol:d,direction:"in",dataLength:a.length}));let f=b.sink;return b.sink=async a=>await mk(a,a=>E_(a,a=>{this._onMessage({remotePeer:c,protocol:d,direction:"out",dataLength:a.length})}),f),b}}function E6(a,b){return a.stop(),b.stop(),a.queue=[...a.queue,...b.queue],a}async function E7(a){try{let b=await a;return{status:"fulfilled",value:b,isFulfilled:!0,isRejected:!1}}catch(c){return{status:"rejected",reason:c,isFulfilled:!1,isRejected:!0}}}class E8{value;next;constructor(a){this.value=a}}class E9{#a;#b;#c;constructor(){this.clear()}enqueue(a){let b=new E8(a);this.#a?(this.#b.next=b,this.#b=b):(this.#a=b,this.#b=b),this.#c++}dequeue(){let a=this.#a;if(a)return this.#a=this.#a.next,this.#c--,a.value}clear(){this.#a=void 0,this.#b=void 0,this.#c=0}get size(){return this.#c}*[Symbol.iterator](){let a=this.#a;for(;a;)yield a.value,a=a.next}}function Fa(a){if(!((Number.isInteger(a)||a===Number.POSITIVE_INFINITY)&&a>0))throw TypeError("Expected `concurrency` to be a number from 1 and up");let b=new E9,c=0,d=()=>{c--,b.size>0&&b.dequeue()()},e=async(a,b,e)=>{c++;let f=(async()=>a(...e))();b(f);try{await f}catch{}d()},f=(d,f,g)=>{b.enqueue(e.bind(void 0,d,f,g)),(async()=>{await Promise.resolve(),c<a&&b.size>0&&b.dequeue()()})()},g=(a,...b)=>new Promise(c=>{f(a,c,b)});return Object.defineProperties(g,{activeCount:{get:()=>c},pendingCount:{get:()=>b.size},clearQueue:{value:()=>{b.clear()}}}),g}async function Fb(a,b={}){let{concurrency:c=Number.POSITIVE_INFINITY}=b,d=Fa(c);return Promise.all(a.map(a=>a&&"function"==typeof a.then?E7(a):"function"==typeof a?E7(d(()=>a())):E7(Promise.resolve(a))))}let Fc=a6("libp2p:transports");class Fd extends vG{constructor(a,b={}){super(),this.components=a,this.started=!1,this.transports=new Map,this.listeners=DD({component:"transport-manager",metric:"listeners",metrics:this.components.getMetrics()}),this.faultTolerance=b.faultTolerance??az.FATAL_ALL}add(a){let b=a[Symbol.toStringTag];if(null==b)throw a7(Error("Transport must have a valid tag"),ax.ERR_INVALID_KEY);if(this.transports.has(b))throw a7(Error("There is already a transport with this tag"),ax.ERR_DUPLICATE_TRANSPORT);Fc("adding transport %s",b),this.transports.set(b,a),this.listeners.has(b)||this.listeners.set(b,[])}isStarted(){return this.started}async start(){let a=this.components.getAddressManager().getListenAddrs();await this.listen(a),this.started=!0}async stop(){let a=[];for(let[b,c]of this.listeners)for(Fc("closing listeners for %s",b);c.length>0;){let d=c.pop();null!=d&&a.push(d.close())}for(let e of(await Promise.all(a),Fc("all listeners closed"),this.listeners.keys()))this.listeners.set(e,[]);this.started=!1}async dial(a,b){let c=this.transportForMultiaddr(a);if(null==c)throw a7(Error(`No transport available for address ${String(a)}`),ax.ERR_TRANSPORT_UNAVAILABLE);try{return await c.dial(a,{...b,upgrader:this.components.getUpgrader()})}catch(d){throw null==d.code&&(d.code=ax.ERR_TRANSPORT_DIAL_FAILED),d}}getAddrs(){let a=[];for(let b of this.listeners.values())for(let c of b)a=[...a,...c.getAddrs()];return a}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(a){for(let b of this.transports.values()){let c=b.filter([a]);if(c.length>0)return b}}async listen(a){if(null==a||0===a.length){Fc("no addresses were provided for listening, this node is dial only");return}let b=[];for(let[c,d]of this.transports.entries()){let e=d.filter(a),f=[];for(let g of e){Fc("creating listener for %s on %s",c,g);let h=d.createListener({upgrader:this.components.getUpgrader()}),i=this.listeners.get(c);null==i&&(i=[],this.listeners.set(c,i)),i.push(h),h.addEventListener("listening",()=>{this.dispatchEvent(new vI("listener:listening",{detail:h}))}),h.addEventListener("close",()=>{this.dispatchEvent(new vI("listener:close",{detail:h}))}),f.push(h.listen(g))}if(0===f.length){b.push(c);continue}let j=await Fb(f),k=j.find(a=>a.isFulfilled);if(null==k&&this.faultTolerance!==az.NO_FATAL)throw a7(Error(`Transport (${c}) could not listen on any available address`),ax.ERR_NO_VALID_ADDRESSES)}if(b.length===this.transports.size){let l=`no valid addresses were provided for transports [${b.join(", ")}]`;if(this.faultTolerance===az.FATAL_ALL)throw a7(Error(l),ax.ERR_NO_VALID_ADDRESSES);Fc(`libp2p in dial mode only: ${l}`)}}async remove(a){for(let b of(Fc("removing %s",a),this.listeners.get(a)??[]))await b.close();this.transports.delete(a),this.listeners.delete(a)}async removeAll(){let a=[];for(let b of this.transports.keys())a.push(this.remove(b));await Promise.all(a)}}(GX=az||(az={}))[GX.FATAL_ALL=0]="FATAL_ALL",GX[GX.NO_FATAL=1]="NO_FATAL";let Fe=(0,cB.fromString)("\n");function Ff(a){let b=new eb(a,Fe);return vM.single(b).slice()}function Fg(a,b){a.push(Ff(b).slice())}function Fh(a,b){let c=new eb;for(let d of b)c.append(Ff(d));a.push(c.slice())}async function Fi(a,b){let c=1,d={[Symbol.asyncIterator]:()=>d,next:async()=>await a.next(c)},e=d;b?.signal!=null&&(e=v1(d,b.signal));let f=a=>{c=a},g=await mk(e,vT({onLength:f}),async a=>await pR(a));if(null==g)throw a7(Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(g[g.length-1]!==Fe[0])throw a7(Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return g.slice(0,-1)}async function Fj(a,b){let c=await Fi(a,b);return(0,cE.toString)(c)}let Fk=a6("libp2p:mss:select");async function Fl(a,b,c,d){b=Array.isArray(b)?[...b]:[b];let{reader:e,writer:f,rest:g,stream:h}=Eg(a),i=b.shift();if(null==i)throw Error("At least one protocol must be specified");null!=c?(Fk('select: write ["%s", "%s"]',c,i),Fh(f,[(0,cB.fromString)(c),(0,cB.fromString)(i)])):(Fk('select: write "%s"',i),Fg(f,(0,cB.fromString)(i)));let j=await Fj(e,d);if(Fk('select: read "%s"',j),j===c&&(j=await Fj(e,d),Fk('select: read "%s"',j)),j===i)return g(),{stream:h,protocol:i};for(let k of b){Fk('select: write "%s"',k),Fg(f,(0,cB.fromString)(k));let l=await Fj(e,d);if(Fk('select: read "%s" for "%s"',l,k),l===k)return g(),{stream:h,protocol:k}}throw g(),a7(Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}let Fm="/multistream/1.0.0",Fn=a6("libp2p:mss:handle");async function Fo(a,b,c){b=Array.isArray(b)?b:[b];let{writer:d,reader:e,rest:f,stream:g}=Eg(a);for(;;){let h=await Fj(e,c);if(Fn('read "%s"',h),h===Fm){Fn('respond with "%s" for "%s"',Fm,h),Fg(d,(0,cB.fromString)(Fm));continue}if(b.includes(h))return Fg(d,(0,cB.fromString)(h)),Fn('respond with "%s" for "%s"',h,h),f(),{stream:g,protocol:h};if("ls"===h){Fg(d,new eb(...b.map(a=>Ff((0,cB.fromString)(a))))),Fn('respond with "%s" for %s',b,h);continue}Fg(d,(0,cB.fromString)("na")),Fn('respond with "na" for "%s"',h)}}let Fp=a6("libp2p:mss:ls");async function Fq(a,b){let{reader:c,writer:d,rest:e,stream:f}=Eg(a);Fp('write "ls"'),Fg(d,(0,cB.fromString)("ls")),e();let g=await Fi(c,b),h=or([g]),i=[];await mk(h,vT(),async a=>{for await(let b of a)i.push((0,cE.toString)(b.slice(0,-1)))});let j={stream:f,protocols:i};return j}class Fr{constructor(a){this.stream=a,this.shaken=!1}async _handshake(a){if(this.shaken)return;let{stream:b}=await Fl(this.stream,Fm,void 0,a);this.stream=b,this.shaken=!0}}class Fs extends Fr{async select(a,b){return await Fl(this.stream,a,this.shaken?void 0:Fm,b)}async ls(a){await this._handshake(a);let b=await Fq(this.stream,a),{stream:c,protocols:d}=b;return this.stream=c,d}}class Ft extends Fr{async handle(a,b){return await Fo(this.stream,a,b)}}var Fu=c(99633);let Fv=Symbol.for("@libp2p/connection"),Fw=a6("libp2p:connection");class Fx{constructor(a){let{remoteAddr:b,remotePeer:c,newStream:d,close:e,getStreams:f,stat:g}=a;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=b,this.remotePeer=c,this.stat={...g,status:DE},this._newStream=d,this._close=e,this._getStreams=f,this.registry=new Map,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[Fv](){return!0}get streams(){return this._getStreams()}async newStream(a,b){if(this.stat.status===DF)throw a7(Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===DG)throw a7(Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(a)||(a=[a]);let{stream:c,protocol:d}=await this._newStream(a,b);return this.addStream(c,{protocol:d,metadata:{}}),{stream:c,protocol:d}}addStream(a,b={}){this.registry.set(a.id,{protocol:b.protocol??"",metadata:b.metadata??{}})}removeStream(a){this.registry.delete(a)}async close(){if(this.stat.status!==DG&&!this._closing){this.stat.status=DF;try{this.streams.forEach(a=>a.close())}catch(a){Fw.error(a)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=DG}}}function Fy(a){return new Fx(a)}let Fz=a6("libp2p:upgrader");class FA extends vG{constructor(a,b){super(),this.components=a,this.connectionEncryption=new Map,b.connectionEncryption.forEach(a=>{this.connectionEncryption.set(a.protocol,a)}),this.muxers=new Map,b.muxers.forEach(a=>{this.muxers.set(a.protocol,a)})}async upgradeInbound(a){let b,c,d,e,f,g,h,i=this.components.getMetrics();if(await this.components.getConnectionGater().denyInboundConnection(a))throw a7(Error("The multiaddr connection is blocked by gater.acceptConnection"),ax.ERR_CONNECTION_INTERCEPTED);if(null!=i){({setTarget:g,proxy:h}=Fu());let j=`${(1e9*Math.random()).toString(36)}${Date.now()}`;g({toString:()=>j}),a=i.trackStream({stream:a,remotePeer:h})}Fz("starting the inbound connection upgrade");let k=a,l=this.components.getConnectionProtector();null!=l&&(Fz("protecting the inbound connection"),k=await l.protect(a));try{if({conn:b,remotePeer:c,protocol:f}=await this._encryptInbound(k),await this.components.getConnectionGater().denyInboundEncryptedConnection(c,{...k,...b}))throw a7(Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ax.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){let m=await this._multiplexInbound({...k,...b},this.muxers);e=m.muxerFactory,d=m.stream}else d=b}catch(n){throw Fz.error("Failed to upgrade inbound connection",n),await a.close(n),n}if(await this.components.getConnectionGater().denyInboundUpgradedConnection(c,{...k,...b}))throw a7(Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ax.ERR_CONNECTION_INTERCEPTED);return null!=i&&(i.updatePlaceholder(h,c),g(c)),Fz("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:f,direction:"inbound",maConn:a,upgradedConn:d,muxerFactory:e,remotePeer:c})}async upgradeOutbound(a){let b=a.remoteAddr.getPeerId();if(null==b)throw a7(Error("outbound connection must have a peer id"),ax.ERR_INVALID_MULTIADDR);let c=dL(b);if(await this.components.getConnectionGater().denyOutboundConnection(c,a))throw a7(Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),ax.ERR_CONNECTION_INTERCEPTED);let d,e,f,g,h,i,j,k=this.components.getMetrics();if(null!=k){({setTarget:i,proxy:j}=Fu());let l=`${(1e9*Math.random()).toString(36)}${Date.now()}`;i({toB58String:()=>l}),a=k.trackStream({stream:a,remotePeer:j})}Fz("Starting the outbound connection upgrade");let m=a,n=this.components.getConnectionProtector();null!=n&&(m=await n.protect(a));try{if({conn:d,remotePeer:e,protocol:g}=await this._encryptOutbound(m,c),await this.components.getConnectionGater().denyOutboundEncryptedConnection(e,{...m,...d}))throw a7(Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ax.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){let o=await this._multiplexOutbound({...m,...d},this.muxers);h=o.muxerFactory,f=o.stream}else f=d}catch(p){throw Fz.error("Failed to upgrade outbound connection",p),await a.close(p),p}if(await this.components.getConnectionGater().denyOutboundUpgradedConnection(e,{...m,...d}))throw a7(Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ax.ERR_CONNECTION_INTERCEPTED);return null!=k&&(k.updatePlaceholder(j,e),i(e)),Fz("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:g,direction:"outbound",maConn:a,upgradedConn:f,muxerFactory:h,remotePeer:e})}_createConnection(a){let{cryptoProtocol:b,direction:c,maConn:d,upgradedConn:e,remotePeer:f,muxerFactory:g}=a,h,i,j;null!=g&&(h=g.createStreamMuxer(this.components,{onIncomingStream:a=>{null!=j&&Promise.resolve().then(async()=>{let b=new Ft(a),d=this.components.getRegistrar().getProtocols(),{stream:e,protocol:g}=await b.handle(d);Fz("%s: incoming stream opened on %s",c,g);let h=this.components.getMetrics();null!=h&&h.trackStream({stream:e,remotePeer:f,protocol:g}),null!=j&&(j.addStream(a,{protocol:g}),this._onStream({connection:j,stream:{...a,...e},protocol:g}))}).catch(b=>{Fz.error(b),null==a.timeline.close&&a.close()})},onStreamEnd:a=>{j?.removeStream(a.id)}}),i=async(a,b={})=>{if(null==h)throw a7(Error("Stream is not multiplexed"),ax.ERR_MUXER_UNAVAILABLE);Fz("%s: starting new stream on %s",c,a);let d=h.newStream(),e=new Fs(d),g=this.components.getMetrics();try{let{stream:i,protocol:j}=await e.select(a,b);return null!=g&&(i=g.trackStream({stream:i,remotePeer:f,protocol:j})),{stream:{...d,...i},protocol:j}}catch(k){if(Fz.error("could not create new stream",k),null==d.timeline.close&&d.close(),null!=k.code)throw k;throw a7(k,ax.ERR_UNSUPPORTED_PROTOCOL)}},mk(e,h,e).catch(Fz.error));let k=d.timeline;d.timeline=new Proxy(k,{set:(...a)=>(null!=j&&"close"===a[1]&&null!=a[2]&&null==k.close&&(async()=>{try{"OPEN"===j.stat.status&&await j.close()}catch(a){Fz.error(a)}finally{this.dispatchEvent(new vI("connectionEnd",{detail:j}))}})().catch(a=>{Fz.error(a)}),Reflect.set(...a))}),d.timeline.upgraded=Date.now();let l=()=>{throw a7(Error("connection is not multiplexed"),ax.ERR_CONNECTION_NOT_MULTIPLEXED)};return j=Fy({remoteAddr:d.remoteAddr,remotePeer:f,stat:{status:"OPEN",direction:c,timeline:d.timeline,multiplexer:h?.protocol,encryption:b},newStream:i??l,getStreams:()=>null!=h?h.streams:l(),close:async()=>{await d.close(),null!=h&&await Promise.all(h.streams.map(async a=>{await a.close()}))}}),this.dispatchEvent(new vI("connection",{detail:j})),j}_onStream(a){let{connection:b,stream:c,protocol:d}=a,e=this.components.getRegistrar().getHandler(d);e({connection:b,stream:c,protocol:d})}async _encryptInbound(a){let b=new Ft(a),c=Array.from(this.connectionEncryption.keys());Fz("handling inbound crypto protocol selection",c);try{let{stream:d,protocol:e}=await b.handle(c),f=this.connectionEncryption.get(e);if(null==f)throw Error(`no crypto module found for ${e}`);return Fz("encrypting inbound connection..."),{...await f.secureInbound(this.components.getPeerId(),d),protocol:e}}catch(g){throw a7(g,ax.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(a,b){let c=new Fs(a),d=Array.from(this.connectionEncryption.keys());Fz("selecting outbound crypto protocol",d);try{let{stream:e,protocol:f}=await c.select(d),g=this.connectionEncryption.get(f);if(null==g)throw Error(`no crypto module found for ${f}`);return Fz("encrypting outbound connection to %p",b),{...await g.secureOutbound(this.components.getPeerId(),e,b),protocol:f}}catch(h){throw a7(h,ax.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(a,b){let c=new Fs(a),d=Array.from(b.keys());Fz("outbound selecting muxer %s",d);try{let{stream:e,protocol:f}=await c.select(d);Fz("%s selected as muxer protocol",f);let g=b.get(f);return{stream:e,muxerFactory:g}}catch(h){throw Fz.error("error multiplexing outbound stream",h),a7(h,ax.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(a,b){let c=new Ft(a),d=Array.from(b.keys());Fz("inbound handling muxers %s",d);try{let{stream:e,protocol:f}=await c.handle(d),g=b.get(f);return{stream:e,muxerFactory:g}}catch(h){throw Fz.error("error multiplexing inbound stream",h),a7(h,ax.ERR_MUXER_UNAVAILABLE)}}}let FB=a6("libp2p:registrar");function FC(a,b){for(let c of a)if(b.includes(c))return!0;return!1}class FD{constructor(a){this.topologies=new Map,this.handlers=new Map,this.components=a,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onDisconnect),this.components.getPeerStore().addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){let a=new Set;for(let b of this.topologies.values())b.protocols.forEach(b=>a.add(b));for(let c of this.handlers.keys())a.add(c);return Array.from(a).sort()}getHandler(a){let b=this.handlers.get(a);if(null==b)throw Error(`No handler registered for protocol ${a}`);return b}getTopologies(a){let b=[];for(let{topology:c,protocols:d}of this.topologies.values())d.includes(a)&&b.push(c);return b}async handle(a,b){let c=Array.isArray(a)?a:[a];for(let d of c){if(this.handlers.has(d))throw a7(Error(`Handler already registered for protocol ${d}`),ax.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);this.handlers.set(d,b)}await this.components.getPeerStore().protoBook.add(this.components.getPeerId(),c)}async unhandle(a){let b=Array.isArray(a)?a:[a];b.forEach(a=>{this.handlers.delete(a)}),await this.components.getPeerStore().protoBook.remove(this.components.getPeerId(),b)}async register(a,b){if(!vB(b))throw FB.error("topology must be an instance of interfaces/topology"),a7(Error("topology must be an instance of interfaces/topology"),ax.ERR_INVALID_PARAMETERS);let c=`${(1e9*Math.random()).toString(36)}${Date.now()}`;return this.topologies.set(c,{topology:b,protocols:Array.isArray(a)?a:[a]}),await b.setRegistrar(this),c}unregister(a){this.topologies.delete(a)}_onDisconnect(a){let b=a.detail;this.components.getPeerStore().protoBook.get(b.remotePeer).then(a=>{for(let{topology:c,protocols:d}of this.topologies.values())FC(a,d)&&c.onDisconnect(b.remotePeer)}).catch(a=>{FB.error(a)})}_onProtocolChange(a){let{peerId:b,protocols:c,oldProtocols:d}=a.detail,e=d.filter(a=>!c.includes(a)),f=c.filter(a=>!d.includes(a));for(let{topology:g,protocols:h}of this.topologies.values())FC(e,h)&&g.onDisconnect(b);for(let{topology:i,protocols:j}of this.topologies.values())if(FC(f,j)){let k=this.components.getConnectionManager().getConnections(b)[0];if(null==k)continue;i.onConnect(b,k)}}}(GY=aA||(aA={})).codec=()=>e2({5:{name:"protocolVersion",codec:fi,optional:!0},6:{name:"agentVersion",codec:fi,optional:!0},1:{name:"publicKey",codec:eF,optional:!0},2:{name:"listenAddrs",codec:eF,repeats:!0},4:{name:"observedAddr",codec:eF,optional:!0},3:{name:"protocols",codec:fi,repeats:!0},8:{name:"signedPeerRecord",codec:eF,optional:!0}}),GY.encode=a=>ew(a,GY.codec()),GY.decode=a=>ev(a,GY.codec());let FE="0.0.0",FF="libp2p",FG=`js-libp2p/${FE}`,FH="0.1.0",FI="id",FJ="id/push",FK="1.0.0",FL="1.0.0",FM=a6("libp2p:identify"),FN=6e4,FO=8192;class FP{constructor(a,b){this.components=a,this.started=!1,this.init=b,this.handleMessage=this.handleMessage.bind(this),this.identifyProtocolStr=`/${b.protocolPrefix}/${FI}/${FK}`,this.identifyPushProtocolStr=`/${b.protocolPrefix}/${FJ}/${FL}`,this.host={protocolVersion:`${b.protocolPrefix}/${FH}`,...b.host},this.components.getConnectionManager().addEventListener("peer:connect",a=>{let b=a.detail;this.identify(b).catch(FM.error)}),this.components.getPeerStore().addEventListener("change:multiaddrs",a=>{let{peerId:b}=a.detail;this.components.getPeerId().equals(b)&&this.pushToPeerStore().catch(a=>FM.error(a))}),this.components.getPeerStore().addEventListener("change:protocols",a=>{let{peerId:b}=a.detail;this.components.getPeerId().equals(b)&&this.pushToPeerStore().catch(a=>FM.error(a))})}isStarted(){return this.started}async start(){!this.started&&(await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"AgentVersion",(0,cB.fromString)(this.host.agentVersion)),await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"ProtocolVersion",(0,cB.fromString)(this.host.protocolVersion)),await this.components.getRegistrar().handle([this.identifyProtocolStr,this.identifyPushProtocolStr],a=>{this.handleMessage(a)?.catch(a=>{FM.error(a)})}),this.started=!0)}async stop(){await this.components.getRegistrar().unhandle(this.identifyProtocolStr),await this.components.getRegistrar().unhandle(this.identifyPushProtocolStr),this.started=!1}async push(a){let b=await this.components.getPeerStore().addressBook.getRawEnvelope(this.components.getPeerId()),c=this.components.getAddressManager().getAddresses().map(a=>a.bytes),d=await this.components.getPeerStore().protoBook.get(this.components.getPeerId()),e=a.map(async a=>{let e=new cM.TimeoutController(this.init.timeout??FN),f;try{let g=await a.newStream([this.identifyPushProtocolStr],{signal:e.signal});f=g.stream;let h=v3(f,e.signal);await mk([aA.encode({listenAddrs:c,signedPeerRecord:b,protocols:d})],vM(),h,jC)}catch(i){FM.error("could not push identify update to peer",i)}finally{null!=f&&f.close(),e.clear()}});await Promise.all(e)}async pushToPeerStore(){if(!this.isStarted())return;let a=[];for(let b of this.components.getConnectionManager().getConnections()){let c=b.remotePeer,d=await this.components.getPeerStore().get(c);d.protocols.includes(this.identifyPushProtocolStr)&&a.push(b)}await this.push(a)}async _identify(a,b={}){let{stream:c}=await a.newStream([this.identifyProtocolStr],b),d=c,e,f=b.signal;null==f&&(f=(e=new cM.TimeoutController(this.init.timeout??FN)).signal),d=v3(c,f);try{let g=await mk([],d,vT({maxDataLength:this.init.maxIdentifyMessageSize??FO}),async a=>await pR(a));if(null==g)throw a7(Error("No data could be retrieved"),ax.ERR_CONNECTION_ENDED);try{return aA.decode(g)}catch(h){throw a7(h,ax.ERR_INVALID_MESSAGE)}}finally{null!=e&&e.clear(),c.close()}}async identify(a,b={}){let c=await this._identify(a,b),{publicKey:d,listenAddrs:e,protocols:f,observedAddr:g,signedPeerRecord:h,agentVersion:i,protocolVersion:j}=c;if(null==d)throw a7(Error("public key was missing from identify message"),ax.ERR_MISSING_PUBLIC_KEY);let k=await dO(d);if(!a.remotePeer.equals(k))throw a7(Error("identified peer does not match the expected peer"),ax.ERR_INVALID_PEER);if(this.components.getPeerId().equals(k))throw a7(Error("identified peer is our own peer id?"),ax.ERR_INVALID_PEER);let l=FP.getCleanMultiaddr(g);if(null!=h){FM("received signed peer record from %p",k);try{let m=await vt.openAndCertify(h,vz.DOMAIN);if(!m.peerId.equals(k))throw a7(Error("identified peer does not match the expected peer"),ax.ERR_INVALID_PEER);if(await this.components.getPeerStore().addressBook.consumePeerRecord(m)){await this.components.getPeerStore().protoBook.set(k,f),null!=i&&await this.components.getPeerStore().metadataBook.setValue(k,"AgentVersion",(0,cB.fromString)(i)),null!=j&&await this.components.getPeerStore().metadataBook.setValue(k,"ProtocolVersion",(0,cB.fromString)(j)),FM("identify completed for peer %p and protocols %o",k,f);return}}catch(n){FM("received invalid envelope, discard it and fallback to listenAddrs is available",n)}}else FM("no signed peer record received from %p",k);FM("falling back to legacy addresses from %p",k);try{await this.components.getPeerStore().addressBook.set(k,e.map(a=>new lC(a)))}catch(o){FM.error("received invalid addrs",o)}await this.components.getPeerStore().protoBook.set(k,f),null!=i&&await this.components.getPeerStore().metadataBook.setValue(k,"AgentVersion",(0,cB.fromString)(i)),null!=j&&await this.components.getPeerStore().metadataBook.setValue(k,"ProtocolVersion",(0,cB.fromString)(j)),FM("identify completed for peer %p and protocols %o",k,f),FM("received observed address of %s",l?.toString())}handleMessage(a){let{protocol:b}=a;switch(b){case this.identifyProtocolStr:return this._handleIdentify(a);case this.identifyPushProtocolStr:return this._handlePush(a);default:FM.error("cannot handle unknown protocol %s",b)}}async _handleIdentify(a){let{connection:b,stream:c}=a,d=new cM.TimeoutController(this.init.timeout??FN);try{let e=this.components.getPeerId().publicKey??new Uint8Array(0),f=await this.components.getPeerStore().get(this.components.getPeerId()),g=this.components.getAddressManager().getAddresses().map(a=>a.decapsulateCode(k1("p2p").code)),h=f.peerRecordEnvelope;if(g.length>0&&null==h){let i=new vz({peerId:this.components.getPeerId(),multiaddrs:g}),j=await vt.seal(i,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(j),h=j.marshal()}let k=aA.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:g.map(a=>a.bytes),signedPeerRecord:h,observedAddr:b.remoteAddr.bytes,protocols:f.protocols}),l=v3(c,d.signal);await mk([k],vM(),l,jC)}catch(m){FM.error("could not respond to identify request",m)}finally{c.close(),d.clear()}}async _handlePush(a){let{connection:b,stream:c}=a,d=new cM.TimeoutController(this.init.timeout??FN),e;try{let f=v3(c,d.signal),g=await mk([],f,vT({maxDataLength:this.init.maxIdentifyMessageSize??FO}),async a=>await pR(a));null!=g&&(e=aA.decode(g))}catch(h){return FM.error("received invalid message",h)}finally{c.close(),d.clear()}if(null==e)return FM.error("received invalid message");let i=b.remotePeer;if(this.components.getPeerId().equals(i)){FM("received push from ourselves?");return}if(FM("received push from %p",i),null!=e.signedPeerRecord){FM("received signedPeerRecord in push");try{let j=await vt.openAndCertify(e.signedPeerRecord,vz.DOMAIN);if(await this.components.getPeerStore().addressBook.consumePeerRecord(j)){FM("consumed signedPeerRecord sent in push"),await this.components.getPeerStore().protoBook.set(i,e.protocols);return}FM("failed to consume signedPeerRecord sent in push")}catch(k){FM("received invalid envelope, discard it and fallback to listenAddrs is available",k)}}else FM("did not receive signedPeerRecord in push");try{await this.components.getPeerStore().addressBook.set(i,e.listenAddrs.map(a=>new lC(a)))}catch(l){FM.error("received invalid addrs",l)}try{await this.components.getPeerStore().protoBook.set(i,e.protocols)}catch(m){FM.error("received invalid protocols",m)}FM("handled push from %p",i)}static getCleanMultiaddr(a){if(null!=a&&a.length>0)try{return new lC(a)}catch{}}}(GZ=aB||(aB={})).codec=()=>e2({1:{name:"identifier",codec:fi}}),GZ.encode=a=>ew(a,GZ.codec()),GZ.decode=a=>ev(a,GZ.codec());let FQ,FR;(G_=FQ=(G$=aC||(aC={})).StatusCode||(G$.StatusCode={})).OK="OK",G_.NOT_FOUND="NOT_FOUND",G_.ERROR="ERROR",(G0=FR||(FR={}))[G0.OK=0]="OK",G0[G0.NOT_FOUND=1]="NOT_FOUND",G0[G0.ERROR=2]="ERROR",(G1=FQ=G$.StatusCode||(G$.StatusCode={})).codec=()=>eJ(FR),G$.codec=()=>e2({1:{name:"status",codec:G$.StatusCode.codec()},2:{name:"data",codec:eF}}),G$.encode=a=>ew(a,G$.codec()),G$.decode=a=>ev(a,G$.codec());let FS="0.0.1",FT="fetch",FU=a6("libp2p:fetch");class FV{constructor(a,b){this.started=!1,this.components=a,this.protocol=`/${b.protocolPrefix??"libp2p"}/${FT}/${FS}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this)}async start(){await this.components.getRegistrar().handle(this.protocol,a=>{this.handleMessage(a).catch(a=>{FU.error(a)})}),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(a,b,c={}){FU("dialing %s to %p",this.protocol,a);let d=await this.components.getConnectionManager().openConnection(a,c),{stream:e}=await d.newStream([this.protocol],c),f=e;null!=c.signal&&(f=v3(e,c.signal));let g=Eg(f);g.write(vM.single(aB.encode({identifier:b})).slice());let h=aC.decode((await vT.fromReader(g.reader).next()).value.slice());switch(h.status){case aC.StatusCode.OK:return h.data;case aC.StatusCode.NOT_FOUND:return null;case aC.StatusCode.ERROR:{let i=new TextDecoder().decode(h.data);throw a7(Error("Error in fetch protocol response: "+i),ax.ERR_INVALID_PARAMETERS)}default:throw a7(Error("Unknown response status"),ax.ERR_INVALID_MESSAGE)}}async handleMessage(a){let{stream:b}=a,c=Eg(b),d=aB.decode((await vT.fromReader(c.reader).next()).value.slice()),e,f=this._getLookupFunction(d.identifier);if(null!=f){let g=await f(d.identifier);e=null!=g?{status:aC.StatusCode.OK,data:g}:{status:aC.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{let h=new TextEncoder().encode("No lookup function registered for key: "+d.identifier);e={status:aC.StatusCode.ERROR,data:h}}c.write(vM.single(aC.encode(e)).slice())}_getLookupFunction(a){for(let b of this.lookupFunctions.keys())if(a.startsWith(b))return this.lookupFunctions.get(b)}registerLookupFunction(a,b){if(this.lookupFunctions.has(a))throw a7(Error("Fetch protocol handler for key prefix '"+a+"' already registered"),ax.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(a,b)}unregisterLookupFunction(a,b){if(null!=b){let c=this.lookupFunctions.get(a);if(c!==b)return}this.lookupFunctions.delete(a)}}let FW=32,FX="1.0.0",FY="ping",FZ=a6("libp2p:ping");class F${constructor(a,b){this.components=a,this.started=!1,this.protocol=`/${b.protocolPrefix}/${FY}/${FX}`}async start(){await this.components.getRegistrar().handle(this.protocol,this.handleMessage),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(a){let{stream:b}=a;mk(b,b).catch(a=>{FZ.error(a)})}async ping(a,b={}){FZ("dialing %s to %p",this.protocol,a);let c=await this.components.getConnectionManager().openConnection(a,b),{stream:d}=await c.newStream([this.protocol],b),e=Date.now(),f=fJ(FW),g=d;null!=b.signal&&(g=v3(d,b.signal));try{let h=await mk([f],g,async a=>await pR(a)),i=Date.now();if(null==h||!(0,dz.equals)(f,h))throw a7(Error("Received wrong ping ack"),ax.ERR_WRONG_PING_ACK);return i-e}finally{d.close()}}}async function F_(){throw Error("Not supported in browsers")}var F0=c(97916);function F1(a){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(a)||/^::1$/.test(a)}function F2(a){let{address:b}=a.nodeAddress();return F1(b)}let F3=a6("libp2p:nat"),F4=7200;function F5(a=1024,b=65535){return Math.floor(Math.random()*(b-a+1)+a)}class F6{constructor(a,b){if(this.components=a,this.started=!1,this.enabled=b.enabled,this.externalAddress=b.externalAddress,this.localAddress=b.localAddress,this.description=b.description??`${FF}@${FE} ${this.components.getPeerId().toString()}`,this.ttl=b.ttl??F4,this.keepAlive=b.keepAlive?? !0,this.gateway=b.gateway,this.ttl<F4)throw a7(Error(`NatManager ttl should be at least ${F4} seconds`),ax.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){!F0.isBrowser&&this.enabled&&!this.started&&(this.started=!0,this._start().catch(a=>{F3.error(a)}))}async _start(){let a=this.components.getTransportManager().getAddrs();for(let b of a){let{family:c,host:d,port:e,transport:f}=b.toOptions();if(!b.isThinWaistAddress()||"tcp"!==f||F2(b)||4!==c)continue;let g=await this._getClient(),h=this.externalAddress??await g.externalIp();if(DL(h))throw Error(`${h} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let i=F5();F3(`opening uPnP connection from ${h}:${i} to ${d}:${e}`),await g.map({publicPort:i,localPort:e,localAddress:this.localAddress,protocol:"TCP"===f.toUpperCase()?"TCP":"UDP"}),this.components.getAddressManager().addObservedAddr(lC.fromNodeAddress({family:4,address:h,port:i},f))}}async _getClient(){return null!=this.client||(this.client=await F_({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway})),this.client}async stop(){if(!F0.isBrowser&&null!=this.client)try{await this.client.close(),this.client=void 0}catch(a){F3.error(a)}}}let F7=a6("libp2p:peer-record-updater");class F8{constructor(a){this.components=a,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.getTransportManager().addEventListener("listener:listening",this.update),this.components.getTransportManager().addEventListener("listener:close",this.update),this.components.getAddressManager().addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.getTransportManager().removeEventListener("listener:listening",this.update),this.components.getTransportManager().removeEventListener("listener:close",this.update),this.components.getAddressManager().removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then(async()=>{let a=new vz({peerId:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map(a=>a.decapsulateCode(k1("p2p").code))}),b=await vt.seal(a,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(b)}).catch(a=>{F7.error("Could not update self peer record: %o",a)})}}class F9{constructor(a){this.dht=a}async findPeer(a,b={}){for await(let c of this.dht.findPeer(a,b))if("FINAL_PEER"===c.name)return c.peer;throw a7(Error(aw.NOT_FOUND),ax.ERR_NOT_FOUND)}async *getClosestPeers(a,b={}){for await(let c of this.dht.getClosestPeers(a,b))"PEER_RESPONSE"===c.name&&(yield*c.closer)}}let Ga={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"},Gb=a6("libp2p:peer-store:address-book"),Gc="change:multiaddrs";async function Gd(){return!0}class Ge{constructor(a,b,c){this.dispatchEvent=a,this.store=b,this.addressFilter=c??Gd}async consumePeerRecord(a){Gb.trace("consumePeerRecord await write lock");let b=await this.store.lock.writeLock();Gb.trace("consumePeerRecord got write lock");let c,d,e;try{let f;try{f=vz.createFromProtobuf(a.payload)}catch(g){return Gb.error("invalid peer record received"),!1}c=f.peerId;let h=f.multiaddrs;if(!c.equals(a.peerId))return Gb("signing key does not match PeerId in the PeerRecord"),!1;if(null==h||0===h.length)return!1;if(await this.store.has(c)&&(d=await this.store.load(c),null!=d.peerRecordEnvelope)){let i=await vt.createFromProtobuf(d.peerRecordEnvelope),j=vz.createFromProtobuf(i.payload);if(j.seqNumber>=f.seqNumber)return Gb("sequence number was lower or equal to existing sequence number - stored: %d received: %d",j.seqNumber,f.seqNumber),!1}let k=await Gf(c,h,this.addressFilter,!0);e=await this.store.patchOrCreate(c,{addresses:k,peerRecordEnvelope:a.marshal()}),Gb("stored provided peer record for %p",f.peerId)}finally{Gb.trace("consumePeerRecord release write lock"),b()}return this.dispatchEvent(new vI(Gc,{detail:{peerId:c,multiaddrs:e.addresses.map(({multiaddr:a})=>a),oldMultiaddrs:null==d?[]:d.addresses.map(({multiaddr:a})=>a)}})),!0}async getRawEnvelope(a){Gb.trace("getRawEnvelope await read lock");let b=await this.store.lock.readLock();Gb.trace("getRawEnvelope got read lock");try{let c=await this.store.load(a);return c.peerRecordEnvelope}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}finally{Gb.trace("getRawEnvelope release read lock"),b()}}async getPeerRecord(a){let b=await this.getRawEnvelope(a);if(null!=b)return await vt.createFromProtobuf(b)}async get(a){a=dK(a),Gb.trace("get wait for read lock");let b=await this.store.lock.readLock();Gb.trace("get got read lock");try{let c=await this.store.load(a);return c.addresses}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}finally{Gb.trace("get release read lock"),b()}return[]}async set(a,b){if(a=dK(a),!Array.isArray(b))throw Gb.error("multiaddrs must be an array of Multiaddrs"),a7(Error("multiaddrs must be an array of Multiaddrs"),Ga.ERR_INVALID_PARAMETERS);Gb.trace("set await write lock");let c=await this.store.lock.writeLock();Gb.trace("set got write lock");let d=!1,e,f;try{let g=await Gf(a,b,this.addressFilter);if(0===g.length)return;try{if(e=await this.store.load(a),d=!0,new Set([...g.map(({multiaddr:a})=>a.toString()),...e.addresses.map(({multiaddr:a})=>a.toString())]).size===e.addresses.length&&g.length===e.addresses.length)return}catch(h){if(h.code!==Ga.ERR_NOT_FOUND)throw h}f=await this.store.patchOrCreate(a,{addresses:g}),Gb("set multiaddrs for %p",a)}finally{Gb.trace("set multiaddrs for %p",a),Gb("set release write lock"),c()}this.dispatchEvent(new vI(Gc,{detail:{peerId:a,multiaddrs:f.addresses.map(a=>a.multiaddr),oldMultiaddrs:null==e?[]:e.addresses.map(({multiaddr:a})=>a)}})),d||this.dispatchEvent(new vI("peer",{detail:{id:a,multiaddrs:f.addresses.map(a=>a.multiaddr),protocols:f.protocols}}))}async add(a,b){if(a=dK(a),!Array.isArray(b))throw Gb.error("multiaddrs must be an array of Multiaddrs"),a7(Error("multiaddrs must be an array of Multiaddrs"),Ga.ERR_INVALID_PARAMETERS);Gb.trace("add await write lock");let c=await this.store.lock.writeLock();Gb.trace("add got write lock");let d,e,f;try{let g=await Gf(a,b,this.addressFilter);if(0===g.length)return;try{if(e=await this.store.load(a),d=!0,new Set([...g.map(({multiaddr:a})=>a.toString()),...e.addresses.map(({multiaddr:a})=>a.toString())]).size===e.addresses.length)return}catch(h){if(h.code!==Ga.ERR_NOT_FOUND)throw h}f=await this.store.mergeOrCreate(a,{addresses:g}),Gb("added multiaddrs for %p",a)}finally{Gb.trace("set release write lock"),c()}this.dispatchEvent(new vI(Gc,{detail:{peerId:a,multiaddrs:f.addresses.map(a=>a.multiaddr),oldMultiaddrs:null==e?[]:e.addresses.map(({multiaddr:a})=>a)}})),!0===d&&this.dispatchEvent(new vI("peer",{detail:{id:a,multiaddrs:f.addresses.map(a=>a.multiaddr),protocols:f.protocols}}))}async delete(a){a=dK(a),Gb.trace("delete await write lock");let b=await this.store.lock.writeLock();Gb.trace("delete got write lock");let c;try{try{c=await this.store.load(a)}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}await this.store.patchOrCreate(a,{addresses:[]})}finally{Gb.trace("delete release write lock"),b()}null!=c&&this.dispatchEvent(new vI(Gc,{detail:{peerId:a,multiaddrs:[],oldMultiaddrs:null==c?[]:c.addresses.map(({multiaddr:a})=>a)}}))}}async function Gf(a,b,c,d=!1){return await mk(b,a=>E_(a,a=>{if(!lC.isMultiaddr(a))throw Gb.error("multiaddr must be an instance of Multiaddr"),a7(Error("multiaddr must be an instance of Multiaddr"),Ga.ERR_INVALID_PARAMETERS)}),b=>jD(b,async b=>await c(a,b)),a=>jS(a,a=>({multiaddr:new lC(a.toString()),isCertified:d})),async a=>await jA(a))}let Gg=a6("libp2p:peer-store:key-book"),Gh="change:pubkey";class Gi{constructor(a,b){this.dispatchEvent=a,this.store=b}async set(a,b){if(a=dK(a),!(b instanceof Uint8Array))throw Gg.error("publicKey must be an instance of Uint8Array to store data"),a7(Error("publicKey must be an instance of PublicKey"),Ga.ERR_INVALID_PARAMETERS);Gg.trace("set await write lock");let c=await this.store.lock.writeLock();Gg.trace("set got write lock");let d=!1,e;try{try{if(e=await this.store.load(a),null!=e.pubKey&&(0,dz.equals)(e.pubKey,b))return}catch(f){if(f.code!==Ga.ERR_NOT_FOUND)throw f}await this.store.patchOrCreate(a,{pubKey:b}),d=!0}finally{Gg.trace("set release write lock"),c()}d&&this.dispatchEvent(new vI(Gh,{detail:{peerId:a,publicKey:b,oldPublicKey:null==e?void 0:e.pubKey}}))}async get(a){a=dK(a),Gg.trace("get await write lock");let b=await this.store.lock.readLock();Gg.trace("get got write lock");try{let c=await this.store.load(a);return c.pubKey}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}finally{Gg("get release write lock"),b()}}async delete(a){a=dK(a),Gg.trace("delete await write lock");let b=await this.store.lock.writeLock();Gg.trace("delete got write lock");let c;try{try{c=await this.store.load(a)}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}await this.store.patchOrCreate(a,{pubKey:void 0})}catch(e){if(e.code!==Ga.ERR_NOT_FOUND)throw e}finally{Gg.trace("delete release write lock"),b()}this.dispatchEvent(new vI(Gh,{detail:{peerId:a,publicKey:void 0,oldPublicKey:null==c?void 0:c.pubKey}}))}}let Gj=a6("libp2p:peer-store:metadata-book"),Gk="change:metadata";class Gl{constructor(a,b){this.dispatchEvent=a,this.store=b}async get(a){a=dK(a),Gj.trace("get await read lock");let b=await this.store.lock.readLock();Gj.trace("get got read lock");try{let c=await this.store.load(a);return c.metadata}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}finally{Gj.trace("get release read lock"),b()}return new Map}async getValue(a,b){a=dK(a),Gj.trace("getValue await read lock");let c=await this.store.lock.readLock();Gj.trace("getValue got read lock");try{let d=await this.store.load(a);return d.metadata.get(b)}catch(e){if(e.code!==Ga.ERR_NOT_FOUND)throw e}finally{Gj.trace("getValue release write lock"),c()}}async set(a,b){if(a=dK(a),!(b instanceof Map))throw Gj.error("valid metadata must be provided to store data"),a7(Error("valid metadata must be provided"),Ga.ERR_INVALID_PARAMETERS);Gj.trace("set await write lock");let c=await this.store.lock.writeLock();Gj.trace("set got write lock");let d;try{try{d=await this.store.load(a)}catch(e){if(e.code!==Ga.ERR_NOT_FOUND)throw e}await this.store.mergeOrCreate(a,{metadata:b})}finally{Gj.trace("set release write lock"),c()}this.dispatchEvent(new vI(Gk,{detail:{peerId:a,metadata:b,oldMetadata:null==d?new Map:d.metadata}}))}async setValue(a,b,c){if(a=dK(a),"string"!=typeof b||!(c instanceof Uint8Array))throw Gj.error("valid key and value must be provided to store data"),a7(Error("valid key and value must be provided"),Ga.ERR_INVALID_PARAMETERS);Gj.trace("setValue await write lock");let d=await this.store.lock.writeLock();Gj.trace("setValue got write lock");let e,f;try{try{e=await this.store.load(a);let g=e.metadata.get(b);if(null!=g&&(0,dz.equals)(c,g))return}catch(h){if(h.code!==Ga.ERR_NOT_FOUND)throw h}f=await this.store.mergeOrCreate(a,{metadata:new Map([[b,c]])})}finally{Gj.trace("setValue release write lock"),d()}this.dispatchEvent(new vI(Gk,{detail:{peerId:a,metadata:f.metadata,oldMetadata:null==e?new Map:e.metadata}}))}async delete(a){a=dK(a),Gj.trace("delete await write lock");let b=await this.store.lock.writeLock();Gj.trace("delete got write lock");let c;try{try{c=await this.store.load(a)}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}null!=c&&await this.store.patch(a,{metadata:new Map})}finally{Gj.trace("delete release write lock"),b()}null!=c&&this.dispatchEvent(new vI(Gk,{detail:{peerId:a,metadata:new Map,oldMetadata:c.metadata}}))}async deleteValue(a,b){a=dK(a),Gj.trace("deleteValue await write lock");let c=await this.store.lock.writeLock();Gj.trace("deleteValue got write lock");let d,e;try{(d=(e=await this.store.load(a)).metadata).delete(b),await this.store.patch(a,{metadata:d})}catch(f){if(f.code!==Ga.ERR_NOT_FOUND)throw f}finally{Gj.trace("deleteValue release write lock"),c()}null!=d&&this.dispatchEvent(new vI(Gk,{detail:{peerId:a,metadata:d,oldMetadata:null==e?new Map:e.metadata}}))}}let Gm=a6("libp2p:peer-store:proto-book"),Gn="change:protocols";class Go{constructor(a,b){this.dispatchEvent=a,this.store=b}async get(a){Gm.trace("get wait for read lock");let b=await this.store.lock.readLock();Gm.trace("get got read lock");try{let c=await this.store.load(a);return c.protocols}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}finally{Gm.trace("get release read lock"),b()}return[]}async set(a,b){if(a=dK(a),!Array.isArray(b))throw Gm.error("protocols must be provided to store data"),a7(Error("protocols must be provided"),Ga.ERR_INVALID_PARAMETERS);Gm.trace("set await write lock");let c=await this.store.lock.writeLock();Gm.trace("set got write lock");let d,e;try{try{if(d=await this.store.load(a),new Set([...b]).size===d.protocols.length)return}catch(f){if(f.code!==Ga.ERR_NOT_FOUND)throw f}e=await this.store.patchOrCreate(a,{protocols:b}),Gm("stored provided protocols for %p",a)}finally{Gm.trace("set release write lock"),c()}this.dispatchEvent(new vI(Gn,{detail:{peerId:a,protocols:e.protocols,oldProtocols:null==d?[]:d.protocols}}))}async add(a,b){if(a=dK(a),!Array.isArray(b))throw Gm.error("protocols must be provided to store data"),a7(Error("protocols must be provided"),Ga.ERR_INVALID_PARAMETERS);Gm.trace("add await write lock");let c=await this.store.lock.writeLock();Gm.trace("add got write lock");let d,e;try{try{if(d=await this.store.load(a),new Set([...d.protocols,...b]).size===d.protocols.length)return}catch(f){if(f.code!==Ga.ERR_NOT_FOUND)throw f}e=await this.store.mergeOrCreate(a,{protocols:b}),Gm("added provided protocols for %p",a)}finally{Gm.trace("add release write lock"),c()}this.dispatchEvent(new vI(Gn,{detail:{peerId:a,protocols:e.protocols,oldProtocols:null==d?[]:d.protocols}}))}async remove(a,b){if(a=dK(a),!Array.isArray(b))throw Gm.error("protocols must be provided to store data"),a7(Error("protocols must be provided"),Ga.ERR_INVALID_PARAMETERS);Gm.trace("remove await write lock");let c=await this.store.lock.writeLock();Gm.trace("remove got write lock");let d,e;try{try{d=await this.store.load(a);let f=new Set(d.protocols);for(let g of b)f.delete(g);if(d.protocols.length===f.size)return;b=Array.from(f)}catch(h){if(h.code!==Ga.ERR_NOT_FOUND)throw h}e=await this.store.patchOrCreate(a,{protocols:b})}finally{Gm.trace("remove release write lock"),c()}this.dispatchEvent(new vI(Gn,{detail:{peerId:a,protocols:e.protocols,oldProtocols:null==d?[]:d.protocols}}))}async delete(a){a=dK(a),Gm.trace("delete await write lock");let b=await this.store.lock.writeLock();Gm.trace("delete got write lock");let c;try{try{c=await this.store.load(a)}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d}await this.store.patchOrCreate(a,{protocols:[]})}finally{Gm.trace("delete release write lock"),b()}null!=c&&this.dispatchEvent(new vI(Gn,{detail:{peerId:a,protocols:[],oldProtocols:c.protocols}}))}}(G2=aD||(aD={})).codec=()=>e2({1:{name:"addresses",codec:aE.codec(),repeats:!0},2:{name:"protocols",codec:fi,repeats:!0},3:{name:"metadata",codec:aF.codec(),repeats:!0},4:{name:"pubKey",codec:eF,optional:!0},5:{name:"peerRecordEnvelope",codec:eF,optional:!0}}),G2.encode=a=>ew(a,G2.codec()),G2.decode=a=>ev(a,G2.codec()),(G3=aE||(aE={})).codec=()=>e2({1:{name:"multiaddr",codec:eF},2:{name:"isCertified",codec:eB,optional:!0}}),G3.encode=a=>ew(a,G3.codec()),G3.decode=a=>ev(a,G3.codec()),(G4=aF||(aF={})).codec=()=>e2({1:{name:"key",codec:fi},2:{name:"value",codec:eF}}),G4.encode=a=>ew(a,G4.codec()),G4.decode=a=>ev(a,G4.codec());let Gp=a6("libp2p:peer-store:store"),Gq="/peers/";class Gr{constructor(){this.components=new xE,this.lock=qE({name:"peer-store",singleProcess:!0})}init(a){this.components=a}_peerIdToDatastoreKey(a){if(null==a.type)throw Gp.error("peerId must be an instance of peer-id to store data"),a7(Error("peerId must be an instance of peer-id"),Ga.ERR_INVALID_PARAMETERS);let b=a.toCID().toString();return new cI(`${Gq}${b}`)}async has(a){return await this.components.getDatastore().has(this._peerIdToDatastoreKey(a))}async delete(a){await this.components.getDatastore().delete(this._peerIdToDatastoreKey(a))}async load(a){let b=await this.components.getDatastore().get(this._peerIdToDatastoreKey(a)),c=aD.decode(b),d=new Map;for(let e of c.metadata)d.set(e.key,e.value);return{...c,id:a,addresses:c.addresses.map(({multiaddr:a,isCertified:b})=>({multiaddr:new lC(a),isCertified:b?? !1})),metadata:d,pubKey:c.pubKey??void 0,peerRecordEnvelope:c.peerRecordEnvelope??void 0}}async save(a){if(null!=a.pubKey&&null!=a.id.publicKey&&!(0,dz.equals)(a.pubKey,a.id.publicKey))throw Gp.error("peer publicKey bytes do not match peer id publicKey bytes"),a7(Error("publicKey bytes do not match peer id publicKey bytes"),Ga.ERR_INVALID_PARAMETERS);let b=new Set,c=a.addresses.filter(a=>!b.has(a.multiaddr.toString())&&(b.add(a.multiaddr.toString()),!0)).sort((a,b)=>a.multiaddr.toString().localeCompare(b.multiaddr.toString())).map(({multiaddr:a,isCertified:b})=>({multiaddr:a.bytes,isCertified:b})),d=[];[...a.metadata.keys()].sort().forEach(b=>{let c=a.metadata.get(b);null!=c&&d.push({key:b,value:c})});let e=aD.encode({addresses:c,protocols:a.protocols.sort(),pubKey:a.pubKey,metadata:d,peerRecordEnvelope:a.peerRecordEnvelope});return await this.components.getDatastore().put(this._peerIdToDatastoreKey(a.id),e),await this.load(a.id)}async patch(a,b){let c=await this.load(a);return await this._patch(a,b,c)}async patchOrCreate(a,b){let c;try{c=await this.load(a)}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d;c={id:a,addresses:[],protocols:[],metadata:new Map}}return await this._patch(a,b,c)}async _patch(a,b,c){return await this.save({...c,...b,id:a})}async merge(a,b){let c=await this.load(a);return await this._merge(a,b,c)}async mergeOrCreate(a,b){let c;try{c=await this.load(a)}catch(d){if(d.code!==Ga.ERR_NOT_FOUND)throw d;c={id:a,addresses:[],protocols:[],metadata:new Map}}return await this._merge(a,b,c)}async _merge(a,b,c){let d=new Map;return c.addresses.forEach(a=>{d.set(a.multiaddr.toString(),a.isCertified)}),(b.addresses??[]).forEach(a=>{let b=a.multiaddr.toString(),c=Boolean(d.get(b)),e=c||a.isCertified;d.set(b,e)}),await this.save({id:a,addresses:Array.from(d.entries()).map(([a,b])=>({multiaddr:new lC(a),isCertified:b})),protocols:Array.from(new Set([...c.protocols??[],...b.protocols??[]])),metadata:new Map([...c.metadata?.entries()??[],...b.metadata?.entries()??[]]),pubKey:b.pubKey??(null!=c?c.pubKey:void 0),peerRecordEnvelope:b.peerRecordEnvelope??(null!=c?c.peerRecordEnvelope:void 0)})}async *all(){for await(let a of this.components.getDatastore().queryKeys({prefix:Gq})){let b=a.toString().split("/")[2],c=a4.base32.decode(b);yield this.load(dM(c))}}}let Gs=a6("libp2p:peer-store");class Gt extends vG{constructor(a={}){super(),this.components=new xE,this.store=new Gr,this.addressBook=new Ge(this.dispatchEvent.bind(this),this.store,a.addressFilter),this.keyBook=new Gi(this.dispatchEvent.bind(this),this.store),this.metadataBook=new Gl(this.dispatchEvent.bind(this),this.store),this.protoBook=new Go(this.dispatchEvent.bind(this),this.store)}init(a){this.components=a,this.store.init(a)}async forEach(a){Gs.trace("getPeers await read lock");let b=await this.store.lock.readLock();Gs.trace("getPeers got read lock");try{for await(let c of this.store.all())!c.id.equals(this.components.getPeerId())&&a(c)}finally{Gs.trace("getPeers release read lock"),b()}}async all(){let a=[];return await this.forEach(b=>{a.push(b)}),a}async delete(a){Gs.trace("delete await write lock");let b=await this.store.lock.writeLock();Gs.trace("delete got write lock");try{await this.store.delete(a)}finally{Gs.trace("delete release write lock"),b()}}async get(a){Gs.trace("get await read lock");let b=await this.store.lock.readLock();Gs.trace("get got read lock");try{return await this.store.load(a)}finally{Gs.trace("get release read lock"),b()}}async has(a){Gs.trace("has await read lock");let b=await this.store.lock.readLock();Gs.trace("has got read lock");try{return await this.store.has(a)}finally{Gs.trace("has release read lock"),b()}}}class Gu{constructor(a){this.dht=a}async provide(a){await jC(this.dht.provide(a))}async *findProviders(a,b={}){for await(let c of this.dht.findProviders(a,b))"PROVIDER"===c.name&&(yield*c.providers)}async put(a,b,c){await jC(this.dht.put(a,b,c))}async get(a,b){for await(let c of this.dht.get(a,b))if("VALUE"===c.name)return c.value;throw a7(Error("Not found"),"ERR_NOT_FOUND")}}let Gv=a6("libp2p:dialer:auto-dialer");class Gw{constructor(a,b){this.components=a,this.enabled=b.enabled,this.minConnections=b.minConnections,this.dialTimeout=b.dialTimeout}handle(a){let{detail:b}=a;if(!this.enabled)return;let c=this.components.getConnectionManager().getConnections(b.id);if(0===c.length){let d=this.minConnections??0,e=this.components.getConnectionManager().getConnections();if(d>e.length){Gv("auto-dialing discovered peer %p with timeout %d",b.id,this.dialTimeout);let f=new cM.TimeoutController(this.dialTimeout);this.components.getConnectionManager().openConnection(b.id,{signal:f.signal}).catch(a=>{Gv.error("could not connect to discovered peer %p with %o",b.id,a)}).finally(()=>{f.clear()})}}}}var Gx=c(73692);let Gy=globalThis.fetch,Gz=globalThis.Headers;function GA(a,b,c){return`${a}?name=${b}&type=${c}`}async function GB(a,b){let c=await Gy(a,{headers:new Gz({accept:"application/dns-json"}),signal:b}),d=await c.json();return d}function GC(a,b){return`${b}_${a}`}let GD=Object.assign(a2("dns-over-http-resolver"),{error:a2("dns-over-http-resolver:error")});class GE{constructor(a={}){this._cache=new Gx({max:a?.maxCache??100}),this._TXTcache=new Gx({max:a?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=a.request??GB,this._abortControllers=[]}cancel(){this._abortControllers.forEach(a=>a.abort())}getServers(){return this._servers}_getShuffledServers(){let a=[...this._servers];for(let b=a.length-1;b>0;b--){let c=Math.floor(Math.random()*b),d=a[b];a[b]=a[c],a[c]=d}return a}setServers(a){this._servers=a}async resolve(a,b="A"){switch(b){case"A":return await this.resolve4(a);case"AAAA":return await this.resolve6(a);case"TXT":return await this.resolveTxt(a);default:throw Error(`${b} is not supported`)}}async resolve4(a){let b="A",c=this._cache.get(GC(a,b));if(null!=c)return c;let d=!1;for(let e of this._getShuffledServers()){let f=new AbortController;this._abortControllers.push(f);try{let g=await this._request(GA(e,a,b),f.signal),h=g.Answer.map(a=>a.data),i=Math.min(...g.Answer.map(a=>a.TTL));return this._cache.set(GC(a,b),h,{ttl:i}),h}catch(j){f.signal.aborted&&(d=!0),GD.error(`${e} could not resolve ${a} record ${b}`)}finally{this._abortControllers=this._abortControllers.filter(a=>a!==f)}}if(d)throw Object.assign(Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw Error(`Could not resolve ${a} record ${b}`)}async resolve6(a){let b="AAAA",c=this._cache.get(GC(a,b));if(null!=c)return c;let d=!1;for(let e of this._getShuffledServers()){let f=new AbortController;this._abortControllers.push(f);try{let g=await this._request(GA(e,a,b),f.signal),h=g.Answer.map(a=>a.data),i=Math.min(...g.Answer.map(a=>a.TTL));return this._cache.set(GC(a,b),h,{ttl:i}),h}catch(j){f.signal.aborted&&(d=!0),GD.error(`${e} could not resolve ${a} record ${b}`)}finally{this._abortControllers=this._abortControllers.filter(a=>a!==f)}}if(d)throw Object.assign(Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw Error(`Could not resolve ${a} record ${b}`)}async resolveTxt(a){let b="TXT",c=this._TXTcache.get(GC(a,b));if(null!=c)return c;let d=!1;for(let e of this._getShuffledServers()){let f=new AbortController;this._abortControllers.push(f);try{let g=await this._request(GA(e,a,b),f.signal),h=g.Answer.map(a=>[a.data.replace(/['"]+/g,"")]),i=Math.min(...g.Answer.map(a=>a.TTL));return this._TXTcache.set(GC(a,b),h,{ttl:i}),h}catch(j){f.signal.aborted&&(d=!0),GD.error(`${e} could not resolve ${a} record ${b}`)}finally{this._abortControllers=this._abortControllers.filter(a=>a!==f)}}if(d)throw Object.assign(Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw Error(`Could not resolve ${a} record ${b}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}}var GF,GG,GH,GI,GJ,GK,GL,GM,GN,GO,GP,GQ,GR,GS,GT,GU,GV,GW,GX,GY,GZ,G$,G_,G0,G1,G2,G3,G4,G5=GE;let{code:G6}=k1("dnsaddr");async function G7(a,b={}){let c=new G5;null!=b.signal&&b.signal.addEventListener("abort",()=>{c.cancel()});let d=a.getPeerId(),[,e]=a.stringTuples().find(([a])=>a===G6)??[];if(null==e)throw Error("No hostname found in multiaddr");let f=await c.resolveTxt(`_dnsaddr.${e}`),g=f.flat().map(a=>a.split("=")[1]);return null!=d&&(g=g.filter(a=>a.includes(d))),g}let G8={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:a=>a},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:DP,maxDialsPerPeer:DQ,dialTimeout:DO,resolvers:{dnsaddr:G7},addressSorter:DN},connectionGater:{},transportManager:{faultTolerance:az.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:Ev,enabled:!1,ttl:Ew},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:FG},timeout:3e4},ping:{protocolPrefix:"ipfs"},fetch:{protocolPrefix:"libp2p"}};function G9(a){let b=a0(G8,a);if(null==b.transports||b.transports.length<1)throw a7(Error(aw.ERR_TRANSPORTS_REQUIRED),ax.ERR_TRANSPORTS_REQUIRED);if(null==b.connectionEncryption||0===b.connectionEncryption.length)throw a7(Error(aw.CONN_ENCRYPTION_REQUIRED),ax.CONN_ENCRYPTION_REQUIRED);if(null===b.connectionProtector&&globalThis.process?.env?.LIBP2P_FORCE_PNET!=null)throw a7(Error(aw.ERR_PROTECTOR_REQUIRED),ax.ERR_PROTECTOR_REQUIRED);return b}var Ha=c(37124);let Hb=Ha.Reader,Hc=["uint64","int64","sint64","fixed64","sfixed64"];function Hd(a,b){let c=Hb.create(a instanceof Uint8Array?a:a.subarray());return b.decode(c)}Hc.forEach(a=>{let b=Hb.prototype[a];Hb.prototype[a]=function(){return BigInt(b.call(this).toString())}});let He=Ha.Writer,Hf=["uint64","int64","sint64","fixed64","sfixed64"];function Hg(a,b){let c=He.create();return b.encode(a,c,{lengthDelimited:!1}),c.finish()}function Hh(a,b,c,d){return{name:a,type:b,encode:c,decode:d}}function Hi(a){function b(b){if(null==a[b.toString()])throw Error("Invalid enum value");return a[b]}let c=function(a,c){let d=b(a);c.int32(d)},d=function(a){let c=a.uint32();return b(c)};return Hh("enum",aG.VARINT,c,d)}function Hj(a,b){return Hh("message",aG.LENGTH_DELIMITED,a,b)}Hf.forEach(a=>{let b=He.prototype[a];He.prototype[a]=function(a){return b.call(this,a.toString())}}),(d=aG||(aG={}))[d.VARINT=0]="VARINT",d[d.BIT64=1]="BIT64",d[d.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",d[d.START_GROUP=3]="START_GROUP",d[d.END_GROUP=4]="END_GROUP",d[d.BIT32=5]="BIT32",(e=aH||(aH={})).RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1",(f=aI||(aI={}))[f.RSA=0]="RSA",f[f.Ed25519=1]="Ed25519",f[f.Secp256k1=2]="Secp256k1",(g=aH||(aH={})).codec=()=>Hi(aI);let Hk;(h=aJ||(aJ={})).codec=()=>(null==Hk&&(Hk=Hj((a,b,c={})=>{if(!1!==c.lengthDelimited&&b.fork(),null!=a.Type)b.uint32(8),aH.codec().encode(a.Type,b);else throw Error('Protocol error: required field "Type" was not found in object');if(null!=a.Data)b.uint32(18),b.bytes(a.Data);else throw Error('Protocol error: required field "Data" was not found in object');!1!==c.lengthDelimited&&b.ldelim()},(a,b)=>{let c={Type:aH.RSA,Data:new Uint8Array(0)},d=null==b?a.len:a.pos+b;for(;a.pos<d;){let e=a.uint32();switch(e>>>3){case 1:c.Type=aH.codec().decode(a);break;case 2:c.Data=a.bytes();break;default:a.skipType(7&e)}}if(null==c.Type)throw Error('Protocol error: value for required field "Type" was not found in protobuf');if(null==c.Data)throw Error('Protocol error: value for required field "Data" was not found in protobuf');return c})),Hk),h.encode=a=>Hg(a,h.codec()),h.decode=a=>Hd(a,h.codec());let Hl;(i=aK||(aK={})).codec=()=>(null==Hl&&(Hl=Hj((a,b,c={})=>{if(!1!==c.lengthDelimited&&b.fork(),null!=a.Type)b.uint32(8),aH.codec().encode(a.Type,b);else throw Error('Protocol error: required field "Type" was not found in object');if(null!=a.Data)b.uint32(18),b.bytes(a.Data);else throw Error('Protocol error: required field "Data" was not found in object');!1!==c.lengthDelimited&&b.ldelim()},(a,b)=>{let c={Type:aH.RSA,Data:new Uint8Array(0)},d=null==b?a.len:a.pos+b;for(;a.pos<d;){let e=a.uint32();switch(e>>>3){case 1:c.Type=aH.codec().decode(a);break;case 2:c.Data=a.bytes();break;default:a.skipType(7&e)}}if(null==c.Type)throw Error('Protocol error: value for required field "Type" was not found in protobuf');if(null==c.Data)throw Error('Protocol error: value for required field "Data" was not found in protobuf');return c})),Hl),i.encode=a=>Hg(a,i.codec()),i.decode=a=>Hd(a,i.codec());var Hm={get(a=globalThis){let b=a.crypto;if(null==b||null==b.subtle)throw Object.assign(Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return b}};function Hn(a,b){let c=Uint8Array.from(a.abs().toByteArray());if(c=0===c[0]?c.slice(1):c,null!=b){if(c.length>b)throw Error("byte array longer than desired length");c=(0,d7.concat)([new Uint8Array(b-c.length),c])}return(0,cE.toString)(c,"base64url")}function Ho(a){let b=Hp(a);return new fq.jsbn.BigInteger((0,cE.toString)(b,"base16"),16)}function Hp(a,b){let c=(0,cB.fromString)(a,"base64urlpad");if(null!=b){if(c.length>b)throw Error("byte array longer than desired length");c=(0,d7.concat)([new Uint8Array(b-c.length),c])}return c}let Hq={"P-256":256,"P-384":384,"P-521":521},Hr=Object.keys(Hq),Hs=Hr.join(" / "),Ht={"P-256":32,"P-384":48,"P-521":66};function Hu(a,b){if("P-256"!==a&&"P-384"!==a&&"P-521"!==a)throw errcode(Error(`Unknown curve: ${a}. Must be ${Hs}`),"ERR_INVALID_CURVE");let c=Ht[a];if(!uint8ArrayEquals(b.slice(0,1),Uint8Array.from([4])))throw errcode(Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:a,x:uint8ArrayToString(b.slice(1,c+1),"base64url"),y:uint8ArrayToString(b.slice(1+c),"base64url"),ext:!0}}function Hv(a){let b=a?.algorithm??"AES-GCM",c=a?.keyLength??16,d=a?.nonceLength??12,e=a?.digest??"SHA-256",f=a?.saltLength??16,g=a?.iterations??32767,h=Hm.get();async function i(a,i){let j=h.getRandomValues(new Uint8Array(f)),k=h.getRandomValues(new Uint8Array(d)),l={name:b,iv:k};"string"==typeof i&&(i=(0,cB.fromString)(i));let m={name:"PBKDF2",salt:j,iterations:g,hash:{name:e}},n=await h.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),o=await h.subtle.deriveKey(m,n,{name:b,length:c},!0,["encrypt"]),p=await h.subtle.encrypt(l,o,a);return(0,d7.concat)([j,l.iv,new Uint8Array(p)])}async function j(a,i){let j=a.slice(0,f),k=a.slice(f,f+d),l=a.slice(f+d),m={name:b,iv:k};"string"==typeof i&&(i=(0,cB.fromString)(i));let n={name:"PBKDF2",salt:j,iterations:g,hash:{name:e}},o=await h.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),p=await h.subtle.deriveKey(n,o,{name:b,length:c},!0,["decrypt"]),q=await h.subtle.decrypt(m,p,l);return new Uint8Array(q)}c*=8;let k={encrypt:i,decrypt:j};return k}function Hw(a){if(isNaN(a)||a<=0)throw a7(Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return ip.randomBytes(a)}function Hx(a){let b=fq.asn1.fromDer((0,cE.toString)(a,"ascii")),c=fq.pki.privateKeyFromAsn1(b);return{kty:"RSA",n:Hn(c.n),e:Hn(c.e),d:Hn(c.d),p:Hn(c.p),q:Hn(c.q),dp:Hn(c.dP),dq:Hn(c.dQ),qi:Hn(c.qInv),alg:"RS256"}}function Hy(a){if(null==a.n||null==a.e||null==a.d||null==a.p||null==a.q||null==a.dp||null==a.dq||null==a.qi)throw a7(Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let b=fq.pki.privateKeyToAsn1({n:Ho(a.n),e:Ho(a.e),d:Ho(a.d),p:Ho(a.p),q:Ho(a.q),dP:Ho(a.dp),dQ:Ho(a.dq),qInv:Ho(a.qi)});return(0,cB.fromString)(fq.asn1.toDer(b).getBytes(),"ascii")}function Hz(a){let b=fq.asn1.fromDer((0,cE.toString)(a,"ascii")),c=fq.pki.publicKeyFromAsn1(b);return{kty:"RSA",n:Hn(c.n),e:Hn(c.e)}}function HA(a){if(null==a.n||null==a.e)throw a7(Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let b=fq.pki.publicKeyToAsn1({n:Ho(a.n),e:Ho(a.e)});return(0,cB.fromString)(fq.asn1.toDer(b).getBytes(),"ascii")}function HB(a,b){return b.map(b=>Ho(a[b]))}function HC(a){return fq.pki.setRsaPrivateKey(...HB(a,["n","e","d","p","q","dp","dq","qi"]))}function HD(a){return fq.pki.setRsaPublicKey(...HB(a,["n","e"]))}async function HE(a){let b=await Hm.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),c=await HI(b);return{privateKey:c[0],publicKey:c[1]}}async function HF(a){let b=await Hm.get().subtle.importKey("jwk",a,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),c=[b,await HJ(a)],d=await HI({privateKey:c[0],publicKey:c[1]});return{privateKey:d[0],publicKey:d[1]}}async function HG(a,b){let c=await Hm.get().subtle.importKey("jwk",a,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),d=await Hm.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},c,Uint8Array.from(b));return new Uint8Array(d,0,d.byteLength)}async function HH(a,b,c){let d=await Hm.get().subtle.importKey("jwk",a,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await Hm.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},d,b,c)}async function HI(a){if(null==a.privateKey||null==a.publicKey)throw a7(Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([Hm.get().subtle.exportKey("jwk",a.privateKey),Hm.get().subtle.exportKey("jwk",a.publicKey)])}async function HJ(a){return await Hm.get().subtle.importKey("jwk",{kty:a.kty,n:a.n,e:a.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function HK(a,b,c,d){let e=b?HD(a):HC(a),f=(0,cE.toString)(Uint8Array.from(c),"ascii"),g=d(f,e);return(0,cB.fromString)(g,"ascii")}function HL(a,b){return HK(a,!0,b,(a,b)=>b.encrypt(a))}function HM(a,b){return HK(a,!1,b,(a,b)=>b.decrypt(a))}async function HN(a,b){let c=Hv(),d=await c.encrypt(a,b);return a5.base64.encode(d)}class HO{constructor(a){this._key=a}async verify(a,b){return await HH(this._key,b,a)}marshal(){return HA(this._key)}get bytes(){return aJ.encode({Type:aH.RSA,Data:this.marshal()}).subarray()}encrypt(a){return HL(this._key,a)}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}}class HP{constructor(a,b){this._key=a,this._publicKey=b}genSecret(){return Hw(16)}async sign(a){return await HG(this._key,a)}get public(){if(null==this._publicKey)throw a7(Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new HO(this._publicKey)}decrypt(a){return HM(this._key,a)}marshal(){return Hy(this._key)}get bytes(){return aK.encode({Type:aH.RSA,Data:this.marshal()}).subarray()}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}async id(){let a=await this.public.hash();return(0,cE.toString)(a,"base58btc")}async export(a,b="pkcs-8"){if("pkcs-8"===b){let c=new fq.util.ByteBuffer(this.marshal()),d=fq.asn1.fromDer(c),e=fq.pki.privateKeyFromAsn1(d),f={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return fq.pki.encryptRsaPrivateKey(e,a,f)}if("libp2p-key"===b)return await HN(this.bytes,a);throw a7(Error(`export format '${b}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}async function HQ(a){let b=Hx(a),c=await HF(b);return new HP(c.privateKey,c.publicKey)}function HR(a){let b=Hz(a);return new HO(b)}async function HS(a){let b=await HF(a);return new HP(b.privateKey,b.publicKey)}async function HT(a){let b=await HE(a);return new HP(b.privateKey,b.publicKey)}let HU=32,HV=64,HW=32;async function HX(){let a=g2.randomPrivateKey(),b=await gT(a),c=H_(a,b);return{privateKey:c,publicKey:b}}async function HY(a){if(a.length!==HW)throw TypeError('"seed" must be 32 bytes in length.');if(!(a instanceof Uint8Array))throw TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let b=a,c=await gT(b),d=H_(b,c);return{privateKey:d,publicKey:c}}async function HZ(a,b){let c=a.slice(0,HW);return await gU(b,c)}async function H$(a,b,c){return await gX(b,c,a)}function H_(a,b){let c=new Uint8Array(HV);for(let d=0;d<HW;d++)c[d]=a[d],c[HW+d]=b[d];return c}class H0{constructor(a){this._key=H6(a,HU)}async verify(a,b){return await H$(this._key,b,a)}marshal(){return this._key}get bytes(){return aJ.encode({Type:aH.Ed25519,Data:this.marshal()}).subarray()}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}}class H1{constructor(a,b){this._key=H6(a,HV),this._publicKey=H6(b,HU)}async sign(a){return await HZ(this._key,a)}get public(){return new H0(this._publicKey)}marshal(){return this._key}get bytes(){return aK.encode({Type:aH.Ed25519,Data:this.marshal()}).subarray()}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}async id(){let a=await cr.identity.digest(this.public.bytes);return a3.base58btc.encode(a.bytes).substring(1)}async export(a,b="libp2p-key"){if("libp2p-key"===b)return await HN(this.bytes,a);throw a7(Error(`export format '${b}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function H2(a){if(a.length>HV){a=H6(a,HV+HU);let b=a.slice(0,HV),c=a.slice(HV,a.length);return new H1(b,c)}a=H6(a,HV);let d=a.slice(0,HV),e=a.slice(HU);return new H1(d,e)}function H3(a){return a=H6(a,HU),new H0(a)}async function H4(){let{privateKey:a,publicKey:b}=await HX();return new H1(a,b)}async function H5(a){let{privateKey:b,publicKey:c}=await HY(a);return new H1(b,c)}function H6(a,b){if((a=Uint8Array.from(a??[])).length!==b)throw a7(Error(`Key must be a Uint8Array of length ${b}, got ${a.length}`),"ERR_INVALID_KEY_TYPE");return a}function H7(){return ip.randomPrivateKey()}async function H8(a,b){let{digest:c}=await dA.sha256.digest(b);try{return await h6(c,a)}catch(d){throw a7(d,"ERR_INVALID_INPUT")}}async function H9(a,b,c){try{let{digest:d}=await dA.sha256.digest(c);return h8(b,d,a)}catch(e){throw a7(e,"ERR_INVALID_INPUT")}}function Ia(a){let b=hv.fromHex(a).toRawBytes(!0);return b}function Ib(a){try{h0(a,!0)}catch(b){throw a7(b,"ERR_INVALID_PRIVATE_KEY")}}function Ic(a){try{hv.fromHex(a)}catch(b){throw a7(b,"ERR_INVALID_PUBLIC_KEY")}}function Id(a){try{return h0(a,!0)}catch(b){throw a7(b,"ERR_INVALID_PRIVATE_KEY")}}class Ie{constructor(a){Ic(a),this._key=a}async verify(a,b){return await H9(this._key,b,a)}marshal(){return Ia(this._key)}get bytes(){return aJ.encode({Type:aH.Secp256k1,Data:this.marshal()}).subarray()}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}}class If{constructor(a,b){this._key=a,this._publicKey=b??Id(a),Ib(this._key),Ic(this._publicKey)}async sign(a){return await H8(this._key,a)}get public(){return new Ie(this._publicKey)}marshal(){return this._key}get bytes(){return aK.encode({Type:aH.Secp256k1,Data:this.marshal()}).subarray()}equals(a){return(0,dz.equals)(this.bytes,a.bytes)}async hash(){let{bytes:a}=await dA.sha256.digest(this.bytes);return a}async id(){let a=await this.public.hash();return(0,cE.toString)(a,"base58btc")}async export(a,b="libp2p-key"){if("libp2p-key"===b)return await HN(this.bytes,a);throw a7(Error(`export format '${b}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function Ig(a){return new If(a)}function Ih(a){return new Ie(a)}async function Ii(){let a=await H7();return new If(a)}let Ij={rsa:aY,ed25519:aZ,secp256k1:a$};function Ik(a){let b=Object.keys(Ij).join(" / ");return a7(Error(`invalid or unsupported key type ${a}. Must be ${b}`),"ERR_UNSUPPORTED_KEY_TYPE")}function Il(a){if("rsa"===(a=a.toLowerCase())||"ed25519"===a||"secp256k1"===a)return Ij[a];throw Ik(a)}async function Im(a,b){return await Il(a).generateKeyPair(b??2048)}function In(a,b){return Il(b=(b??"rsa").toLowerCase()),a.bytes}function Io(a,b){return Il(b=(b??"rsa").toLowerCase()),a.bytes}let Ip;(j=aL||(aL={})).codec=()=>(null==Ip&&(Ip=Hj((a,b,c={})=>{if(!1!==c.lengthDelimited&&b.fork(),null!=a.id)b.uint32(10),b.bytes(a.id);else throw Error('Protocol error: required field "id" was not found in object');null!=a.pubKey&&(b.uint32(18),b.bytes(a.pubKey)),null!=a.privKey&&(b.uint32(26),b.bytes(a.privKey)),!1!==c.lengthDelimited&&b.ldelim()},(a,b)=>{let c={id:new Uint8Array(0)},d=null==b?a.len:a.pos+b;for(;a.pos<d;){let e=a.uint32();switch(e>>>3){case 1:c.id=a.bytes();break;case 2:c.pubKey=a.bytes();break;case 3:c.privKey=a.bytes();break;default:a.skipType(7&e)}}if(null==c.id)throw Error('Protocol error: value for required field "id" was not found in protobuf');return c})),Ip),j.encode=a=>Hg(a,j.codec()),j.decode=a=>Hd(a,j.codec());let Iq=async()=>{let a=await Im("Ed25519"),b=await It(a);if("Ed25519"===b.type)return b;throw Error(`Generated unexpected PeerId type "${b.type}"`)},Ir=async a=>{let b=await Im("RSA",a?.bits??2048),c=await It(b);if("RSA"===c.type)return c;throw Error(`Generated unexpected PeerId type "${c.type}"`)};async function Is(a){return await peerIdFromKeys(marshalPublicKey(a))}async function It(a){return await dO(In(a.public),Io(a))}class Iu extends vG{get[Dd](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}get lan(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}get(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}findProviders(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}findPeer(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}getClosestPeers(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}provide(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}put(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}async getMode(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}async setMode(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}async refreshRoutingTable(){throw a7(Error(aw.DHT_DISABLED),ax.DHT_DISABLED)}}class Iv extends vG{isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}get multicodecs(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}getPeers(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}getTopics(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}subscribe(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}unsubscribe(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}getSubscribers(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}async publish(){throw a7(Error(aw.PUBSUB_DISABLED),ax.ERR_PUBSUB_DISABLED)}}function Iw(a,b){let c={[Symbol.iterator]:()=>c,next:()=>{let c=a.next(),d=c.value;if(!0===c.done||null==d){let e={done:!0,value:void 0};return e}return{done:!1,value:b(d)}}};return c}class Ix{constructor(a){if(this.map=new Map,null!=a)for(let[b,c]of a.entries())this.map.set(b.toString(),c)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(a){this.map.delete(a.toString())}entries(){return Iw(this.map.entries(),a=>[dL(a[0]),a[1]])}forEach(a){this.map.forEach((b,c)=>{a(b,dL(c),this)})}get(a){return this.map.get(a.toString())}has(a){return this.map.has(a.toString())}set(a,b){this.map.set(a.toString(),b)}keys(){return Iw(this.map.keys(),a=>dL(a))}values(){return this.map.values()}get size(){return this.map.size}}class Iy{constructor(a){if(this.set=new Set,null!=a)for(let b of a)this.set.add(b.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(a){this.set.add(a.toString())}clear(){this.set.clear()}delete(a){this.set.delete(a.toString())}entries(){return Iw(this.set.entries(),a=>{let b=dL(a[0]);return[b,b]})}forEach(a){this.set.forEach(b=>{let c=dL(b);a(c,c,this)})}has(a){return this.set.has(a.toString())}values(){return Iw(this.set.values(),a=>dL(a))}}class Iz{constructor(a){if(this.list=[],null!=a)for(let b of a)this.list.push(b.toString())}[Symbol.iterator](){return mapIterable(this.list.entries(),a=>peerIdFromString(a[1]))}concat(a){let b=new Iz(this);for(let c of a)b.push(c);return b}entries(){return mapIterable(this.list.entries(),a=>[a[0],peerIdFromString(a[1])])}every(a){return this.list.every((b,c)=>a(peerIdFromString(b),c,this))}filter(a){let b=new Iz;return this.list.forEach((c,d)=>{let e=peerIdFromString(c);a(e,d,this)&&b.push(e)}),b}find(a){let b=this.list.find((b,c)=>a(peerIdFromString(b),c,this));if(null!=b)return peerIdFromString(b)}findIndex(a){return this.list.findIndex((b,c)=>a(peerIdFromString(b),c,this))}forEach(a){this.list.forEach((b,c)=>{a(peerIdFromString(b),c,this)})}includes(a){return this.list.includes(a.toString())}indexOf(a){return this.list.indexOf(a.toString())}pop(){let a=this.list.pop();if(null!=a)return peerIdFromString(a)}push(...a){for(let b of a)this.list.push(b.toString())}shift(){let a=this.list.shift();if(null!=a)return peerIdFromString(a)}unshift(...a){let b=this.list.length;for(let c=a.length-1;c> -1;c--)b=this.list.unshift(a[c].toString());return b}get length(){return this.list.length}}let IA=a6("libp2p");class IB extends vG{constructor(a){super(),this.initializables=[],this.started=!1,this.peerId=a.peerId,this.components=new xE({peerId:a.peerId,datastore:a.datastore??new jR,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...a.connectionGater}}),this.components.setPeerStore(new Gt({addressFilter:this.components.getConnectionGater().filterMultiaddrForPeer,...a.peerStore})),this.services=[this.components],a.metrics.enabled&&(this.metrics=this.components.setMetrics(new E5(a.metrics))),this.peerStore=this.components.getPeerStore(),this.peerStore.addEventListener("peer",a=>{let{detail:b}=a;this.dispatchEvent(new vI("peer:discovery",{detail:b}))}),null!=a.connectionProtector&&this.components.setConnectionProtector(a.connectionProtector),this.components.setUpgrader(new FA(this.components,{connectionEncryption:(a.connectionEncryption??[]).map(a=>this.configureComponent(a)),muxers:(a.streamMuxers??[]).map(a=>this.configureComponent(a))})),this.connectionManager=this.components.setConnectionManager(new D1(a.connectionManager)),this.registrar=this.components.setRegistrar(new FD(this.components)),this.components.setTransportManager(new Fd(this.components,a.transportManager)),this.components.setAddressManager(new Dv(this.components,a.addresses)),this.configureComponent(new F8(this.components)),this.configureComponent(new D4(this.components,{enabled:a.connectionManager.autoDial,minConnections:a.connectionManager.minConnections,autoDialInterval:a.connectionManager.autoDialInterval}));let b=E$.generateOptions();this.keychain=this.configureComponent(new E$(this.components,{...b,...a.keychain})),this.services.push(new F6(this.components,a.nat)),a.transports.forEach(a=>{this.components.getTransportManager().add(this.configureComponent(a))}),null!=a.streamMuxers&&a.streamMuxers.length>0&&(this.identifyService=new FP(this.components,{...a.identify}),this.configureComponent(this.identifyService)),null!=a.dht?this.dht=this.components.setDHT(a.dht):this.dht=new Iu,null!=a.pubsub?this.pubsub=this.components.setPubSub(a.pubsub):this.pubsub=new Iv;let c=(a.peerRouters??[]).map(a=>this.configureComponent(a));null!=a.dht&&(c.push(this.configureComponent(new F9(this.dht))),this.dht.addEventListener("peer",a=>{this.onDiscoveryPeer(a)})),this.peerRouting=this.components.setPeerRouting(this.configureComponent(new Dq(this.components,{...a.peerRouting,routers:c})));let d=(a.contentRouters??[]).map(a=>this.configureComponent(a));null!=a.dht&&d.push(this.configureComponent(new Gu(this.dht))),this.contentRouting=this.components.setContentRouting(this.configureComponent(new Dr(this.components,{routers:d}))),a.relay.enabled&&(this.components.getTransportManager().add(this.configureComponent(new Es)),this.configureComponent(new EF(this.components,{addressSorter:a.connectionManager.addressSorter,...a.relay}))),this.fetchService=this.configureComponent(new FV(this.components,{...a.fetch})),this.pingService=this.configureComponent(new F$(this.components,{...a.ping}));let e=this.configureComponent(new Gw(this.components,{enabled:!1!==a.connectionManager.autoDial,minConnections:a.connectionManager.minConnections,dialTimeout:a.connectionManager.dialTimeout??3e4}));for(let f of(this.addEventListener("peer:discovery",a=>{this.isStarted()&&e.handle(a)}),a.peerDiscovery??[]))this.configureComponent(f),f.addEventListener("peer",a=>{this.onDiscoveryPeer(a)})}configureComponent(a){return xC(a)&&this.services.push(a),xD(a)&&this.initializables.push(a),a}async start(){if(!this.started){this.started=!0,IA("libp2p is starting");try{this.initializables.forEach(a=>{a.init(this.components)}),await Promise.all(this.services.map(async a=>{null!=a.beforeStart&&await a.beforeStart()})),await Promise.all(this.services.map(a=>a.start())),await Promise.all(this.services.map(async a=>{null!=a.afterStart&&await a.afterStart()})),IA("libp2p has started"),await this.components.getPeerStore().forEach(a=>{this.dispatchEvent(new vI("peer:discovery",{detail:{id:a.id,multiaddrs:a.addresses.map(a=>a.multiaddr),protocols:a.protocols}}))})}catch(a){throw IA.error("An error occurred starting libp2p",a),await this.stop(),a}}}async stop(){this.started&&(IA("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map(async a=>{null!=a.beforeStop&&await a.beforeStop()})),await Promise.all(this.services.map(a=>a.stop())),await Promise.all(this.services.map(async a=>{null!=a.afterStop&&await a.afterStop()})),IA("libp2p has stopped"))}async loadKeychain(){if(null!=this.keychain)try{await this.keychain.findKeyByName("self")}catch(a){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this.started}getConnections(a){return this.components.getConnectionManager().getConnections(a)}getPeers(){let a=new Iy;for(let b of this.components.getConnectionManager().getConnections())a.add(b.remotePeer);return Array.from(a)}async dial(a,b={}){let{id:c,multiaddrs:d}=Dt(a);return await this.components.getPeerStore().addressBook.add(c,d),await this.components.getConnectionManager().openConnection(c,b)}async dialProtocol(a,b,c={}){if(null==b||0===(b=Array.isArray(b)?b:[b]).length)throw a7(Error("no protocols were provided to open a stream"),ax.ERR_INVALID_PROTOCOLS_FOR_STREAM);let d=await this.dial(a,c);return await d.newStream(b,c)}getMultiaddrs(){return this.components.getAddressManager().getAddresses()}async hangUp(a){let{id:b}=Dt(a);await this.components.getConnectionManager().closeConnections(b)}async getPublicKey(a,b={}){if(IA("getPublicKey %p",a),null!=a.publicKey)return a.publicKey;let c=await this.peerStore.get(a);if(null!=c.pubKey)return c.pubKey;if(null==this.dht)throw a7(Error("Public key was not in the peer store and the DHT is not enabled"),ax.ERR_NO_ROUTERS_AVAILABLE);let d=(0,d7.concat)([(0,cB.fromString)("/pk/"),a.multihash.digest]);for await(let e of this.dht.get(d,b))if("VALUE"===e.name){let f=iG(e.value);return await this.peerStore.keyBook.set(a,e.value),f.bytes}throw a7(Error(`Node not responding with its public key: ${a.toString()}`),ax.ERR_INVALID_RECORD)}async fetch(a,b,c={}){let{id:d,multiaddrs:e}=Dt(a);return null!=e&&await this.components.getPeerStore().addressBook.add(d,e),await this.fetchService.fetch(d,b,c)}async ping(a,b={}){let{id:c,multiaddrs:d}=Dt(a);return d.length>0&&await this.components.getPeerStore().addressBook.add(c,d),await this.pingService.ping(c,b)}async handle(a,b){return await this.components.getRegistrar().handle(a,b)}async unhandle(a){return await this.components.getRegistrar().unhandle(a)}onDiscoveryPeer(a){let{detail:b}=a;if(b.id.toString()===this.peerId.toString()){IA.error(Error(ax.ERR_DISCOVERED_SELF));return}b.multiaddrs.length>0&&this.components.getPeerStore().addressBook.add(b.id,b.multiaddrs).catch(a=>IA.error(a)),b.protocols.length>0&&this.components.getPeerStore().protoBook.set(b.id,b.protocols).catch(a=>IA.error(a)),this.dispatchEvent(new vI("peer:discovery",{detail:b}))}}async function IC(a){return null==a.peerId&&(a.peerId=await Iq()),new IB(G9(a))}async function ID(a){return await IC(a)}var IE=c(99507);let IF=1e3,IG=60*IF,IH=60*IG,II=36*IH,IJ="/lan",IK="/ipfs",IL="/kad/1.0.0",IM="/dht/record",IN="/dht/provider",IO=256,IP=24*IH,IQ=IH,IR=20,IS=3,IT=Number(5*IG),IU=Number(30*IF),IV=Number(5*IG),IW=Number(30*IF),IX=Number(30*IF),IY=(0,cB.fromString)("/pk/");function IZ(a){return{...a,multiaddrs:a.multiaddrs.filter(a=>{let[[b,c]]=a.stringTuples();return(4===b||6===b)&&null!=c&&!DL(c)})}}function I$(a){return{...a,multiaddrs:a.multiaddrs.filter(a=>{let[[b,c]]=a.stringTuples();return(4===b||6===b)&&null!=c&&DL(c)})}}async function I_(a){let b=await dA.sha256.digest(a);return b.digest}async function I0(a){return await I_(a.toBytes())}function I1(a){return new cI(`${IM}/${(0,cE.toString)(a,"base32")}`,!1)}function I2(a){return(0,d7.concat)([IY,a.toBytes()])}function I3(a){return"/pk/"===(0,cE.toString)(a.slice(0,4))}function I4(a){return dM(a.slice(4))}function I5(a,b){let c=new Date,d=new j5(a,b,c);return d.serialize()}let I6="routing-table-size",I7="ping-queue-size",I8="ping-running";class I9{constructor(a){this.components=new xE;let{kBucketSize:b,pingTimeout:c,lan:d,pingConcurrency:e,protocol:f}=a;this.log=a6(`libp2p:kad-dht:${d?"lan":"wan"}:routing-table`),this.kBucketSize=b??20,this.pingTimeout=c??1e4,this.pingConcurrency=e??10,this.lan=d,this.running=!1,this.protocol=f;let g=()=>{this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:I7,value:this.pingQueue.size}),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:I8,value:this.pingQueue.pending})};this.pingQueue=new dm({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",g),this.pingQueue.addListener("next",g),this._onPing=this._onPing.bind(this)}init(a){this.components=a}isStarted(){return this.running}async start(){this.running=!0;let a=new IE({localNodeId:await I0(this.components.getPeerId()),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});a.on("ping",this._onPing),this.kb=a}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_onPing(a,b){this.pingQueue.add(async()=>{if(!this.running)return;let c=0;try{await Promise.all(a.map(async a=>{let b;try{b=new cM.TimeoutController(this.pingTimeout);let d={signal:b.signal};this.log("pinging old contact %p",a.peer);let e=await this.components.getConnectionManager().openConnection(a.peer,d),{stream:f}=await e.newStream(this.protocol,d);f.close(),c++}catch(g){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",a.peer,g),this.log("evicting old contact after ping failed %p",a),this.kb.remove(a.id))}finally{null!=b&&b.clear(),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:I6,value:this.size})}})),this.running&&c<a.length&&null!=this.kb&&(this.log("adding new contact %p",b.peer),this.kb.add(b))}catch(d){this.log.error("could not process k-bucket ping event",d)}}).catch(a=>{this.log.error("could not process k-bucket ping event",a)})}get size(){return null==this.kb?0:this.kb.count()}async find(a){let b=await I0(a),c=this.closestPeer(b);if(null!=c&&a.equals(c))return c}closestPeer(a){let b=this.closestPeers(a,1);if(b.length>0)return b[0]}closestPeers(a,b=this.kBucketSize){if(null==this.kb)return[];let c=this.kb.closest(a,b);return c.map(a=>a.peer)}async add(a){if(null==this.kb)throw Error("RoutingTable is not started");let b=await I0(a);this.kb.add({id:b,peer:a}),this.log("added %p with kad id %b",a,b),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:I6,value:this.size})}async remove(a){if(null==this.kb)throw Error("RoutingTable is not started");let b=await I0(a);this.kb.remove(b),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:I6,value:this.size})}}var Ja=c(53160);function Jb(a,b){if(a.length!==b.length)throw Error("Inputs should have the same length");let c=(0,Ja.E)(a.length);for(let d=0;d<a.length;d++)c[d]=a[d]^b[d];return c}var Jc=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];let Jd=15;class Je{constructor(a){let{peerRouting:b,routingTable:c,refreshInterval:d,refreshQueryTimeout:e,lan:f}=a;this.log=a6(`libp2p:kad-dht:${f?"lan":"wan"}:routing-table:refresh`),this.peerRouting=b,this.routingTable=c,this.refreshInterval=d??IV,this.refreshQueryTimeout=e??IW,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}init(a){}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(a=!1){this.log("refreshing routing table");let b=this._maxCommonPrefix(),c=this._getTrackedCommonPrefixLengthsForRefresh(b);this.log(`max common prefix length ${b}`),this.log(`tracked CPLs [ ${c.map(a=>a.toISOString()).join(", ")} ]`),Promise.all(c.map(async(d,e)=>{try{if(await this._refreshCommonPrefixLength(e,d,a),0===this._numPeersForCpl(b)){let f=Math.min(2*(e+1),c.length-1);for(let g=e+1;g<f+1;g++)try{await this._refreshCommonPrefixLength(g,d,a)}catch(h){this.log.error(h)}}}catch(i){this.log.error(i)}})).catch(a=>{this.log.error(a)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()}).catch(a=>{this.log.error(a)})}async _refreshCommonPrefixLength(a,b,c){if(!c&&b.getTime()>Date.now()-this.refreshInterval){this.log("not running refresh for cpl %s as time since last refresh not above interval",a);return}let d=await this._generateRandomPeerId(a);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",a,d,this.routingTable.size);let e=new cM.TimeoutController(this.refreshQueryTimeout);try{let f=await sS(this.peerRouting.getClosestPeers(d.toBytes(),{signal:e.signal}));this.log(`found ${f} peers that were close to imaginary peer %p`,d),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",a,d,this.routingTable.size)}finally{e.clear()}}_getTrackedCommonPrefixLengthsForRefresh(a){a>Jd&&(a=Jd);let b=[];for(let c=0;c<=a;c++)b[c]=this.commonPrefixLengthRefreshedAt[c]??new Date;return b}async _generateRandomPeerId(a){if(null==this.routingTable.kb)throw Error("Routing table not started");let b=fJ(2),c=(b[1]<<8)+b[0],d=await this._makePeerId(this.routingTable.kb.localNodeId,c,a);return dM(d)}async _makePeerId(a,b,c){if(c>Jd)throw Error(`Cannot generate peer ID for common prefix length greater than ${Jd}`);let d=new DataView(a.buffer,a.byteOffset,a.byteLength),e=d.getUint16(0,!1),f=e^32768>>c,g=65535<<16-(c+1),h=f&g|b& ~g,i=Jc[h],j=new ArrayBuffer(34),k=new DataView(j,0,j.byteLength);return k.setUint8(0,dA.sha256.code),k.setUint8(1,32),k.setUint32(2,i,!1),new Uint8Array(k.buffer,k.byteOffset,k.byteLength)}_maxCommonPrefix(){let a=0;for(let b of this._prefixLengths())b>a&&(a=b);return a}_numPeersForCpl(a){let b=0;for(let c of this._prefixLengths())c===a&&b++;return b}*_prefixLengths(){if(null!=this.routingTable.kb)for(let{id:a}of this.routingTable.kb.toIterable()){let b=Jb(this.routingTable.kb.localNodeId,a),c=0;for(let d of b)if(0===d)c++;else break;yield c}}}(k=aM||(aM={})).codec=()=>e2({1:{name:"key",codec:eF,optional:!0},2:{name:"value",codec:eF,optional:!0},3:{name:"author",codec:eF,optional:!0},4:{name:"signature",codec:eF,optional:!0},5:{name:"timeReceived",codec:fi,optional:!0}}),k.encode=a=>ew(a,k.codec()),k.decode=a=>ev(a,k.codec());let Jf,Jg,Jh,Ji,Jj;(m=Jf=(l=aN||(aN={})).MessageType||(l.MessageType={})).PUT_VALUE="PUT_VALUE",m.GET_VALUE="GET_VALUE",m.ADD_PROVIDER="ADD_PROVIDER",m.GET_PROVIDERS="GET_PROVIDERS",m.FIND_NODE="FIND_NODE",m.PING="PING",(n=Jg||(Jg={}))[n.PUT_VALUE=0]="PUT_VALUE",n[n.GET_VALUE=1]="GET_VALUE",n[n.ADD_PROVIDER=2]="ADD_PROVIDER",n[n.GET_PROVIDERS=3]="GET_PROVIDERS",n[n.FIND_NODE=4]="FIND_NODE",n[n.PING=5]="PING",(o=Jf=l.MessageType||(l.MessageType={})).codec=()=>eJ(Jg),(p=Jh=l.ConnectionType||(l.ConnectionType={})).NOT_CONNECTED="NOT_CONNECTED",p.CONNECTED="CONNECTED",p.CAN_CONNECT="CAN_CONNECT",p.CANNOT_CONNECT="CANNOT_CONNECT",(q=Ji||(Ji={}))[q.NOT_CONNECTED=0]="NOT_CONNECTED",q[q.CONNECTED=1]="CONNECTED",q[q.CAN_CONNECT=2]="CAN_CONNECT",q[q.CANNOT_CONNECT=3]="CANNOT_CONNECT",(r=Jh=l.ConnectionType||(l.ConnectionType={})).codec=()=>eJ(Ji),(s=Jj=l.Peer||(l.Peer={})).codec=()=>e2({1:{name:"id",codec:eF,optional:!0},2:{name:"addrs",codec:eF,repeats:!0},3:{name:"connection",codec:l.ConnectionType.codec(),optional:!0}}),s.encode=a=>ew(a,s.codec()),s.decode=a=>ev(a,s.codec()),l.codec=()=>e2({1:{name:"type",codec:l.MessageType.codec(),optional:!0},10:{name:"clusterLevelRaw",codec:eW,optional:!0},2:{name:"key",codec:eF,optional:!0},3:{name:"record",codec:eF,optional:!0},8:{name:"closerPeers",codec:l.Peer.codec(),repeats:!0},9:{name:"providerPeers",codec:l.Peer.codec(),repeats:!0}}),l.encode=a=>ew(a,l.codec()),l.decode=a=>ev(a,l.codec());let Jk=aN.MessageType,Jl=aN.ConnectionType,Jm=Object.keys(Jk);class Jn{constructor(a,b,c){if(!(b instanceof Uint8Array))throw Error("Key must be a Uint8Array");this.type=a,this.key=b,this.clusterLevelRaw=c,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let a=this.clusterLevelRaw-1;return a<0?0:a}set clusterLevel(a){this.clusterLevelRaw=a}serialize(){return aN.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(Jo),providerPeers:this.providerPeers.map(Jo),record:null==this.record?void 0:this.record.serialize()})}static deserialize(a){let b=aN.decode(a),c=new Jn(b.type??aN.MessageType.PUT_VALUE,b.key??Uint8Array.from([]),b.clusterLevelRaw??0);return c.closerPeers=b.closerPeers.map(Jp),c.providerPeers=b.providerPeers.map(Jp),b.record?.length!=null&&(c.record=j5.deserialize(b.record)),c}}function Jo(a){let b={id:a.id.toBytes(),addrs:(a.multiaddrs??[]).map(a=>a.bytes),connection:Jl.CONNECTED};return b}function Jp(a){if(null==a.id)throw Error("Invalid peer in message");return{id:dM(a.id),multiaddrs:(a.addrs??[]).map(a=>new lC(a)),protocols:[]}}function Jq(a){return{...a,name:"SENDING_QUERY",type:0,messageName:a.type,messageType:Jm.indexOf(a.type.toString())}}function Jr(a){return{...a,name:"PEER_RESPONSE",type:1,messageName:a.messageType,closer:null!=a.closer?a.closer:[],providers:null!=a.providers?a.providers:[]}}function Js(a){return{...a,name:"FINAL_PEER",type:2}}function Jt(a){return{...a,name:"QUERY_ERROR",type:3}}function Ju(a){return{...a,name:"PROVIDER",type:4}}function Jv(a){return{...a,name:"VALUE",type:5}}function Jw(a){return{...a,name:"DIALING_PEER",type:7}}class Jx extends vG{constructor(a){super(),this.components=new xE;let{protocol:b,lan:c}=a;this.log=a6(`libp2p:kad-dht:${c?"lan":"wan"}:network`),this.running=!1,this.protocol=b}init(a){this.components=a}async start(){!this.running&&(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async *sendRequest(a,b,c={}){if(!this.running)return;this.log("sending %s to %p",b.type,a),yield Jw({peer:a}),yield Jq({to:a,type:b.type});let d;try{let e=await this.components.getConnectionManager().openConnection(a,c),f=await e.newStream(this.protocol,c);d=f.stream;let g=await this._writeReadMessage(d,b.serialize(),c);yield Jr({from:a,messageType:g.type,closer:g.closerPeers,providers:g.providerPeers,record:g.record})}catch(h){yield Jt({from:a,error:h})}finally{null!=d&&d.close()}}async *sendMessage(a,b,c={}){if(!this.running)return;this.log("sending %s to %p",b.type,a),yield Jw({peer:a}),yield Jq({to:a,type:b.type});let d;try{let e=await this.components.getConnectionManager().openConnection(a,c),f=await e.newStream(this.protocol,c);await this._writeMessage(d=f.stream,b.serialize(),c),yield Jr({from:a,messageType:b.type})}catch(g){yield Jt({from:a,error:g})}finally{null!=d&&d.close()}}async _writeMessage(a,b,c){null!=c.signal&&(a=v3(a,c.signal)),await mk([b],vM(),a,jC)}async _writeReadMessage(a,b,c){null!=c.signal&&(a=v3(a,c.signal));let d=await mk([b],vM(),a,vT(),async a=>{let b=await pR(a);if(null!=b)return b;throw a7(Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")}),e=Jn.deserialize(d);return e.closerPeers.forEach(a=>{this.dispatchEvent(new vI("peer",{detail:a}))}),e.providerPeers.forEach(a=>{this.dispatchEvent(new vI("peer",{detail:a}))}),e}}function Jy(a,b){let c=b.key,d=(0,cE.toString)(c),e=d.split("/");if(e.length<3)return;let f=a[e[1].toString()];if(null==f){let g="Invalid record keytype";throw a7(Error(g),"ERR_INVALID_RECORD_KEY_TYPE")}return f(c,b.value)}let Jz=async(a,b)=>{if(!(a instanceof Uint8Array))throw a7(Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(a.byteLength<5)throw a7(Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");let c=(0,cE.toString)(a.subarray(0,4));if("/pk/"!==c)throw a7(Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let d=a.slice(4),e=await dA.sha256.digest(b);if(!(0,dz.equals)(d,e.bytes))throw a7(Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},JA={pk:Jz};function JB(a,b,c){if(0===c.length){let d="No records given";throw a7(Error(d),"ERR_NO_RECORDS_RECEIVED")}let e=(0,cE.toString)(b),f=e.split("/");if(f.length<3){let g="Record key does not have a selector function";throw a7(Error(g),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let h=a[f[1].toString()];if(null==h){let i=`Unrecognized key prefix: ${f[1]}`;throw a7(Error(i),"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===c.length?0:h(b,c)}function JC(a,b){return 0}let JD={pk:JC};class JE{constructor(a){this.components=new xE;let{validators:b,selectors:c,peerRouting:d,queryManager:e,routingTable:f,network:g,lan:h}=a;this.log=a6(`libp2p:kad-dht:${h?"lan":"wan"}:content-fetching`),this.validators=b,this.selectors=c,this.peerRouting=d,this.queryManager=e,this.routingTable=f,this.network=g}init(a){this.components=a}async putLocal(a,b){let c=I1(a);await this.components.getDatastore().put(c,b)}async getLocal(a){this.log("getLocal %b",a);let b=I1(a);this.log("fetching record for key %k",b);let c=await this.components.getDatastore().get(b);this.log("found %k in local datastore",b);let d=j5.deserialize(c);return await Jy(this.validators,d),d}async *sendCorrectionRecord(a,b,c,d={}){this.log("sendCorrection for %b",a);let e=await I5(a,c);for(let{value:f,from:g}of b){if((0,dz.equals)(f,c)){this.log("record was ok");continue}if(this.components.getPeerId().equals(g)){try{let h=I1(a);this.log(`Storing corrected record for key ${h.toString()}`),await this.components.getDatastore().put(h,e)}catch(i){this.log.error("Failed error correcting self",i)}continue}let j=!1,k=new Jn(Jk.PUT_VALUE,a,0);for await(let l of(k.record=j5.deserialize(e),this.network.sendRequest(g,k,d)))"PEER_RESPONSE"===l.name&&null!=l.record&&(0,dz.equals)(l.record.value,j5.deserialize(e).value)&&(j=!0),yield l;j||(yield Jt({from:g,error:a7(Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async *put(a,b,c={}){this.log("put key %b value %b",a,b);let d=await I5(a,b),e=I1(a);this.log(`storing record for key ${e.toString()}`),await this.components.getDatastore().put(e,d),yield*mk(this.peerRouting.getClosestPeers(a,{signal:c.signal}),b=>jS(b,b=>async()=>{if("FINAL_PEER"!==b.name)return[b];let e=[],f=new Jn(Jk.PUT_VALUE,a,0);for await(let g of(f.record=j5.deserialize(d),this.log("send put to %p",b.peer.id),this.network.sendRequest(b.peer.id,f,c)))e.push(g),"PEER_RESPONSE"===g.name&&(null!=g.record&&(0,dz.equals)(g.record.value,j5.deserialize(d).value)||e.push(Jt({from:b.peer.id,error:a7(Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return e}),a=>mb(a,{ordered:!1,concurrency:IS}),async function*(a){for await(let b of a)yield*b})}async *get(a,b={}){this.log("get %b",a);let c=[];for await(let d of this.getMany(a,b))"VALUE"===d.name&&c.push(d),yield d;if(0===c.length)return;let e=c.map(a=>a.value),f=0;try{f=JB(this.selectors,a,e)}catch(g){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==g.code)throw g}let h=e[f];if(this.log("GetValue %b %b",a,h),null==h)throw a7(Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(a,c,h,b),yield c[f]}async *getMany(a,b={}){this.log("getMany values for %b",a);try{let c=await this.getLocal(a);yield Jv({value:c.value,from:this.components.getPeerId()})}catch(d){this.log("error getting local value for %b",a,d)}let e=await I_(a),f=this.routingTable.closestPeers(e);this.log("found %d peers in routing table",f.length);let g=this,h=async function*({peer:b,signal:c}){for await(let d of g.peerRouting.getValueOrPeers(b,a,{signal:c}))yield d,"PEER_RESPONSE"===d.name&&null!=d.record&&(yield Jv({from:b,value:d.record.value}))};yield*this.queryManager.run(a,f,h,b)}}class JF{constructor(a){this.components=new xE;let{network:b,peerRouting:c,queryManager:d,routingTable:e,providers:f,lan:g}=a;this.log=a6(`libp2p:kad-dht:${g?"lan":"wan"}:content-routing`),this.network=b,this.peerRouting=c,this.queryManager=d,this.routingTable=e,this.providers=f}init(a){this.components=a}async *provide(a,b,c={}){this.log("provide %s",a),await this.providers.addProvider(a,this.components.getPeerId());let d=new Jn(Jk.ADD_PROVIDER,a.bytes,0);d.providerPeers=[{id:this.components.getPeerId(),multiaddrs:b,protocols:[]}];let e=0,f=b=>async()=>{if("FINAL_PEER"!==b.name)return[b];let f=[];this.log("putProvider %s to %p",a,b.peer.id);try{for await(let g of(this.log("sending provider record for %s to %p",a,b.peer.id),this.network.sendMessage(b.peer.id,d,c)))"PEER_RESPONSE"===g.name&&(this.log("sent provider record for %s to %p",a,b.peer.id),e++),f.push(g)}catch(h){this.log.error("error sending provide record to peer %p",b.peer.id,h),f.push(Jt({from:b.peer.id,error:h}))}return f};yield*mk(this.peerRouting.getClosestPeers(a.multihash.bytes,c),a=>jS(a,a=>f(a)),a=>mb(a,{ordered:!1,concurrency:IS}),async function*(a){for await(let b of a)yield*b}),this.log("sent provider records to %d peers",e)}async *findProviders(a,b){let c=this.routingTable.kBucketSize,d=a.multihash.bytes,e=await I_(d),f=this;this.log("findProviders %c",a);let g=await this.providers.getProviders(a);if(g.length>0){let h=[];for(let i of g.slice(0,c))h.push({id:i,multiaddrs:(await this.components.getPeerStore().addressBook.get(i)??[]).map(a=>a.multiaddr),protocols:[]});yield Jr({from:this.components.getPeerId(),messageType:Jk.GET_PROVIDERS,providers:h}),yield Ju({from:this.components.getPeerId(),providers:h})}if(g.length>=c)return;let j=async function*({peer:a,signal:b}){let c=new Jn(Jk.GET_PROVIDERS,d,0);yield*f.network.sendRequest(a,c,{signal:b})},k=new Set(g.map(a=>a.toString()));for await(let l of this.queryManager.run(d,this.routingTable.closestPeers(e),j,b))if(yield l,"PEER_RESPONSE"===l.name){this.log("Found %d provider entries for %c and %d closer peers",l.providers.length,a,l.closer.length);let m=[];for(let n of l.providers)!k.has(n.id.toString())&&(k.add(n.id.toString()),m.push(n));if(m.length>0&&(yield Ju({from:l.from,providers:m})),k.size===c)return}}}class JG{constructor(a,b){this.originDhtKey=a,this.capacity=b,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(a=>a.peerId)}async add(a){if(null!=this.peerDistances.find(b=>b.peerId.equals(a)))return;let b=await I0(a),c={peerId:a,distance:Jb(this.originDhtKey,b)};this.peerDistances.push(c),this.peerDistances.sort((a,b)=>s8(a.distance,b.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(a){if(0===a.length)return!1;if(0===this.length)return!0;let b=await Promise.all(a.map(I0)),c=this.peerDistances[this.peerDistances.length-1].distance;for(let d of b){let e=Jb(this.originDhtKey,d);if(0>s8(e,c))return!0}return!1}}class JH{constructor(a){this.components=new xE;let{routingTable:b,network:c,validators:d,queryManager:e,lan:f}=a;this.routingTable=b,this.network=c,this.validators=d,this.queryManager=e,this.log=a6(`libp2p:kad-dht:${f?"lan":"wan"}:peer-routing`)}init(a){this.components=a}async findPeerLocal(a){let b,c=await this.routingTable.find(a);if(null!=c){this.log("findPeerLocal found %p in routing table",a);try{b=await this.components.getPeerStore().get(c)}catch(d){if("ERR_NOT_FOUND"!==d.code)throw d}}if(null==b)try{b=await this.components.getPeerStore().get(a)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=b)return this.log("findPeerLocal found %p in peer store",a),{id:b.id,multiaddrs:b.addresses.map(a=>a.multiaddr),protocols:[]}}async *_getValueSingle(a,b,c={}){let d=new Jn(Jk.GET_VALUE,b,0);yield*this.network.sendRequest(a,d,c)}async *getPublicKeyFromNode(a,b={}){let c=I2(a);for await(let d of this._getValueSingle(a,c,b))if(yield d,"PEER_RESPONSE"===d.name&&null!=d.record){let e=await dO(iH({bytes:d.record.value}));if(!e.equals(a))throw a7(Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==e.publicKey)throw a7(Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield Jv({from:a,value:e.publicKey})}throw a7(Error(`Node not responding with its public key: ${a.toString()}`),"ERR_INVALID_RECORD")}async *findPeer(a,b={}){this.log("findPeer %p",a);let c=await this.findPeerLocal(a);if(null!=c){this.log("found local"),yield Js({from:this.components.getPeerId(),peer:c});return}let d=await I0(a),e=this.routingTable.closestPeers(d),f=e.find(b=>b.equals(a));if(null!=f)try{let g=await this.components.getPeerStore().get(a);this.log("found in peerStore"),yield Js({from:this.components.getPeerId(),peer:{id:g.id,multiaddrs:g.addresses.map(a=>a.multiaddr),protocols:[]}});return}catch(h){if("ERR_NOT_FOUND"!==h.code)throw h}let i=this,j=async function*({peer:b,signal:c}){let d=new Jn(Jk.FIND_NODE,a.toBytes(),0);for await(let e of i.network.sendRequest(b,d,{signal:c}))if(yield e,"PEER_RESPONSE"===e.name){let f=e.closer.find(b=>b.id.equals(a));null!=f&&(yield Js({from:e.from,peer:f}))}},k=!1;for await(let l of this.queryManager.run(a.toBytes(),e,j,b))"FINAL_PEER"===l.name&&(k=!0),yield l;k||(yield Jt({from:this.components.getPeerId(),error:a7(Error("Not found"),"ERR_NOT_FOUND")}))}async *getClosestPeers(a,b={}){this.log("getClosestPeers to %b",a);let c=await I_(a),d=this.routingTable.closestPeers(c),e=this,f=new JG(c,this.routingTable.kBucketSize);await Promise.all(d.map(async a=>await f.add(a)));let g=async function*({peer:b,signal:c}){e.log("closerPeersSingle %s from %p",(0,cE.toString)(a,"base32"),b);let d=new Jn(Jk.FIND_NODE,a,0);yield*e.network.sendRequest(b,d,{signal:c})};for await(let h of this.queryManager.run(a,d,g,b))yield h,"PEER_RESPONSE"===h.name&&await Promise.all(h.closer.map(async a=>await f.add(a.id)));for(let i of(this.log("found %d peers close to %b",f.length,a),f.peers))yield Js({from:this.components.getPeerId(),peer:{id:i,multiaddrs:(await this.components.getPeerStore().addressBook.get(i)??[]).map(a=>a.multiaddr),protocols:[]}})}async *getValueOrPeers(a,b,c={}){for await(let d of this._getValueSingle(a,b,c)){if("PEER_RESPONSE"===d.name&&null!=d.record)try{await this._verifyRecordOnline(d.record)}catch(e){let f="invalid record received, discarded";this.log(f),yield Jt({from:d.from,error:a7(Error(f),"ERR_INVALID_RECORD")});continue}yield d}}async _verifyRecordOnline(a){if(null==a.timeReceived)throw a7(Error("invalid record received"),"ERR_INVALID_RECORD");await Jy(this.validators,new j5(a.key,a.value,a.timeReceived))}async getCloserPeersOffline(a,b){let c=await I_(a),d=this.routingTable.closestPeers(c),e=[];for(let f of d)if(!f.equals(b))try{let g=await this.components.getPeerStore().addressBook.get(f),h=await this.components.getPeerStore().protoBook.get(f);e.push({id:f,multiaddrs:g.map(a=>a.multiaddr),protocols:h})}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}return e.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",e.length,a,b):this.log("getCloserPeersOffline could not find peer closer to %b than %p",a,b),e}}let JI=a6("libp2p:kad-dht:providers");class JJ{constructor(a={}){this.components=new xE;let{cacheSize:b,cleanupInterval:c,provideValidity:d}=a;this.cleanupInterval=c??IQ,this.provideValidity=d??IP,this.cache=c7(b??IO),this.syncQueue=new dm({concurrency:1}),this.started=!1}init(a){this.components=a}isStarted(){return this.started}async start(){!this.started&&(this.started=!0,this.cleaner=setInterval(()=>{this._cleanup().catch(a=>{JI.error(a)})},this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add(async()=>{let a=Date.now(),b=0,c=0,d=new Map,e=this.components.getDatastore().batch(),f=this.components.getDatastore().query({prefix:IN});for await(let g of f)try{let{cid:h,peerId:i}=JM(g.key),j=JO(g.value).getTime(),k=Date.now(),l=k-j,m=l>this.provideValidity;if(JI("comparing: %d - %d = %d > %d %s",k,j,l,this.provideValidity,m?"(expired)":""),m){c++,e.delete(g.key);let n=d.get(h)??new Set;n.add(i),d.set(h,n)}b++}catch(o){JI.error(o.message)}for(let[p,q]of(d.size>0?(JI("deleting %d / %d entries",c,b),await e.commit()):JI("nothing to delete"),d)){let r=JK(p),s=this.cache.get(r);if(null!=s){for(let t of q)s.delete(t);0===s.size?this.cache.remove(r):this.cache.set(r,s)}}JI("Cleanup successful (%dms)",Date.now()-a)})}async _getProvidersMap(a){let b=JK(a),c=this.cache.get(b);return null==c&&(c=await JN(this.components.getDatastore(),a),this.cache.set(b,c)),c}async addProvider(a,b){return await this.syncQueue.add(async()=>{JI("%p provides %s",b,a);let c=await this._getProvidersMap(a);JI("loaded %s provs",c.size);let d=new Date;c.set(b.toString(),d);let e=JK(a);this.cache.set(e,c),await JL(this.components.getDatastore(),a,b,d)})}async getProviders(a){return await this.syncQueue.add(async()=>{JI("get providers for %s",a);let b=await this._getProvidersMap(a);return[...b.keys()].map(a=>dL(a))})}}function JK(a){let b="string"==typeof a?a:(0,cE.toString)(a.multihash.bytes,"base32");return`${IN}/${b}`}async function JL(a,b,c,d){let e=[JK(b),"/",c.toString()].join(""),f=new cI(e),g=Uint8Array.from(k2.encode(d.getTime()));return await a.put(f,g)}function JM(a){let b=a.toString().split("/");if(5!==b.length)throw Error(`incorrectly formatted provider entry key in datastore: ${a.toString()}`);return{cid:b[3],peerId:b[4]}}async function JN(a,b){let c=new Map,d=a.query({prefix:JK(b)});for await(let e of d){let{peerId:f}=JM(e.key);c.set(f,JO(e.value))}return c}function JO(a){return new Date(k2.decode(a))}let JP=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*JQ(a){let{key:b,startingPeer:c,ourPeerId:d,signal:e,query:f,alpha:g,pathIndex:h,numPaths:i,cleanUp:j,queryFuncTimeout:k,log:l}=a,m=new dm({concurrency:g}),n=await I_(b),o=new Set;function p(a,c){if(null==a)return;o.add(a.toString());let g=BigInt("0x"+(0,cE.toString)(Jb(c,n),"base16"));m.add(async()=>{let c,j=[e];null!=k&&(c=new cM.TimeoutController(k),j.push(c.signal));let q=(0,cN.anySignal)(j);try{for await(let r of f({key:b,peer:a,signal:q,pathIndex:h,numPaths:i})){if(q.aborted)return;if("PEER_RESPONSE"===r.name)for(let s of r.closer){if(o.has(s.id.toString())){l("already seen %p in query",s.id);continue}if(d.equals(s.id)){l("not querying ourselves");continue}let t=await I0(s.id),u=BigInt("0x"+(0,cE.toString)(Jb(t,n),"base16"));if(u>g){l("skipping %p as they are not closer to %b than %p",s.id,b,a);continue}l("querying closer peer %p",s.id),p(s.id,t)}m.emit("completed",r)}c?.clear()}catch(v){e.aborted?m.emit("error",v):m.emit("completed",Jt({from:a,error:v}))}finally{c?.clear()}},{priority:JP-g}).catch(a=>{l.error(a)})}p(c,await I0(c)),yield*JR(m,e,j,l)}async function*JR(a,b,c,d){let e=xX(),f=!0,g=[],h=()=>{f&&(d("clean up queue, results %d, queue size %d, pending tasks %d",g.length,a.size,a.pending),f=!1,a.clear(),g.splice(0,g.length))};for(a.on("completed",a=>{g.push(a),e.resolve()}),a.on("error",a=>{d("queue error",a),h(),e.reject(a)}),a.on("idle",()=>{d("queue idle"),f=!1,e.resolve()}),b.addEventListener("abort",()=>{d("abort queue");let a=f;h(),a&&e.reject(a7(Error("Query aborted"),"ERR_QUERY_ABORTED"))}),c.addEventListener("cleanup",()=>{h(),e.resolve()});f;)for(await e.promise,e=xX();g.length>0;){let i=g.shift();null!=i&&(yield i)}yield*g}let JS="running-queries";class JT{constructor(a){this.components=new xE;let{lan:b=!1,disjointPaths:c=IR,alpha:d=IS}=a;this.disjointPaths=c??IR,this.controllers=new Set,this.running=!1,this.alpha=d??IS,this.lan=b,this.queries=0}init(a){this.components=a}isStarted(){return this.running}async start(){this.running=!0}async stop(){for(let a of(this.running=!1,this.controllers))a.abort();this.controllers.clear()}async *run(a,b,c,d={}){if(!this.running)throw Error("QueryManager not started");let e;if(null==d.signal){e=new cM.TimeoutController(IX),d.signal=e.signal;try{null!=Do.setMaxListeners&&(0,Do.setMaxListeners)(1/0,e.signal)}catch{}}let f=new AbortController;this.controllers.add(f);let g=[f.signal];null!=d.signal&&g.push(d.signal);let h=(0,cN.anySignal)(g);try{null!=Do.setMaxListeners&&(0,Do.setMaxListeners)(1/0,h)}catch{}let i=a6(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+(0,cE.toString)(a,"base58btc")),j=b.slice(0,Math.min(this.disjointPaths,b.length)),k=Date.now(),l=new vG;try{if(i("query:start"),this.queries++,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:JS,value:this.queries}),0===b.length){i.error("Running query with no peers");return}let m=j.map((b,e)=>JQ({key:a,startingPeer:b,ourPeerId:this.components.getPeerId(),signal:h,query:c,pathIndex:e,numPaths:j.length,alpha:this.alpha,cleanUp:l,queryFuncTimeout:d.queryFuncTimeout,log:i}));for await(let n of jW(...m))yield n,"QUERY_ERROR"===n.name&&i("error",n.error)}catch(o){if(this.running||"ERR_QUERY_ABORTED"!==o.code)throw o}finally{this.controllers.delete(f),null!=e&&e.clear(),this.queries--,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:JS,value:this.queries}),l.dispatchEvent(new vI("cleanup")),i("query:done in %dms",Date.now()-k)}}}let JU=a6("libp2p:kad-dht:rpc:handlers:add-provider");class JV{constructor(a){let{providers:b}=a;this.providers=b}init(){}async handle(a,b){if(JU("start"),null==b.key||0===b.key.length)throw a7(Error("Missing key"),"ERR_MISSING_KEY");let c;try{c=bm.CID.decode(b.key)}catch(d){throw a7(Error("Invalid CID"),"ERR_INVALID_CID")}(null==b.providerPeers||0===b.providerPeers.length)&&JU.error("no providers found in message"),await Promise.all(b.providerPeers.map(async b=>{if(!b.id.equals(a)){JU("invalid provider peer %p from %p",b.id,a);return}if(b.multiaddrs.length<1){JU("no valid addresses for provider %p. Ignore",a);return}JU("received provider %p for %s (addrs %s)",a,c,b.multiaddrs.map(a=>a.toString())),await this.providers.addProvider(c,b.id)}))}}let JW=a6("libp2p:kad-dht:rpc:handlers:find-node");class JX{constructor(a){this.components=new xE;let{peerRouting:b,lan:c}=a;this.peerRouting=b,this.lan=Boolean(c)}init(a){this.components=a}async handle(a,b){JW("incoming request from %p for peers closer to %b",a,b.key);let c=[];c=(c=(0,dz.equals)(this.components.getPeerId().toBytes(),b.key)?[{id:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map(a=>a.decapsulateCode(k1("p2p").code)),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(b.key,a)).map(this.lan?I$:IZ).filter(({multiaddrs:a})=>a.length);let d=new Jn(b.type,new Uint8Array(0),b.clusterLevel);return c.length>0?d.closerPeers=c:JW("could not find any peers closer to %b than %p",b.key,a),d}}let JY=a6("libp2p:kad-dht:rpc:handlers:get-providers");class JZ{constructor(a){this.components=new xE;let{peerRouting:b,providers:c,lan:d}=a;this.peerRouting=b,this.providers=c,this.lan=Boolean(d)}init(a){this.components=a}async handle(a,b){let c;try{c=bm.CID.decode(b.key)}catch(d){throw a7(Error("Invalid CID"),"ERR_INVALID_CID")}JY("%p asking for providers for %s",a,c);let[e,f]=await Promise.all([this.providers.getProviders(c),this.peerRouting.getCloserPeersOffline(b.key,a)]),g=await this._getPeers(e),h=await this._getPeers(f.map(({id:a})=>a)),i=new Jn(b.type,b.key,b.clusterLevel);return g.length>0&&(i.providerPeers=g),h.length>0&&(i.closerPeers=h),JY("got %s providers %s closerPeers",g.length,h.length),i}async _getAddresses(a){let b=await this.components.getPeerStore().addressBook.get(a);return b.map(a=>a.multiaddr)}async _getPeers(a){let b=[],c=this.lan?I$:IZ;for(let d of a){let e=c({id:d,multiaddrs:await this._getAddresses(d),protocols:[]});e.multiaddrs.length>0&&b.push(e)}return b}}let J$=a6("libp2p:kad-dht:rpc:handlers:get-value");class J_{constructor(a){this.components=new xE;let{peerRouting:b}=a;this.peerRouting=b}init(a){this.components=a}async handle(a,b){let c=b.key;if(J$("%p asked for key %b",a,c),null==c||0===c.length)throw a7(Error("Invalid key"),"ERR_INVALID_KEY");let d=new Jn(Jk.GET_VALUE,c,b.clusterLevel);if(I3(c)){J$("is public key");let e=I4(c),f;try{let g=await this.components.getPeerStore().keyBook.get(e);if(null==g)throw a7(Error("No public key found in key book"),"ERR_NOT_FOUND");f=g}catch(h){if("ERR_NOT_FOUND"!==h.code)throw h}if(null!=f)return J$("returning found public key"),d.record=new j5(c,f,new Date),d}let[i,j]=await Promise.all([this._checkLocalDatastore(c),this.peerRouting.getCloserPeersOffline(b.key,a)]);return null!=i&&(J$("had record for %b in local datastore",c),d.record=i),j.length>0&&(J$("had %s closer peers in routing table",j.length),d.closerPeers=j),d}async _checkLocalDatastore(a){J$("checkLocalDatastore looking for %b",a);let b=I1(a),c;try{c=await this.components.getDatastore().get(b)}catch(d){if("ERR_NOT_FOUND"===d.code)return;throw d}let e=j5.deserialize(c);if(null==e)throw a7(Error("Invalid record"),"ERR_INVALID_RECORD");if(null==e.timeReceived||Date.now()-e.timeReceived.getTime()>II){await this.components.getDatastore().delete(b);return}return e}}let J0=a6("libp2p:kad-dht:rpc:handlers:ping");class J1{async handle(a,b){return J0("ping from %p",a),b}init(){}}class J2{constructor(a){this.components=new xE;let{validators:b}=a;this.log=a6("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=b}init(a){this.components=a}async handle(a,b){let c=b.key;this.log("%p asked us to store value for key %b",a,c);let d=b.record;if(null==d){let e=`Empty record from: ${a.toString()}`;throw this.log.error(e),a7(Error(e),"ERR_EMPTY_RECORD")}try{await Jy(this.validators,d),d.timeReceived=new Date;let f=I1(d.key);await this.components.getDatastore().put(f,d.serialize()),this.log("put record for %b into datastore under key %k",c,f)}catch(g){this.log("did not put record for key %b into datastore %o",c,g)}return b}}class J3{constructor(a){let{providers:b,peerRouting:c,validators:d,lan:e}=a;this.log=a6("libp2p:kad-dht:rpc"),this.routingTable=a.routingTable,this.handlers={[Jk.GET_VALUE]:new J_({peerRouting:c}),[Jk.PUT_VALUE]:new J2({validators:d}),[Jk.FIND_NODE]:new JX({peerRouting:c,lan:e}),[Jk.ADD_PROVIDER]:new JV({providers:b}),[Jk.GET_PROVIDERS]:new JZ({peerRouting:c,providers:b,lan:e}),[Jk.PING]:new J1}}init(a){for(let b of Object.values(this.handlers))b.init(a)}async handleMessage(a,b){try{await this.routingTable.add(a)}catch(c){this.log.error("Failed to update the kbucket store",c)}let d=this.handlers[b.type];if(null==d){this.log.error(`no handler found for message type: ${b.type}`);return}return await d.handle(a,b)}onIncomingStream(a){Promise.resolve().then(async()=>{let{stream:b,connection:c}=a,d=c.remotePeer;try{await this.routingTable.add(d)}catch(e){this.log.error(e)}let f=this;await mk(b,vT(),async function*(a){for await(let b of a){let c=Jn.deserialize(b);f.log("incoming %s from %p",c.type,d);let e=await f.handleMessage(d,c);null!=e&&(yield e.serialize())}},vM(),b)}).catch(a=>{this.log.error(a)})}}class J4 extends vG{constructor(a){super(),this.components=new xE;let{protocol:b,lan:c}=a;this.log=a6(`libp2p:kad-dht:topology-listener:${c?"lan":"wan"}`),this.running=!1,this.protocol=b}init(a){this.components=a}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;let a=vE({onConnect:a=>{this.log("observed peer %p with protocol %s",a,this.protocol),this.dispatchEvent(new vI("peer",{detail:a}))}});this.registrarId=await this.components.getRegistrar().register(this.protocol,a)}stop(){this.running=!1,null!=this.registrarId&&(this.components.getRegistrar().unregister(this.registrarId),this.registrarId=void 0)}}class J5{constructor(a){this.components=new xE;let{peerRouting:b,lan:c,count:d,interval:e,queryTimeout:f}=a;this.log=a6(`libp2p:kad-dht:${c?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=b,this.count=d??IR,this.interval=e??IT,this.queryTimeout=f??IU}init(a){this.components=a}isStarted(){return this.running}async start(){!this.running&&(this.running=!0,this._querySelf())}async stop(){this.running=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}_querySelf(){Promise.resolve().then(async()=>{let a=new cM.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;let b=(0,cN.anySignal)([this.controller.signal,a.signal]);try{null!=Do.setMaxListeners&&(0,Do.setMaxListeners)(1/0,b)}catch{}let c=await mk(this.peerRouting.getClosestPeers(this.components.getPeerId().toBytes(),{signal:b}),a=>jE(a,this.count),async a=>await sS(a));this.log("query ran successfully - found %d peers",c)}catch(d){this.log("query error",d)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),a.clear()}}).catch(a=>{this.log("query error",a)})}}class J6 extends vG{constructor(a){super(),this.components=new xE;let{kBucketSize:b,clientMode:c,validators:d,selectors:e,querySelfInterval:f,lan:g,protocolPrefix:h,pingTimeout:i,pingConcurrency:j}=a;this.running=!1,this.lan=Boolean(g),this.log=a6(`libp2p:kad-dht:${!0===g?"lan":"wan"}`),this.protocol=`${h??IK}${!0===g?IJ:""}${IL}`,this.kBucketSize=b??20,this.clientMode=c?? !0,this.routingTable=new I9({kBucketSize:b,lan:this.lan,pingTimeout:i,pingConcurrency:j,protocol:this.protocol}),this.providers=new JJ,this.validators={...JA,...d},this.selectors={...JD,...e},this.network=new Jx({protocol:this.protocol,lan:this.lan}),this.queryManager=new JT({disjointPaths:Math.ceil(this.kBucketSize/2),lan:g}),this.peerRouting=new JH({routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new JE({validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new JF({network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new Je({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new J3({routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new J4({protocol:this.protocol,lan:this.lan}),this.querySelf=new J5({peerRouting:this.peerRouting,interval:f,lan:this.lan}),this.network.addEventListener("peer",a=>{let b=a.detail;this.onPeerConnect(b).catch(a=>{this.log.error("could not add %p to routing table",b.id,a)}),this.dispatchEvent(new vI("peer",{detail:b}))}),this.topologyListener.addEventListener("peer",a=>{let b=a.detail;Promise.resolve().then(async()=>{let a=await this.components.getPeerStore().addressBook.get(b),c={id:b,multiaddrs:a.map(a=>a.multiaddr),protocols:[]};await this.onPeerConnect(c)}).catch(a=>{this.log.error("could not add %p to routing table",b,a)})})}get[Dd](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}init(a){this.components=a,this.routingTable.init(a),this.providers.init(a),this.network.init(a),this.queryManager.init(a),this.peerRouting.init(a),this.contentFetching.init(a),this.contentRouting.init(a),this.routingTableRefresh.init(a),this.rpc.init(a),this.topologyListener.init(a),this.querySelf.init(a)}async onPeerConnect(a){if(this.log("peer %p connected with protocols %s",a.id,a.protocols),0===(a=this.lan?I$(a):IZ(a)).multiaddrs.length){this.log("ignoring %p as they do not have any %s addresses in %s",a.id,this.lan?"private":"public",a.multiaddrs.map(a=>a.toString()));return}try{await this.routingTable.add(a.id)}catch(b){this.log.error("could not add %p to routing table",a.id,b)}}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(a){await this.components.getRegistrar().unhandle(this.protocol),"client"===a?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.getRegistrar().handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc)))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async *put(a,b,c={}){yield*this.contentFetching.put(a,b,c)}async *get(a,b={}){yield*this.contentFetching.get(a,b)}async *provide(a,b={}){yield*this.contentRouting.provide(a,this.components.getAddressManager().getAddresses(),b)}async *findProviders(a,b={}){yield*this.contentRouting.findProviders(a,b)}async *findPeer(a,b={}){yield*this.peerRouting.findPeer(a,b)}async *getClosestPeers(a,b={}){yield*this.peerRouting.getClosestPeers(a,b)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}}let J7=a6("libp2p:kad-dht");class J8 extends vG{constructor(a,b){super(),this.components=new xE,this.wan=a,this.lan=b,this.wan.addEventListener("peer",a=>{this.dispatchEvent(new vI("peer",{detail:a.detail}))}),this.lan.addEventListener("peer",a=>{this.dispatchEvent(new vI("peer",{detail:a.detail}))})}get[Dd](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}init(a){this.components=a,this.wan.init(a),this.lan.init(a)}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(a){await this.wan.setMode(a)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async *put(a,b,c={}){for await(let d of jW(this.lan.put(a,b,c),this.wan.put(a,b,c)))yield d}async *get(a,b={}){let c=!1,d=!1;for await(let e of jW(this.lan.get(a,b),this.wan.get(a,b)))yield e,"DIALING_PEER"===e.name&&(c=!0),"VALUE"===e.name&&(c=!0,null!=e.value&&(d=!0)),"SENDING_QUERY"===e.name&&(c=!0);if(!c)throw a7(Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");d||(yield Jt({from:this.components.getPeerId(),error:a7(Error("Not found"),"ERR_NOT_FOUND")}))}async *provide(a,b={}){let c=0,d=0,e=[],f=[this.lan];for await(let g of(await this.wan.getMode()==="server"&&f.push(this.wan),jW(...f.map(c=>c.provide(a,b)))))yield g,"SENDING_QUERY"===g.name&&c++,"QUERY_ERROR"===g.name&&e.push(g.error),"PEER_RESPONSE"===g.name&&"ADD_PROVIDER"===g.messageName&&(J7("sent provider record for %s to %p",a,g.from),d++);if(0===d){if(e.length>0)throw a7(Error(`Failed to provide to ${e.length} of ${c} peers`),"ERR_PROVIDES_FAILED",{errors:e});throw a7(Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}}async *findProviders(a,b={}){yield*jW(this.lan.findProviders(a,b),this.wan.findProviders(a,b))}async *findPeer(a,b={}){let c=!1;for await(let d of jW(this.lan.findPeer(a,b),this.wan.findPeer(a,b)))yield d,("SENDING_QUERY"===d.name||"FINAL_PEER"===d.name)&&(c=!0);if(!c)throw a7(Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async *getClosestPeers(a,b={}){yield*jW(this.lan.getClosestPeers(a,b),this.wan.getClosestPeers(a,b))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class J9 extends J8{constructor(a){super(new J6({protocolPrefix:"/ipfs",...a,lan:!1}),new J6({protocolPrefix:"/ipfs",...a,clientMode:!1,lan:!0}))}}let Ka=a6("libp2p:bootstrap");class Kb extends vG{constructor(a={list:[]}){if(null==a.list||0===a.list.length)throw Error("Bootstrap requires a list of peer addresses");for(let b of(super(),this.interval=a.interval??1e4,this.list=[],a.list)){if(!lX.matches(b)){Ka.error("Invalid multiaddr");continue}let c=new lC(b),d=c.getPeerId();if(null==d){Ka.error("Invalid bootstrap multiaddr without peer id");continue}let e={id:dL(d),multiaddrs:[c],protocols:[]};this.list.push(e)}}get[Dd](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){null==this.timer&&(this.timer=setInterval(()=>this._discoverBootstrapPeers(),this.interval),Ka("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){null!=this.timer&&this.list.forEach(a=>{this.dispatchEvent(new vI("peer",{detail:a}))})}stop(){null!=this.timer&&clearInterval(this.timer),this.timer=void 0}}Kb.tag="bootstrap";var Kc=WebSocket,Kd=c(90507);function Ke(a){return a instanceof ArrayBuffer||a?.constructor?.name==="ArrayBuffer"&&"number"==typeof a?.byteLength}var Kf=a=>{a.binaryType="arraybuffer";let b=async()=>await new Promise((b,c)=>{if(d)return b();if(null!=e)return c(e);let f=b=>{a.removeEventListener("open",g),a.removeEventListener("error",h),b()},g=()=>f(b),h=b=>{f(()=>c(b.error??Error(`connect ECONNREFUSED ${a.url}`)))};a.addEventListener("open",g),a.addEventListener("error",h)}),c=async function*(){let c=new Kd.zN(({push:b,stop:c,fail:d})=>{let e=a=>{let c=null;"string"==typeof a.data&&(c=(0,cB.fromString)(a.data)),Ke(a.data)&&(c=new Uint8Array(a.data)),a.data instanceof Uint8Array&&(c=a.data),null!=c&&b(c)},f=a=>d(a.error??Error("Socket error"));return a.addEventListener("message",e),a.addEventListener("error",f),a.addEventListener("close",c),()=>{a.removeEventListener("message",e),a.removeEventListener("error",f),a.removeEventListener("close",c)}},{highWaterMark:1/0});for await(let d of(await b(),c))yield Ke(d)?new Uint8Array(d):d}(),d=1===a.readyState,e;return a.addEventListener("open",()=>{d=!0,e=null}),a.addEventListener("close",()=>{d=!1,e=null}),a.addEventListener("error",b=>{d||(e=b.error??Error(`connect ECONNREFUSED ${a.url}`))}),Object.assign(c,{connected:b})},Kg=a=>{if(a.readyState>=2)throw Error("socket closed");if(1!==a.readyState)return new Promise((b,c)=>{function d(){a.removeEventListener("open",e),a.removeEventListener("error",f)}function e(){d(),b()}function f(b){d(),c(b.error??Error(`connect ECONNREFUSED ${a.url}`))}a.addEventListener("open",e),a.addEventListener("error",f)})},Kh=(a,b)=>{(b=b??{}).closeOnEnd=!1!==b.closeOnEnd;let c=async c=>{for await(let d of c){try{await Kg(a)}catch(e){if("socket closed"===e.message)break;throw e}a.send(d)}if(null!=b.closeOnEnd&&a.readyState<=1)return await new Promise((b,c)=>{a.addEventListener("close",a=>{if(a.wasClean||1006===a.code)b();else{let d=Object.assign(Error("ws error"),{event:a});c(d)}}),setTimeout(()=>a.close())})};return c},Ki=(a,b)=>{b=b??{};let c=Kf(a),d=b.remoteAddress,e=b.remotePort;if(null!=a.url)try{let f=new URL(a.url);d=f.hostname,e=parseInt(f.port,10)}catch{}if(null==d||null==e)throw Error("Remote connection did not have address and/or port");let g={sink:Kh(a,b),source:c,connected:async()=>await c.connected(),close:async()=>{(a.readyState===a.CONNECTING||a.readyState===a.OPEN)&&await new Promise(b=>{a.addEventListener("close",()=>{b()}),a.close()})},destroy:()=>{null!=a.terminate?a.terminate():a.close()},remoteAddress:d,remotePort:e,socket:a};return g},Kj=c(17745);let Kk={http:"ws",https:"wss"},Kl="ws";var Km=(a,b)=>(0,Kj.relative)(a,b,Kk,Kl);function Kn(a,b){let c="undefined"==typeof window?"":window.location;b=b??{};let d=Km(a,c.toString()),e=new Kc(d,b.websocket);return Ki(e,b)}function Ko(){throw Error("WebSocket Servers can not be created in the browser!")}let Kp=421,Kq=290,Kr=6,Ks=478,Kt=2e3,Ku=a6("libp2p:websockets:socket");function Kv(a,b,c){c=c??{};let d={async sink(b){c?.signal!=null&&(b=v1(b,c.signal));try{await a.sink(b)}catch(d){"aborted"!==d.type&&Ku.error(d)}},source:null!=c.signal?v1(a.source,c.signal):a.source,remoteAddr:b,timeline:{open:Date.now()},async close(){let b=Date.now();try{await de(a.close(),Kt)}catch(c){let{host:e,port:f}=d.remoteAddr.toOptions();Ku("timeout closing stream to %s:%s after %dms, destroying it manually",e,f,Date.now()-b),a.destroy()}finally{d.timeline.close=Date.now()}}};return null!=a.socket.once&&a.socket.once("close",()=>{null==d.timeline.close&&(d.timeline.close=Date.now())}),d}function Kw(a){return a.filter(a=>{if(a.protoCodes().includes(Kq))return!1;let b=a.decapsulateCode(Kp);return lM.matches(b)||lN.matches(b)})}function Kx(a){return a.filter(a=>{if(a.protoCodes().includes(Kq))return!1;let b=a.decapsulateCode(Kp);return lN.matches(b)&&lG.matches(b.decapsulateCode(Kr).decapsulateCode(Ks))})}let Ky=a6("libp2p:websockets");class Kz{constructor(a){this.init=a}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[Dc](){return!0}async dial(a,b){Ky("dialing %s",a),b=b??{};let c=await this._connect(a,b),d=Kv(c,a);Ky("new outbound connection %s",d.remoteAddr);let e=await b.upgrader.upgradeOutbound(d);return Ky("outbound connection %s upgraded",d.remoteAddr),e}async _connect(a,b){if(b?.signal?.aborted=== !0)throw new DH;let c=a.toOptions();Ky("dialing %s:%s",c.host,c.port);let d=xX(),e=a=>{Ky.error("connection error:",a),d.reject(a)},f=Kn(p6(a),this.init);if(null!=f.socket.on?f.socket.on("error",e):f.socket.onerror=e,null==b.signal)return await Promise.race([f.connected(),d.promise]),Ky("connected %s",a),f;let g,h=new Promise((a,c)=>{if(g=()=>{c(new DH),setTimeout(()=>{f.close().catch(a=>{Ky.error("error closing raw socket",a)})})},b?.signal?.aborted=== !0)return g();b?.signal?.addEventListener("abort",g)});try{await Promise.race([h,d.promise,f.connected()])}finally{null!=g&&b?.signal?.removeEventListener("abort",g)}return Ky("connected %s",a),f}createListener(a){return Ko({...this.init,...a})}filter(a){return(a=Array.isArray(a)?a:[a],this.init?.filter!=null)?this.init?.filter(a):F0.isBrowser||F0.isWebWorker?Kx(a):Kw(a)}}class KA{constructor(a){if(!(a>0)||(a-1&a)!=0)throw Error("Max size for a FixedFIFO should be a power of two");this.buffer=Array(a),this.mask=a-1,this.top=0,this.btm=0,this.next=null}push(a){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=a,this.top=this.top+1&this.mask,!0)}shift(){let a=this.buffer[this.btm];if(void 0!==a)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,a}isEmpty(){return void 0===this.buffer[this.btm]}}class KB{constructor(a={}){this.hwm=a.splitLimit??16,this.head=new KA(this.hwm),this.tail=this.head,this.size=0}calculateSize(a){return a?.byteLength!=null?a.byteLength:1}push(a){if(a?.value!=null&&(this.size+=this.calculateSize(a.value)),!this.head.push(a)){let b=this.head;this.head=b.next=new KA(2*this.head.buffer.length),this.head.push(a)}}shift(){let a=this.tail.shift();if(void 0===a&&null!=this.tail.next){let b=this.tail.next;this.tail.next=null,this.tail=b,a=this.tail.shift()}return a?.value!=null&&(this.size-=this.calculateSize(a.value)),a}isEmpty(){return this.head.isEmpty()}}function KC(a={}){let b=a=>{let b=a.shift();if(null==b)return{done:!0};if(null!=b.error)throw b.error;return{done:!0===b.done,value:b.value}};return KE(b,a)}function KD(a={}){let b=a=>{let b,c=[];for(;!a.isEmpty()&&null!=(b=a.shift());){if(null!=b.error)throw b.error;!1===b.done&&c.push(b.value)}return null==b?{done:!0}:{done:!0===b.done,value:c}};return KE(b,a)}function KE(a,b){let c=(b=b??{}).onEnd,d=new KB,e,f,g,h=async()=>d.isEmpty()?g?{done:!0}:await new Promise((b,c)=>{f=g=>{f=null,d.push(g);try{b(a(d))}catch(h){c(h)}return e}}):a(d),i=a=>null!=f?f(a):(d.push(a),e),j=a=>(d=new KB,null!=f)?f({error:a}):(d.push({error:a}),e),k=a=>{if(g)return e;if(b?.objectMode!== !0&&a?.byteLength==null)throw Error("objectMode was not true but tried to push non-Uint8Array value");return i({done:!1,value:a})},l=a=>g?e:(g=!0,null!=a?j(a):i({done:!0})),m=()=>(d=new KB,l(),{done:!0}),n=a=>(l(a),{done:!0});if(e={[Symbol.asyncIterator](){return this},next:h,return:m,throw:n,push:k,end:l,get readableLength(){return d.size}},null==c)return e;let o=e;return e={[Symbol.asyncIterator](){return this},next(){return o.next()},throw(a){return o.throw(a),null!=c&&(c(a),c=void 0),{done:!0}},return(){return o.return(),null!=c&&(c(),c=void 0),{done:!0}},push:k,end(a){return o.end(a),null!=c&&(c(a),c=void 0),e},get readableLength(){return o.readableLength}}}(t=aO||(aO={}))[t.NEW_STREAM=0]="NEW_STREAM",t[t.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",t[t.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",t[t.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",t[t.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",t[t.RESET_RECEIVER=5]="RESET_RECEIVER",t[t.RESET_INITIATOR=6]="RESET_INITIATOR";let KF=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),KG=Object.freeze({NEW_STREAM:aO.NEW_STREAM,MESSAGE:aO.MESSAGE_INITIATOR,CLOSE:aO.CLOSE_INITIATOR,RESET:aO.RESET_INITIATOR}),KH=Object.freeze({MESSAGE:aO.MESSAGE_RECEIVER,CLOSE:aO.CLOSE_RECEIVER,RESET:aO.RESET_RECEIVER});var KI=c(48764).Buffer;let KJ=10240;function KK(a){return null!=globalThis.Buffer?KI.allocUnsafe(a):new Uint8Array(a)}class KL{constructor(){this._pool=KK(KJ),this._poolOffset=0}write(a){let b=this._pool,c=this._poolOffset;k2.encode(a.id<<3|a.type,b,c),c+=k2.encode.bytes,(a.type===aO.NEW_STREAM||a.type===aO.MESSAGE_INITIATOR||a.type===aO.MESSAGE_RECEIVER)&&null!=a.data?k2.encode(a.data.length,b,c):k2.encode(0,b,c),c+=k2.encode.bytes;let d=b.slice(this._poolOffset,c);return(KJ-c<100?(this._pool=KK(KJ),this._poolOffset=0):this._poolOffset=c,(a.type===aO.NEW_STREAM||a.type===aO.MESSAGE_INITIATOR||a.type===aO.MESSAGE_RECEIVER)&&null!=a.data)?[d,a.data instanceof Uint8Array?a.data:a.data.slice()]:[d]}}let KM=new KL;async function*KN(a){for await(let b of a)if(Array.isArray(b))for(let c of b)yield*KM.write(c);else yield*KM.write(b)}class KO{constructor(){this._buffer=new eb,this._headerInfo=null}write(a){if(null==a||0===a.length)return[];this._buffer.append(a);let b=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(c){break}let{id:d,type:e,length:f,offset:g}=this._headerInfo,h=this._buffer.length-g;if(h<f)break;let i={id:d,type:e};(e===aO.NEW_STREAM||e===aO.MESSAGE_INITIATOR||e===aO.MESSAGE_RECEIVER)&&(i.data=this._buffer.slice(g,g+f)),b.push(i),this._buffer.consume(g+f),this._headerInfo=null}return b}_decodeHeader(a){let{value:b,offset:c}=KR(a),{value:d,offset:e}=KR(a,c),f=7&b;if(null==KF[f])throw Error(`Invalid type received: ${f}`);return{id:b>>3,type:f,offset:c+e,length:d}}}let KP=128,KQ=127;function KR(a,b=0){let c=0,d=0,e=b,f,g=a.length;do{if(e>=g||d>49)throw b=0,RangeError("Could not decode varint");f=a.get(e++),c+=d<28?(f&KQ)<<d:(f&KQ)*Math.pow(2,d),d+=7}while(f>=KP);return b=e-b,{value:c,offset:b}}async function*KS(a){let b=new KO;for await(let c of a){let d=b.write(c);d.length>0&&(yield d)}}let KT=1048576;function KU(a){let b=a??KT,c=a=>{if((a.type===aO.NEW_STREAM||a.type===aO.MESSAGE_INITIATOR||a.type===aO.MESSAGE_RECEIVER)&&a.data.byteLength>b)throw Object.assign(Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return a=>(async function*(){for await(let b of a)Array.isArray(b)?(b.forEach(c),yield*b):(c(b),yield b)})()}let KV=a6("libp2p:mplex:stream"),KW="ERR_MPLEX_STREAM_RESET",KX="ERR_MPLEX_STREAM_ABORT",KY="ERR_MPLEX_SINK_ENDED";function KZ(a){let{id:b,name:c,send:d,onEnd:e,type:f="initiator",maxMsgSize:g=KT}=a,h=new AbortController,i=new AbortController,j=new AbortController,k="initiator"===f?KG:KH,l="initiator"===f?`i${b}`:`r${b}`,m=`${null==c?b:c}`,n=!1,o=!1,p,q={open:Date.now()},r=a=>{!n&&(n=!0,KV.trace("%s stream %s source end - err: %o",f,m,a),null!=a&&null==p&&(p=a),o&&(t.timeline.close=Date.now(),null!=e&&e(p)))},s=a=>{!o&&(o=!0,KV.trace("%s stream %s sink end - err: %o",f,m,a),null!=a&&null==p&&(p=a),n&&(q.close=Date.now(),null!=e&&e(p)))},t={close:()=>{KV.trace("%s stream %s close",f,m),t.closeRead(),t.closeWrite()},closeRead:()=>{KV.trace("%s stream %s closeRead",f,m),!n&&t.source.end()},closeWrite:()=>{if(KV.trace("%s stream %s closeWrite",f,m),!o){j.abort();try{d({id:b,type:k.CLOSE})}catch(a){KV.trace("%s stream %s error sending close",f,c,a)}s()}},abort:a=>{KV.trace("%s stream %s abort",f,m,a),t.source.end(a),h.abort(),s(a)},reset:()=>{let a=a7(Error("stream reset"),KW);i.abort(),t.source.end(a),s(a)},sink:async a=>{if(o)throw a7(Error("stream closed for writing"),KY);a=v1(a,(0,cN.anySignal)([h.signal,i.signal,j.signal]));try{"initiator"===f&&d({id:b,type:KG.NEW_STREAM,data:(0,cB.fromString)(m)});let e=new eb;for await(let l of a)for(e.append(l);0!==e.length;){if(e.length<=g){d({id:b,type:k.MESSAGE,data:e.subarray()}),e.consume(e.length);break}let n=e.length-g;d({id:b,type:k.MESSAGE,data:e.subarray(0,n)}),e.consume(n)}}catch(p){if("aborted"===p.type&&"The operation was aborted"===p.message){if(j.signal.aborted)return;i.signal.aborted&&(p.message="stream reset",p.code=KW),h.signal.aborted&&(p.message="stream aborted",p.code=KX)}if(p.code===KW)KV.trace("%s stream %s reset",f,c);else{KV.trace("%s stream %s error",f,c,p);try{d({id:b,type:k.RESET})}catch(q){KV.trace("%s stream %s error sending reset",f,c,q)}}t.source.end(p),s(p);return}try{d({id:b,type:k.CLOSE})}catch(r){KV.trace("%s stream %s error sending close",f,c,r)}s()},source:KC({onEnd:r}),timeline:q,id:l};return t}let K$=a6("libp2p:mplex"),K_=1024,K0=4194304;function K1(a){let b={...a,type:`${KF[a.type]} (${a.type})`};return a.type===aO.NEW_STREAM&&(b.data=(0,cE.toString)(a.data instanceof Uint8Array?a.data:a.data.slice())),(a.type===aO.MESSAGE_INITIATOR||a.type===aO.MESSAGE_RECEIVER)&&(b.data=(0,cE.toString)(a.data instanceof Uint8Array?a.data:a.data.slice(),"base16")),b}class K2{constructor(a,b){this.protocol="/mplex/6.7.0",b=b??{},this._streamId=0,this._streams={initiators:DD({metrics:a.getMetrics(),component:"mplex",metric:"initiatorStreams"}),receivers:DD({metrics:a.getMetrics(),component:"mplex",metric:"receiverStreams"})},this._init=b,this.sink=this._createSink();let c=this._createSource();this._source=c,this.source=c}init(a){}get streams(){let a=[];return this._streams.initiators.forEach(b=>{a.push(b)}),this._streams.receivers.forEach(b=>{a.push(b)}),a}newStream(a){let b=this._streamId++;a=null==a?b.toString():a.toString();let c=this._streams.initiators;return this._newStream({id:b,name:a,type:"initiator",registry:c})}_newReceiverStream(a){let{id:b,name:c}=a,d=this._streams.receivers;return this._newStream({id:b,name:c,type:"receiver",registry:d})}_newStream(a){let b=this._init.maxStreamsPerConnection??K_;if(this._streams.initiators.size+this._streams.receivers.size===b)throw a7(Error("Too many streams open"),"ERR_TOO_MANY_STREAMS");let{id:c,name:d,type:e,registry:f}=a;if(K$("new %s stream %s %s",e,c,d),f.has(c))throw Error(`${e} stream ${c} already exists!`);let g=a=>{if(!f.has(c))throw a7(Error("the stream is not in the muxer registry, it may have already been closed"),"ERR_STREAM_DOESNT_EXIST");K$.enabled&&K$.trace("%s stream %s send",e,c,K1(a)),(a.type===aO.NEW_STREAM||a.type===aO.MESSAGE_INITIATOR||a.type===aO.MESSAGE_RECEIVER)&&(a.data=a.data instanceof Uint8Array?a.data:a.data.slice()),this._source.push(a)},h=()=>{K$("%s stream %s %s ended",e,c,d),f.delete(c),null!=this._init.onStreamEnd&&this._init.onStreamEnd(i)},i=KZ({id:c,name:d,send:g,type:e,onEnd:h,maxMsgSize:this._init.maxMsgSize});return f.set(c,i),i}_createSink(){let a=async a=>{null!=this._init.signal&&(a=v1(a,this._init.signal));try{await mk(a,KS,KU(this._init.maxMsgSize),async a=>{for await(let b of a)this._handleIncoming(b)}),this._source.end()}catch(b){K$("error in sink",b),this._source.end(b)}};return a}_createSource(){let a=a=>{let{initiators:b,receivers:c}=this._streams;for(let d of b.values())null!=a?d.abort(a):d.close();for(let e of c.values())null!=a?e.abort(a):e.close()},b=KD({objectMode:!0,onEnd:a});return Object.assign(KN(b),{push:b.push,end:b.end,return:b.return})}_handleIncoming(a){let{id:b,type:c}=a;if(K$.enabled&&K$.trace("incoming message",K1(a)),a.type===aO.NEW_STREAM){let d=this._newReceiverStream({id:b,name:(0,cE.toString)(a.data instanceof Uint8Array?a.data:a.data.slice())});null!=this._init.onIncomingStream&&this._init.onIncomingStream(d);return}let e=(1&c)==1?this._streams.initiators:this._streams.receivers,f=e.get(b);if(null==f){K$("missing stream %s",b);return}let g=this._init.maxStreamBufferSize??K0;switch(c){case aO.MESSAGE_INITIATOR:case aO.MESSAGE_RECEIVER:if(f.source.readableLength>g){this._source.push({id:a.id,type:c===aO.MESSAGE_INITIATOR?aO.RESET_RECEIVER:aO.RESET_INITIATOR});let h=a7(Error("Input buffer full - increase Mplex maxBufferSize to accomodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");f.abort(h);return}f.source.push(a.data.slice());break;case aO.CLOSE_INITIATOR:case aO.CLOSE_RECEIVER:f.closeRead();break;case aO.RESET_INITIATOR:case aO.RESET_RECEIVER:f.reset();break;default:K$("unknown message type %s",c)}}}class K3{constructor(a={}){this.protocol="/mplex/6.7.0",this.init=a}createStreamMuxer(a,b={}){return new K2(a,{...b,...this.init})}}function K4(a,b={}){let c=Eg(a),d=vT.fromReader(c.reader,b),e={read:async a=>{let{value:b}=await c.reader.next(a);if(null==b)throw Error("Value is null");return b},readLP:async()=>{let{value:a}=await d.next();if(null==a)throw Error("Value is null");return a},readPB:async a=>{let b=await e.readLP();if(null==b)throw Error("Value is null");let c=b instanceof Uint8Array?b:b.slice();return a.decode(c)},write:a=>{a instanceof Uint8Array?c.writer.push(a):c.writer.push(a.slice())},writeLP:a=>{e.write(vM.single(a,b))},writePB:(a,b)=>{e.writeLP(b.encode(a))},pb:a=>({read:async()=>await e.readPB(a),write:b=>e.writePB(b,a)}),unwrap:()=>(c.rest(),c.stream)};return e}function K5(){let a=xX(),b=!1;return{sink:async c=>{if(b)throw Error("already piped");b=!0,a.resolve(c)},source:async function*(){let b=await a.promise;yield*b}()}}function K6(){let a=K5(),b=K5();return[{source:a.source,sink:b.sink},{source:b.source,sink:a.sink}]}let K7=65535,K8=K7-16,K9=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var La=c(512),Lb=c(57664),Lc=c(73294),Ld=c(15501);let Le={hashSHA256(a){return(0,Lc.vp)(a)},getHKDF(a,b){let c=new La.t(Lc.mE,b,a),d=c.expand(96),e=d,f=e.slice(0,32),g=e.slice(32,64),h=e.slice(64,96);return[f,g,h]},generateX25519KeyPair(){let a=Lb.Au();return{publicKey:a.publicKey,privateKey:a.secretKey}},generateX25519KeyPairFromSeed(a){let b=Lb._w(a);return{publicKey:b.publicKey,privateKey:b.secretKey}},generateX25519SharedKey(a,b){return Lb.gi(a,b)},chaCha20Poly1305Encrypt(a,b,c,d){let e=new Ld.OK(d);return e.seal(b,a,c)},chaCha20Poly1305Decrypt(a,b,c,d){let e=new Ld.OK(d);return e.open(b,a,c)}};function Lf(a){return async function*(b){for await(let c of b)for(let d=0;d<c.length;d+=K8){let e=d+K8;e>c.length&&(e=c.length);let f=a.encrypt(c.slice(d,e),a.session);yield f}}}function Lg(a){return async function*(b){for await(let c of b)for(let d=0;d<c.length;d+=K7){let e=d+K7;e>c.length&&(e=c.length);let{plaintext:f,valid:g}=await a.decrypt(c.slice(d,e),a.session);if(!g)throw Error("Failed to validate decrypted chunk");yield f}}}let Lh=a=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(a):new Uint8Array(a),Li=(a,b,c)=>(b=b??Lh(2),new DataView(b.buffer,b.byteOffset,b.byteLength).setUint16(c??0,a,!1),b);Li.bytes=2;let Lj=a=>{if(a.length<2)throw RangeError("Could not decode int16BE");return a instanceof Uint8Array?new DataView(a.buffer,a.byteOffset,a.byteLength).getUint16(0,!1):a.getUint16(0)};function Lk(a){return(0,d7.concat)([a.ne,a.ciphertext],a.ne.length+a.ciphertext.length)}function Ll(a){return(0,d7.concat)([a.ne,a.ns,a.ciphertext],a.ne.length+a.ns.length+a.ciphertext.length)}function Lm(a){return(0,d7.concat)([a.ns,a.ciphertext],a.ns.length+a.ciphertext.length)}function Ln(a){if(a.length<32)throw Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:a.slice(0,32),ciphertext:a.slice(32,a.length),ns:new Uint8Array(0)}}function Lo(a){if(a.length<80)throw Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:a.slice(0,32),ns:a.slice(32,80),ciphertext:a.slice(80,a.length)}}function Lp(a){if(a.length<48)throw Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:a.slice(0,48),ciphertext:a.slice(48,a.length)}}Lj.bytes=2;let Lq;(v=Lq=(u=aP||(aP={})).NoiseHandshakePayload||(u.NoiseHandshakePayload={})).codec=()=>e2({1:{name:"identityKey",codec:eF},2:{name:"identitySig",codec:eF},3:{name:"data",codec:eF}}),v.encode=a=>ew(a,v.codec()),v.decode=a=>ev(a,v.codec());let Lr=aP.NoiseHandshakePayload;async function Ls(a,b,c){let d=await Lu(a,Lx(b)),e=c??new Uint8Array(0);if(null==a.publicKey)throw Error("PublicKey was missing from local PeerId");return Lt(a.publicKey,d,e)}function Lt(a,b,c){return Lr.encode({identityKey:a,identitySig:b,data:c??new Uint8Array(0)})}async function Lu(a,b){if(null==a.privateKey)throw Error("PrivateKey was missing from PeerId");let c=await iI(a.privateKey);return await c.sign(b)}async function Lv(a){return await dO(a.identityKey)}function Lw(a){return Lr.decode(a)}function Lx(a){let b=(0,cB.fromString)("noise-libp2p-static-key:");return(0,d7.concat)([b,a],b.length+a.length)}async function Ly(a,b){let c=await dO(b);return c.equals(a)}async function Lz(a,b,c){let d=b.identityKey;if(!await Ly(c,d))throw Error("Peer ID doesn't match libp2p public key.");let e=Lx(a),f=await dO(d);if(null==f.publicKey)throw Error("PublicKey was missing from PeerId");if(null==b.identitySig)throw Error("Signature was missing from message");let g=iG(f.publicKey),h=await g.verify(e,b.identitySig);if(!h)throw Error("Static key doesn't match to peer that signed payload!");return f}function LA(a){return a instanceof Uint8Array&&32===a.length}let LB=a6("libp2p:noise"),LC;function LD(a){LC(`LOCAL_STATIC_PUBLIC_KEY ${(0,cE.toString)(a.publicKey,"hex")}`),LC(`LOCAL_STATIC_PRIVATE_KEY ${(0,cE.toString)(a.privateKey,"hex")}`)}function LE(a){a?(LC(`LOCAL_PUBLIC_EPHEMERAL_KEY ${(0,cE.toString)(a.publicKey,"hex")}`),LC(`LOCAL_PRIVATE_EPHEMERAL_KEY ${(0,cE.toString)(a.privateKey,"hex")}`)):LC("Missing local ephemeral keys.")}function LF(a){LC(`REMOTE_STATIC_PUBLIC_KEY ${(0,cE.toString)(a,"hex")}`)}function LG(a){LC(`REMOTE_EPHEMERAL_PUBLIC_KEY ${(0,cE.toString)(a,"hex")}`)}function LH(a){a.cs1&&a.cs2?(LC(`CIPHER_STATE_1 ${a.cs1.n} ${(0,cE.toString)(a.cs1.k,"hex")}`),LC(`CIPHER_STATE_2 ${a.cs2.n} ${(0,cE.toString)(a.cs2.k,"hex")}`)):LC("Missing cipher state.")}LC=K9?LB:Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});let LI=0,LJ=Number.MAX_SAFE_INTEGER,LK="Cipherstate has reached maximum n, a new handshake must be performed";class LL{constructor(a){this.crypto=a}encryptWithAd(a,b,c){let d=this.encrypt(a.k,a.n,b,c);return this.setNonce(a,this.incrementNonce(a.n)),d}decryptWithAd(a,b,c){let{plaintext:d,valid:e}=this.decrypt(a.k,a.n,b,c);return this.setNonce(a,this.incrementNonce(a.n)),{plaintext:d,valid:e}}hasKey(a){return!this.isEmptyKey(a.k)}setNonce(a,b){a.n=b}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(a){let b=this.createEmptyKey();return(0,dz.equals)(b,a)}incrementNonce(a){return a+1}nonceToBytes(a){let b=new Uint8Array(12);return new DataView(b.buffer,b.byteOffset,b.byteLength).setUint32(4,a,!0),b}encrypt(a,b,c,d){if(b>LJ)throw Error(LK);let e=this.nonceToBytes(b);return this.crypto.chaCha20Poly1305Encrypt(d,e,c,a)}encryptAndHash(a,b){let c;return c=this.hasKey(a.cs)?this.encryptWithAd(a.cs,a.h,b):b,this.mixHash(a,c),c}decrypt(a,b,c,d){if(b>LJ)throw Error(LK);let e=this.nonceToBytes(b),f=this.crypto.chaCha20Poly1305Decrypt(d,e,c,a);return f?{plaintext:f,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(a,b){let c,d=!0;return this.hasKey(a.cs)?{plaintext:c,valid:d}=this.decryptWithAd(a.cs,a.h,b):c=b,this.mixHash(a,b),{plaintext:c,valid:d}}dh(a,b){try{let c=this.crypto.generateX25519SharedKey(a,b);if(32===c.length)return c;return c.slice(0,32)}catch(d){let e=d;return LB(e.message),new Uint8Array(32)}}mixHash(a,b){a.h=this.getHash(a.h,b)}getHash(a,b){let c=this.crypto.hashSHA256((0,d7.concat)([a,b],a.length+b.length));return c}mixKey(a,b){let[c,d]=this.crypto.getHKDF(a.ck,b);a.cs=this.initializeKey(d),a.ck=c}initializeKey(a){let b=LI;return{k:a,n:b}}initializeSymmetric(a){let b=(0,cB.fromString)(a,"utf-8"),c=this.hashProtocolName(b),d=c,e=this.createEmptyKey(),f=this.initializeKey(e);return{cs:f,ck:d,h:c}}hashProtocolName(a){if(!(a.length<=32))return this.getHash(a,new Uint8Array(0));{let b=new Uint8Array(32);return b.set(a),b}}split(a){let[b,c]=this.crypto.getHKDF(a.ck,new Uint8Array(0)),d=this.initializeKey(b),e=this.initializeKey(c);return{cs1:d,cs2:e}}writeMessageRegular(a,b){let c=this.encryptWithAd(a,new Uint8Array(0),b),d=this.createEmptyKey(),e=new Uint8Array(0);return{ne:d,ns:e,ciphertext:c}}readMessageRegular(a,b){return this.decryptWithAd(a,new Uint8Array(0),b.ciphertext)}}class LM extends LL{initSession(a,b,c,d){let e=this.createEmptyKey(),f;return f=a?this.initializeInitiator(b,c,d,e):this.initializeResponder(b,c,d,e),{hs:f,i:a,mc:0}}sendMessage(a,b){let c;if(0===a.mc)c=this.writeMessageA(a.hs,b);else if(1===a.mc){let{messageBuffer:d,h:e,cs1:f,cs2:g}=this.writeMessageB(a.hs,b);c=d,a.h=e,a.cs1=f,a.cs2=g}else if(a.mc>1){if(a.i){if(!a.cs1)throw Error("CS1 (cipher state) is not defined");c=this.writeMessageRegular(a.cs1,b)}else{if(!a.cs2)throw Error("CS2 (cipher state) is not defined");c=this.writeMessageRegular(a.cs2,b)}}else throw Error("Session invalid.");return a.mc++,c}recvMessage(a,b){let c=new Uint8Array(0),d=!1;if(0===a.mc&&({plaintext:c,valid:d}=this.readMessageA(a.hs,b)),1===a.mc){let{plaintext:e,valid:f,h:g,cs1:h,cs2:i}=this.readMessageB(a.hs,b);c=e,d=f,a.h=g,a.cs1=h,a.cs2=i}return a.mc++,{plaintext:c,valid:d}}writeMessageA(a,b){a.e=this.crypto.generateX25519KeyPair();let c=a.e.publicKey;this.mixHash(a.ss,c),this.mixKey(a.ss,this.dh(a.e.privateKey,a.rs));let d=a.s.publicKey,e=this.encryptAndHash(a.ss,d);this.mixKey(a.ss,this.dh(a.s.privateKey,a.rs));let f=this.encryptAndHash(a.ss,b);return{ne:c,ns:e,ciphertext:f}}writeMessageB(a,b){a.e=this.crypto.generateX25519KeyPair();let c=a.e.publicKey;this.mixHash(a.ss,c),this.mixKey(a.ss,this.dh(a.e.privateKey,a.re)),this.mixKey(a.ss,this.dh(a.e.privateKey,a.rs));let d=this.encryptAndHash(a.ss,b),e=this.createEmptyKey(),f={ne:c,ns:e,ciphertext:d},{cs1:g,cs2:h}=this.split(a.ss);return{messageBuffer:f,cs1:g,cs2:h,h:a.ss.h}}readMessageA(a,b){LA(b.ne)&&(a.re=b.ne),this.mixHash(a.ss,a.re),this.mixKey(a.ss,this.dh(a.s.privateKey,a.re));let{plaintext:c,valid:d}=this.decryptAndHash(a.ss,b.ns);d&&32===c.length&&LA(c)&&(a.rs=c),this.mixKey(a.ss,this.dh(a.s.privateKey,a.rs));let{plaintext:e,valid:f}=this.decryptAndHash(a.ss,b.ciphertext);return{plaintext:e,valid:d&&f}}readMessageB(a,b){if(LA(b.ne)&&(a.re=b.ne),this.mixHash(a.ss,a.re),!a.e)throw Error("Handshake state should contain ephemeral key by now.");this.mixKey(a.ss,this.dh(a.e.privateKey,a.re)),this.mixKey(a.ss,this.dh(a.s.privateKey,a.re));let{plaintext:c,valid:d}=this.decryptAndHash(a.ss,b.ciphertext),{cs1:e,cs2:f}=this.split(a.ss);return{h:a.ss.h,valid:d,plaintext:c,cs1:e,cs2:f}}initializeInitiator(a,b,c,d){let e="Noise_IK_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(e);this.mixHash(f,a),this.mixHash(f,c);let g=new Uint8Array(32);return{ss:f,s:b,rs:c,re:g,psk:d}}initializeResponder(a,b,c,d){let e="Noise_IK_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(e);this.mixHash(f,a),this.mixHash(f,b.publicKey);let g=new Uint8Array(32);return{ss:f,s:b,rs:c,re:g,psk:d}}}class LN extends Error{constructor(a,b){super(b),this.initialMsg=a,this.name="FailedIKhandshake"}}class LO{constructor(a,b,c,d,e,f,g,h,i){this.isInitiator=a,this.payload=b,this.prologue=c,this.staticKeypair=e,this.connection=f,h&&(this.remotePeer=h),this.ik=i??new LM(d),this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,g),this.remoteEarlyData=new Uint8Array}async stage0(){if(LD(this.session.hs.s),LF(this.session.hs.rs),this.isInitiator){LB("IK Stage 0 - Initiator sending message...");let a=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(Ll(a)),LB("IK Stage 0 - Initiator sent message."),LE(this.session.hs.e)}else{LB("IK Stage 0 - Responder receiving message...");let b=await this.connection.readLP();try{let c=Lo(b.slice()),{plaintext:d,valid:e}=this.ik.recvMessage(this.session,c);if(!e)throw Error("ik handshake stage 0 decryption validation fail");LB("IK Stage 0 - Responder got message, going to verify payload.");let f=await Lw(d);this.remotePeer=this.remotePeer||await Lv(f),await Lz(this.session.hs.rs,f,this.remotePeer),this.setRemoteEarlyData(f.data),LB("IK Stage 0 - Responder successfully verified payload!"),LG(this.session.hs.re)}catch(g){let h=g;throw LB("Responder breaking up with IK handshake in stage 0."),new LN(b,`Error occurred while verifying initiator's signed payload: ${h.message}`)}}}async stage1(){if(this.isInitiator){LB("IK Stage 1 - Initiator receiving message...");let a=(await this.connection.readLP()).slice(),b=Ln(a),{plaintext:c,valid:d}=this.ik.recvMessage(this.session,b);LB("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!d)throw Error("ik stage 1 decryption validation fail");let e=await Lw(c);this.remotePeer=this.remotePeer||await Lv(e),await Lz(b.ns.slice(0,32),e,this.remotePeer),this.setRemoteEarlyData(e.data),LB("IK Stage 1 - Initiator successfully verified payload!"),LG(this.session.hs.re)}catch(f){let g=f;throw LB("Initiator breaking up with IK handshake in stage 1."),new LN(a,`Error occurred while verifying responder's signed payload: ${g.message}`)}}else{LB("IK Stage 1 - Responder sending message...");let h=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(Lk(h)),LB("IK Stage 1 - Responder sent message..."),LE(this.session.hs.e)}LH(this.session)}decrypt(a,b){let c=this.getCS(b,!1);return this.ik.decryptWithAd(c,new Uint8Array(0),a)}encrypt(a,b){let c=this.getCS(b);return this.ik.encryptWithAd(c,new Uint8Array(0),a)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(a,b=!0){if(!a.cs1||!a.cs2)throw Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?b?a.cs1:a.cs2:b?a.cs2:a.cs1}setRemoteEarlyData(a){a&&(this.remoteEarlyData=a)}}class LP extends Error{constructor(a="Unexpected Peer"){super(a),this.code=LP.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class LQ extends Error{constructor(a="Invalid crypto exchange"){super(a),this.code=LQ.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}class LR extends Error{constructor(a="Invalid crypto transmission"){super(a),this.code=LR.code}static get code(){return"ERR_INVALID_CRYPTO_TRANSMISSION"}}class LS extends LL{initializeInitiator(a,b,c,d){let e="Noise_XX_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(e);this.mixHash(f,a);let g=new Uint8Array(32);return{ss:f,s:b,rs:c,psk:d,re:g}}initializeResponder(a,b,c,d){let e="Noise_XX_25519_ChaChaPoly_SHA256",f=this.initializeSymmetric(e);this.mixHash(f,a);let g=new Uint8Array(32);return{ss:f,s:b,rs:c,psk:d,re:g}}writeMessageA(a,b,c){let d=new Uint8Array(0);void 0!==c?a.e=c:a.e=this.crypto.generateX25519KeyPair();let e=a.e.publicKey;this.mixHash(a.ss,e);let f=this.encryptAndHash(a.ss,b);return{ne:e,ns:d,ciphertext:f}}writeMessageB(a,b){a.e=this.crypto.generateX25519KeyPair();let c=a.e.publicKey;this.mixHash(a.ss,c),this.mixKey(a.ss,this.dh(a.e.privateKey,a.re));let d=a.s.publicKey,e=this.encryptAndHash(a.ss,d);this.mixKey(a.ss,this.dh(a.s.privateKey,a.re));let f=this.encryptAndHash(a.ss,b);return{ne:c,ns:e,ciphertext:f}}writeMessageC(a,b){let c=a.s.publicKey,d=this.encryptAndHash(a.ss,c);this.mixKey(a.ss,this.dh(a.s.privateKey,a.re));let e=this.encryptAndHash(a.ss,b),f=this.createEmptyKey(),g={ne:f,ns:d,ciphertext:e},{cs1:h,cs2:i}=this.split(a.ss);return{h:a.ss.h,messageBuffer:g,cs1:h,cs2:i}}readMessageA(a,b){return LA(b.ne)&&(a.re=b.ne),this.mixHash(a.ss,a.re),this.decryptAndHash(a.ss,b.ciphertext)}readMessageB(a,b){if(LA(b.ne)&&(a.re=b.ne),this.mixHash(a.ss,a.re),!a.e)throw Error("Handshake state `e` param is missing.");this.mixKey(a.ss,this.dh(a.e.privateKey,a.re));let{plaintext:c,valid:d}=this.decryptAndHash(a.ss,b.ns);d&&32===c.length&&LA(c)&&(a.rs=c),this.mixKey(a.ss,this.dh(a.e.privateKey,a.rs));let{plaintext:e,valid:f}=this.decryptAndHash(a.ss,b.ciphertext);return{plaintext:e,valid:d&&f}}readMessageC(a,b){let{plaintext:c,valid:d}=this.decryptAndHash(a.ss,b.ns);if(d&&32===c.length&&LA(c)&&(a.rs=c),!a.e)throw Error("Handshake state `e` param is missing.");this.mixKey(a.ss,this.dh(a.e.privateKey,a.rs));let{plaintext:e,valid:f}=this.decryptAndHash(a.ss,b.ciphertext),{cs1:g,cs2:h}=this.split(a.ss);return{h:a.ss.h,plaintext:e,valid:d&&f,cs1:g,cs2:h}}initSession(a,b,c){let d=this.createEmptyKey(),e=new Uint8Array(32),f;return f=a?this.initializeInitiator(b,c,e,d):this.initializeResponder(b,c,e,d),{hs:f,i:a,mc:0}}sendMessage(a,b,c){let d;if(0===a.mc)d=this.writeMessageA(a.hs,b,c);else if(1===a.mc)d=this.writeMessageB(a.hs,b);else if(2===a.mc){let{h:e,messageBuffer:f,cs1:g,cs2:h}=this.writeMessageC(a.hs,b);d=f,a.h=e,a.cs1=g,a.cs2=h}else if(a.mc>2){if(a.i){if(!a.cs1)throw Error("CS1 (cipher state) is not defined");d=this.writeMessageRegular(a.cs1,b)}else{if(!a.cs2)throw Error("CS2 (cipher state) is not defined");d=this.writeMessageRegular(a.cs2,b)}}else throw Error("Session invalid.");return a.mc++,d}recvMessage(a,b){let c=new Uint8Array(0),d=!1;if(0===a.mc)({plaintext:c,valid:d}=this.readMessageA(a.hs,b));else if(1===a.mc)({plaintext:c,valid:d}=this.readMessageB(a.hs,b));else if(2===a.mc){let{h:e,plaintext:f,valid:g,cs1:h,cs2:i}=this.readMessageC(a.hs,b);c=f,d=g,a.h=e,a.cs1=h,a.cs2=i}return a.mc++,{plaintext:c,valid:d}}}class LT{constructor(a,b,c,d,e,f,g,h){this.isInitiator=a,this.payload=b,this.prologue=c,this.staticKeypair=e,this.connection=f,g&&(this.remotePeer=g),this.xx=h??new LS(d),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if(LD(this.session.hs.s),this.isInitiator){LB("Stage 0 - Initiator starting to send first message.");let a=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(Lk(a)),LB("Stage 0 - Initiator finished sending first message."),LE(this.session.hs.e)}else{LB("Stage 0 - Responder waiting to receive first message...");let b=Ln((await this.connection.readLP()).slice()),{valid:c}=this.xx.recvMessage(this.session,b);if(!c)throw new LQ("xx handshake stage 0 validation fail");LB("Stage 0 - Responder received first message."),LG(this.session.hs.re)}}async exchange(){if(this.isInitiator){LB("Stage 1 - Initiator waiting to receive first message from responder...");let a=Lo((await this.connection.readLP()).slice()),{plaintext:b,valid:c}=this.xx.recvMessage(this.session,a);if(!c)throw new LQ("xx handshake stage 1 validation fail");LB("Stage 1 - Initiator received the message."),LG(this.session.hs.re),LF(this.session.hs.rs),LB("Initiator going to check remote's signature...");try{let d=await Lw(b);this.remotePeer=this.remotePeer||await Lv(d),this.remotePeer=await Lz(this.session.hs.rs,d,this.remotePeer),this.setRemoteEarlyData(d.data)}catch(e){let f=e;throw new LP(`Error occurred while verifying signed payload: ${f.message}`)}LB("All good with the signature!")}else{LB("Stage 1 - Responder sending out first message with signed payload and static key.");let g=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(Ll(g)),LB("Stage 1 - Responder sent the second handshake message with signed payload."),LE(this.session.hs.e)}}async finish(){if(this.isInitiator){LB("Stage 2 - Initiator sending third handshake message.");let a=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(Lm(a)),LB("Stage 2 - Initiator sent message with signed payload.")}else{LB("Stage 2 - Responder waiting for third handshake message...");let b=Lp((await this.connection.readLP()).slice()),{plaintext:c,valid:d}=this.xx.recvMessage(this.session,b);if(!d)throw new LQ("xx handshake stage 2 validation fail");LB("Stage 2 - Responder received the message, finished handshake.");try{let e=await Lw(c);this.remotePeer=this.remotePeer||await Lv(e),await Lz(this.session.hs.rs,e,this.remotePeer),this.setRemoteEarlyData(e.data)}catch(f){let g=f;throw new LP(`Error occurred while verifying signed payload: ${g.message}`)}}LH(this.session)}encrypt(a,b){let c=this.getCS(b);return this.xx.encryptWithAd(c,new Uint8Array(0),a)}decrypt(a,b){let c=this.getCS(b,!1);return this.xx.decryptWithAd(c,new Uint8Array(0),a)}getRemoteStaticKey(){return this.session.hs.rs}getCS(a,b=!0){if(!a.cs1||!a.cs2)throw new LQ("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?b?a.cs1:a.cs2:b?a.cs2:a.cs1}setRemoteEarlyData(a){a&&(this.remoteEarlyData=a)}}class LU extends LT{constructor(a,b,c,d,e,f,g,h,i,j){super(a,b,c,d,e,f,h,j),i&&(this.ephemeralKeys=i),this.initialMsg=g}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,new Uint8Array(0),this.ephemeralKeys),LB("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),LE(this.session.hs.e);else{LB("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let a=Ln(this.initialMsg),{valid:b}=this.xx.recvMessage(this.session,{ne:a.ne,ns:new Uint8Array(0),ciphertext:new Uint8Array(0)});if(!b)throw Error("xx fallback stage 0 decryption validation fail");LB("XX Fallback Stage 0 - Responder used received message from IK."),LG(this.session.hs.re)}}async exchange(){if(this.isInitiator){let a=Lo(this.initialMsg),{plaintext:b,valid:c}=this.xx.recvMessage(this.session,a);if(!c)throw Error("xx fallback stage 1 decryption validation fail");LB("XX Fallback Stage 1 - Initiator used received message from IK."),LG(this.session.hs.re),LF(this.session.hs.rs),LB("Initiator going to check remote's signature...");try{let d=await Lw(b);this.remotePeer=this.remotePeer||await Lv(d),await Lz(this.session.hs.rs,d,this.remotePeer),this.setRemoteEarlyData(d.data)}catch(e){let f=e;throw Error(`Error occurred while verifying signed payload from responder: ${f.message}`)}LB("All good with the signature!")}else LB("XX Fallback Stage 1 - Responder start"),await super.exchange(),LB("XX Fallback Stage 1 - Responder end")}}class LV{constructor(){this.storage=new Ix}store(a,b){this.storage.set(a,b)}load(a){return a?this.storage.get(a)??null:null}resetStorage(){this.storage.clear()}}let LW=new LV;class LX{constructor(a,b,c=Le){this.protocol="/noise",this.prologue=new Uint8Array(0),this.earlyData=b??new Uint8Array(0),this.useNoisePipes=!1,this.crypto=c,a?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(a):this.staticKeys=this.crypto.generateX25519KeyPair()}async secureOutbound(a,b,c){let d=K4(b,{lengthEncoder:Li,lengthDecoder:Lj,maxDataLength:K7}),e=await this.performHandshake({connection:d,isInitiator:!0,localPeer:a,remotePeer:c}),f=await this.createSecureConnection(d,e);return{conn:f,remoteEarlyData:e.remoteEarlyData,remotePeer:e.remotePeer}}async secureInbound(a,b,c){let d=K4(b,{lengthEncoder:Li,lengthDecoder:Lj,maxDataLength:K7}),e=await this.performHandshake({connection:d,isInitiator:!1,localPeer:a,remotePeer:c}),f=await this.createSecureConnection(d,e);return{conn:f,remoteEarlyData:e.remoteEarlyData,remotePeer:e.remotePeer}}async performHandshake(a){let b=await Ls(a.localPeer,this.staticKeys.publicKey,this.earlyData),c=this.useNoisePipes;if(a.isInitiator&&null===LW.load(a.remotePeer)&&(c=!1),!c)return await this.performXXHandshake(a,b);{let{remotePeer:d,connection:e,isInitiator:f}=a,g=new LO(f,b,this.prologue,this.crypto,this.staticKeys,e,LW.load(a.remotePeer)??new Uint8Array(32),d);try{return await this.performIKHandshake(g)}catch(h){let i=h,j;return a.isInitiator&&(j=g.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(a,b,i.initialMsg,j)}}}async performXXFallbackHandshake(a,b,c,d){let{isInitiator:e,remotePeer:f,connection:g}=a,h=new LU(e,b,this.prologue,this.crypto,this.staticKeys,g,c,f,d);try{await h.propose(),await h.exchange(),await h.finish()}catch(i){let j=i;throw j.message=`Error occurred during XX Fallback handshake: ${j.message}`,LB(j),j}return h}async performXXHandshake(a,b){let{isInitiator:c,remotePeer:d,connection:e}=a,f=new LT(c,b,this.prologue,this.crypto,this.staticKeys,e,d);try{await f.propose(),await f.exchange(),await f.finish(),this.useNoisePipes&&f.remotePeer&&LW.store(f.remotePeer,f.getRemoteStaticKey())}catch(g){if(g instanceof Error)throw g.message=`Error occurred during XX handshake: ${g.message}`,g}return f}async performIKHandshake(a){return await a.stage0(),await a.stage1(),a}async createSecureConnection(a,b){let[c,d]=K6(),e=a.unwrap();return await mk(c,Lf(b),vM({lengthEncoder:Li}),e,vT({lengthDecoder:Lj}),Lg(b),c),d}}let LY=new LX,LZ=a0.bind({ignoreUndefined:!0,concatArrays:!0});function L$({options:a={},peerId:b,multiaddrs:c=[],repo:d,keychainConfig:e={},config:f={}}){let{datastore:g}=d,h=L_({options:a,config:f,datastore:g,keychainConfig:e,peerId:b,multiaddrs:c});return"function"==typeof a.libp2p?a.libp2p({libp2pOptions:h,options:a,config:f,datastore:g,peerId:b}):ID(h)}function L_({options:a,config:b,datastore:c,keychainConfig:d,peerId:e,multiaddrs:f}){let g=()=>{let a=jJ(b,"Pubsub.Router")||"gossipsub",c=xW();if(!c[a])throw a7(Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${a} router.`),"ERR_NOT_SUPPORTED");return c[a]},h={datastore:c,peerId:e},i={addresses:{listen:f.map(a=>a.toString()),announce:jJ(a,"addresses.announce",jJ(b,"Addresses.Announce",[])),noAnnounce:jJ(a,"addresses.noAnnounce",jJ(b,"Addresses.NoAnnounce",[]))},connectionManager:jJ(a,"connectionManager",{maxConnections:jJ(a,"config.Swarm.ConnMgr.HighWater",jJ(b,"Swarm.ConnMgr.HighWater")),minConnections:jJ(a,"config.Swarm.ConnMgr.LowWater",jJ(b,"Swarm.ConnMgr.LowWater"))}),keychain:d,identify:{host:{agentVersion:`js-ipfs/${o0}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[new K3({maxStreamsPerConnection:1/0})],connectionEncryption:[LY],relay:{enabled:jJ(a,"relay.enabled",jJ(b,"relay.enabled",!0)),hop:{enabled:jJ(a,"relay.hop.enabled",jJ(b,"relay.hop.enabled",!1)),active:jJ(a,"relay.hop.active",jJ(b,"relay.hop.active",!1))}},nat:{enabled:!jJ(b,"Swarm.DisableNatPortMap",!1)}};jJ(a,"config.Pubsub.Enabled",jJ(b,"Pubsub.Enabled",!0))&&(i.pubsub=g()),"none"!==jJ(b,"Routing.Type","dhtclient")&&(i.dht=new J9({clientMode:"dhtserver"!==jJ(b,"Routing.Type","dht"),kBucketSize:jJ(a,"dht.kBucketSize",20),validators:{ipns:jr},selectors:{ipns:jK}}));let j=jJ(a,"config.Bootstrap",jJ(b,"Bootstrap",[]));j.length>0&&i.peerDiscovery?.push(new Kb({list:j}));let k=jJ(a,"libp2p",void 0);"function"==typeof k&&(k=void 0);let l=LZ(h,Dj(),i,k),m=jJ(a,"config.Addresses.Delegates",jJ(b,"Addresses.Delegates",[]));if(m.length>0){let n=m[Math.floor(Math.random()*m.length)],o=new lC(n).toOptions(),p={host:o.host,protocol:443===parseInt(o.port)?"https":"http",port:o.port},q=Bi(p);l.contentRouters?.push(new x4(q)),l.peerRouters?.push(new x_(q))}return jJ(a,"config.Discovery.MDNS.Enabled",jJ(b,"Discovery.MDNS.Enabled",!0))||(l.peerDiscovery=l.peerDiscovery?.filter(a=>null!=a&&"@libp2p/mdns"!==a[Symbol.toStringTag])),null==l.transports&&(l.transports=[]),null==l.transports.find(a=>"@libp2p/websockets"===a[Symbol.toStringTag])&&l.transports.push(new Kz),l}let L0=a0.bind({ignoreUndefined:!0}),L1=a6("ipfs:components:peer:storage");class L2{constructor(a,b,c,d,e){this.print=d,this.peerId=a,this.keychain=b,this.repo=c,this.print=d,this.isNew=e}static async start(a,b,c){let{repoAutoMigrate:d,repo:e,onMigrationProgress:f}=c,g="string"==typeof e||null==e?vr(a,b,{path:e,autoMigrate:d,onMigrationProgress:f}):e,{peerId:h,keychain:i,isNew:j}=await L3(a,g,c);return new L2(h,i,g,a,j)}}let L3=async(a,b,c)=>{if(!b.closed)return{...await L8(b,c),isNew:!1};try{return await b.open(),{...await L8(b,c),isNew:!1}}catch(d){if(d.code!==un)throw d;if(c.init&& !1===c.init.allowNew)throw new cA("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await L4(a,b,c),isNew:!0}}},L4=async(a,b,c)=>{let d=c.init||{},e=await b.exists();if(L1("repo exists?",e),!0===e)throw Error("repo already exists");let f=d.privateKey?await L5(d.privateKey):await L6(a,d),g=L7(f);L1("peer identity: %s",g.PeerID);let h={...L0(Ma(l5(),d.profiles),c.config),Identity:g};await b.init(h),await b.open(),L1("repo opened");let i={pass:c.pass};try{i.dek=await b.config.get("Keychain.DEK")}catch(j){if("ERR_NOT_FOUND"!==j.code)throw j}let k=await L$({options:void 0,multiaddrs:void 0,peerId:f,repo:b,config:h,keychainConfig:i});return k.keychain&&(await k.loadKeychain(),await b.config.set("Keychain",{DEK:k.keychain.init.dek})),{peerId:f,keychain:k.keychain}},L5=async a=>{if(L1("using user-supplied private-key"),d1(a))return a;let b=(0,cB.fromString)(a,"base64pad"),c=await iI(b);return await dO(c.public.bytes,c.bytes)},L6=(a,{algorithm:b="Ed25519",bits:c=2048})=>{if(a("generating %s keypair...",b),"Ed25519"===b)return Iq();if("RSA"===b)return Ir({bits:c});throw a7(Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},L7=a=>{if(null==a.privateKey)throw a7(Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:a.toString(),PrivKey:(0,cE.toString)(a.privateKey,"base64pad")}},L8=async(a,b)=>{let c=b.config,d=b.init&&b.init.profiles||[],e=b.pass,f=await a.config.getAll(),g=L9(Ma(f,d),c);if(f!==g&&await a.config.replace(g),!g.Identity||!g.Identity.PrivKey)throw new cu("No private key was found in the config, please intialize the repo");let h=(0,cB.fromString)(g.Identity.PrivKey,"base64pad"),i=await iI(h),j=await dO(i.public.bytes,i.bytes),k=await L$({options:void 0,multiaddrs:void 0,peerId:j,repo:a,config:g,keychainConfig:{pass:e,...g.Keychain}});return k.keychain&&await k.loadKeychain(),{peerId:j,keychain:k.keychain}},L9=(a,b)=>b?L0(a,b):a,Ma=(a,b)=>(b||[]).reduce((a,b)=>{let c=pb[b];if(!c)throw Error(`Could not find profile with name '${b}'`);return L1("applying profile %s",b),c.transform(a)},a);var Mb=c(82838);function Mc(a){let b=new Uint8Array(a.reduce((a,b)=>a+k2.encodingLength(b),0)),c=0;for(let d of a)b=k2.encode(d,b,c),c+=k2.encodingLength(d);return b}var Md=Mc;class Me{constructor(a,b,c){this._refCounter=1,this.cid=a,this.priority=b||1,this.wantType=c}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){let a=this.cid.toString(a3.base58btc);return`WantlistEntry <key: ${a}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(a){return this._refCounter===a._refCounter&&this.cid.equals(a.cid)&&this.priority===a.priority&&this.wantType===a.wantType}}let Mf=a8.Reader,Mg=a8.Writer,Mh=a8.util,Mi=a8.roots["ipfs-bitswap"]||(a8.roots["ipfs-bitswap"]={}),Mj=Mi.Message=(()=>{function a(a){if(this.blocks=[],this.payload=[],this.blockPresences=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.wantlist=null,a.prototype.blocks=Mh.emptyArray,a.prototype.payload=Mh.emptyArray,a.prototype.blockPresences=Mh.emptyArray,a.prototype.pendingBytes=0,a.encode=function(a,b){if(b||(b=Mg.create()),null!=a.wantlist&&Object.hasOwnProperty.call(a,"wantlist")&&Mi.Message.Wantlist.encode(a.wantlist,b.uint32(10).fork()).ldelim(),null!=a.blocks&&a.blocks.length)for(var c=0;c<a.blocks.length;++c)b.uint32(18).bytes(a.blocks[c]);if(null!=a.payload&&a.payload.length)for(var c=0;c<a.payload.length;++c)Mi.Message.Block.encode(a.payload[c],b.uint32(26).fork()).ldelim();if(null!=a.blockPresences&&a.blockPresences.length)for(var c=0;c<a.blockPresences.length;++c)Mi.Message.BlockPresence.encode(a.blockPresences[c],b.uint32(34).fork()).ldelim();return null!=a.pendingBytes&&Object.hasOwnProperty.call(a,"pendingBytes")&&b.uint32(40).int32(a.pendingBytes),b},a.decode=function(a,b){a instanceof Mf||(a=Mf.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new Mi.Message;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.wantlist=Mi.Message.Wantlist.decode(a,a.uint32());break;case 2:d.blocks&&d.blocks.length||(d.blocks=[]),d.blocks.push(a.bytes());break;case 3:d.payload&&d.payload.length||(d.payload=[]),d.payload.push(Mi.Message.Block.decode(a,a.uint32()));break;case 4:d.blockPresences&&d.blockPresences.length||(d.blockPresences=[]),d.blockPresences.push(Mi.Message.BlockPresence.decode(a,a.uint32()));break;case 5:d.pendingBytes=a.int32();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof Mi.Message)return a;var b=new Mi.Message;if(null!=a.wantlist){if("object"!=typeof a.wantlist)throw TypeError(".Message.wantlist: object expected");b.wantlist=Mi.Message.Wantlist.fromObject(a.wantlist)}if(a.blocks){if(!Array.isArray(a.blocks))throw TypeError(".Message.blocks: array expected");b.blocks=[];for(var c=0;c<a.blocks.length;++c)"string"==typeof a.blocks[c]?Mh.base64.decode(a.blocks[c],b.blocks[c]=Mh.newBuffer(Mh.base64.length(a.blocks[c])),0):a.blocks[c].length&&(b.blocks[c]=a.blocks[c])}if(a.payload){if(!Array.isArray(a.payload))throw TypeError(".Message.payload: array expected");b.payload=[];for(var c=0;c<a.payload.length;++c){if("object"!=typeof a.payload[c])throw TypeError(".Message.payload: object expected");b.payload[c]=Mi.Message.Block.fromObject(a.payload[c])}}if(a.blockPresences){if(!Array.isArray(a.blockPresences))throw TypeError(".Message.blockPresences: array expected");b.blockPresences=[];for(var c=0;c<a.blockPresences.length;++c){if("object"!=typeof a.blockPresences[c])throw TypeError(".Message.blockPresences: object expected");b.blockPresences[c]=Mi.Message.BlockPresence.fromObject(a.blockPresences[c])}}return null!=a.pendingBytes&&(b.pendingBytes=0|a.pendingBytes),b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.blocks=[],c.payload=[],c.blockPresences=[]),b.defaults&&(c.wantlist=null,c.pendingBytes=0),null!=a.wantlist&&a.hasOwnProperty("wantlist")&&(c.wantlist=Mi.Message.Wantlist.toObject(a.wantlist,b)),a.blocks&&a.blocks.length){c.blocks=[];for(var d=0;d<a.blocks.length;++d)c.blocks[d]=b.bytes===String?Mh.base64.encode(a.blocks[d],0,a.blocks[d].length):b.bytes===Array?Array.prototype.slice.call(a.blocks[d]):a.blocks[d]}if(a.payload&&a.payload.length){c.payload=[];for(var d=0;d<a.payload.length;++d)c.payload[d]=Mi.Message.Block.toObject(a.payload[d],b)}if(a.blockPresences&&a.blockPresences.length){c.blockPresences=[];for(var d=0;d<a.blockPresences.length;++d)c.blockPresences[d]=Mi.Message.BlockPresence.toObject(a.blockPresences[d],b)}return null!=a.pendingBytes&&a.hasOwnProperty("pendingBytes")&&(c.pendingBytes=a.pendingBytes),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a.Wantlist=function(){function a(a){if(this.entries=[],a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.entries=Mh.emptyArray,a.prototype.full=!1,a.encode=function(a,b){if(b||(b=Mg.create()),null!=a.entries&&a.entries.length)for(var c=0;c<a.entries.length;++c)Mi.Message.Wantlist.Entry.encode(a.entries[c],b.uint32(10).fork()).ldelim();return null!=a.full&&Object.hasOwnProperty.call(a,"full")&&b.uint32(16).bool(a.full),b},a.decode=function(a,b){a instanceof Mf||(a=Mf.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new Mi.Message.Wantlist;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.entries&&d.entries.length||(d.entries=[]),d.entries.push(Mi.Message.Wantlist.Entry.decode(a,a.uint32()));break;case 2:d.full=a.bool();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof Mi.Message.Wantlist)return a;var b=new Mi.Message.Wantlist;if(a.entries){if(!Array.isArray(a.entries))throw TypeError(".Message.Wantlist.entries: array expected");b.entries=[];for(var c=0;c<a.entries.length;++c){if("object"!=typeof a.entries[c])throw TypeError(".Message.Wantlist.entries: object expected");b.entries[c]=Mi.Message.Wantlist.Entry.fromObject(a.entries[c])}}return null!=a.full&&(b.full=Boolean(a.full)),b},a.toObject=function(a,b){b||(b={});var c={};if((b.arrays||b.defaults)&&(c.entries=[]),b.defaults&&(c.full=!1),a.entries&&a.entries.length){c.entries=[];for(var d=0;d<a.entries.length;++d)c.entries[d]=Mi.Message.Wantlist.Entry.toObject(a.entries[d],b)}return null!=a.full&&a.hasOwnProperty("full")&&(c.full=a.full),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a.WantType=function(){let a={},b=Object.create(a);return b[a[0]="Block"]=0,b[a[1]="Have"]=1,b}(),a.Entry=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.block=Mh.newBuffer([]),a.prototype.priority=0,a.prototype.cancel=!1,a.prototype.wantType=0,a.prototype.sendDontHave=!1,a.encode=function(a,b){return b||(b=Mg.create()),null!=a.block&&Object.hasOwnProperty.call(a,"block")&&b.uint32(10).bytes(a.block),null!=a.priority&&Object.hasOwnProperty.call(a,"priority")&&b.uint32(16).int32(a.priority),null!=a.cancel&&Object.hasOwnProperty.call(a,"cancel")&&b.uint32(24).bool(a.cancel),null!=a.wantType&&Object.hasOwnProperty.call(a,"wantType")&&b.uint32(32).int32(a.wantType),null!=a.sendDontHave&&Object.hasOwnProperty.call(a,"sendDontHave")&&b.uint32(40).bool(a.sendDontHave),b},a.decode=function(a,b){a instanceof Mf||(a=Mf.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new Mi.Message.Wantlist.Entry;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.block=a.bytes();break;case 2:d.priority=a.int32();break;case 3:d.cancel=a.bool();break;case 4:d.wantType=a.int32();break;case 5:d.sendDontHave=a.bool();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof Mi.Message.Wantlist.Entry)return a;var b=new Mi.Message.Wantlist.Entry;switch(null!=a.block&&("string"==typeof a.block?Mh.base64.decode(a.block,b.block=Mh.newBuffer(Mh.base64.length(a.block)),0):a.block.length&&(b.block=a.block)),null!=a.priority&&(b.priority=0|a.priority),null!=a.cancel&&(b.cancel=Boolean(a.cancel)),a.wantType){case"Block":case 0:b.wantType=0;break;case"Have":case 1:b.wantType=1}return null!=a.sendDontHave&&(b.sendDontHave=Boolean(a.sendDontHave)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.block="":(c.block=[],b.bytes!==Array&&(c.block=Mh.newBuffer(c.block))),c.priority=0,c.cancel=!1,c.wantType=b.enums===String?"Block":0,c.sendDontHave=!1),null!=a.block&&a.hasOwnProperty("block")&&(c.block=b.bytes===String?Mh.base64.encode(a.block,0,a.block.length):b.bytes===Array?Array.prototype.slice.call(a.block):a.block),null!=a.priority&&a.hasOwnProperty("priority")&&(c.priority=a.priority),null!=a.cancel&&a.hasOwnProperty("cancel")&&(c.cancel=a.cancel),null!=a.wantType&&a.hasOwnProperty("wantType")&&(c.wantType=b.enums===String?Mi.Message.Wantlist.WantType[a.wantType]:a.wantType),null!=a.sendDontHave&&a.hasOwnProperty("sendDontHave")&&(c.sendDontHave=a.sendDontHave),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a}(),a.Block=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.prefix=Mh.newBuffer([]),a.prototype.data=Mh.newBuffer([]),a.encode=function(a,b){return b||(b=Mg.create()),null!=a.prefix&&Object.hasOwnProperty.call(a,"prefix")&&b.uint32(10).bytes(a.prefix),null!=a.data&&Object.hasOwnProperty.call(a,"data")&&b.uint32(18).bytes(a.data),b},a.decode=function(a,b){a instanceof Mf||(a=Mf.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new Mi.Message.Block;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.prefix=a.bytes();break;case 2:d.data=a.bytes();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof Mi.Message.Block)return a;var b=new Mi.Message.Block;return null!=a.prefix&&("string"==typeof a.prefix?Mh.base64.decode(a.prefix,b.prefix=Mh.newBuffer(Mh.base64.length(a.prefix)),0):a.prefix.length&&(b.prefix=a.prefix)),null!=a.data&&("string"==typeof a.data?Mh.base64.decode(a.data,b.data=Mh.newBuffer(Mh.base64.length(a.data)),0):a.data.length&&(b.data=a.data)),b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.prefix="":(c.prefix=[],b.bytes!==Array&&(c.prefix=Mh.newBuffer(c.prefix))),b.bytes===String?c.data="":(c.data=[],b.bytes!==Array&&(c.data=Mh.newBuffer(c.data)))),null!=a.prefix&&a.hasOwnProperty("prefix")&&(c.prefix=b.bytes===String?Mh.base64.encode(a.prefix,0,a.prefix.length):b.bytes===Array?Array.prototype.slice.call(a.prefix):a.prefix),null!=a.data&&a.hasOwnProperty("data")&&(c.data=b.bytes===String?Mh.base64.encode(a.data,0,a.data.length):b.bytes===Array?Array.prototype.slice.call(a.data):a.data),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a.BlockPresenceType=function(){let a={},b=Object.create(a);return b[a[0]="Have"]=0,b[a[1]="DontHave"]=1,b}(),a.BlockPresence=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}return a.prototype.cid=Mh.newBuffer([]),a.prototype.type=0,a.encode=function(a,b){return b||(b=Mg.create()),null!=a.cid&&Object.hasOwnProperty.call(a,"cid")&&b.uint32(10).bytes(a.cid),null!=a.type&&Object.hasOwnProperty.call(a,"type")&&b.uint32(16).int32(a.type),b},a.decode=function(a,b){a instanceof Mf||(a=Mf.create(a));for(var c=void 0===b?a.len:a.pos+b,d=new Mi.Message.BlockPresence;a.pos<c;){var e=a.uint32();switch(e>>>3){case 1:d.cid=a.bytes();break;case 2:d.type=a.int32();break;default:a.skipType(7&e)}}return d},a.fromObject=function(a){if(a instanceof Mi.Message.BlockPresence)return a;var b=new Mi.Message.BlockPresence;switch(null!=a.cid&&("string"==typeof a.cid?Mh.base64.decode(a.cid,b.cid=Mh.newBuffer(Mh.base64.length(a.cid)),0):a.cid.length&&(b.cid=a.cid)),a.type){case"Have":case 0:b.type=0;break;case"DontHave":case 1:b.type=1}return b},a.toObject=function(a,b){b||(b={});var c={};return b.defaults&&(b.bytes===String?c.cid="":(c.cid=[],b.bytes!==Array&&(c.cid=Mh.newBuffer(c.cid))),c.type=b.enums===String?"Have":0),null!=a.cid&&a.hasOwnProperty("cid")&&(c.cid=b.bytes===String?Mh.base64.encode(a.cid,0,a.cid.length):b.bytes===Array?Array.prototype.slice.call(a.cid):a.cid),null!=a.type&&a.hasOwnProperty("type")&&(c.type=b.enums===String?Mi.Message.BlockPresenceType[a.type]:a.type),c},a.prototype.toJSON=function(){return this.constructor.toObject(this,a8.util.toJSONOptions)},a}(),a})(),Mk={Block:Mj.Wantlist.WantType.Block,Have:Mj.Wantlist.WantType.Have},Ml=(a,b)=>Array.prototype.slice.call(b,0).sort((b,c)=>{let d=a(b),e=a(c);return d<e?-1:d>e?1:0});class Mm{constructor(a,b){this.set=b?DD({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:b.metrics}):new Map,this._stats=a}get length(){return this.set.size}add(a,b,c){let d=a.toString(a3.base58btc),e=this.set.get(d);e?(e.inc(),e.priority=b,e.wantType===Mk.Have&&c===Mk.Block&&(e.wantType=c)):(this.set.set(d,new Me(a,b,c)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(a){let b=a.toString(a3.base58btc),c=this.set.get(b);if(c)c.dec(),!c.hasRefs()&&(this.set.delete(b),this._stats&&this._stats.push(null,"wantListSize",-1))}removeForce(a){this.set.has(a)&&this.set.delete(a)}forEach(a){return this.set.forEach(a)}entries(){return this.set.entries()}sortedEntries(){return new Map(Ml(a=>a[1].key,Array.from(this.set.entries())))}contains(a){let b=a.toString(a3.base58btc);return this.set.has(b)}get(a){let b=a.toString(a3.base58btc);return this.set.get(b)}}Mm.Entry=Me;let Mn=Mm.Entry;class Mo{constructor(a,b,c,d,e){this.entry=new Mn(a,b,c),this.cancel=Boolean(d),this.sendDontHave=Boolean(e)}get cid(){return this.entry.cid}set cid(a){this.entry.cid=a}get priority(){return this.entry.priority}set priority(a){this.entry.priority=a}get wantType(){return this.entry.wantType}set wantType(a){this.entry.wantType=a}get[Symbol.toStringTag](){let a=this.cid.toString(a3.base58btc);return`BitswapMessageEntry ${a} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(a){return this.cancel===a.cancel&&this.sendDontHave===a.sendDontHave&&this.wantType===a.wantType&&this.entry.equals(a.entry)}}let Mp=(a,b)=>{let c=["bitswap"];return b&&c.push(b),a&&c.push(`${a.toString().slice(0,8)}`),Object.assign(a2(c.join(":")),{error:a2(c.concat(["error"]).join(":"))})},Mq=(a,b)=>{if(a.size!==b.size)return!1;for(let[c,d]of a){let e=b.get(c);if(void 0===e||d instanceof Uint8Array&&e instanceof Uint8Array&&!(0,dz.equals)(d,e)||d instanceof Mo&&e instanceof Mo&&!d.equals(e))return!1}return!0};class Mr{constructor(a){this.full=a,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(a,b,c,d,e){null==c&&(c=Mr.WantType.Block);let f=a.toString(a3.base58btc),g=this.wantlist.get(f);g?(g.wantType===c&&(g.priority=b),d&&(g.cancel=Boolean(d)),e&&(g.sendDontHave=Boolean(e)),c===Mr.WantType.Block&&g.wantType===Mr.WantType.Have&&(g.wantType=c)):this.wantlist.set(f,new Mo(a,b,c,d,e))}addBlock(a,b){let c=a.toString(a3.base58btc);this.blocks.set(c,b)}addHave(a){let b=a.toString(a3.base58btc);this.blockPresences.has(b)||this.blockPresences.set(b,Mr.BlockPresenceType.Have)}addDontHave(a){let b=a.toString(a3.base58btc);this.blockPresences.has(b)||this.blockPresences.set(b,Mr.BlockPresenceType.DontHave)}cancel(a){let b=a.toString(a3.base58btc);this.wantlist.delete(b),this.addEntry(a,0,Mr.WantType.Block,!0,!1)}setPendingBytes(a){this.pendingBytes=a}serializeToBitswap100(){let a={wantlist:{entries:Array.from(this.wantlist.values()).map(a=>({block:a.cid.bytes,priority:Number(a.priority),cancel:Boolean(a.cancel)})),full:!!this.full||void 0},blocks:Array.from(this.blocks.values())};return Mj.encode(a).finish()}serializeToBitswap110(){let a={wantlist:{entries:Array.from(this.wantlist.values()).map(a=>({block:a.cid.bytes,priority:Number(a.priority),wantType:a.wantType,cancel:Boolean(a.cancel),sendDontHave:Boolean(a.sendDontHave)})),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[b,c]of this.blocks.entries()){let d=bm.CID.parse(b),e=d.version,f=d.code,g=d.multihash.code,h=d.multihash.digest.length,i=Md([e,f,g,h]);a.payload.push(new Mj.Block({prefix:i,data:c}))}for(let[j,k]of this.blockPresences)a.blockPresences.push(new Mj.BlockPresence({cid:bm.CID.parse(j).bytes,type:k}));return this.pendingBytes>0&&(a.pendingBytes=this.pendingBytes),Mj.encode(a).finish()}equals(a){return!!(this.full===a.full&&this.pendingBytes===a.pendingBytes&&Mq(this.wantlist,a.wantlist)&&Mq(this.blocks,a.blocks)&&Mq(this.blockPresences,a.blockPresences))}get[Symbol.toStringTag](){let a=Array.from(this.wantlist.keys()),b=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${a}, blocks: ${b}>`}}Mr.deserialize=async(a,b)=>{let c=Mj.decode(a),d=c.wantlist&&c.wantlist.full||!1,e=new Mr(d);return(c.wantlist&&c.wantlist.entries&&c.wantlist.entries.forEach(a=>{if(!a.block)return;let b=bm.CID.decode(a.block);e.addEntry(b,a.priority||0,a.wantType,Boolean(a.cancel),Boolean(a.sendDontHave))}),c.blockPresences&&c.blockPresences.forEach(a=>{if(!a.cid)return;let b=bm.CID.decode(a.cid);a.type===Mr.BlockPresenceType.Have?e.addHave(b):e.addDontHave(b)}),c.blocks.length>0)?(await Promise.all(c.blocks.map(async a=>{let b=await dA.sha256.digest(a),c=bm.CID.createV0(b);e.addBlock(c,a)})),e):(c.payload.length>0&&(await Promise.all(c.payload.map(async a=>{if(!a.prefix||!a.data)return;let c=Mb(a.prefix),d=c[0],f=c[1],g=c[2],h=g===dA.sha256.code?dA.sha256:b&&await b.getHasher(g);if(!h)throw a7(Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let i=await h.digest(a.data),j=bm.CID.create(d,f,i);e.addBlock(j,a.data)})),e.setPendingBytes(c.pendingBytes)),e)},Mr.blockPresenceSize=a=>a.bytes.length+1,Mr.Entry=Mo,Mr.WantType={Block:Mj.Wantlist.WantType.Block,Have:Mj.Wantlist.WantType.Have},Mr.BlockPresenceType={Have:Mj.BlockPresenceType.Have,DontHave:Mj.BlockPresenceType.DontHave};let Ms=3,Mt=2147483647,Mu=1e3,Mv=1;var Mw=Mx;function Mx(a,b,c){var d=null,e=null,f=function(){d&&(clearTimeout(d),e=null,d=null)},g=function(){var a=e;f(),a&&a()},h=function(){if(!b)return a.apply(this,arguments);var g=this,h=arguments,i=c&&!d;if(f(),e=function(){a.apply(g,h)},d=setTimeout(function(){if(d=null,!i){var a=e;return e=null,a()}},b),i)return e()};return h.cancel=f,h.flush=g,h}class My{constructor(a,b,c){this.peerId=b,this.network=c,this.refcnt=1,this._entries=[],this._log=Mp(a,"msgqueue"),this.sendEntries=Mw(this._sendEntries.bind(this),Mv)}addMessage(a){!a.empty&&this.send(a)}addEntries(a){this._entries=this._entries.concat(a),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let a=new Mr(!1);this._entries.forEach(b=>{b.cancel?a.cancel(b.cid):a.addEntry(b.cid,b.priority)}),this._entries=[],this.addMessage(a)}async send(a){try{await this.network.connectTo(this.peerId)}catch(b){this._log.error("cant connect to peer %s: %s",this.peerId.toString(),b.message);return}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,a).catch(a=>{this._log.error("send error: %s",a.message)})}}class Mz{constructor(a,b,c,d){this.peers=DD({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:d.metrics}),this.wantlist=new Mm(c,d),this.network=b,this._stats=c,this._peerId=a,this._log=Mp(a,"want")}_addEntries(a,b,c){let d=a.map((a,c)=>new Mr.Entry(a,Mt-c,Mr.WantType.Block,b));for(let e of(d.forEach(a=>{a.cancel?c?this.wantlist.removeForce(a.cid.toString(a3.base58btc)):this.wantlist.remove(a.cid):(this._log("adding to wl"),this.wantlist.add(a.cid,a.priority))}),this.peers.values()))e.addEntries(d)}_startPeerHandler(a){let b=this.peers.get(a.toString());if(b){b.refcnt++;return}b=new My(this._peerId,a,this.network);let c=new Mr(!0);for(let d of this.wantlist.entries())c.addEntry(d[1].cid,d[1].priority);return b.addMessage(c),this.peers.set(a.toString(),b),b}_stopPeerHandler(a){let b=this.peers.get(a.toString());if(b)b.refcnt--,!(b.refcnt>0)&&this.peers.delete(a.toString())}wantBlocks(a,b={}){this._addEntries(a,!1),b&&b.signal&&b.signal.addEventListener("abort",()=>{this.cancelWants(a)})}unwantBlocks(a){this._log("unwant blocks: %s",a.length),this._addEntries(a,!0,!0)}cancelWants(a){this._log("cancel wants: %s",a.length),this._addEntries(a,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(a){this._startPeerHandler(a)}disconnected(a){this._stopPeerHandler(a)}start(){}stop(){this.peers.forEach(a=>this.disconnected(a.peerId))}}let MA="/ipfs/bitswap/1.0.0",MB="/ipfs/bitswap/1.1.0",MC="/ipfs/bitswap/1.2.0";class MD{constructor(a,b,c,d={}){this._log=Mp(a.peerId,"network"),this._libp2p=a,this._bitswap=b,this._protocols=[MA],d.b100Only||(this._protocols.unshift(MB),this._protocols.unshift(MC)),this._stats=c,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=d.hashLoader}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection);let a=vE({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarId=await this._libp2p.registrar.register(this._protocols,a),this._libp2p.getConnections().forEach(a=>{this._onPeerConnect(a.remotePeer)})}async stop(){this._running=!1,await this._libp2p.unhandle(this._protocols),null!=this._registrarId&&this._libp2p.registrar.unregister(this._registrarId)}_onConnection({protocol:a,stream:b,connection:c}){this._running&&Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",a,c.remotePeer),await mk(b,vT(),async a=>{for await(let b of a)try{let d=await Mr.deserialize(b.slice(),this._hashLoader);await this._bitswap._receiveMessage(c.remotePeer,d)}catch(e){this._bitswap._receiveError(e);break}})}).catch(a=>{this._log(a)})}_onPeerConnect(a){this._bitswap._onPeerConnected(a)}_onPeerDisconnect(a){this._bitswap._onPeerDisconnected(a)}findProviders(a,b={}){return this._libp2p.contentRouting.findProviders(a,b)}async findAndConnect(a,b){let c=[],d=0;for await(let e of this.findProviders(a,b))if(this._log(`connecting to provider ${e.id}`),c.push(this.connectTo(e.id,b).catch(a=>{this._log.error(a)})),++d===Ms)break;await Promise.all(c)}async provide(a,b){await this._libp2p.contentRouting.provide(a,b)}async sendMessage(a,b){if(!this._running)throw Error("network isn't running");let c=a.toString();this._log("sendMessage to %s",c,b);let d=await this._libp2p.dial(a),{stream:e,protocol:f}=await d.newStream([MC,MB,MA]),g;switch(f){case MA:g=b.serializeToBitswap100();break;case MB:case MC:g=b.serializeToBitswap110();break;default:throw Error("Unknown protocol: "+f)}ME(e,g,this._log),this._updateSentStats(a,b.blocks)}async connectTo(a,b){if(!this._running)throw Error("network isn't running");return this._libp2p.dial(a,b)}_updateSentStats(a,b){let c=a.toString();if(this._stats){for(let d of b.values())this._stats.push(c,"dataSent",d.length);this._stats.push(c,"blocksSent",b.size)}}}async function ME(a,b,c){try{await mk([b],vM(),a)}catch(d){c(d)}}class MF{constructor(a){this.partner=a,this.wantlist=new Mm,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(a){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=a}receivedBytes(a){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=a}wants(a,b,c){this.wantlist.add(a,b,c)}cancelWant(a){this.wantlist.remove(a)}wantlistContains(a){return this.wantlist.get(a)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class MG extends Map{constructor(a,b){for(let[c,d]of(super(),this._cmp=b||this._defaultSort,this._keys=[],a||[]))this.set(c,d)}update(a){if(a<0||a>=this._keys.length)return;let b=this._keys[a];this._keys.splice(a,1);let c=this._find(b);this._keys.splice(c,0,b)}set(a,b){if(this.has(a)){let c=this.indexOf(a);this._keys.splice(c,1)}super.set(a,b);let d=this._find(a);return this._keys.splice(d,0,a),this}clear(){super.clear(),this._keys=[]}delete(a){if(!this.has(a))return!1;let b=this.indexOf(a);return this._keys.splice(b,1),super.delete(a)}indexOf(a){if(!this.has(a))return -1;let b=this._find(a);if(this._keys[b]===a)return b;for(let c=1;c<this._keys.length;c++){if(this._keys[b+c]===a)return b+c;if(this._keys[b-c]===a)return b-c}return -1}_find(a){let b=0,c=this._keys.length;for(;b<c;){let d=b+c>>>1,e=this._kCmp(this._keys[d],a);if(e<0)b=d+1;else{if(!(e>0))return d;c=d}}return b}*keys(){for(let a of this._keys)yield a}*values(){for(let a of this._keys)yield this.get(a)}*entries(){for(let a of this._keys)yield[a,this.get(a)]}*[Symbol.iterator](){yield*this.entries()}forEach(a,b){if(a)for(let c of this._keys)a.apply(b,[[c,this.get(c)]])}_defaultSort(a,b){return a[0]<b[0]?-1:b[0]<a[0]?1:0}_kCmp(a,b){return this._cmp([a,this.get(a)],[b,this.get(b)])}}let MH={hasNewInfo(){return!1},merge(){}};class MI{constructor(a=MH){this._taskMerger=a,this._byPeer=new MG([],MJ.compare)}pushTasks(a,b){let c=this._byPeer.get(a.toString());c||(c=new MJ(a,this._taskMerger)),c.pushTasks(b),this._byPeer.set(a.toString(),c)}popTasks(a){let b=this._head();if(void 0===b)return{tasks:[],pendingSize:0};let{tasks:c,pendingSize:d}=b.popTasks(a);if(0===c.length)return{tasks:c,pendingSize:d};let e=b.peerId;return b.isIdle()?this._byPeer.delete(e.toString()):this._byPeer.update(0),{peerId:e,tasks:c,pendingSize:d}}_head(){if(0!==this._byPeer.size)for(let[,a]of this._byPeer)return a}remove(a,b){let c=this._byPeer.get(b.toString());c&&c.remove(a)}tasksDone(a,b){let c=this._byPeer.get(a.toString());if(!c)return;let d=this._byPeer.indexOf(a.toString());for(let e of b)c.taskDone(e);this._byPeer.update(d)}}class MJ{constructor(a,b){this.peerId=a,this._taskMerger=b,this._activeTotalSize=0,this._pending=new MK,this._active=new Set}pushTasks(a){for(let b of a)this._pushTask(b)}_pushTask(a){if(!this._taskHasMoreInfoThanActiveTasks(a))return;let b=this._pending.get(a.topic);if(b){a.priority>b.priority&&this._pending.updatePriority(a.topic,a.priority),this._taskMerger.merge(a,b);return}this._pending.add(a)}_taskHasMoreInfoThanActiveTasks(a){let b=[];for(let c of this._active)c.topic===a.topic&&b.push(c);return 0===b.length||this._taskMerger.hasNewInfo(a,b)}popTasks(a){let b=0,c=[],d=this._pending.tasks();for(let e=0;e<d.length&&b<a;e++){let f=d[e];c.push(f),b+=f.size,this._pending.delete(f.topic),this._activeTotalSize+=f.size,this._active.add(f)}return{tasks:c,pendingSize:this._pending.totalSize}}taskDone(a){this._active.has(a)&&(this._activeTotalSize-=a.size,this._active.delete(a))}remove(a){this._pending.delete(a)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(a,b){return 0===a[1]._pending.length?1:0===b[1]._pending.length?-1:a[1]._activeTotalSize===b[1]._activeTotalSize?b[1]._pending.length-a[1]._pending.length:a[1]._activeTotalSize-b[1]._activeTotalSize}}class MK{constructor(){this._tasks=new MG([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((a,b)=>a+b.task.size,0)}get(a){return(this._tasks.get(a)||{}).task}add(a){this._tasks.set(a.topic,{created:Date.now(),task:a})}delete(a){this._tasks.delete(a)}tasks(){return[...this._tasks.values()].map(a=>a.task)}updatePriority(a,b){let c=this._tasks.get(a);if(!c)return;let d=this._tasks.indexOf(a);c.task.priority=b,this._tasks.update(d)}_compare(a,b){return a[1].task.priority===b[1].task.priority?a[1].created-b[1].created:b[1].task.priority-a[1].task.priority}}let ML={hasNewInfo(a,b){let c=!1,d=!1;for(let e of b)e.data.haveBlock&&(c=!0),e.data.isWantBlock&&(d=!0);return!d&&!!a.data.isWantBlock|| !c&&!!a.data.haveBlock},merge(a,b){let c=a.data,d=b.data;!d.haveBlock&&c.haveBlock&&(d.haveBlock=c.haveBlock,d.blockSize=c.blockSize),!d.isWantBlock&&c.isWantBlock&&(d.isWantBlock=!0,(!d.haveBlock||c.haveBlock)&&(d.haveBlock=c.haveBlock,b.size=a.size)),d.isWantBlock&&d.haveBlock&&(b.size=d.blockSize)}},MM=Mr.WantType,MN=16384,MO=1024;class MP{constructor(a,b,c,d,e,f={}){this._log=Mp(a,"engine"),this.blockstore=b,this.network=c,this._stats=d,this._opts=this._processOpts(f),this.ledgerMap=DD({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:e.metrics}),this._running=!1,this._requestQueue=new MI(ML)}_processOpts(a){return{maxSizeReplaceHasWithBlock:MO,targetMessageSize:MN,...a}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:a,tasks:b,pendingSize:c}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===b.length)return;let d=new Mr(!1);d.setPendingBytes(c);let e=[],f=new Map;for(let g of b){let h=bm.CID.parse(g.topic);g.data.haveBlock?g.data.isWantBlock?(e.push(h),f.set(g.topic,g.data)):d.addHave(h):d.addDontHave(h)}let i=await this._getBlocks(e);for(let[j,k]of f){let l=bm.CID.parse(j),m=i.get(j);m?d.addBlock(l,m):k.sendDontHave&&d.addDontHave(l)}if(d.empty){a&&this._requestQueue.tasksDone(a,b),this._scheduleProcessTasks();return}try{for(let[n,o]of(a&&await this.network.sendMessage(a,d),i.entries()))a&&this.messageSent(a,bm.CID.parse(n),o)}catch(p){this._log.error(p)}a&&this._requestQueue.tasksDone(a,b),this._scheduleProcessTasks()}wantlistForPeer(a){let b=a.toString(),c=this.ledgerMap.get(b);return c?c.wantlist.sortedEntries():new Map}ledgerForPeer(a){let b=a.toString(),c=this.ledgerMap.get(b);return c?{peer:c.partner,value:c.debtRatio(),sent:c.accounting.bytesSent,recv:c.accounting.bytesRecv,exchanged:c.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(a=>a.partner)}receivedBlocks(a){if(a.length){for(let b of this.ledgerMap.values())for(let c of a){let d=b.wantlistContains(c.cid);if(!d)continue;let e=c.data.length,f=this._sendAsBlock(d.wantType,e),g=e;f||(g=Mr.blockPresenceSize(d.cid)),this._requestQueue.pushTasks(b.partner,[{topic:d.cid.toString(a3.base58btc),priority:d.priority,size:g,data:{blockSize:e,isWantBlock:f,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(a,b){let c=this._findOrCreate(a);if(b.empty)return;if(b.full&&(c.wantlist=new Mm),this._updateBlockAccounting(b.blocks,c),0===b.wantlist.size){this._scheduleProcessTasks();return}let d=[],e=[];b.wantlist.forEach(a=>{a.cancel?(c.cancelWant(a.cid),d.push(a.cid)):(c.wants(a.cid,a.priority,a.wantType),e.push(a))}),this._cancelWants(a,d),await this._addWants(a,e),this._scheduleProcessTasks()}_cancelWants(a,b){for(let c of b)this._requestQueue.remove(c.toString(a3.base58btc),a)}async _addWants(a,b){let c=await this._getBlockSizes(b.map(a=>a.cid)),d=[];for(let e of b){let f=e.cid.toString(a3.base58btc),g=c.get(f);if(null==g)e.sendDontHave&&d.push({topic:f,priority:e.priority,size:Mr.blockPresenceSize(e.cid),data:{isWantBlock:e.wantType===MM.Block,blockSize:0,haveBlock:!1,sendDontHave:e.sendDontHave}});else{let h=this._sendAsBlock(e.wantType,g),i=g;h||(i=Mr.blockPresenceSize(e.cid)),d.push({topic:f,priority:e.priority,size:i,data:{isWantBlock:h,blockSize:g,haveBlock:!0,sendDontHave:e.sendDontHave}})}this._requestQueue.pushTasks(a,d)}}_sendAsBlock(a,b){return a===MM.Block||b<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(a){let b=await this._getBlocks(a);return new Map([...b].map(([a,b])=>[a,b.length]))}async _getBlocks(a){let b=new Map;return await Promise.all(a.map(async a=>{try{let c=await this.blockstore.get(a);b.set(a.toString(a3.base58btc),c)}catch(d){"ERR_NOT_FOUND"!==d.code&&this._log.error("failed to query blockstore for %s: %s",a,d)}})),b}_updateBlockAccounting(a,b){for(let c of a.values())this._log("got block (%s bytes)",c.length),b.receivedBytes(c.length)}messageSent(a,b,c){let d=this._findOrCreate(a);d.sentBytes(c.length),d.wantlist.remove(b)}numBytesSentTo(a){return this._findOrCreate(a).accounting.bytesSent}numBytesReceivedFrom(a){return this._findOrCreate(a).accounting.bytesRecv}peerDisconnected(a){this.ledgerMap.delete(a.toString())}_findOrCreate(a){let b=a.toString(),c=this.ledgerMap.get(b);if(c)return c;let d=new MF(a);return this.ledgerMap.set(b,d),this._stats&&this._stats.push(b,"peerCount",1),d}start(){this._running=!0}stop(){this._running=!1}}let MQ=a=>`unwant:${(0,cE.toString)(a.multihash.bytes,"base64")}`,MR=a=>`block:${(0,cE.toString)(a.multihash.bytes,"base64")}`;class MS extends Do.EventEmitter{constructor(a){super(),this.setMaxListeners(Mu),this._log=Mp(a,"notif")}hasBlock(a,b){let c=MR(a);this._log(c),this.emit(c,b)}wantBlock(a,b={}){if(!a)throw Error("Not a valid cid");let c=MR(a),d=MQ(a);return this._log(`wantBlock:${a}`),new Promise((e,f)=>{let g=()=>{this.removeListener(c,h),f(Error(`Block for ${a} unwanted`))},h=a=>{this.removeListener(d,g),e(a)};this.once(d,g),this.once(c,h),b&&b.signal&&b.signal.addEventListener("abort",()=>{this.removeListener(c,h),this.removeListener(d,g),f(Error(`Want for ${a} aborted`))})})}unwantBlock(a){let b=MQ(a);this._log(b),this.emit(b)}}var MT=c(63573);class MU extends Do.EventEmitter{constructor(a,b){super(),this._options=b,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),a.forEach(a=>{this._stats[a]=BigInt(0),this._movingAverages[a]={},this._options.movingAverageIntervals.forEach(b=>{let c=this._movingAverages[a][b]=MT(b);c.push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(a,b){this._enabled&&(this._queue.push([a,b,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let a=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-a),0)}_update(){if(this._timeout=null,this._queue.length){let a;for(;this._queue.length;){let b=a=this._queue.shift();b&&this._applyOp(b)}a&&this._updateFrequency(a[2]),this.emit("update",this._stats)}}_updateFrequency(a){let b=a-this._frequencyLastTime;b&&Object.keys(this._stats).forEach(c=>{this._updateFrequencyFor(c,b,a)}),this._frequencyLastTime=a}_updateFrequencyFor(a,b,c){let d=this._frequencyAccumulators[a]||0;this._frequencyAccumulators[a]=0;let e=d/b*1e3,f=this._movingAverages[a];f||(f=this._movingAverages[a]={}),this._options.movingAverageIntervals.forEach(a=>{let b=f[a];b||(b=f[a]=MT(a)),b.push(c,e)})}_applyOp(a){let b=a[0],c=a[1];if("number"!=typeof c)throw Error(`invalid increment number: ${c}`);Object.prototype.hasOwnProperty.call(this._stats,b)||(this._stats[b]=BigInt(0)),this._stats[b]=BigInt(this._stats[b])+BigInt(c),this._frequencyAccumulators[b]||(this._frequencyAccumulators[b]=0),this._frequencyAccumulators[b]+=c}}let MV={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class MW extends Do.EventEmitter{constructor(a,b=[],c=MV){super();let d=Object.assign({},MV,c);if("number"!=typeof d.computeThrottleTimeout)throw Error("need computeThrottleTimeout");if("number"!=typeof d.computeThrottleMaxQueueSize)throw Error("need computeThrottleMaxQueueSize");this._initialCounters=b,this._options=d,this._enabled=this._options.enabled,this._global=new MU(b,d),this._global.on("update",a=>this.emit("update",a)),this._peers=DD({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:a.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){for(let a of(this._enabled=!1,this._global.stop(),this._peers))a[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(a){let b="string"!=typeof a&&a.toString?a.toString():`${a}`;return this._peers.get(b)}push(a,b,c){if(this._enabled&&(this._global.push(b,c),a)){let d=this._peers.get(a);d||(d=new MU(this._initialCounters,this._options),this._peers.set(a,d)),d.push(b,c)}}disconnected(a){let b=a.toString(),c=this._peers.get(b);c&&(c.stop(),this._peers.delete(b))}}let MX={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},MY=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class MZ extends vk{constructor(a,b,c={}){super(),this._libp2p=a,this._log=Mp(this.peerId),this._options=Object.assign({},MX,c),this._stats=new MW(a,MY,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new MD(a,this,this._stats,{hashLoader:c.hashLoader}),this.blockstore=b,this.engine=new MP(this.peerId,b,this.network,this._stats,a),this.wm=new Mz(this.peerId,this.network,this._stats,a),this.notifications=new MS(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(a,b){try{await this.engine.messageReceived(a,b)}catch(c){this._log("failed to receive message",b)}if(0===b.blocks.size)return;let d=[];for(let[e,f]of b.blocks.entries()){let g=bm.CID.parse(e);d.push({wasWanted:this.wm.wantlist.contains(g),cid:g,data:f})}this.wm.cancelWants(d.filter(({wasWanted:a})=>a).map(({cid:a})=>a)),await Promise.all(d.map(({cid:b,wasWanted:c,data:d})=>this._handleReceivedBlock(a,b,d,c)))}async _handleReceivedBlock(a,b,c,d){this._log("received block");let e=await this.blockstore.has(b);this._updateReceiveCounters(a.toString(),b,c,e),d&&await this.put(b,c)}_updateReceiveCounters(a,b,c,d){this._stats.push(a,"blocksReceived",1),this._stats.push(a,"dataReceived",c.length),d&&(this._stats.push(a,"dupBlksReceived",1),this._stats.push(a,"dupDataReceived",c.length))}_receiveError(a){this._log.error("ReceiveError: %s",a.message)}_onPeerConnected(a){this.wm.connected(a)}_onPeerDisconnected(a){this.wm.disconnected(a),this.engine.peerDisconnected(a),this._stats.disconnected(a)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(a,b){return this.engine.wantlistForPeer(a)}ledgerForPeer(a){return this.engine.ledgerForPeer(a)}async get(a,b={}){let c=(a,b)=>(this.wm.wantBlocks([a],b),this.notifications.wantBlock(a,b)),d=!1,e=async(a,b)=>{try{let e=await this.blockstore.get(a,b);return e}catch(f){if("ERR_NOT_FOUND"!==f.code)throw f;return d||(d=!0,this.network.findAndConnect(a,b).catch(a=>this._log.error(a))),c(a,b)}},f=new AbortController,g=b.signal?(0,cN.anySignal)([b.signal,f.signal]):f.signal;try{let h=await Promise.race([this.notifications.wantBlock(a,{signal:g}),e(a,{signal:g})]);return h}finally{f.abort()}}async *getMany(a,b={}){for await(let c of a)yield this.get(c,b)}unwant(a){let b=Array.isArray(a)?a:[a];this.wm.unwantBlocks(b),b.forEach(a=>this.notifications.unwantBlock(a))}cancelWants(a){this.wm.cancelWants(Array.isArray(a)?a:[a])}async put(a,b,c){await this.blockstore.put(a,b),this._sendHaveBlockNotifications(a,b)}async *putMany(a,b){for await(let{key:c,value:d}of this.blockstore.putMany(a,b))this._sendHaveBlockNotifications(c,d),yield{key:c,value:d}}_sendHaveBlockNotifications(a,b){this.notifications.hasBlock(a,b),this.engine.receivedBlocks([{cid:a,data:b}]),this.network.provide(a).catch(a=>{this._log.error("Failed to provide: %s",a.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}}let M$=(a,b,c={})=>new MZ(a,b,c);function M_(a){return a7(a=a||Error("Not Found"),"ERR_NOT_FOUND")}function M0(a){return a7(a=a||Error("Aborted"),"ERR_ABORTED")}class M1 extends vk{constructor(a,b){super(),this.child=a,this.bitswap=b}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(a,b,c={}){!await this.has(a)&&(this.bitswap.isStarted()?await this.bitswap.put(a,b,c):await this.child.put(a,b,c))}async *putMany(a,b={}){let c=jD(a,async({key:a})=>!await this.has(a));this.bitswap.isStarted()?yield*this.bitswap.putMany(c,b):yield*this.child.putMany(c,b)}async get(a,b={}){return!await this.has(a)&&this.bitswap.isStarted()?this.bitswap.get(a,b):this.child.get(a,b)}async *getMany(a,b={}){let c=vZ(),d=vZ();Promise.resolve().then(async()=>{for await(let b of a)!await this.has(b)&&this.bitswap.isStarted()?c.push(b):d.push(b);c.end(),d.end()}),yield*jW(this.bitswap.getMany(c,b),this.child.getMany(d,b))}async delete(a,b){await this.child.delete(a,b)}async *deleteMany(a,b){yield*this.child.deleteMany(a,b)}async has(a,b={}){return this.child.has(a,b)}async *query(a,b={}){yield*this.child.query(a,b)}async *queryKeys(a,b={}){yield*this.child.queryKeys(a,b)}}class M2{constructor(a,b,c,d,e){this.peerId=a,this.libp2p=b,this.bitswap=c,this.repo=d,this.blockstore=e}static async start({peerId:a,repo:b,print:c,hashers:d,options:e}){b.closed&&await b.open();let f=await b.config.getAll(),g=await L$({options:e,repo:b,peerId:a,multiaddrs:M3(a,f),config:f,keychainConfig:void 0});for(let h of(g.keychain&&await g.loadKeychain(),await g.start(),g.getMultiaddrs()))c(`Swarm listening on ${h.toString()}`);let i=M$(g,b.blocks,{statsEnabled:!0,hashLoader:d});await i.start();let j=new M1(b.blocks,i);return b.blocks=j,b.pins.blockstore=j,new M2(a,g,i,b,j)}static async stop(a){a.repo.blocks=a.blockstore.unwrap(),a.repo.pins.blockstore=a.blockstore.unwrap(),await a.bitswap.stop(),await a.libp2p.stop()}}let M3=(a,b)=>{let c=a.toString(),d=[],e=b.Addresses&&b.Addresses.Swarm||[];for(let f of e){let g=new lC(f);if(g.protoCodes().includes(M4))throw a7(Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let h=g.getPeerId();h&&h!==c&&(g=g.encapsulate(`/p2p/${c}`)),d.push(g)}return d},M4=479;function M5({network:a}){async function b(b={}){let c=[],{libp2p:d}=await a.use(b);return await d.peerStore.forEach(a=>{c.push({id:a.id,addrs:a.addresses.map(a=>a.multiaddr)})}),c}return cT(b)}function M6({network:a}){async function b(b,c={}){let{libp2p:d}=await a.use(c);await d.dial(b,c)}return cT(b)}function M7({network:a}){async function b(b,c={}){let{libp2p:d}=await a.use(c);await d.hangUp(b)}return cT(b)}function M8({network:a}){async function b(b={}){let{libp2p:c}=await a.use(b);return c.getMultiaddrs()}return cT(b)}function M9({network:a}){async function b(b={}){let{libp2p:c}=await a.use(b);if(b.verbose){let d=[];for(let e of c.getConnections()){let f={addr:e.remoteAddr,peer:e.remotePeer};(b.verbose||b.direction)&&(f.direction=e.stat.direction),b.verbose&&(f.muxer=e.stat.multiplexer,f.latency="n/a",f.streams=[]),d.push(f)}return d}let g=new Map;for(let h of c.getConnections()){let i={addr:h.remoteAddr,peer:h.remotePeer};g.set(h.remotePeer.toString(),i)}return Array.from(g.values())}return cT(b)}class Na{constructor({network:a}){this.addrs=M5({network:a}),this.connect=M6({network:a}),this.disconnect=M7({network:a}),this.localAddrs=M8({network:a}),this.peers=M9({network:a})}}let Nb={success:!0,time:0,text:""};function Nc({network:a}){async function*b(b,c={}){let{libp2p:d}=await a.use();c.count=c.count||10;let e=await d.peerStore.get(b),f=e&&e.id;if(!f){yield{...Nb,text:`Looking up peer ${b}`};let g=await d.peerRouting.findPeer(b);f=g&&g.id}if(!f)throw Error("Peer was not found");yield{...Nb,text:`PING ${f.toString()}`};let h=0,i=0;for(let j=0;j<c.count;j++)try{let k=await d.ping(f);i+=k,h++,yield{...Nb,time:k}}catch(l){yield{...Nb,success:!1,text:l.toString()}}if(h){let m=i/h;yield{...Nb,text:`Average latency: ${m}ms`}}}return cT(b)}let Nd="/ipns/";function Ne(a){a.startsWith(Nd)&&(a=a.substring(Nd.length));let b;if(("1"===a[0]||"Q"===a[0])&&(a=`z${a}`),"z"===a[0]&&(b=a3.base58btc.decode(a)),"k"===a[0]&&(b=kg.base36.decode(a)),!b)throw Error("Could not parse string");if(1!==b[0]&&114!==b[1]&&(b=(0,d7.concat)([[1,114],b])),40!==b.length)throw Error("Incorrect length "+b.length);return(0,d7.concat)([(0,cB.fromString)(Nd),b.subarray(2)])}function Nf({network:a,repo:b,peerId:c}){let{get:d,put:e,findProvs:f,findPeer:g,provide:h,query:i}={async *get(b,d={}){let{libp2p:e}=await Ng(a,c,d),f=b instanceof Uint8Array?b:Ne(b);if(null==e.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*e.dht.get(f,d)},async *put(b,d,e){let{libp2p:f}=await Ng(a,c,e),g=b instanceof Uint8Array?b:Ne(b);if(null==f.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.put(g,d)},async *findProvs(b,d={}){let{libp2p:e}=await Ng(a,c,d);if(null==e.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*e.dht.findProviders(b,{signal:d.signal})},async *findPeer(b,d={}){let{libp2p:e}=await Ng(a,c,d);if(null==e.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*e.dht.findPeer(b,{signal:d.signal})},async *provide(d,e={recursive:!1}){let{libp2p:f}=await Ng(a,c,e),g=await b.blocks.has(d);if(!g)throw a7(Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(e.recursive)throw a7(Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(null==f.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*f.dht.provide(d)},async *query(b,d={}){let{libp2p:e}=await Ng(a,c,d),f,g=bm.CID.asCID(b);if(f=null!=g?g.multihash.bytes:dL(b.toString()).toBytes(),null==e.dht)throw a7(Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*e.dht.getClosestPeers(f,d)}};return{get:cT(d),put:cT(e),findProvs:cT(f),findPeer:cT(g),provide:cT(h),query:cT(i)}}let Ng=async(a,b,c)=>{let d=await a.use(c);if(null!=d.libp2p.dht)return d;{let e=async function*(){yield{from:b,name:"QUERY_ERROR",type:3,error:new cA("dht not enabled")}};return{libp2p:{dht:{get:e,put:e,findProviders:e,findPeer:e,provide:e,getClosestPeers:e}}}}};function Nh({network:a,config:b}){let c=jJ(b||{},"Pubsub.Enabled",!0),d={},e;return{subscribe:c?cT(f):Ni,unsubscribe:c?cT(g):Ni,publish:c?cT(h):Ni,ls:c?cT(i):Ni,peers:c?cT(j):Ni};async function f(b,c,f={}){let{libp2p:g}=await a.use(f);g.pubsub.subscribe(b),null==e&&(e=a=>{let b=a.detail;d[b.topic]&&d[b.topic].forEach(a=>{if("function"==typeof a){a(b);return}null!=a&&null!=a.handleEvent&&a.handleEvent(b)})},g.pubsub.addEventListener("message",e)),null!=c&&(null==d[b]&&(d[b]=[]),d[b].push(c))}async function g(b,c,f={}){let{libp2p:g}=await a.use(f);null!=c&&null!=d[b]&&(d[b]=d[b].filter(a=>a!==c),0===d[b].length&&delete d[b]),"function"!=typeof c&&delete d[b],null==d[b]&&g.pubsub.unsubscribe(b),0===Object.keys(d).length&&(g.pubsub.removeEventListener("message",e),e=void 0)}async function h(b,c,d={}){let{libp2p:e}=await a.use(d);if(!c)throw a7(Error('argument "data" is required'),"ERR_ARG_REQUIRED");await e.pubsub.publish(b,c)}async function i(b={}){let{libp2p:c}=await a.use(b);return c.pubsub.getTopics()}async function j(b,c={}){let{libp2p:d}=await a.use(c);return d.pubsub.getSubscribers(b)}}let Ni=async()=>{throw new cA("pubsub not enabled")},Nj=a0.bind({ignoreUndefined:!0}),Nk=a6("ipfs");class Nl{constructor({print:a,storage:b,codecs:c,options:d}){let{peerId:e,repo:f,keychain:g}=b,h=c4.create(M2),i=qd(d.preload),j=dw(),k=dx({network:h}),l=new kc(d),m=Object.values(cs.kq);(d.ipld&&d.ipld.hashers?d.ipld.hashers:[]).forEach(a=>m.push(a)),this.hashers=new ya({hashers:m,loadHasher:d.ipld&&d.ipld.loadHasher});let n=Object.values(cs.gh);(d.ipld&&d.ipld.bases?d.ipld.bases:[]).forEach(a=>n.push(a)),this.bases=new x6({bases:n,loadBase:d.ipld&&d.ipld.loadBase});let o=new d_({repo:f,codecs:c}),p=new mp({codecs:c,hashers:this.hashers,preload:i,repo:f}),q=new kr({dns:j,ipns:l,repo:f,codecs:c,peerId:e,isOnline:k,keychain:g,options:d}),r=dP({repo:f,codecs:c,bases:this.bases,name:q}),s=new p2({repo:f,codecs:c,hashers:this.hashers,preload:i}),t=Object.assign(ku({repo:f,codecs:c,resolve:r,preload:i}),{local:kB({repo:b.repo})}),{add:u,addAll:v,cat:w,get:x,ls:y}=new o_({preload:i,repo:f,options:d.EXPERIMENTAL,hashers:this.hashers}),z=sk({repo:f,preload:i,hashers:this.hashers,options:d}),A=qf({files:z,preload:i,options:d.preload});this.preload=i,this.name=q,this.ipns=l,this.pin=o,this.resolve=r,this.block=p,this.refs=t,this.start=c5({network:h,peerId:e,repo:f,preload:i,ipns:l,mfsPreload:A,print:a,keychain:g,hashers:this.hashers,options:d}),this.stop=c6({network:h,preload:i,mfsPreload:A,ipns:l,repo:f}),this.dht=Nf({network:h,repo:f,peerId:e}),this.pubsub=Nh({network:h,config:d.config}),this.dns=j,this.isOnline=k,this.id=o5({network:h,peerId:e}),this.version=o3({repo:f}),this.bitswap=new kG({network:h}),this.bootstrap=new l8({repo:f}),this.config=pd({repo:f}),this.ping=Nc({network:h}),this.add=u,this.addAll=v,this.cat=w,this.get=x,this.ls=y,this.dag=s,this.files=z,this.key=new su({keychain:g}),this.object=new sH({preload:i,codecs:c,repo:f}),this.repo=new sN({repo:f,hashers:this.hashers}),this.stats=new sQ({repo:f,network:h}),this.swarm=new Na({network:h}),Object.defineProperty(this,"libp2p",{get(){let a=h.try();return a?a.libp2p:void 0}});let B=()=>Promise.reject(a7(Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),C=async function*(){throw a7(Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=B,this.diag={cmds:B,net:B,sys:B},this.log={level:B,ls:B,tail:C},this.mount=B,this.codecs=c}async init(){throw new cw}}let Nm=async a=>{let b=bQ({Data:new bl({type:"directory"}).marshal(),Links:[]}),c=await a.block.put(b,{mhtype:"sha2-256",format:"dag-pb"});return await a.pin.add(c),c},Nn=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!a1.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function No(a={}){a=Nj(Nn(),a);let b=a.init||{},c={name:cr.identity.name,code:cr.identity.code,encode:a=>a,decode:a=>a},d=Object.values(cs.QB);[aQ,aR,aS,cq,c].concat(a.ipld&&a.ipld.codecs||[]).forEach(a=>d.push(a));let e=new x8({codecs:d,loadCodec:a.ipld&&a.ipld.loadCodec}),f=a.silent?Nk:console.log;Nk("creating repo");let g=await L2.start(f,e,a);Nk("getting repo config");let h=await g.repo.config.getAll(),i=new Nl({storage:g,print:f,codecs:e,options:{...a,config:h}});if(Nk("starting preload"),await i.preload.start(),Nk("starting storage"),i.ipns.startOffline(g),g.isNew&&!b.emptyRepo){let j=await Nm(i);if(Nk("adding default assets"),await ct({addAll:i.addAll,print:f}),Nk("initializing IPNS keyspace"),null==g.peerId.publicKey)throw a7(Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");await i.ipns.initializeKeyspace(g.peerId,(0,cB.fromString)(`/ipfs/${j}`))}return!1!==a.start&&(Nk("starting node"),await i.start()),i}c(52596);let Np=No},31114:function(a,b,c){"use strict";function d(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,n=g-1;(0!==l||m<d)&& -1!==n;n--,m++)l+=256*j[n]>>>0,j[n]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var o=g-d;o!==g&&0===j[o];)o++;for(var p=i.repeat(c);o<g;++o)p+=a.charAt(j[o]);return p}function m(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[b]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&& -1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var n=f-e;n!==f&&0===g[n];)n++;for(var o=new Uint8Array(d+(f-n)),p=d;n!==f;)o[p++]=g[n++];return o}}}function n(a){var c=m(a);if(c)return c;throw Error(`Non-${b} character`)}return{encode:l,decodeUnsafe:m,decode:n}}c.d(b,{kU:function(){return m},Dp:function(){return l},ET:function(){return p}});var e=d,f=c(95934);class g{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class h{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return j(this,a)}}class i{constructor(a){this.decoders=a}or(a){return j(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let j=(a,b)=>new i({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class k{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new g(a,b,c),this.decoder=new h(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let l=({name:a,prefix:b,encode:c,decode:d})=>new k(a,b,c,d),m=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:g}=e(c,b);return l({prefix:a,name:b,encode:d,decode:a=>(0,f.coerce)(g(a))})},n=(a,b,c,d)=>{let e={};for(let f=0;f<b.length;++f)e[b[f]]=f;let g=a.length;for(;"="===a[g-1];)--g;let h=new Uint8Array(g*c/8|0),i=0,j=0,k=0;for(let l=0;l<g;++l){let m=e[a[l]];if(void 0===m)throw SyntaxError(`Non-${d} character`);j=j<<c|m,i+=c,i>=8&&(i-=8,h[k++]=255&j>>i)}if(i>=c||255&j<<8-i)throw SyntaxError("Unexpected end of data");return h},o=(a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let i=0;i<a.length;++i)for(h=h<<8|a[i],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f},p=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>l({prefix:b,name:a,encode(a){return o(a,d,c)},decode(b){return n(b,d,c,a)}})},22817:function(a,b,c){"use strict";c.r(b),c.d(b,{base32:function(){return e},base32hex:function(){return i},base32hexpad:function(){return k},base32hexpadupper:function(){return l},base32hexupper:function(){return j},base32pad:function(){return g},base32padupper:function(){return h},base32upper:function(){return f},base32z:function(){return m}});var d=c(31114);let e=(0,d.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),f=(0,d.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),g=(0,d.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),h=(0,d.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i=(0,d.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),j=(0,d.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),k=(0,d.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),l=(0,d.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),m=(0,d.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},98441:function(a,b,c){"use strict";c.r(b),c.d(b,{base36:function(){return e},base36upper:function(){return f}});var d=c(31114);let e=(0,d.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f=(0,d.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})},99086:function(a,b,c){"use strict";c.r(b),c.d(b,{base58btc:function(){return e},base58flickr:function(){return f}});var d=c(31114);let e=(0,d.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),f=(0,d.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},9885:function(a,b,c){"use strict";c.r(b),c.d(b,{base64:function(){return e},base64pad:function(){return f},base64url:function(){return g},base64urlpad:function(){return h}});var d=c(31114);let e=(0,d.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),f=(0,d.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),g=(0,d.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),h=(0,d.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})},37211:function(a,b,c){"use strict";c.d(b,{gh:function(){return F},QB:function(){return H},kq:function(){return G}});var d={};c.r(d),c.d(d,{identity:function(){return l}});var e={};c.r(e),c.d(e,{base2:function(){return m}});var f={};c.r(f),c.d(f,{base8:function(){return n}});var g={};c.r(g),c.d(g,{base10:function(){return o}});var h={};c.r(h),c.d(h,{base16:function(){return p},base16upper:function(){return q}});var i={};c.r(i),c.d(i,{base256emoji:function(){return A}});var j=c(31114),k=c(95934);let l=(0,j.Dp)({prefix:"\0",name:"identity",encode:a=>(0,k.toString)(a),decode:a=>(0,k.fromString)(a)}),m=(0,j.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),n=(0,j.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),o=(0,j.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),p=(0,j.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q=(0,j.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var r=c(22817),s=c(98441),t=c(99086),u=c(9885);let v=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),w=v.reduce((a,b,c)=>(a[c]=b,a),[]),x=v.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]);function y(a){return a.reduce((a,b)=>a+=w[b],"")}function z(a){let b=[];for(let c of a){let d=x[c.codePointAt(0)];if(void 0===d)throw Error(`Non-base256emoji character: ${c}`);b.push(d)}return new Uint8Array(b)}let A=(0,j.Dp)({prefix:"\uD83D\uDE80",name:"base256emoji",encode:y,decode:z});var B=c(56155),C=c(78103),D=c(96945),E=c(40950);c(16441);let F={...d,...e,...f,...g,...h,...r,...s,...t,...u,...i},G={...B,...C},H={raw:D,json:E}},95934:function(a,b,c){"use strict";c.r(b),c.d(b,{coerce:function(){return h},empty:function(){return d},equals:function(){return g},fromHex:function(){return f},fromString:function(){return j},isBinary:function(){return i},toHex:function(){return e},toString:function(){return k}});let d=new Uint8Array(0),e=a=>a.reduce((a,b)=>a+b.toString(16).padStart(2,"0"),""),f=a=>{let b=a.match(/../g);return b?new Uint8Array(b.map(a=>parseInt(a,16))):d},g=(a,b)=>{if(a===b)return!0;if(a.byteLength!==b.byteLength)return!1;for(let c=0;c<a.byteLength;c++)if(a[c]!==b[c])return!1;return!0},h=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")},i=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),j=a=>new TextEncoder().encode(a),k=a=>new TextDecoder().decode(a)},81362:function(a,b,c){"use strict";c.r(b),c.d(b,{CID:function(){return i}});var d=c(15216),e=c(28924),f=c(99086),g=c(22817),h=c(95934);class i{constructor(a,b,c,d){this.code=b,this.version=a,this.multihash=c,this.bytes=d,this.byteOffset=d.byteOffset,this.byteLength=d.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:r,byteLength:r,code:q,version:q,multihash:q,bytes:q,_baseCache:r,asCID:r})}toV0(){if(0===this.version)return this;{let{code:a,multihash:b}=this;if(a!==m)throw Error("Cannot convert a non dag-pb CID to CIDv0");if(b.code!==n)throw Error("Cannot convert non sha2-256 multihash CID to CIDv0");return i.createV0(b)}}toV1(){switch(this.version){case 0:{let{code:a,digest:b}=this.multihash,c=e.create(a,b);return i.createV1(this.code,c)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(a){return a&&this.code===a.code&&this.version===a.version&&e.equals(this.multihash,a.multihash)}toString(a){let{bytes:b,version:c,_baseCache:d}=this;return 0===c?k(b,d,a||f.base58btc.encoder):l(b,d,a||g.base32.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(a){return t(/^0\.0/,u),!!(a&&(a[p]||a.asCID===a))}get toBaseEncodedString(){throw Error("Deprecated, use .toString()")}get codec(){throw Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw Error('"multibaseName" property is deprecated')}get prefix(){throw Error('"prefix" property is deprecated')}static asCID(a){if(a instanceof i)return a;if(null!=a&&a.asCID===a){let{version:b,code:c,multihash:d,bytes:f}=a;return new i(b,c,d,f||o(b,c,d.bytes))}if(null==a|| !0!==a[p])return null;{let{version:g,multihash:h,code:j}=a,k=e.decode(h);return i.create(g,j,k)}}static create(a,b,c){if("number"!=typeof b)throw Error("String codecs are no longer supported");switch(a){case 0:if(b===m)return new i(a,b,c,c.bytes);throw Error(`Version 0 CID must use dag-pb (code: ${m}) block encoding`);case 1:{let d=o(a,b,c.bytes);return new i(a,b,c,d)}default:throw Error("Invalid version")}}static createV0(a){return i.create(0,m,a)}static createV1(a,b){return i.create(1,a,b)}static decode(a){let[b,c]=i.decodeFirst(a);if(c.length)throw Error("Incorrect length");return b}static decodeFirst(a){let b=i.inspectBytes(a),c=b.size-b.multihashSize,d=(0,h.coerce)(a.subarray(c,c+b.multihashSize));if(d.byteLength!==b.multihashSize)throw Error("Incorrect length");let f=d.subarray(b.multihashSize-b.digestSize),g=new e.Digest(b.multihashCode,b.digestSize,f,d),j=0===b.version?i.createV0(g):i.createV1(b.codec,g);return[j,a.subarray(b.size)]}static inspectBytes(a){let b=0,c=()=>{let[c,e]=d.Jx(a.subarray(b));return b+=e,c},e=c(),f=m;if(18===e?(e=0,b=0):1===e&&(f=c()),0!==e&&1!==e)throw RangeError(`Invalid CID version ${e}`);let g=b,h=c(),i=c(),j=b+i,k=j-g;return{version:e,codec:f,multihashCode:h,digestSize:i,multihashSize:k,size:j}}static parse(a,b){let[c,d]=j(a,b),e=i.decode(d);return e._baseCache.set(c,a),e}}let j=(a,b)=>{switch(a[0]){case"Q":{let c=b||f.base58btc;return[f.base58btc.prefix,c.decode(`${f.base58btc.prefix}${a}`)]}case f.base58btc.prefix:{let d=b||f.base58btc;return[f.base58btc.prefix,d.decode(a)]}case g.base32.prefix:{let e=b||g.base32;return[g.base32.prefix,e.decode(a)]}default:if(null==b)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[a[0],b.decode(a)]}},k=(a,b,c)=>{let{prefix:d}=c;if(d!==f.base58btc.prefix)throw Error(`Cannot string encode V0 in ${c.name} encoding`);let e=b.get(d);if(null!=e)return e;{let g=c.encode(a).slice(1);return b.set(d,g),g}},l=(a,b,c)=>{let{prefix:d}=c,e=b.get(d);if(null!=e)return e;{let f=c.encode(a);return b.set(d,f),f}},m=112,n=18,o=(a,b,c)=>{let e=d.P$(a),f=e+d.P$(b),g=new Uint8Array(f+c.byteLength);return d.mL(a,g,0),d.mL(b,g,e),g.set(c,f),g},p=Symbol.for("@ipld/js-cid/CID"),q={writable:!1,configurable:!1,enumerable:!0},r={writable:!1,enumerable:!1,configurable:!1},s="0.0.0-dev",t=(a,b)=>{if(a.test(s))console.warn(b);else throw Error(b)},u=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`},40950:function(a,b,c){"use strict";c.r(b),c.d(b,{code:function(){return g},decode:function(){return i},encode:function(){return h},name:function(){return f}});let d=new TextEncoder,e=new TextDecoder,f="json",g=512,h=a=>d.encode(JSON.stringify(a)),i=a=>JSON.parse(e.decode(a))},96945:function(a,b,c){"use strict";c.r(b),c.d(b,{code:function(){return f},decode:function(){return h},encode:function(){return g},name:function(){return e}});var d=c(95934);let e="raw",f=85,g=a=>(0,d.coerce)(a),h=a=>(0,d.coerce)(a)},28924:function(a,b,c){"use strict";c.r(b),c.d(b,{Digest:function(){return i},create:function(){return f},decode:function(){return g},equals:function(){return h}});var d=c(95934),e=c(15216);let f=(a,b)=>{let c=b.byteLength,d=e.P$(a),f=d+e.P$(c),g=new Uint8Array(f+c);return e.mL(a,g,0),e.mL(c,g,d),g.set(b,f),new i(a,c,b,g)},g=a=>{let b=(0,d.coerce)(a),[c,f]=e.Jx(b),[g,h]=e.Jx(b.subarray(f)),j=b.subarray(f+h);if(j.byteLength!==g)throw Error("Incorrect length");return new i(c,g,j,b)},h=(a,b)=>a===b||a.code===b.code&&a.size===b.size&&(0,d.equals)(a.bytes,b.bytes);class i{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}},7225:function(a,b,c){"use strict";c.d(b,{D:function(){return e}});var d=c(28924);let e=({name:a,code:b,encode:c})=>new f(a,b,c);class f{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?d.create(this.code,b):b.then(a=>d.create(this.code,a))}throw Error("Unknown type, must be binary type")}}},78103:function(a,b,c){"use strict";c.r(b),c.d(b,{identity:function(){return j}});var d=c(95934),e=c(28924);let f=0,g="identity",h=d.coerce,i=a=>e.create(f,h(a)),j={code:f,name:g,encode:h,digest:i}},56155:function(a,b,c){"use strict";c.r(b),c.d(b,{sha256:function(){return f},sha512:function(){return g}});var d=c(7225);let e=a=>async b=>new Uint8Array(await crypto.subtle.digest(a,b)),f=(0,d.D)({name:"sha2-256",code:18,encode:e("SHA-256")}),g=(0,d.D)({name:"sha2-512",code:19,encode:e("SHA-512")})},16441:function(a,b,c){"use strict";c.d(b,{aI:function(){return e},k0:function(){return d.CID}});var d=c(81362);c(15216);var e=c(95934);c(7225),c(28924)},15216:function(a,b,c){"use strict";c.d(b,{Jx:function(){return w},mL:function(){return x},"P$":function(){return y}});var d=h,e=128,f=-128,g=2147483648;function h(a,b,c){b=b||[];for(var d=c=c||0;a>=g;)b[c++]=255&a|e,a/=128;for(;a&f;)b[c++]=255&a|e,a>>>=7;return b[c]=0|a,h.bytes=c-d+1,b}var i=l,j=128,k=127;function l(a,b){var c,d=0,b=b||0,e=0,f=b,g=a.length;do{if(f>=g)throw l.bytes=0,RangeError("Could not decode varint");c=a[f++],d+=e<28?(c&k)<<e:(c&k)*Math.pow(2,e),e+=7}while(c>=j);return l.bytes=f-b,d}var m=128,n=16384,o=2097152,p=268435456,q=34359738368,r=4398046511104,s=562949953421312,t=72057594037927940,u=0x7fffffffffffffff,v={encode:d,decode:i,encodingLength:function(a){return a<m?1:a<n?2:a<o?3:a<p?4:a<q?5:a<r?6:a<s?7:a<t?8:a<u?9:10}};let w=a=>{let b=v.decode(a);return[b,v.decode.bytes]},x=(a,b,c=0)=>(v.encode(a,b,c),b),y=a=>v.encodingLength(a)},78647:function(a,b,c){"use strict";c.r(b),c.d(b,{customAlphabet:function(){return g},customRandom:function(){return f},nanoid:function(){return h},random:function(){return e},urlAlphabet:function(){return d}});let d="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",e=a=>crypto.getRandomValues(new Uint8Array(a)),f=(a,b,c)=>{let d=(2<<Math.log(a.length-1)/Math.LN2)-1,e=-~(1.6*d*b/a.length);return (f=b)=>{let g="";for(;;){let h=c(e),i=e;for(;i--;)if((g+=a[h[i]&d]||"").length===f)return g}}},g=(a,b=21)=>f(a,b,e),h=(a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((a,b)=>((b&=63)<36?a+=b.toString(36):b<62?a+=(b-26).toString(36).toUpperCase():b>62?a+="-":a+="_",a),"")},53160:function(a,b,c){"use strict";function d(a=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(a):new Uint8Array(a)}c.d(b,{E:function(){return d}})},20605:function(a,b,c){"use strict";c.r(b),c.d(b,{concat:function(){return e}});var d=c(53160);function e(a,b){b||(b=a.reduce((a,b)=>a+b.length,0));let c=(0,d.E)(b),e=0;for(let f of a)c.set(f,e),e+=f.length;return c}},19588:function(a,b,c){"use strict";function d(a,b){if(a===b)return!0;if(a.byteLength!==b.byteLength)return!1;for(let c=0;c<a.byteLength;c++)if(a[c]!==b[c])return!1;return!0}c.r(b),c.d(b,{equals:function(){return d}})},52217:function(a,b,c){"use strict";c.r(b),c.d(b,{fromString:function(){return e}});var d=c(67645);function e(a,b="utf8"){let c=d.Z[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(a,"utf8"):c.decoder.decode(`${c.prefix}${a}`)}},92263:function(a,b,c){"use strict";c.r(b),c.d(b,{toString:function(){return e}});var d=c(67645);function e(a,b="utf8"){let c=d.Z[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString("utf8"):c.encoder.encode(a).substring(1)}},67645:function(a,b,c){"use strict";var d=c(37211),e=c(53160);function f(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}let g=f("utf8","u",a=>{let b=new TextDecoder("utf8");return"u"+b.decode(a)},a=>{let b=new TextEncoder;return b.encode(a.substring(1))}),h=f("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{a=a.substring(1);let b=(0,e.E)(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),i={utf8:g,"utf-8":g,hex:d.gh.base16,latin1:h,ascii:h,binary:h,...d.gh};b.Z=i}}])